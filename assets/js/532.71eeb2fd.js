/*! For license information please see 532.71eeb2fd.js.LICENSE.txt */
"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[532],{8903:(e,t,n)=>{n.d(t,{G:()=>Ht});var i=n(2529),s=n(2300),r=n(5190),o=n(2068);class a{constructor(){this.radius=0,this.mass=0}load(e){e&&(void 0!==e.mass&&(this.mass=e.mass),void 0!==e.radius&&(this.radius=e.radius))}}class l extends o.PV{constructor(){super(),this.density=5,this.value=50,this.limit=new a}load(e){e&&(super.load(e),void 0!==e.density&&(this.density=e.density),(0,i.Et)(e.limit)?this.limit.radius=e.limit:this.limit.load(e.limit))}}class c{constructor(){this.color=new s.O,this.color.value="#000000",this.draggable=!1,this.opacity=1,this.destroy=!0,this.orbits=!1,this.size=new l}load(e){void 0!==e&&(void 0!==e.color&&(this.color=s.O.create(this.color,e.color)),void 0!==e.draggable&&(this.draggable=e.draggable),this.name=e.name,void 0!==e.opacity&&(this.opacity=e.opacity),void 0!==e.position&&(this.position={},void 0!==e.position.x&&(this.position.x=(0,r.DT)(e.position.x)),void 0!==e.position.y&&(this.position.y=(0,r.DT)(e.position.y))),void 0!==e.size&&this.size.load(e.size),void 0!==e.destroy&&(this.destroy=e.destroy),void 0!==e.orbits&&(this.orbits=e.orbits))}}var u=n(7883),d=n(5118);class h{constructor(e,t,n,i){this.absorbers=e,this.container=t,this._calcPosition=()=>{const e=(0,r.l1)({size:this.container.canvas.size,position:this.options.position});return u.M.create(e.x,e.y)},this._updateParticlePosition=(e,t)=>{if(e.destroyed)return;const n=this.container,i=n.canvas.size;if(e.needsNewPosition){const t=(0,r.Mh)({size:i});e.position.setTo(t),e.velocity.setTo(e.initialVelocity),e.absorberOrbit=void 0,e.needsNewPosition=!1}if(this.options.orbits){if(void 0===e.absorberOrbit&&(e.absorberOrbit=u.M.create(0,0),e.absorberOrbit.length=(0,r.Yf)(e.getPosition(),this.position),e.absorberOrbit.angle=(0,r.G0)()*Math.PI*2),e.absorberOrbit.length<=this.size&&!this.options.destroy){const t=Math.min(i.width,i.height);e.absorberOrbit.length=t*(.2*(0,r.G0)()-.1+1)}void 0===e.absorberOrbitDirection&&(e.absorberOrbitDirection=e.velocity.x>=0?"clockwise":"counter-clockwise");const s=e.absorberOrbit.length,o=e.absorberOrbit.angle,a=e.absorberOrbitDirection;e.velocity.setTo(u.M.origin);const l={x:"clockwise"===a?Math.cos:Math.sin,y:"clockwise"===a?Math.sin:Math.cos};e.position.x=this.position.x+s*l.x(o),e.position.y=this.position.y+s*l.y(o),e.absorberOrbit.length-=t.length,e.absorberOrbit.angle+=(e.retina.moveSpeed??0)*n.retina.pixelRatio/100*n.retina.reduceFactor}else{const n=u.M.origin;n.length=t.length,n.angle=t.angle,e.velocity.addTo(n)}},this.initialPosition=i?u.M.create(i.x,i.y):void 0,n instanceof c?this.options=n:(this.options=new c,this.options.load(n)),this.dragging=!1,this.name=this.options.name,this.opacity=this.options.opacity,this.size=(0,r.VG)(this.options.size.value)*t.retina.pixelRatio,this.mass=this.size*this.options.size.density*t.retina.reduceFactor;const s=this.options.size.limit;this.limit={radius:s.radius*t.retina.pixelRatio*t.retina.reduceFactor,mass:s.mass},this.color=(0,d.BN)(this.options.color)??{b:0,g:0,r:0},this.position=this.initialPosition?.copy()??this._calcPosition()}attract(e){const t=this.container,n=this.options;if(n.draggable){const e=t.interactivity.mouse;if(e.clicking&&e.downPosition){(0,r.Yf)(this.position,e.downPosition)<=this.size&&(this.dragging=!0)}else this.dragging=!1;this.dragging&&e.position&&(this.position.x=e.position.x,this.position.y=e.position.y)}const i=e.getPosition(),{dx:s,dy:o,distance:a}=(0,r.vr)(this.position,i),l=u.M.create(s,o);if(l.length=this.mass/Math.pow(a,2)*t.retina.reduceFactor,a<this.size+e.getRadius()){const i=.033*e.getRadius()*t.retina.pixelRatio;this.size>e.getRadius()&&a<this.size-e.getRadius()||void 0!==e.absorberOrbit&&e.absorberOrbit.length<0?n.destroy?e.destroy():(e.needsNewPosition=!0,this._updateParticlePosition(e,l)):(n.destroy&&(e.size.value-=i),this._updateParticlePosition(e,l)),(this.limit.radius<=0||this.size<this.limit.radius)&&(this.size+=i),(this.limit.mass<=0||this.mass<this.limit.mass)&&(this.mass+=i*this.options.size.density*t.retina.reduceFactor)}else this._updateParticlePosition(e,l)}draw(e){e.translate(this.position.x,this.position.y),e.beginPath(),e.arc(0,0,this.size,0,2*Math.PI,!1),e.closePath(),e.fillStyle=(0,d.xx)(this.color,this.opacity),e.fill()}resize(){const e=this.initialPosition;this.position=e&&(0,i.Tj)(e,this.container.canvas.size,u.M.origin)?e:this._calcPosition()}}class p{constructor(e){this.container=e,this.array=[],this.absorbers=[],this.interactivityAbsorbers=[],e.getAbsorber=e=>void 0===e||(0,i.Et)(e)?this.array[e||0]:this.array.find((t=>t.name===e)),e.addAbsorber=(e,t)=>this.addAbsorber(e,t)}addAbsorber(e,t){const n=new h(this,this.container,e,t);return this.array.push(n),n}draw(e){for(const t of this.array)t.draw(e)}handleClickMode(e){const t=this.absorbers,n=this.interactivityAbsorbers;if("absorber"===e){const e=(0,i.TA)(n)??(0,i.TA)(t),s=this.container.interactivity.mouse.clickPosition;this.addAbsorber(e,s)}}async init(){this.absorbers=this.container.actualOptions.absorbers,this.interactivityAbsorbers=this.container.actualOptions.interactivity.modes.absorbers,(0,i.wJ)(this.absorbers,(e=>{this.addAbsorber(e)}))}particleUpdate(e){for(const t of this.array)if(t.attract(e),e.destroyed)break}removeAbsorber(e){const t=this.array.indexOf(e);t>=0&&this.array.splice(t,1)}resize(){for(const e of this.array)e.resize()}stop(){this.array=[]}}class f{constructor(){this.id="absorbers"}getPlugin(e){return new p(e)}loadOptions(e,t){(this.needsPlugin(e)||this.needsPlugin(t))&&(t?.absorbers&&(e.absorbers=(0,i.wJ)(t.absorbers,(e=>{const t=new c;return t.load(e),t}))),e.interactivity.modes.absorbers=(0,i.wJ)(t?.interactivity?.modes?.absorbers,(e=>{const t=new c;return t.load(e),t})))}needsPlugin(e){if(!e)return!1;const t=e.absorbers;return(0,i.cy)(t)?!!t.length:!!t||!(!e.interactivity?.events?.onClick?.mode||!(0,i.hn)("absorber",e.interactivity.events.onClick.mode))}}class m{load(e){e&&(void 0!==e.bottom&&(this.bottom=(0,r.DT)(e.bottom)),void 0!==e.left&&(this.left=(0,r.DT)(e.left)),void 0!==e.right&&(this.right=(0,r.DT)(e.right)),void 0!==e.top&&(this.top=(0,r.DT)(e.top)))}}class v extends o.PV{constructor(){super(),this.value=3}}class g extends o.PV{constructor(){super(),this.value={min:4,max:9}}}class y{constructor(){this.count=1,this.factor=new v,this.rate=new g,this.sizeOffset=!0}load(e){e&&(void 0!==e.color&&(this.color=s.O.create(this.color,e.color)),void 0!==e.count&&(this.count=e.count),this.factor.load(e.factor),this.rate.load(e.rate),this.particles=(0,i.wJ)(e.particles,(e=>(0,i.zw)({},e))),void 0!==e.sizeOffset&&(this.sizeOffset=e.sizeOffset),e.colorOffset&&(this.colorOffset=this.colorOffset??{},void 0!==e.colorOffset.h&&(this.colorOffset.h=e.colorOffset.h),void 0!==e.colorOffset.s&&(this.colorOffset.s=e.colorOffset.s),void 0!==e.colorOffset.l&&(this.colorOffset.l=e.colorOffset.l)))}}class b{constructor(){this.bounds=new m,this.mode="none",this.split=new y}load(e){e&&(e.mode&&(this.mode=e.mode),e.bounds&&this.bounds.load(e.bounds),this.split.load(e.split))}}var _=n(2935);function w(e,t,n,s){const o=n.options.destroy;if(!o)return;const a=o.split,l=(0,_.y)(e,t,n.options),c=(0,r._W)(a.factor),u=n.getFillColor();a.color?l.color.load(a.color):a.colorOffset&&u?l.color.load({value:{hsl:{h:u.h+(0,r.VG)(a.colorOffset.h??0),s:u.s+(0,r.VG)(a.colorOffset.s??0),l:u.l+(0,r.VG)(a.colorOffset.l??0)}}}):l.color.load({value:{hsl:n.getFillColor()}}),l.move.load({center:{x:n.position.x,y:n.position.y,mode:"precise"}}),(0,i.Et)(l.size.value)?l.size.value/=c:(l.size.value.min/=c,l.size.value.max/=c),l.load(s);const d=a.sizeOffset?(0,r.DT)(-n.size.value,n.size.value):0,h={x:n.position.x+(0,r.U4)(d),y:n.position.y+(0,r.U4)(d)};return t.particles.addParticle(h,l,n.group,(e=>!(e.size.value<.5)&&(e.velocity.length=(0,r.U4)((0,r.DT)(n.velocity.length,e.velocity.length)),e.splitCount=(n.splitCount??0)+1,e.unbreakable=!0,setTimeout((()=>{e.unbreakable=!1}),500),!0)))}class k{constructor(e,t){this.engine=e,this.container=t}init(e){const t=this.container,n=e.options.destroy;if(!n)return;e.splitCount=0;const i=n.bounds;e.destroyBounds||(e.destroyBounds={});const{bottom:s,left:o,right:a,top:l}=i,{destroyBounds:c}=e,u=t.canvas.size;s&&(c.bottom=(0,r.VG)(s)*u.height/100),o&&(c.left=(0,r.VG)(o)*u.width/100),a&&(c.right=(0,r.VG)(a)*u.width/100),l&&(c.top=(0,r.VG)(l)*u.height/100)}isEnabled(e){return!e.destroyed}loadOptions(e,...t){e.destroy||(e.destroy=new b);for(const n of t)e.destroy.load(n?.destroy)}particleDestroyed(e,t){if(t)return;const n=e.options.destroy;n&&"split"===n.mode&&function(e,t,n){const s=n.options.destroy;if(!s)return;const o=s.split;if(o.count>=0&&(void 0===n.splitCount||n.splitCount++>o.count))return;const a=(0,r._W)(o.rate),l=(0,i.TA)(o.particles);for(let i=0;i<a;i++)w(e,t,n,l)}(this.engine,this.container,e)}update(e){if(!this.isEnabled(e))return;const t=e.getPosition(),n=e.destroyBounds;n&&(void 0!==n.bottom&&t.y>=n.bottom||void 0!==n.left&&t.x<=n.left||void 0!==n.right&&t.x>=n.right||void 0!==n.top&&t.y<=n.top)&&e.destroy()}}class x{randomPosition(e,t,n){const[i,s]=[t.width/2,t.height/2],o=((e,t)=>{const n=(0,r.G0)()/4,i=Math.atan(t/e*Math.tan(2*Math.PI*n)),s=(0,r.G0)();return s<.25?i:s<.5?Math.PI-i:s<.75?Math.PI+i:-i})(i,s),a=(d=o,(c=i)*(u=s)/Math.sqrt((u*Math.cos(d))**2+(c*Math.sin(d))**2)),l=n?a*Math.sqrt((0,r.G0)()):a;var c,u,d;return{x:e.x+l*Math.cos(o),y:e.y+l*Math.sin(o)}}}var S=n(5337);class E{constructor(){this.wait=!1}load(e){e&&(void 0!==e.count&&(this.count=e.count),void 0!==e.delay&&(this.delay=(0,r.DT)(e.delay)),void 0!==e.duration&&(this.duration=(0,r.DT)(e.duration)),void 0!==e.wait&&(this.wait=e.wait))}}class C{constructor(){this.quantity=1,this.delay=.1}load(e){void 0!==e&&(void 0!==e.quantity&&(this.quantity=(0,r.DT)(e.quantity)),void 0!==e.delay&&(this.delay=(0,r.DT)(e.delay)))}}class T{constructor(){this.mode="percent",this.height=0,this.width=0}load(e){void 0!==e&&(void 0!==e.mode&&(this.mode=e.mode),void 0!==e.height&&(this.height=e.height),void 0!==e.width&&(this.width=e.width))}}class M{constructor(){this.autoPlay=!0,this.fill=!0,this.life=new E,this.rate=new C,this.shape="square",this.startCount=0}load(e){e&&(void 0!==e.autoPlay&&(this.autoPlay=e.autoPlay),void 0!==e.size&&(this.size||(this.size=new T),this.size.load(e.size)),void 0!==e.direction&&(this.direction=e.direction),this.domId=e.domId,void 0!==e.fill&&(this.fill=e.fill),this.life.load(e.life),this.name=e.name,this.particles=(0,i.wJ)(e.particles,(e=>(0,i.zw)({},e))),this.rate.load(e.rate),void 0!==e.shape&&(this.shape=e.shape),void 0!==e.position&&(this.position={},void 0!==e.position.x&&(this.position.x=(0,r.DT)(e.position.x)),void 0!==e.position.y&&(this.position.y=(0,r.DT)(e.position.y))),void 0!==e.spawnColor&&(void 0===this.spawnColor&&(this.spawnColor=new S.A),this.spawnColor.load(e.spawnColor)),void 0!==e.startCount&&(this.startCount=e.startCount))}}class A{constructor(e,t,n,s,o){this.emitters=t,this.container=n,this._calcPosition=()=>(0,r.l1)({size:this.container.canvas.size,position:this.options.position}),this._destroy=()=>{this.emitters.removeEmitter(this),this._engine.dispatchEvent("emitterDestroyed",{container:this.container,data:{emitter:this}})},this._emit=()=>{if(this._paused)return;const e=(0,r.VG)(this.options.rate.quantity);this._emitParticles(e)},this._emitParticles=e=>{const t=this.getPosition(),n=this.getSize(),s=(0,i.TA)(this._particlesOptions);for(let r=0;r<e;r++){const e=(0,i.zw)({},s);if(this.spawnColor){const t=this.options.spawnColor?.animation;t&&(this.spawnColor.h=this._setColorAnimation(t.h,this.spawnColor.h,360),this.spawnColor.s=this._setColorAnimation(t.s,this.spawnColor.s,100),this.spawnColor.l=this._setColorAnimation(t.l,this.spawnColor.l,100)),e.color?e.color.value=this.spawnColor:e.color={value:this.spawnColor}}if(!t)return;const r=this._shape?.randomPosition(t,n,this.fill)??t;this.container.particles.addParticle(r,e)}},this._prepareToDie=()=>{if(this._paused)return;const e=void 0!==this.options.life?.duration?(0,r.VG)(this.options.life.duration):void 0;this.container.retina.reduceFactor&&(this._lifeCount>0||this._immortal)&&void 0!==e&&e>0&&(this._duration=1e3*e)},this._setColorAnimation=(e,t,n)=>{const i=this.container;if(!e.enable)return t;const s=(0,r.U4)(e.offset),o=1e3*(0,r.VG)(this.options.rate.delay)/i.retina.reduceFactor;return(t+(0,r.VG)(e.speed??0)*i.fpsLimit/o+3.6*s)%n},this._engine=e,this._currentDuration=0,this._currentEmitDelay=0,this._currentSpawnDelay=0,this._initialPosition=o,s instanceof M?this.options=s:(this.options=new M,this.options.load(s)),this._spawnDelay=1e3*(0,r.VG)(this.options.life.delay??0)/this.container.retina.reduceFactor,this.position=this._initialPosition??this._calcPosition(),this.name=this.options.name,this._shape=this._engine.emitterShapeManager?.getShape(this.options.shape),this.fill=this.options.fill,this._firstSpawn=!this.options.life.wait,this._startParticlesAdded=!1;let a=(0,i.zw)({},this.options.particles);a??={},a.move??={},a.move.direction??=this.options.direction,this.options.spawnColor&&(this.spawnColor=(0,d.R5)(this.options.spawnColor)),this._paused=!this.options.autoPlay,this._particlesOptions=a,this.size=this.options.size??(()=>{const e=new T;return e.load({height:0,mode:"percent",width:0}),e})(),this._lifeCount=this.options.life.count??-1,this._immortal=this._lifeCount<=0,this._engine.dispatchEvent("emitterCreated",{container:n,data:{emitter:this}}),this.play()}externalPause(){this._paused=!0,this.pause()}externalPlay(){this._paused=!1,this.play()}getPosition(){if(this.options.domId){const e=this.container,t=document.getElementById(this.options.domId);if(t){const n=t.getBoundingClientRect();return{x:(n.x+n.width/2)*e.retina.pixelRatio,y:(n.y+n.height/2)*e.retina.pixelRatio}}}return this.position}getSize(){const e=this.container;if(this.options.domId){const t=document.getElementById(this.options.domId);if(t){const n=t.getBoundingClientRect();return{width:n.width*e.retina.pixelRatio,height:n.height*e.retina.pixelRatio}}}return(0,i.YC)(this.size,e.canvas.size)}pause(){this._paused||delete this._emitDelay}play(){if(!this._paused&&this.container.retina.reduceFactor&&(this._lifeCount>0||this._immortal||!this.options.life.count)&&(this._firstSpawn||this._currentSpawnDelay>=(this._spawnDelay??0))){if(void 0===this._emitDelay){const e=(0,r.VG)(this.options.rate.delay);this._emitDelay=1e3*e/this.container.retina.reduceFactor}(this._lifeCount>0||this._immortal)&&this._prepareToDie()}}resize(){const e=this._initialPosition;this.position=e&&(0,i.Tj)(e,this.container.canvas.size,u.M.origin)?e:this._calcPosition()}update(e){this._paused||(this._firstSpawn&&(this._firstSpawn=!1,this._currentSpawnDelay=this._spawnDelay??0,this._currentEmitDelay=this._emitDelay??0),this._startParticlesAdded||(this._startParticlesAdded=!0,this._emitParticles(this.options.startCount)),void 0!==this._duration&&(this._currentDuration+=e.value,this._currentDuration>=this._duration&&(this.pause(),void 0!==this._spawnDelay&&delete this._spawnDelay,this._immortal||this._lifeCount--,this._lifeCount>0||this._immortal?(this.position=this._calcPosition(),this._spawnDelay=1e3*(0,r.VG)(this.options.life.delay??0)/this.container.retina.reduceFactor):this._destroy(),this._currentDuration-=this._duration,delete this._duration)),void 0!==this._spawnDelay&&(this._currentSpawnDelay+=e.value,this._currentSpawnDelay>=this._spawnDelay&&(this._engine.dispatchEvent("emitterPlay",{container:this.container}),this.play(),this._currentSpawnDelay-=this._currentSpawnDelay,delete this._spawnDelay)),void 0!==this._emitDelay&&(this._currentEmitDelay+=e.value,this._currentEmitDelay>=this._emitDelay&&(this._emit(),this._currentEmitDelay-=this._emitDelay)))}}class I{constructor(e,t){this.container=t,this._engine=e,this.array=[],this.emitters=[],this.interactivityEmitters={random:{count:1,enable:!1},value:[]},t.getEmitter=e=>void 0===e||(0,i.Et)(e)?this.array[e||0]:this.array.find((t=>t.name===e)),t.addEmitter=(e,t)=>this.addEmitter(e,t),t.removeEmitter=e=>{const n=t.getEmitter(e);n&&this.removeEmitter(n)},t.playEmitter=e=>{const n=t.getEmitter(e);n&&n.externalPlay()},t.pauseEmitter=e=>{const n=t.getEmitter(e);n&&n.externalPause()}}addEmitter(e,t){const n=new M;n.load(e);const i=new A(this._engine,this,this.container,n,t);return this.array.push(i),i}handleClickMode(e){const t=this.emitters,n=this.interactivityEmitters;if("emitter"!==e)return;let s;if(n&&(0,i.cy)(n.value))if(n.value.length>0&&n.random.enable){s=[];const e=[];for(let t=0;t<n.random.count;t++){const r=(0,i.n0)(n.value);e.includes(r)&&e.length<n.value.length?t--:(e.push(r),s.push((0,i.Vh)(n.value,r)))}}else s=n.value;else s=n?.value;const r=s??t,o=this.container.interactivity.mouse.clickPosition;(0,i.wJ)(r,(e=>{this.addEmitter(e,o)}))}async init(){if(this.emitters=this.container.actualOptions.emitters,this.interactivityEmitters=this.container.actualOptions.interactivity.modes.emitters,this.emitters)if((0,i.cy)(this.emitters))for(const e of this.emitters)this.addEmitter(e);else this.addEmitter(this.emitters)}pause(){for(const e of this.array)e.pause()}play(){for(const e of this.array)e.play()}removeEmitter(e){const t=this.array.indexOf(e);t>=0&&this.array.splice(t,1)}resize(){for(const e of this.array)e.resize()}stop(){this.array=[]}update(e){for(const t of this.array)t.update(e)}}const R=new Map;class O{constructor(e){this._engine=e}addShape(e,t){this.getShape(e)||R.set(e,t)}getShape(e){return R.get(e)}getSupportedShapes(){return R.keys()}}function L(e,t){return e+t*((0,r.G0)()-.5)}class P{randomPosition(e,t,n){if(n)return{x:L(e.x,t.width),y:L(e.y,t.height)};{const n=t.width/2,i=t.height/2,s=Math.floor(4*(0,r.G0)()),o=2*((0,r.G0)()-.5);switch(s){case 0:return{x:e.x+o*n,y:e.y-i};case 1:return{x:e.x-n,y:e.y+o*i};case 2:return{x:e.x+o*n,y:e.y+i};default:return{x:e.x+n,y:e.y+o*i}}}}}class D{constructor(e){this._engine=e,this.id="emitters"}getPlugin(e){return new I(this._engine,e)}loadOptions(e,t){if(!this.needsPlugin(e)&&!this.needsPlugin(t))return;t?.emitters&&(e.emitters=(0,i.wJ)(t.emitters,(e=>{const t=new M;return t.load(e),t})));const n=t?.interactivity?.modes?.emitters;if(n)if((0,i.cy)(n))e.interactivity.modes.emitters={random:{count:1,enable:!0},value:n.map((e=>{const t=new M;return t.load(e),t}))};else{const t=n;if(void 0!==t.value)if((0,i.cy)(t.value))e.interactivity.modes.emitters={random:{count:t.random.count??1,enable:t.random.enable??!1},value:t.value.map((e=>{const t=new M;return t.load(e),t}))};else{const n=new M;n.load(t.value),e.interactivity.modes.emitters={random:{count:t.random.count??1,enable:t.random.enable??!1},value:n}}else{(e.interactivity.modes.emitters={random:{count:1,enable:!1},value:new M}).value.load(n)}}}needsPlugin(e){if(!e)return!1;const t=e.emitters;return(0,i.cy)(t)&&!!t.length||void 0!==t||!!e.interactivity?.events?.onClick?.mode&&(0,i.hn)("emitter",e.interactivity.events.onClick.mode)}}class N{constructor(e){this.container=e,this.type="external"}}class z{constructor(){this.delay=1,this.pauseOnStop=!1,this.quantity=1}load(e){e&&(void 0!==e.delay&&(this.delay=e.delay),void 0!==e.quantity&&(this.quantity=e.quantity),void 0!==e.particles&&(this.particles=(0,i.zw)({},e.particles)),void 0!==e.pauseOnStop&&(this.pauseOnStop=e.pauseOnStop))}}class B extends N{constructor(e){super(e),this._delay=0}clear(){}init(){}async interact(e){const t=this.container,{interactivity:n}=t;if(!t.retina.reduceFactor)return;const i=t.actualOptions.interactivity.modes.trail;if(!i)return;const s=1e3*i.delay/this.container.retina.reduceFactor;if(this._delay<s&&(this._delay+=e.value),this._delay<s)return;const r=!(i.pauseOnStop&&(n.mouse.position===this._lastPosition||n.mouse.position?.x===this._lastPosition?.x&&n.mouse.position?.y===this._lastPosition?.y)),o=t.interactivity.mouse.position;o?this._lastPosition={...o}:delete this._lastPosition,r&&t.particles.push(i.quantity,t.interactivity.mouse,i.particles),this._delay-=s}isEnabled(e){const t=this.container,n=t.actualOptions,s=t.interactivity.mouse,r=(e?.interactivity??n.interactivity).events;return s.clicking&&s.inside&&!!s.position&&(0,i.hn)("trail",r.onClick.mode)||s.inside&&!!s.position&&(0,i.hn)("trail",r.onHover.mode)}loadModeOptions(e,...t){e.trail||(e.trail=new z);for(const n of t)e.trail.load(n?.trail)}reset(){}}class F{constructor(){this.enable=!1,this.value=0}load(e){e&&(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.value&&(this.value=(0,r.DT)(e.value)))}}class U{constructor(){this.darken=new F,this.enable=!1,this.enlighten=new F,this.mode="vertical",this.speed=25}load(e){e&&(void 0!==e.backColor&&(this.backColor=s.O.create(this.backColor,e.backColor)),this.darken.load(e.darken),void 0!==e.enable&&(this.enable=e.enable),this.enlighten.load(e.enlighten),void 0!==e.mode&&(this.mode=e.mode),void 0!==e.speed&&(this.speed=(0,r.DT)(e.speed)))}}class j{getTransformValues(e){const t=e.roll?.enable&&e.roll,n=t&&t.horizontal,i=t&&t.vertical;return{a:n?Math.cos(t.angle):void 0,d:i?Math.sin(t.angle):void 0}}init(e){!function(e){const t=e.options.roll;if(t?.enable)if(e.roll={enable:t.enable,horizontal:"horizontal"===t.mode||"both"===t.mode,vertical:"vertical"===t.mode||"both"===t.mode,angle:(0,r.G0)()*Math.PI*2,speed:(0,r.VG)(t.speed)/360},t.backColor)e.backColor=(0,d.R5)(t.backColor);else if(t.darken.enable&&t.enlighten.enable){const n=(0,r.G0)()>=.5?"darken":"enlighten";e.roll.alter={type:n,value:(0,r.VG)("darken"===n?t.darken.value:t.enlighten.value)}}else t.darken.enable?e.roll.alter={type:"darken",value:(0,r.VG)(t.darken.value)}:t.enlighten.enable&&(e.roll.alter={type:"enlighten",value:(0,r.VG)(t.enlighten.value)});else e.roll={enable:!1,horizontal:!1,vertical:!1,angle:0,speed:0}}(e)}isEnabled(e){const t=e.options.roll;return!e.destroyed&&!e.spawning&&!!t?.enable}loadOptions(e,...t){e.roll||(e.roll=new U);for(const n of t)e.roll.load(n?.roll)}update(e,t){this.isEnabled(e)&&function(e,t){const n=e.options.roll,i=e.roll;if(!i||!n?.enable)return;const s=i.speed*t.factor,r=2*Math.PI;i.angle+=s,i.angle>r&&(i.angle-=r)}(e,t)}}var q=n(3134);class V{static init(e){const t=new V,n=e.selector;if(!n)throw new Error("No selector provided");const i=document.querySelector(n);if(!i)throw new Error("No element found for selector");return q.$k.set(n.replace(".","").replace("!",""),i,{fullScreen:{enable:!1},particles:{color:{value:e.color??"!000000"},links:{color:"random",distance:e.minDistance??120,enable:e.connectParticles??!1},move:{enable:!0,speed:e.speed??.5},number:{value:e.maxParticles??100},size:{value:{min:1,max:e.sizeVariations??3}}},responsive:e.responsive?.map((t=>({maxWidth:t.breakpoint,options:{particles:{color:{value:t.options?.color},links:{distance:t.options?.minDistance,enable:t.options?.connectParticles},number:{value:e.maxParticles},move:{enable:!0,speed:t.options?.speed},size:{value:t.options?.sizeVariations}}}})))}).then((e=>{t._container=e})),t}destroy(){const e=this._container;e&&e.destroy()}pauseAnimation(){const e=this._container;e&&e.pause()}resumeAnimation(){const e=this._container;e&&e.play()}}const H=e=>{const{particlesJS:t,pJSDom:n}=(e=>{const t=(t,n)=>e.load(t,n);return t.load=(t,n,i)=>{e.loadJSON(t,n).then((e=>{e&&i(e)})).catch((()=>{i(void 0)}))},t.setOnClickHandler=t=>{e.setOnClickHandler(t)},{particlesJS:t,pJSDom:e.dom()}})(e);return window.particlesJS=t,window.pJSDom=n,window.Particles=V,{particlesJS:t,pJSDom:n,Particles:V}};function G(e,t,n,i,s,o){!function(e,t){const n=e.options,i=n.move.path;if(!i.enable)return;if(e.lastPathTime<=e.pathDelay)return void(e.lastPathTime+=t.value);const s=e.pathGenerator?.generate(e,t);s&&e.velocity.addTo(s);i.clamp&&(e.velocity.x=(0,r.qE)(e.velocity.x,-1,1),e.velocity.y=(0,r.qE)(e.velocity.y,-1,1));e.lastPathTime-=e.pathDelay}(e,o);const a=e.gravity,l=a?.enable&&a.inverse?-1:1;s&&n&&(e.velocity.x+=s*o.factor/(60*n)),a?.enable&&n&&(e.velocity.y+=l*(a.acceleration*o.factor)/(60*n));const c=e.moveDecay;e.velocity.multTo(c);const u=e.velocity.mult(n);a?.enable&&i>0&&(!a.inverse&&u.y>=0&&u.y>=i||a.inverse&&u.y<=0&&u.y<=-i)&&(u.y=l*i,n&&(e.velocity.y=u.y/n));const d=e.options.zIndex,h=(1-e.zIndexFactor)**d.velocityRate;u.multTo(h);const{position:p}=e;p.addTo(u),t.vibrate&&(p.x+=Math.sin(p.x*Math.cos(p.y)),p.y+=Math.cos(p.y*Math.sin(p.x)))}class W{constructor(){this._initSpin=e=>{const t=e.container,n=e.options.move.spin;if(!n.enable)return;const i=n.position??{x:50,y:50},s={x:i.x/100*t.canvas.size.width,y:i.y/100*t.canvas.size.height},o=e.getPosition(),a=(0,r.Yf)(o,s),l=(0,r.VG)(n.acceleration);e.retina.spinAcceleration=l*t.retina.pixelRatio,e.spin={center:s,direction:e.velocity.x>=0?"clockwise":"counter-clockwise",angle:e.velocity.angle,radius:a,acceleration:e.retina.spinAcceleration}}}init(e){const t=e.options.move.gravity;e.gravity={enable:t.enable,acceleration:(0,r.VG)(t.acceleration),inverse:t.inverse},this._initSpin(e)}isEnabled(e){return!e.destroyed&&e.options.move.enable}move(e,t){const n=e.options,i=n.move;if(!i.enable)return;const s=e.container,o=s.retina.pixelRatio,a=function(e){return e.slow.inRange?e.slow.factor:1}(e),l=(e.retina.moveSpeed??=(0,r.VG)(i.speed)*o)*s.retina.reduceFactor,c=e.retina.moveDrift??=(0,r.VG)(e.options.move.drift)*o,u=(0,r.W9)(n.size.value)*o,d=l*(i.size?e.getRadius()/u:1)*a*(t.factor||1)/2,h=e.retina.maxSpeed??s.retina.maxSpeed;i.spin.enable?function(e,t){const n=e.container;if(!e.spin)return;const i={x:"clockwise"===e.spin.direction?Math.cos:Math.sin,y:"clockwise"===e.spin.direction?Math.sin:Math.cos};e.position.x=e.spin.center.x+e.spin.radius*i.x(e.spin.angle),e.position.y=e.spin.center.y+e.spin.radius*i.y(e.spin.angle),e.spin.radius+=e.spin.acceleration;const s=Math.max(n.canvas.size.width,n.canvas.size.height);e.spin.radius>s/2?(e.spin.radius=s/2,e.spin.acceleration*=-1):e.spin.radius<0&&(e.spin.radius=0,e.spin.acceleration*=-1),e.spin.angle+=t/100*(1-e.spin.radius/s)}(e,d):G(e,i,d,h,c,t),function(e){const t=e.initialPosition,{dx:n,dy:i}=(0,r.vr)(t,e.position),s=Math.abs(n),o=Math.abs(i),{maxDistance:a}=e.retina,l=a.horizontal,c=a.vertical;if(l||c)if((l&&s>=l||c&&o>=c)&&!e.misplaced)e.misplaced=!!l&&s>l||!!c&&o>c,l&&(e.velocity.x=e.velocity.y/2-e.velocity.x),c&&(e.velocity.y=e.velocity.x/2-e.velocity.y);else if((!l||s<l)&&(!c||o<c)&&e.misplaced)e.misplaced=!1;else if(e.misplaced){const n=e.position,i=e.velocity;l&&(n.x<t.x&&i.x<0||n.x>t.x&&i.x>0)&&(i.x*=-(0,r.G0)()),c&&(n.y<t.y&&i.y<0||n.y>t.y&&i.y>0)&&(i.y*=-(0,r.G0)())}}(e)}}class K{draw(e,t,n){t.circleRange||(t.circleRange={min:0,max:2*Math.PI});const i=t.circleRange;e.arc(0,0,n,i.min,i.max,!1)}getSidesCount(){return 12}particleInit(e,t){const n=t.shapeData,s=n?.angle??{max:360,min:0};t.circleRange=(0,i.Gv)(s)?{min:s.min*Math.PI/180,max:s.max*Math.PI/180}:{min:0,max:s*Math.PI/180}}}function J(e,t,n,i,s){if(!t||!n.enable||(t.maxLoops??0)>0&&(t.loops??0)>(t.maxLoops??0))return;if(t.time||(t.time=0),(t.delayTime??0)>0&&t.time<(t.delayTime??0)&&(t.time+=e.value),(t.delayTime??0)>0&&t.time<(t.delayTime??0))return;const o=(0,r.U4)(n.offset),a=(t.velocity??0)*e.factor+3.6*o,l=t.decay??1;s&&"increasing"!==t.status?(t.value-=a,t.value<0&&(t.loops||(t.loops=0),t.loops++,t.status="increasing",t.value+=t.value)):(t.value+=a,t.value>i&&(t.loops||(t.loops=0),t.loops++,s&&(t.status="decreasing",t.value-=t.value%i))),t.velocity&&1!==l&&(t.velocity*=l),t.value>i&&(t.value%=i)}class Y{constructor(e){this.container=e}init(e){const t=(0,d.R5)(e.options.color,e.id,e.options.reduceDuplicates);t&&(e.color=(0,d.pz)(t,e.options.color.animation,this.container.retina.reduceFactor))}isEnabled(e){const{h:t,s:n,l:i}=e.options.color.animation,{color:s}=e;return!e.destroyed&&!e.spawning&&(void 0!==s?.h.value&&t.enable||void 0!==s?.s.value&&n.enable||void 0!==s?.l.value&&i.enable)}update(e,t){!function(e,t){const{h:n,s:i,l:s}=e.options.color.animation,{color:r}=e;if(!r)return;const{h:o,s:a,l:l}=r;o&&J(t,o,n,360,!1),a&&J(t,a,i,100,!0),l&&J(t,l,s,100,!0)}(e,t)}}class Z{constructor(e){this.container=e}init(e){const t=e.options.opacity;e.opacity=(0,i.Xs)(t,1);const n=t.animation;n.enable&&(e.opacity.velocity=(0,r.VG)(n.speed)/100*this.container.retina.reduceFactor,n.sync||(e.opacity.velocity*=(0,r.G0)()))}isEnabled(e){return!e.destroyed&&!e.spawning&&!!e.opacity&&e.opacity.enable&&((e.opacity.maxLoops??0)<=0||(e.opacity.maxLoops??0)>0&&(e.opacity.loops??0)<(e.opacity.maxLoops??0))}reset(e){e.opacity&&(e.opacity.time=0,e.opacity.loops=0)}update(e,t){this.isEnabled(e)&&function(e,t){const n=e.opacity;if(e.destroyed||!n?.enable||(n.maxLoops??0)>0&&(n.loops??0)>(n.maxLoops??0))return;const i=n.min,s=n.max,o=n.decay??1;if(n.time||(n.time=0),(n.delayTime??0)>0&&n.time<(n.delayTime??0)&&(n.time+=t.value),!((n.delayTime??0)>0&&n.time<(n.delayTime??0))){switch(n.status){case"increasing":n.value>=s?(n.status="decreasing",n.loops||(n.loops=0),n.loops++):n.value+=(n.velocity??0)*t.factor;break;case"decreasing":n.value<=i?(n.status="increasing",n.loops||(n.loops=0),n.loops++):n.value-=(n.velocity??0)*t.factor}n.velocity&&1!==n.decay&&(n.velocity*=o),function(e,t,n,i){switch(e.options.opacity.animation.destroy){case"max":t>=i&&e.destroy();break;case"min":t<=n&&e.destroy()}}(e,n.value,i,s),e.destroyed||(n.value=(0,r.qE)(n.value,i,s))}}(e,t)}}class X{constructor(e){this.container=e,this.modes=["bounce","bounce-vertical","bounce-horizontal","bounceVertical","bounceHorizontal","split"]}update(e,t,n,s){if(!this.modes.includes(s))return;const o=this.container;let a=!1;for(const[,i]of o.plugins)if(void 0!==i.particleBounce&&(a=i.particleBounce(e,n,t)),a)break;if(a)return;const l=e.getPosition(),c=e.offset,u=e.getRadius(),d=(0,i.AE)(l,u),h=o.canvas.size;!function(e){if("bounce"!==e.outMode&&"bounce-horizontal"!==e.outMode&&"bounceHorizontal"!==e.outMode&&"split"!==e.outMode||"left"!==e.direction&&"right"!==e.direction)return;e.bounds.right<0&&"left"===e.direction?e.particle.position.x=e.size+e.offset.x:e.bounds.left>e.canvasSize.width&&"right"===e.direction&&(e.particle.position.x=e.canvasSize.width-e.size-e.offset.x);const t=e.particle.velocity.x;let n=!1;if("right"===e.direction&&e.bounds.right>=e.canvasSize.width&&t>0||"left"===e.direction&&e.bounds.left<=0&&t<0){const t=(0,r._W)(e.particle.options.bounce.horizontal);e.particle.velocity.x*=-t,n=!0}if(!n)return;const i=e.offset.x+e.size;e.bounds.right>=e.canvasSize.width&&"right"===e.direction?e.particle.position.x=e.canvasSize.width-i:e.bounds.left<=0&&"left"===e.direction&&(e.particle.position.x=i),"split"===e.outMode&&e.particle.destroy()}({particle:e,outMode:s,direction:t,bounds:d,canvasSize:h,offset:c,size:u}),function(e){if("bounce"!==e.outMode&&"bounce-vertical"!==e.outMode&&"bounceVertical"!==e.outMode&&"split"!==e.outMode||"bottom"!==e.direction&&"top"!==e.direction)return;e.bounds.bottom<0&&"top"===e.direction?e.particle.position.y=e.size+e.offset.y:e.bounds.top>e.canvasSize.height&&"bottom"===e.direction&&(e.particle.position.y=e.canvasSize.height-e.size-e.offset.y);const t=e.particle.velocity.y;let n=!1;if("bottom"===e.direction&&e.bounds.bottom>=e.canvasSize.height&&t>0||"top"===e.direction&&e.bounds.top<=0&&t<0){const t=(0,r._W)(e.particle.options.bounce.vertical);e.particle.velocity.y*=-t,n=!0}if(!n)return;const i=e.offset.y+e.size;e.bounds.bottom>=e.canvasSize.height&&"bottom"===e.direction?e.particle.position.y=e.canvasSize.height-i:e.bounds.top<=0&&"top"===e.direction&&(e.particle.position.y=i),"split"===e.outMode&&e.particle.destroy()}({particle:e,outMode:s,direction:t,bounds:d,canvasSize:h,offset:c,size:u})}}class ${constructor(e){this.container=e,this.modes=["destroy"]}update(e,t,n,s){if(!this.modes.includes(s))return;const o=this.container;switch(e.outType){case"normal":case"outside":if((0,i.Tj)(e.position,o.canvas.size,u.M.origin,e.getRadius(),t))return;break;case"inside":{const{dx:t,dy:n}=(0,r.vr)(e.position,e.moveCenter),{x:i,y:s}=e.velocity;if(i<0&&t>e.moveCenter.radius||s<0&&n>e.moveCenter.radius||i>=0&&t<-e.moveCenter.radius||s>=0&&n<-e.moveCenter.radius)return;break}}o.particles.remove(e,void 0,!0)}}class Q{constructor(e){this.container=e,this.modes=["none"]}update(e,t,n,s){if(!this.modes.includes(s))return;if(e.options.move.distance.horizontal&&("left"===t||"right"===t)||e.options.move.distance.vertical&&("top"===t||"bottom"===t))return;const r=e.options.move.gravity,o=this.container,a=o.canvas.size,l=e.getRadius();if(r.enable){const n=e.position;(!r.inverse&&n.y>a.height+l&&"bottom"===t||r.inverse&&n.y<-l&&"top"===t)&&o.particles.remove(e)}else{if(e.velocity.y>0&&e.position.y<=a.height+l||e.velocity.y<0&&e.position.y>=-l||e.velocity.x>0&&e.position.x<=a.width+l||e.velocity.x<0&&e.position.x>=-l)return;(0,i.Tj)(e.position,o.canvas.size,u.M.origin,l,t)||o.particles.remove(e)}}}class ee{constructor(e){this.container=e,this.modes=["out"]}update(e,t,n,s){if(!this.modes.includes(s))return;const o=this.container;switch(e.outType){case"inside":{const{x:t,y:n}=e.velocity,i=u.M.origin;i.length=e.moveCenter.radius,i.angle=e.velocity.angle+Math.PI,i.addTo(u.M.create(e.moveCenter));const{dx:s,dy:a}=(0,r.vr)(e.position,i);if(t<=0&&s>=0||n<=0&&a>=0||t>=0&&s<=0||n>=0&&a<=0)return;e.position.x=Math.floor((0,r.U4)({min:0,max:o.canvas.size.width})),e.position.y=Math.floor((0,r.U4)({min:0,max:o.canvas.size.height}));const{dx:l,dy:c}=(0,r.vr)(e.position,e.moveCenter);e.direction=Math.atan2(-c,-l),e.velocity.angle=e.direction;break}default:if((0,i.Tj)(e.position,o.canvas.size,u.M.origin,e.getRadius(),t))return;switch(e.outType){case"outside":{e.position.x=Math.floor((0,r.U4)({min:-e.moveCenter.radius,max:e.moveCenter.radius}))+e.moveCenter.x,e.position.y=Math.floor((0,r.U4)({min:-e.moveCenter.radius,max:e.moveCenter.radius}))+e.moveCenter.y;const{dx:t,dy:n}=(0,r.vr)(e.position,e.moveCenter);e.moveCenter.radius&&(e.direction=Math.atan2(n,t),e.velocity.angle=e.direction);break}case"normal":{const n=e.options.move.warp,s=o.canvas.size,a={bottom:s.height+e.getRadius()+e.offset.y,left:-e.getRadius()-e.offset.x,right:s.width+e.getRadius()+e.offset.x,top:-e.getRadius()-e.offset.y},l=e.getRadius(),c=(0,i.AE)(e.position,l);"right"===t&&c.left>s.width+e.offset.x?(e.position.x=a.left,e.initialPosition.x=e.position.x,n||(e.position.y=(0,r.G0)()*s.height,e.initialPosition.y=e.position.y)):"left"===t&&c.right<-e.offset.x&&(e.position.x=a.right,e.initialPosition.x=e.position.x,n||(e.position.y=(0,r.G0)()*s.height,e.initialPosition.y=e.position.y)),"bottom"===t&&c.top>s.height+e.offset.y?(n||(e.position.x=(0,r.G0)()*s.width,e.initialPosition.x=e.position.x),e.position.y=a.top,e.initialPosition.y=e.position.y):"top"===t&&c.bottom<-e.offset.y&&(n||(e.position.x=(0,r.G0)()*s.width,e.initialPosition.x=e.position.x),e.position.y=a.bottom,e.initialPosition.y=e.position.y);break}}}}}class te{constructor(e){this.container=e,this._updateOutMode=(e,t,n,i)=>{for(const s of this.updaters)s.update(e,i,t,n)},this.updaters=[new X(e),new $(e),new ee(e),new Q(e)]}init(){}isEnabled(e){return!e.destroyed&&!e.spawning}update(e,t){const n=e.options.move.outModes;this._updateOutMode(e,t,n.bottom??n.default,"bottom"),this._updateOutMode(e,t,n.left??n.default,"left"),this._updateOutMode(e,t,n.right??n.default,"right"),this._updateOutMode(e,t,n.top??n.default,"top")}}class ne{init(e){const t=e.container,n=e.options.size.animation;n.enable&&(e.size.velocity=(e.retina.sizeAnimationSpeed??t.retina.sizeAnimationSpeed)/100*t.retina.reduceFactor,n.sync||(e.size.velocity*=(0,r.G0)()))}isEnabled(e){return!e.destroyed&&!e.spawning&&e.size.enable&&((e.size.maxLoops??0)<=0||(e.size.maxLoops??0)>0&&(e.size.loops??0)<(e.size.maxLoops??0))}reset(e){e.size.loops=0}update(e,t){this.isEnabled(e)&&function(e,t){const n=e.size;if(e.destroyed||!n||!n.enable||(n.maxLoops??0)>0&&(n.loops??0)>(n.maxLoops??0))return;const i=(n.velocity??0)*t.factor,s=n.min,o=n.max,a=n.decay??1;if(n.time||(n.time=0),(n.delayTime??0)>0&&n.time<(n.delayTime??0)&&(n.time+=t.value),!((n.delayTime??0)>0&&n.time<(n.delayTime??0))){switch(n.status){case"increasing":n.value>=o?(n.status="decreasing",n.loops||(n.loops=0),n.loops++):n.value+=i;break;case"decreasing":n.value<=s?(n.status="increasing",n.loops||(n.loops=0),n.loops++):n.value-=i}n.velocity&&1!==a&&(n.velocity*=a),function(e,t,n,i){switch(e.options.size.animation.destroy){case"max":t>=i&&e.destroy();break;case"min":t<=n&&e.destroy()}}(e,n.value,s,o),e.destroyed||(n.value=(0,r.qE)(n.value,s,o))}}(e,t)}}async function ie(e,t=!0){await async function(e,t=!0){await e.addMover("base",(()=>new W),t)}(e,!1),await async function(e,t=!0){await e.addShape("circle",new K,t)}(e,!1),await async function(e,t=!0){await e.addParticleUpdater("color",(e=>new Y(e)),t)}(e,!1),await async function(e,t=!0){await e.addParticleUpdater("opacity",(e=>new Z(e)),t)}(e,!1),await async function(e,t=!0){await e.addParticleUpdater("outModes",(e=>new te(e)),t)}(e,!1),await async function(e,t=!0){await e.addParticleUpdater("size",(()=>new ne),t)}(e,!1),await e.refresh(t)}var se=n(1724),re=n(3887);class oe{constructor(){this.distance=200,this.duration=.4,this.easing="ease-out-quad",this.factor=1,this.maxSpeed=50,this.speed=1}load(e){e&&(void 0!==e.distance&&(this.distance=e.distance),void 0!==e.duration&&(this.duration=e.duration),void 0!==e.easing&&(this.easing=e.easing),void 0!==e.factor&&(this.factor=e.factor),void 0!==e.maxSpeed&&(this.maxSpeed=e.maxSpeed),void 0!==e.speed&&(this.speed=e.speed))}}class ae extends N{constructor(e,t){super(t),this._clickAttract=()=>{const e=this.container;e.attract||(e.attract={particles:[]});const{attract:t}=e;if(t.finish||(t.count||(t.count=0),t.count++,t.count===e.particles.count&&(t.finish=!0)),t.clicking){const t=e.interactivity.mouse.clickPosition,n=e.retina.attractModeDistance;if(!n||n<0||!t)return;this._processAttract(t,n,new se.j(t.x,t.y,n))}else!1===t.clicking&&(t.particles=[])},this._hoverAttract=()=>{const e=this.container,t=e.interactivity.mouse.position,n=e.retina.attractModeDistance;!n||n<0||!t||this._processAttract(t,n,new se.j(t.x,t.y,n))},this._processAttract=(e,t,n)=>{const i=this.container,s=i.actualOptions.interactivity.modes.attract;if(!s)return;const o=i.particles.quadTree.query(n,(e=>this.isEnabled(e)));for(const a of o){const{dx:n,dy:i,distance:o}=(0,r.vr)(a.position,e),l=s.speed*s.factor,c=(0,r.qE)((0,r.il)(s.easing)(1-o/t)*l,0,s.maxSpeed),d=u.M.create(0===o?l:n/o*c,0===o?l:i/o*c);a.position.subFrom(d)}},this._engine=e,t.attract||(t.attract={particles:[]}),this.handleClickMode=e=>{const n=this.container.actualOptions.interactivity.modes.attract;if(n&&"attract"===e){t.attract||(t.attract={particles:[]}),t.attract.clicking=!0,t.attract.count=0;for(const e of t.attract.particles)this.isEnabled(e)&&e.velocity.setTo(e.initialVelocity);t.attract.particles=[],t.attract.finish=!1,setTimeout((()=>{t.destroyed||(t.attract||(t.attract={particles:[]}),t.attract.clicking=!1)}),1e3*n.duration)}}}clear(){}init(){const e=this.container,t=e.actualOptions.interactivity.modes.attract;t&&(e.retina.attractModeDistance=t.distance*e.retina.pixelRatio)}async interact(){const e=this.container,t=e.actualOptions,n=e.interactivity.status===re.Rb,s=t.interactivity.events,r=s.onHover.enable,o=s.onHover.mode,a=s.onClick.enable,l=s.onClick.mode;n&&r&&(0,i.hn)("attract",o)?this._hoverAttract():a&&(0,i.hn)("attract",l)&&this._clickAttract()}isEnabled(e){const t=this.container,n=t.actualOptions,s=t.interactivity.mouse,r=(e?.interactivity??n.interactivity).events;if(!(s.position&&r.onHover.enable||s.clickPosition&&r.onClick.enable))return!1;const o=r.onHover.mode,a=r.onClick.mode;return(0,i.hn)("attract",o)||(0,i.hn)("attract",a)}loadModeOptions(e,...t){e.attract||(e.attract=new oe);for(const n of t)e.attract.load(n?.attract)}reset(){}}var le=n(963);class ce{constructor(){this.distance=200}load(e){e&&void 0!==e.distance&&(this.distance=e.distance)}}class ue extends N{constructor(e){super(e),this._processBounce=(e,t,n)=>{const s=this.container.particles.quadTree.query(n,(e=>this.isEnabled(e)));for(const r of s)n instanceof se.j?(0,i.pE)((0,i.Tg)(r),{position:e,radius:t,mass:t**2*Math.PI/2,velocity:u.M.origin,factor:u.M.origin}):n instanceof le.M&&(0,i.jo)(r,(0,i.AE)(e,t))},this._processMouseBounce=()=>{const e=this.container,t=10*e.retina.pixelRatio,n=e.interactivity.mouse.position,i=e.retina.bounceModeDistance;!i||i<0||!n||this._processBounce(n,i,new se.j(n.x,n.y,i+t))},this._singleSelectorBounce=(e,t)=>{const n=this.container,i=document.querySelectorAll(e);i.length&&i.forEach((e=>{const i=e,s=n.retina.pixelRatio,r={x:(i.offsetLeft+i.offsetWidth/2)*s,y:(i.offsetTop+i.offsetHeight/2)*s},o=i.offsetWidth/2*s,a=10*s,l="circle"===t.type?new se.j(r.x,r.y,o+a):new le.M(i.offsetLeft*s-a,i.offsetTop*s-a,i.offsetWidth*s+2*a,i.offsetHeight*s+2*a);this._processBounce(r,o,l)}))}}clear(){}init(){const e=this.container,t=e.actualOptions.interactivity.modes.bounce;t&&(e.retina.bounceModeDistance=t.distance*e.retina.pixelRatio)}async interact(){const e=this.container,t=e.actualOptions.interactivity.events,n=e.interactivity.status===re.Rb,s=t.onHover.enable,r=t.onHover.mode,o=t.onDiv;n&&s&&(0,i.hn)("bounce",r)?this._processMouseBounce():(0,i.U6)("bounce",o,((e,t)=>this._singleSelectorBounce(e,t)))}isEnabled(e){const t=this.container,n=t.actualOptions,s=t.interactivity.mouse,r=(e?.interactivity??n.interactivity).events,o=r.onDiv;return s.position&&r.onHover.enable&&(0,i.hn)("bounce",r.onHover.mode)||(0,i.iK)("bounce",o)}loadModeOptions(e,...t){e.bounce||(e.bounce=new ce);for(const n of t)e.bounce.load(n?.bounce)}reset(){}}class de{constructor(){this.distance=200,this.duration=.4,this.mix=!1}load(e){if(e){if(void 0!==e.distance&&(this.distance=e.distance),void 0!==e.duration&&(this.duration=e.duration),void 0!==e.mix&&(this.mix=e.mix),void 0!==e.opacity&&(this.opacity=e.opacity),void 0!==e.color){const t=(0,i.cy)(this.color)?void 0:this.color;this.color=(0,i.wJ)(e.color,(e=>s.O.create(t,e)))}void 0!==e.size&&(this.size=e.size)}}}class he extends de{constructor(){super(),this.selectors=[]}get ids(){return(0,i.wJ)(this.selectors,(e=>e.replace("#","")))}set ids(e){this.selectors=(0,i.wJ)(e,(e=>`#${e}`))}load(e){super.load(e),e&&(void 0!==e.ids&&(this.ids=e.ids),void 0!==e.selectors&&(this.selectors=e.selectors))}}class pe extends de{load(e){super.load(e),e&&(this.divs=(0,i.wJ)(e.divs,(e=>{const t=new he;return t.load(e),t})))}}function fe(e,t,n,i){if(t>=n){const s=e+(t-n)*i;return(0,r.qE)(s,e,t)}if(t<n){const s=e-(n-t)*i;return(0,r.qE)(s,t,e)}}class me extends N{constructor(e){super(e),this._clickBubble=()=>{const e=this.container,t=e.actualOptions,n=e.interactivity.mouse.clickPosition,i=t.interactivity.modes.bubble;if(!i||!n)return;e.bubble||(e.bubble={});const s=e.retina.bubbleModeDistance;if(!s||s<0)return;const o=e.particles.quadTree.queryCircle(n,s,(e=>this.isEnabled(e))),{bubble:a}=e;for(const l of o){if(!a.clicking)continue;l.bubble.inRange=!a.durationEnd;const t=l.getPosition(),o=(0,r.Yf)(t,n),c=((new Date).getTime()-(e.interactivity.mouse.clickTime||0))/1e3;c>i.duration&&(a.durationEnd=!0),c>2*i.duration&&(a.clicking=!1,a.durationEnd=!1);const u={bubbleObj:{optValue:e.retina.bubbleModeSize,value:l.bubble.radius},particlesObj:{optValue:(0,r.W9)(l.options.size.value)*e.retina.pixelRatio,value:l.size.value},type:"size"};this._process(l,o,c,u);const d={bubbleObj:{optValue:i.opacity,value:l.bubble.opacity},particlesObj:{optValue:(0,r.W9)(l.options.opacity.value),value:l.opacity?.value??1},type:"opacity"};this._process(l,o,c,d),!a.durationEnd&&o<=s?this._hoverBubbleColor(l,o):delete l.bubble.color}},this._hoverBubble=()=>{const e=this.container,t=e.interactivity.mouse.position,n=e.retina.bubbleModeDistance;if(!n||n<0||void 0===t)return;const i=e.particles.quadTree.queryCircle(t,n,(e=>this.isEnabled(e)));for(const s of i){s.bubble.inRange=!0;const i=s.getPosition(),o=(0,r.Yf)(i,t),a=1-o/n;o<=n?a>=0&&e.interactivity.status===re.Rb&&(this._hoverBubbleSize(s,a),this._hoverBubbleOpacity(s,a),this._hoverBubbleColor(s,a)):this.reset(s),e.interactivity.status===re.Z0&&this.reset(s)}},this._hoverBubbleColor=(e,t,n)=>{const s=this.container.actualOptions,r=n??s.interactivity.modes.bubble;if(r){if(!e.bubble.finalColor){const t=r.color;if(!t)return;const n=(0,i.TA)(t);e.bubble.finalColor=(0,d.R5)(n)}if(e.bubble.finalColor)if(r.mix){e.bubble.color=void 0;const n=e.getFillColor();e.bubble.color=n?(0,d.K6)((0,d.EY)(n,e.bubble.finalColor,1-t,t)):e.bubble.finalColor}else e.bubble.color=e.bubble.finalColor}},this._hoverBubbleOpacity=(e,t,n)=>{const i=this.container.actualOptions,s=n?.opacity??i.interactivity.modes.bubble?.opacity;if(!s)return;const o=e.options.opacity.value,a=fe(e.opacity?.value??1,s,(0,r.W9)(o),t);void 0!==a&&(e.bubble.opacity=a)},this._hoverBubbleSize=(e,t,n)=>{const i=this.container,s=n?.size?n.size*i.retina.pixelRatio:i.retina.bubbleModeSize;if(void 0===s)return;const o=(0,r.W9)(e.options.size.value)*i.retina.pixelRatio,a=fe(e.size.value,s,o,t);void 0!==a&&(e.bubble.radius=a)},this._process=(e,t,n,i)=>{const s=this.container,r=i.bubbleObj.optValue,o=s.actualOptions.interactivity.modes.bubble;if(!o||void 0===r)return;const a=o.duration,l=s.retina.bubbleModeDistance,c=i.particlesObj.optValue,u=i.bubbleObj.value,d=i.particlesObj.value||0,h=i.type;if(l&&!(l<0)&&r!==c)if(s.bubble||(s.bubble={}),s.bubble.durationEnd)u&&("size"===h&&delete e.bubble.radius,"opacity"===h&&delete e.bubble.opacity);else if(t<=l){if((u??d)!==r){const t=d-n*(d-r)/a;"size"===h&&(e.bubble.radius=t),"opacity"===h&&(e.bubble.opacity=t)}}else"size"===h&&delete e.bubble.radius,"opacity"===h&&delete e.bubble.opacity},this._singleSelectorHover=(e,t,n)=>{const s=this.container,r=document.querySelectorAll(t),o=s.actualOptions.interactivity.modes.bubble;o&&r.length&&r.forEach((t=>{const r=t,a=s.retina.pixelRatio,l={x:(r.offsetLeft+r.offsetWidth/2)*a,y:(r.offsetTop+r.offsetHeight/2)*a},c=r.offsetWidth/2*a,u="circle"===n.type?new se.j(l.x,l.y,c):new le.M(r.offsetLeft*a,r.offsetTop*a,r.offsetWidth*a,r.offsetHeight*a),d=s.particles.quadTree.query(u,(e=>this.isEnabled(e)));for(const n of d){if(!u.contains(n.getPosition()))continue;n.bubble.inRange=!0;const t=o.divs,s=(0,i.NV)(t,r);n.bubble.div&&n.bubble.div===r||(this.clear(n,e,!0),n.bubble.div=r),this._hoverBubbleSize(n,1,s),this._hoverBubbleOpacity(n,1,s),this._hoverBubbleColor(n,1,s)}}))},e.bubble||(e.bubble={}),this.handleClickMode=t=>{"bubble"===t&&(e.bubble||(e.bubble={}),e.bubble.clicking=!0)}}clear(e,t,n){e.bubble.inRange&&!n||(delete e.bubble.div,delete e.bubble.opacity,delete e.bubble.radius,delete e.bubble.color)}init(){const e=this.container,t=e.actualOptions.interactivity.modes.bubble;t&&(e.retina.bubbleModeDistance=t.distance*e.retina.pixelRatio,void 0!==t.size&&(e.retina.bubbleModeSize=t.size*e.retina.pixelRatio))}async interact(e){const t=this.container.actualOptions.interactivity.events,n=t.onHover,s=t.onClick,r=n.enable,o=n.mode,a=s.enable,l=s.mode,c=t.onDiv;r&&(0,i.hn)("bubble",o)?this._hoverBubble():a&&(0,i.hn)("bubble",l)?this._clickBubble():(0,i.U6)("bubble",c,((t,n)=>this._singleSelectorHover(e,t,n)))}isEnabled(e){const t=this.container,n=t.actualOptions,s=t.interactivity.mouse,r=(e?.interactivity??n.interactivity).events,{onClick:o,onDiv:a,onHover:l}=r,c=(0,i.iK)("bubble",a);return!!(c||l.enable&&s.position||o.enable&&s.clickPosition)&&((0,i.hn)("bubble",l.mode)||(0,i.hn)("bubble",o.mode)||c)}loadModeOptions(e,...t){e.bubble||(e.bubble=new pe);for(const n of t)e.bubble.load(n?.bubble)}reset(e){e.bubble.inRange=!1}}class ve{constructor(){this.opacity=.5}load(e){e&&void 0!==e.opacity&&(this.opacity=e.opacity)}}class ge{constructor(){this.distance=80,this.links=new ve,this.radius=60}get lineLinked(){return this.links}set lineLinked(e){this.links=e}get line_linked(){return this.links}set line_linked(e){this.links=e}load(e){e&&(void 0!==e.distance&&(this.distance=e.distance),this.links.load(e.links??e.lineLinked??e.line_linked),void 0!==e.radius&&(this.radius=e.radius))}}var ye=n(1525);function be(e,t,n,i){const s=e.actualOptions.interactivity.modes.connect;if(s)return function(e,t,n,i){const s=Math.floor(n.getRadius()/t.getRadius()),r=t.getFillColor(),o=n.getFillColor();if(!r||!o)return;const a=t.getPosition(),l=n.getPosition(),c=(0,d.EY)(r,o,t.getRadius(),n.getRadius()),u=e.createLinearGradient(a.x,a.y,l.x,l.y);return u.addColorStop(0,(0,d.LC)(r,i)),u.addColorStop(s>1?1:s,(0,d.xx)(c,i)),u.addColorStop(1,(0,d.LC)(o,i)),u}(t,n,i,s.links.opacity)}function _e(e,t,n){e.canvas.draw((i=>{const s=be(e,i,t,n);if(!s)return;const r=t.getPosition(),o=n.getPosition();!function(e,t,n,i,s){(0,ye.V6)(e,i,s),e.lineWidth=t,e.strokeStyle=n,e.stroke()}(i,t.retina.linksWidth??0,s,r,o)}))}class we extends N{constructor(e){super(e)}clear(){}init(){const e=this.container,t=e.actualOptions.interactivity.modes.connect;t&&(e.retina.connectModeDistance=t.distance*e.retina.pixelRatio,e.retina.connectModeRadius=t.radius*e.retina.pixelRatio)}async interact(){const e=this.container;if(e.actualOptions.interactivity.events.onHover.enable&&"pointermove"===e.interactivity.status){const t=e.interactivity.mouse.position;if(!e.retina.connectModeDistance||e.retina.connectModeDistance<0||!e.retina.connectModeRadius||e.retina.connectModeRadius<0||!t)return;const n=Math.abs(e.retina.connectModeRadius),i=e.particles.quadTree.queryCircle(t,n,(e=>this.isEnabled(e)));let s=0;for(const r of i){const t=r.getPosition();for(const n of i.slice(s+1)){const i=n.getPosition(),s=Math.abs(e.retina.connectModeDistance),o=Math.abs(t.x-i.x),a=Math.abs(t.y-i.y);o<s&&a<s&&_e(e,r,n)}++s}}}isEnabled(e){const t=this.container,n=t.interactivity.mouse,s=(e?.interactivity??t.actualOptions.interactivity).events;return!(!s.onHover.enable||!n.position)&&(0,i.hn)("connect",s.onHover.mode)}loadModeOptions(e,...t){e.connect||(e.connect=new ge);for(const n of t)e.connect.load(n?.connect)}reset(){}}class ke{constructor(){this.blink=!1,this.consent=!1,this.opacity=1}load(e){e&&(void 0!==e.blink&&(this.blink=e.blink),void 0!==e.color&&(this.color=s.O.create(this.color,e.color)),void 0!==e.consent&&(this.consent=e.consent),void 0!==e.opacity&&(this.opacity=e.opacity))}}class xe{constructor(){this.distance=100,this.links=new ke}get lineLinked(){return this.links}set lineLinked(e){this.links=e}get line_linked(){return this.links}set line_linked(e){this.links=e}load(e){e&&(void 0!==e.distance&&(this.distance=e.distance),this.links.load(e.links??e.lineLinked??e.line_linked))}}function Se(e,t,n,i,s){e.canvas.draw((e=>{const r=t.getPosition();!function(e,t,n,i,s,r){(0,ye.V6)(e,n,i),e.strokeStyle=(0,d.xx)(s,r),e.lineWidth=t,e.stroke()}(e,t.retina.linksWidth??0,r,s,n,i)}))}class Ee extends N{constructor(e){super(e)}clear(){}init(){const e=this.container,t=e.actualOptions.interactivity.modes.grab;t&&(e.retina.grabModeDistance=t.distance*e.retina.pixelRatio)}async interact(){const e=this.container,t=e.actualOptions.interactivity;if(!t.modes.grab||!t.events.onHover.enable||e.interactivity.status!==re.Rb)return;const n=e.interactivity.mouse.position;if(!n)return;const i=e.retina.grabModeDistance;if(!i||i<0)return;const s=e.particles.quadTree.queryCircle(n,i,(e=>this.isEnabled(e)));for(const o of s){const s=o.getPosition(),a=(0,r.Yf)(s,n);if(a>i)continue;const l=t.modes.grab.links,c=l.opacity,u=c-a*c/i;if(u<=0)continue;const h=l.color??o.options.links?.color;if(!e.particles.grabLineColor&&h){const n=t.modes.grab.links;e.particles.grabLineColor=(0,d.PG)(h,n.blink,n.consent)}const p=(0,d._h)(o,void 0,e.particles.grabLineColor);p&&Se(e,o,p,u,n)}}isEnabled(e){const t=this.container,n=t.interactivity.mouse,s=(e?.interactivity??t.actualOptions.interactivity).events;return s.onHover.enable&&!!n.position&&(0,i.hn)("grab",s.onHover.mode)}loadModeOptions(e,...t){e.grab||(e.grab=new xe);for(const n of t)e.grab.load(n?.grab)}reset(){}}class Ce extends N{constructor(e){super(e),this.handleClickMode=e=>{if("pause"!==e)return;const t=this.container;t.getAnimationStatus()?t.pause():t.play()}}clear(){}init(){}async interact(){}isEnabled(){return!0}reset(){}}class Te{constructor(){this.default=!0,this.groups=[],this.quantity=4}get particles_nb(){return this.quantity}set particles_nb(e){this.quantity=(0,r.DT)(e)}load(e){if(!e)return;void 0!==e.default&&(this.default=e.default),void 0!==e.groups&&(this.groups=e.groups.map((e=>e))),this.groups.length||(this.default=!0);const t=e.quantity??e.particles_nb;void 0!==t&&(this.quantity=(0,r.DT)(t))}}class Me extends N{constructor(e){super(e),this.handleClickMode=e=>{if("push"!==e)return;const t=this.container,n=t.actualOptions.interactivity.modes.push;if(!n)return;const s=(0,r.VG)(n.quantity);if(s<=0)return;const o=(0,i.Vh)([void 0,...n.groups]),a=void 0!==o?t.actualOptions.particles.groups[o]:void 0;t.particles.push(s,t.interactivity.mouse,a,o)}}clear(){}init(){}async interact(){}isEnabled(){return!0}loadModeOptions(e,...t){e.push||(e.push=new Te);for(const n of t)e.push.load(n?.push)}reset(){}}class Ae{constructor(){this.quantity=2}get particles_nb(){return this.quantity}set particles_nb(e){this.quantity=(0,r.DT)(e)}load(e){if(!e)return;const t=e.quantity??e.particles_nb;void 0!==t&&(this.quantity=(0,r.DT)(t))}}class Ie extends N{constructor(e){super(e),this.handleClickMode=e=>{const t=this.container,n=t.actualOptions;if(!n.interactivity.modes.remove||"remove"!==e)return;const i=(0,r.VG)(n.interactivity.modes.remove.quantity);t.particles.removeQuantity(i)}}clear(){}init(){}async interact(){}isEnabled(){return!0}loadModeOptions(e,...t){e.remove||(e.remove=new Ae);for(const n of t)e.remove.load(n?.remove)}reset(){}}class Re{constructor(){this.distance=200,this.duration=.4,this.factor=100,this.speed=1,this.maxSpeed=50,this.easing="ease-out-quad"}load(e){e&&(void 0!==e.distance&&(this.distance=e.distance),void 0!==e.duration&&(this.duration=e.duration),void 0!==e.easing&&(this.easing=e.easing),void 0!==e.factor&&(this.factor=e.factor),void 0!==e.speed&&(this.speed=e.speed),void 0!==e.maxSpeed&&(this.maxSpeed=e.maxSpeed))}}class Oe extends Re{constructor(){super(),this.selectors=[]}get ids(){return(0,i.wJ)(this.selectors,(e=>e.replace("#","")))}set ids(e){this.selectors=(0,i.wJ)(e,(e=>`#${e}`))}load(e){super.load(e),e&&(void 0!==e.ids&&(this.ids=e.ids),void 0!==e.selectors&&(this.selectors=e.selectors))}}class Le extends Re{load(e){super.load(e),e&&(this.divs=(0,i.wJ)(e.divs,(e=>{const t=new Oe;return t.load(e),t})))}}class Pe extends N{constructor(e,t){super(t),this._clickRepulse=()=>{const e=this.container,t=e.actualOptions.interactivity.modes.repulse;if(!t)return;const n=e.repulse||{particles:[]};if(n.finish||(n.count||(n.count=0),n.count++,n.count===e.particles.count&&(n.finish=!0)),n.clicking){const i=e.retina.repulseModeDistance;if(!i||i<0)return;const s=Math.pow(i/6,3),o=e.interactivity.mouse.clickPosition;if(void 0===o)return;const a=new se.j(o.x,o.y,s),l=e.particles.quadTree.query(a,(e=>this.isEnabled(e)));for(const e of l){const{dx:i,dy:a,distance:l}=(0,r.vr)(o,e.position),c=l**2,d=-s*t.speed/c;if(c<=s){n.particles.push(e);const t=u.M.create(i,a);t.length=d,e.velocity.setTo(t)}}}else if(!1===n.clicking){for(const e of n.particles)e.velocity.setTo(e.initialVelocity);n.particles=[]}},this._hoverRepulse=()=>{const e=this.container,t=e.interactivity.mouse.position,n=e.retina.repulseModeDistance;!n||n<0||!t||this._processRepulse(t,n,new se.j(t.x,t.y,n))},this._processRepulse=(e,t,n,i)=>{const s=this.container,o=s.particles.quadTree.query(n,(e=>this.isEnabled(e))),a=s.actualOptions.interactivity.modes.repulse;if(a)for(const l of o){const{dx:n,dy:s,distance:o}=(0,r.vr)(l.position,e),c=(i?.speed??a.speed)*a.factor,d=(0,r.qE)((0,r.il)(a.easing)(1-o/t)*c,0,a.maxSpeed),h=u.M.create(0===o?c:n/o*d,0===o?c:s/o*d);l.position.addTo(h)}},this._singleSelectorRepulse=(e,t)=>{const n=this.container,s=n.actualOptions.interactivity.modes.repulse;if(!s)return;const r=document.querySelectorAll(e);r.length&&r.forEach((e=>{const r=e,o=n.retina.pixelRatio,a={x:(r.offsetLeft+r.offsetWidth/2)*o,y:(r.offsetTop+r.offsetHeight/2)*o},l=r.offsetWidth/2*o,c="circle"===t.type?new se.j(a.x,a.y,l):new le.M(r.offsetLeft*o,r.offsetTop*o,r.offsetWidth*o,r.offsetHeight*o),u=s.divs,d=(0,i.NV)(u,r);this._processRepulse(a,l,c,d)}))},this._engine=e,t.repulse||(t.repulse={particles:[]}),this.handleClickMode=e=>{const n=this.container.actualOptions.interactivity.modes.repulse;if(!n||"repulse"!==e)return;t.repulse||(t.repulse={particles:[]});const i=t.repulse;i.clicking=!0,i.count=0;for(const s of t.repulse.particles)this.isEnabled(s)&&s.velocity.setTo(s.initialVelocity);i.particles=[],i.finish=!1,setTimeout((()=>{t.destroyed||(i.clicking=!1)}),1e3*n.duration)}}clear(){}init(){const e=this.container,t=e.actualOptions.interactivity.modes.repulse;t&&(e.retina.repulseModeDistance=t.distance*e.retina.pixelRatio)}async interact(){const e=this.container,t=e.actualOptions,n=e.interactivity.status===re.Rb,s=t.interactivity.events,r=s.onHover,o=r.enable,a=r.mode,l=s.onClick,c=l.enable,u=l.mode,d=s.onDiv;n&&o&&(0,i.hn)("repulse",a)?this._hoverRepulse():c&&(0,i.hn)("repulse",u)?this._clickRepulse():(0,i.U6)("repulse",d,((e,t)=>this._singleSelectorRepulse(e,t)))}isEnabled(e){const t=this.container,n=t.actualOptions,s=t.interactivity.mouse,r=(e?.interactivity??n.interactivity).events,o=r.onDiv,a=r.onHover,l=r.onClick,c=(0,i.iK)("repulse",o);if(!(c||a.enable&&s.position||l.enable&&s.clickPosition))return!1;const u=a.mode,d=l.mode;return(0,i.hn)("repulse",u)||(0,i.hn)("repulse",d)||c}loadModeOptions(e,...t){e.repulse||(e.repulse=new Le);for(const n of t)e.repulse.load(n?.repulse)}reset(){}}class De{constructor(){this.factor=3,this.radius=200}load(e){e&&(void 0!==e.factor&&(this.factor=e.factor),void 0!==e.radius&&(this.radius=e.radius))}}class Ne extends N{constructor(e){super(e)}clear(e,t,n){e.slow.inRange&&!n||(e.slow.factor=1)}init(){const e=this.container,t=e.actualOptions.interactivity.modes.slow;t&&(e.retina.slowModeRadius=t.radius*e.retina.pixelRatio)}async interact(){}isEnabled(e){const t=this.container,n=t.interactivity.mouse,s=(e?.interactivity??t.actualOptions.interactivity).events;return s.onHover.enable&&!!n.position&&(0,i.hn)("slow",s.onHover.mode)}loadModeOptions(e,...t){e.slow||(e.slow=new De);for(const n of t)e.slow.load(n?.slow)}reset(e){e.slow.inRange=!1;const t=this.container,n=t.actualOptions,i=t.interactivity.mouse.position,s=t.retina.slowModeRadius,o=n.interactivity.modes.slow;if(!o||!s||s<0||!i)return;const a=e.getPosition(),l=(0,r.Yf)(i,a),c=l/s,u=o.factor,{slow:d}=e;l>s||(d.inRange=!0,d.factor=c/u)}}const ze=[0,4,2,1],Be=[8,8,4,2];class Fe{constructor(e){this.pos=0,this.data=new Uint8ClampedArray(e)}getString(e){const t=this.data.slice(this.pos,this.pos+e);return this.pos+=t.length,t.reduce(((e,t)=>e+String.fromCharCode(t)),"")}nextByte(){return this.data[this.pos++]}nextTwoBytes(){return this.pos+=2,this.data[this.pos-2]+(this.data[this.pos-1]<<8)}readSubBlocks(){let e="",t=0;do{t=this.data[this.pos++];for(let n=t;--n>=0;e+=String.fromCharCode(this.data[this.pos++]));}while(0!==t);return e}readSubBlocksBin(){let e=0,t=0;for(let i=0;0!==(e=this.data[this.pos+i]);i+=e+1)t+=e;const n=new Uint8Array(t);for(let i=0;0!==(e=this.data[this.pos++]);)for(let t=e;--t>=0;n[i++]=this.data[this.pos++]);return n}skipSubBlocks(){for(;0!==this.data[this.pos];this.pos+=this.data[this.pos]+1);this.pos++}}function Ue(e,t){const n=[];for(let i=0;i<t;i++)n.push({r:e.data[e.pos],g:e.data[e.pos+1],b:e.data[e.pos+2]}),e.pos+=3;return n}async function je(e,t,n,i,s,r){switch(e.nextByte()){case 59:return!0;case 44:await async function(e,t,n,i,s,r){const o=t.frames[i(!0)];o.left=e.nextTwoBytes(),o.top=e.nextTwoBytes(),o.width=e.nextTwoBytes(),o.height=e.nextTwoBytes();const a=e.nextByte(),l=!(128&~a),c=!(64&~a);o.sortFlag=!(32&~a),o.reserved=(24&a)>>>3;const u=1<<1+(7&a);l&&(o.localColorTable=Ue(e,u));const d=e=>{const{r:i,g:r,b:a}=(l?o.localColorTable:t.globalColorTable)[e];return{r:i,g:r,b:a,a:e===s(null)?n?~~((i+r+a)/3):0:255}},h=(()=>{try{return new ImageData(o.width,o.height,{colorSpace:"srgb"})}catch(e){if(e instanceof DOMException&&"IndexSizeError"===e.name)return null;throw e}})();if(null==h)throw new EvalError("GIF frame size is to large");const p=e.nextByte(),f=e.readSubBlocksBin(),m=1<<p,v=(e,t)=>{const n=e>>>3,i=7&e;return(f[n]+(f[n+1]<<8)+(f[n+2]<<16)&(1<<t)-1<<i)>>>i};if(c){for(let n=0,s=p+1,a=0,l=[[0]],c=0;c<4;c++){if(ze[c]<o.height)for(let e=0,t=0;;){const i=n;if(n=v(a,s),a+=s+1,n===m){s=p+1,l.length=m+2;for(let e=0;e<l.length;e++)l[e]=e<m?[e]:[]}else{n>=l.length?l.push(l[i].concat(l[i][0])):i!==m&&l.push(l[i].concat(l[n][0]));for(let i=0;i<l[n].length;i++){const{r:s,g:r,b:a,a:u}=d(l[n][i]);h.data.set([s,r,a,u],ze[c]*o.width+Be[c]*t+e%(4*o.width)),e+=4}l.length===1<<s&&s<12&&s++}if(e===4*o.width*(t+1)&&(t++,ze[c]+Be[c]*t>=o.height))break}r?.(e.pos/(e.data.length-1),i(!1)+1,h,{x:o.left,y:o.top},{width:t.width,height:t.height})}o.image=h,o.bitmap=await createImageBitmap(h)}else{for(let e=0,t=p+1,n=0,i=[[0]],s=-4;;){const r=e;if(e=v(n,t),n+=t,e===m){t=p+1,i.length=m+2;for(let e=0;e<i.length;e++)i[e]=e<m?[e]:[]}else{if(e===m+1)break;e>=i.length?i.push(i[r].concat(i[r][0])):r!==m&&i.push(i[r].concat(i[e][0]));for(let t=0;t<i[e].length;t++){const{r:n,g:r,b:o,a:a}=d(i[e][t]);h.data.set([n,r,o,a],s+=4)}i.length>=1<<t&&t<12&&t++}}o.image=h,o.bitmap=await createImageBitmap(h),r?.((e.pos+1)/e.data.length,i(!1)+1,o.image,{x:o.left,y:o.top},{width:t.width,height:t.height})}}(e,t,n,i,s,r);break;case 33:await async function(e,t,n,i){switch(e.nextByte()){case 249:{const s=t.frames[n(!1)];e.pos++;const r=e.nextByte();s.GCreserved=(224&r)>>>5,s.disposalMethod=(28&r)>>>2,s.userInputDelayFlag=!(2&~r);const o=!(1&~r);s.delayTime=10*e.nextTwoBytes();const a=e.nextByte();o&&i(a),e.pos++;break}case 255:{e.pos++;const n={identifier:e.getString(8),authenticationCode:e.getString(3),data:e.readSubBlocksBin()};t.applicationExtensions.push(n);break}case 254:t.comments.push([n(!1),e.readSubBlocks()]);break;case 1:if(0===t.globalColorTable.length)throw new EvalError("plain text extension without global color table");e.pos++,t.frames[n(!1)].plainTextData={left:e.nextTwoBytes(),top:e.nextTwoBytes(),width:e.nextTwoBytes(),height:e.nextTwoBytes(),charSize:{width:e.nextTwoBytes(),height:e.nextTwoBytes()},foregroundColor:e.nextByte(),backgroundColor:e.nextByte(),text:e.readSubBlocks()};break;default:e.skipSubBlocks()}}(e,t,i,s);break;default:throw new EvalError("undefined block found")}return!1}const qe=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d.]+%?\))|currentcolor/gi;async function Ve(e){return new Promise((t=>{e.loading=!0;const n=new Image;e.element=n,n.addEventListener("load",(()=>{e.loading=!1,t()})),n.addEventListener("error",(()=>{e.element=void 0,e.error=!0,e.loading=!1,(0,i.tZ)().error(`${re.dI} loading image: ${e.source}`),t()})),n.src=e.source}))}async function He(e){if("gif"===e.type){e.loading=!0;try{e.gifData=await async function(e,t,n){n||(n=!1);const i=await fetch(e);if(!i.ok&&404===i.status)throw new EvalError("file not found");const s=await i.arrayBuffer(),r={width:0,height:0,totalTime:0,colorRes:0,pixelAspectRatio:0,frames:[],sortFlag:!1,globalColorTable:[],backgroundImage:new ImageData(1,1,{colorSpace:"srgb"}),comments:[],applicationExtensions:[]},o=new Fe(new Uint8ClampedArray(s));if("GIF89a"!==o.getString(6))throw new Error("not a supported GIF file");r.width=o.nextTwoBytes(),r.height=o.nextTwoBytes();const a=o.nextByte(),l=!(128&~a);r.colorRes=(112&a)>>>4,r.sortFlag=!(8&~a);const c=1<<1+(7&a),u=o.nextByte();r.pixelAspectRatio=o.nextByte(),0!==r.pixelAspectRatio&&(r.pixelAspectRatio=(r.pixelAspectRatio+15)/64),l&&(r.globalColorTable=Ue(o,c));const d=(()=>{try{return new ImageData(r.width,r.height,{colorSpace:"srgb"})}catch(e){if(e instanceof DOMException&&"IndexSizeError"===e.name)return null;throw e}})();if(null==d)throw new Error("GIF frame size is to large");const{r:h,g:p,b:f}=r.globalColorTable[u];d.data.set(l?[h,p,f,255]:[0,0,0,0]);for(let w=4;w<d.data.length;w*=2)d.data.copyWithin(w,0,w);r.backgroundImage=d;let m=-1,v=!0,g=-1;const y=e=>(e&&(v=!0),m),b=e=>(null!=e&&(g=e),g);try{do{v&&(r.frames.push({left:0,top:0,width:0,height:0,disposalMethod:0,image:new ImageData(1,1,{colorSpace:"srgb"}),plainTextData:null,userInputDelayFlag:!1,delayTime:0,sortFlag:!1,localColorTable:[],reserved:0,GCreserved:0}),m++,g=-1,v=!1)}while(!await je(o,r,n,y,b,t));r.frames.length--;for(const e of r.frames){if(e.userInputDelayFlag&&0===e.delayTime){r.totalTime=1/0;break}r.totalTime+=e.delayTime}return r}catch(_){if(_ instanceof EvalError)throw new Error(`error while parsing frame ${m} "${_.message}"`);throw _}}(e.source),e.gifLoopCount=function(e){for(const t of e.applicationExtensions)if(t.identifier+t.authenticationCode==="NETSCAPE2.0")return t.data[1]+(t.data[2]<<8);return NaN}(e.gifData)??0,0===e.gifLoopCount&&(e.gifLoopCount=1/0)}catch{e.error=!0}e.loading=!1}else await Ve(e)}async function Ge(e){if("svg"!==e.type)return void await Ve(e);e.loading=!0;const t=await fetch(e.source);t.ok?e.svgData=await t.text():((0,i.tZ)().error(`${re.dI} Image not found`),e.error=!0),e.loading=!1}function We(e,t,n,i){const s=function(e,t,n){const{svgData:i}=e;if(!i)return"";const s=(0,d.LC)(t,n);if(i.includes("fill"))return i.replace(qe,(()=>s));const r=i.indexOf(">");return`${i.substring(0,r)} fill="${s}"${i.substring(r)}`}(e,n,i.opacity?.value??1),r={color:n,gif:t.gif,data:{...e,svgData:s},loaded:!1,ratio:t.width/t.height,replaceColor:t.replaceColor??t.replace_color,source:t.src};return new Promise((t=>{const n=new Blob([s],{type:"image/svg+xml"}),i=URL||window.URL||window.webkitURL||window,o=i.createObjectURL(n),a=new Image;a.addEventListener("load",(()=>{r.loaded=!0,r.element=a,t(r),i.revokeObjectURL(o)})),a.addEventListener("error",(async()=>{i.revokeObjectURL(o);const n={...e,error:!1,loading:!0};await Ve(n),r.loaded=!0,r.element=n.element,t(r)})),a.src=o}))}class Ke{constructor(e){this.loadImageShape=async e=>{if(!this._engine.loadImage)throw new Error(`${re.dI} image shape not initialized`);await this._engine.loadImage({gif:e.gif,name:e.name,replaceColor:e.replaceColor??e.replace_color??!1,src:e.src})},this._engine=e}addImage(e){this._engine.images||(this._engine.images=[]),this._engine.images.push(e)}draw(e,t,n,i,s){const r=t.image,o=r?.element;if(r){if(e.globalAlpha=i,r.gif&&r.gifData){const i=new OffscreenCanvas(r.gifData.width,r.gifData.height),o=i.getContext("2d");if(!o)throw new Error("could not create offscreen canvas context");o.imageSmoothingQuality="low",o.imageSmoothingEnabled=!1,o.clearRect(0,0,i.width,i.height),void 0===t.gifLoopCount&&(t.gifLoopCount=r.gifLoopCount??0);let a=t.gifFrame??0;const l={x:.5*-r.gifData.width,y:.5*-r.gifData.height},c=r.gifData.frames[a];if(void 0===t.gifTime&&(t.gifTime=0),!c.bitmap)return;switch(e.scale(n/r.gifData.width,n/r.gifData.height),c.disposalMethod){case 4:case 5:case 6:case 7:case 0:o.drawImage(c.bitmap,c.left,c.top),e.drawImage(i,l.x,l.y),o.clearRect(0,0,i.width,i.height);break;case 1:o.drawImage(c.bitmap,c.left,c.top),e.drawImage(i,l.x,l.y);break;case 2:o.drawImage(c.bitmap,c.left,c.top),e.drawImage(i,l.x,l.y),o.clearRect(0,0,i.width,i.height),0===r.gifData.globalColorTable.length?o.putImageData(r.gifData.frames[0].image,l.x+c.left,l.y+c.top):o.putImageData(r.gifData.backgroundImage,l.x,l.y);break;case 3:{const t=o.getImageData(0,0,i.width,i.height);o.drawImage(c.bitmap,c.left,c.top),e.drawImage(i,l.x,l.y),o.clearRect(0,0,i.width,i.height),o.putImageData(t,0,0)}}if(t.gifTime+=s.value,t.gifTime>c.delayTime){if(t.gifTime-=c.delayTime,++a>=r.gifData.frames.length){if(--t.gifLoopCount<=0)return;a=0,o.clearRect(0,0,i.width,i.height)}t.gifFrame=a}e.scale(r.gifData.width/n,r.gifData.height/n)}else if(o){const t=r.ratio,i={x:-n,y:-n};e.drawImage(o,i.x,i.y,2*n,2*n/t)}e.globalAlpha=1}}getSidesCount(){return 12}async init(e){const t=e.actualOptions;if(t.preload&&this._engine.loadImage)for(const n of t.preload)await this._engine.loadImage(n)}loadShape(e){if("image"!==e.shape&&"images"!==e.shape)return;this._engine.images||(this._engine.images=[]);const t=e.shapeData;this._engine.images.find((e=>e.name===t.name||e.source===t.src))||this.loadImageShape(t).then((()=>{this.loadShape(e)}))}particleInit(e,t){if("image"!==t.shape&&"images"!==t.shape)return;this._engine.images||(this._engine.images=[]);const n=this._engine.images,i=t.shapeData,s=t.getFillColor(),r=n.find((e=>e.name===i.name||e.source===i.src));if(!r)return;const o=i.replaceColor??i.replace_color??r.replaceColor;r.loading?setTimeout((()=>{this.particleInit(e,t)})):(async()=>{let e;e=r.svgData&&s?await We(r,i,s,t):{color:s,data:r,element:r.element,gif:r.gif,gifData:r.gifData,gifLoopCount:r.gifLoopCount,loaded:!0,ratio:i.width&&i.height?i.width/i.height:r.ratio??1,replaceColor:o,source:i.src},e.ratio||(e.ratio=1);const n={image:e,fill:i.fill??t.fill,close:i.close??t.close};t.image=n.image,t.fill=n.fill,t.close=n.close})()}}class Je{constructor(){this.src="",this.gif=!1}load(e){e&&(void 0!==e.gif&&(this.gif=e.gif),void 0!==e.height&&(this.height=e.height),void 0!==e.name&&(this.name=e.name),void 0!==e.replaceColor&&(this.replaceColor=e.replaceColor),void 0!==e.src&&(this.src=e.src),void 0!==e.width&&(this.width=e.width))}}class Ye{constructor(e){this.id="imagePreloader",this._engine=e}getPlugin(){return{}}loadOptions(e,t){if(!t||!t.preload)return;e.preload||(e.preload=[]);const n=e.preload;for(const i of t.preload){const e=n.find((e=>e.name===i.name||e.src===i.src));if(e)e.load(i);else{const e=new Je;e.load(i),n.push(e)}}}needsPlugin(){return!0}}async function Ze(e,t=!0){!function(e){e.loadImage||(e.loadImage=async t=>{if(!t.name&&!t.src)throw new Error(`${re.dI} no image source provided`);if(e.images||(e.images=[]),!e.images.find((e=>e.name===t.name||e.source===t.src)))try{const n={gif:t.gif??!1,name:t.name??t.src,source:t.src,type:t.src.substring(t.src.length-3),error:!1,loading:!0,replaceColor:t.replaceColor,ratio:t.width&&t.height?t.width/t.height:void 0};e.images.push(n);const i=t.gif?He:t.replaceColor?Ge:Ve;await i(n)}catch{throw new Error(`${re.dI} ${t.name??t.src} not found`)}})}(e);const n=new Ye(e);await e.addPlugin(n,t),await e.addShape(["image","images"],new Ke(e),t)}class Xe extends o.PV{constructor(){super(),this.sync=!1}load(e){e&&(super.load(e),void 0!==e.sync&&(this.sync=e.sync))}}class $e extends o.PV{constructor(){super(),this.random.minimumValue=1e-4,this.sync=!1}load(e){e&&(super.load(e),void 0!==e.sync&&(this.sync=e.sync))}}class Qe{constructor(){this.count=0,this.delay=new Xe,this.duration=new $e}load(e){e&&(void 0!==e.count&&(this.count=e.count),this.delay.load(e.delay),this.duration.load(e.duration))}}class et{constructor(e){this.container=e}init(e){const t=this.container,n=e.options.life;n&&(e.life={delay:t.retina.reduceFactor?(0,r.VG)(n.delay.value)*(n.delay.sync?1:(0,r.G0)())/t.retina.reduceFactor*1e3:0,delayTime:0,duration:t.retina.reduceFactor?(0,r.VG)(n.duration.value)*(n.duration.sync?1:(0,r.G0)())/t.retina.reduceFactor*1e3:0,time:0,count:n.count},e.life.duration<=0&&(e.life.duration=-1),e.life.count<=0&&(e.life.count=-1),e.life&&(e.spawning=e.life.delay>0))}isEnabled(e){return!e.destroyed}loadOptions(e,...t){e.life||(e.life=new Qe);for(const n of t)e.life.load(n?.life)}update(e,t){if(!this.isEnabled(e)||!e.life)return;const n=e.life;let i=!1;if(e.spawning){if(n.delayTime+=t.value,!(n.delayTime>=e.life.delay))return;i=!0,e.spawning=!1,n.delayTime=0,n.time=0}if(-1===n.duration)return;if(e.spawning)return;if(i?n.time=0:n.time+=t.value,n.time<n.duration)return;if(n.time=0,e.life.count>0&&e.life.count--,0===e.life.count)return void e.destroy();const s=this.container.canvas.size,o=(0,r.DT)(0,s.width),a=(0,r.DT)(0,s.width);e.position.x=(0,r.U4)(o),e.position.y=(0,r.U4)(a),e.spawning=!0,n.delayTime=0,n.time=0,e.reset();const l=e.options.life;l&&(n.delay=1e3*(0,r.VG)(l.delay.value),n.duration=1e3*(0,r.VG)(l.duration.value))}}class tt{draw(e,t,n){const i=t.shapeData;e.moveTo(-n/2,0),e.lineTo(n/2,0),e.lineCap=i?.cap??"butt"}getSidesCount(){return 1}}class nt{init(){}isEnabled(e){return!(0,i.B9)()&&!e.destroyed&&e.container.actualOptions.interactivity.events.onHover.parallax.enable}move(e){const t=e.container,n=t.actualOptions.interactivity.events.onHover.parallax;if((0,i.B9)()||!n.enable)return;const s=n.force,r=t.interactivity.mouse.position;if(!r)return;const o=t.canvas.size,a=o.width/2,l=o.height/2,c=n.smooth,u=e.getRadius()/s,d=(r.x-a)*u,h=(r.y-l)*u,{offset:p}=e;p.x+=(d-p.x)/c,p.y+=(h-p.y)/c}}class it{constructor(e){this.container=e,this.type="particles"}}class st extends it{constructor(e){super(e)}clear(){}init(){}async interact(e){const t=this.container,n=e.retina.attractDistance??t.retina.attractDistance,i=e.getPosition(),s=t.particles.quadTree.queryCircle(i,n);for(const o of s){if(e===o||!o.options.move.attract.enable||o.destroyed||o.spawning)continue;const t=o.getPosition(),{dx:n,dy:s}=(0,r.vr)(i,t),a=e.options.move.attract.rotate,l=n/(1e3*a.x),c=s/(1e3*a.y),u=o.size.value/e.size.value,d=1/u;e.velocity.x-=l*u,e.velocity.y-=c*u,o.velocity.x+=l*d,o.velocity.y+=c*d}}isEnabled(e){return e.options.move.attract.enable}reset(){}}function rt(e,t,n,i,s,o){const a=(0,r.qE)(e.options.collisions.absorb.speed*s.factor/10,0,i);e.size.value+=a/2,n.size.value-=a,i<=o&&(n.size.value=0,n.destroy())}const ot=e=>{void 0===e.collisionMaxSpeed&&(e.collisionMaxSpeed=(0,r.VG)(e.options.collisions.maxSpeed)),e.velocity.length>e.collisionMaxSpeed&&(e.velocity.length=e.collisionMaxSpeed)};function at(e,t){(0,i.pE)((0,i.Tg)(e),(0,i.Tg)(t)),ot(e),ot(t)}function lt(e,t,n,i){switch(e.options.collisions.mode){case"absorb":!function(e,t,n,i){const s=e.getRadius(),r=t.getRadius();void 0===s&&void 0!==r?e.destroy():void 0!==s&&void 0===r?t.destroy():void 0!==s&&void 0!==r&&(s>=r?rt(e,0,t,r,n,i):rt(t,0,e,s,n,i))}(e,t,n,i);break;case"bounce":at(e,t);break;case"destroy":!function(e,t){e.unbreakable||t.unbreakable||at(e,t),void 0===e.getRadius()&&void 0!==t.getRadius()?e.destroy():void 0!==e.getRadius()&&void 0===t.getRadius()?t.destroy():void 0!==e.getRadius()&&void 0!==t.getRadius()&&(e.getRadius()>=t.getRadius()?t:e).destroy()}(e,t)}}class ct extends it{constructor(e){super(e)}clear(){}init(){}async interact(e,t){if(e.destroyed||e.spawning)return;const n=this.container,i=e.getPosition(),s=e.getRadius(),o=n.particles.quadTree.queryCircle(i,2*s);for(const a of o){if(e===a||!a.options.collisions.enable||e.options.collisions.mode!==a.options.collisions.mode||a.destroyed||a.spawning)continue;const o=a.getPosition(),l=a.getRadius();if(Math.abs(Math.round(i.z)-Math.round(o.z))>s+l)continue;(0,r.Yf)(i,o)>s+l||lt(e,a,t,n.retina.pixelRatio)}}isEnabled(e){return e.options.collisions.enable}reset(){}}class ut extends se.j{constructor(e,t,n,i){super(e,t,n),this.canvasSize=i,this.canvasSize={...i}}contains(e){const{width:t,height:n}=this.canvasSize,{x:i,y:s}=e;return super.contains(e)||super.contains({x:i-t,y:s})||super.contains({x:i-t,y:s-n})||super.contains({x:i,y:s-n})}intersects(e){if(super.intersects(e))return!0;const t=e,n=e,i={x:e.position.x-this.canvasSize.width,y:e.position.y-this.canvasSize.height};if(void 0!==n.radius){const e=new se.j(i.x,i.y,2*n.radius);return super.intersects(e)}if(void 0!==t.size){const e=new le.M(i.x,i.y,2*t.size.width,2*t.size.height);return super.intersects(e)}return!1}}class dt{constructor(){this.blur=5,this.color=new s.O,this.color.value="#000",this.enable=!1}load(e){e&&(void 0!==e.blur&&(this.blur=e.blur),this.color=s.O.create(this.color,e.color),void 0!==e.enable&&(this.enable=e.enable))}}class ht{constructor(){this.enable=!1,this.frequency=1}load(e){e&&(void 0!==e.color&&(this.color=s.O.create(this.color,e.color)),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.frequency&&(this.frequency=e.frequency),void 0!==e.opacity&&(this.opacity=e.opacity))}}class pt{constructor(){this.blink=!1,this.color=new s.O,this.color.value="#fff",this.consent=!1,this.distance=100,this.enable=!1,this.frequency=1,this.opacity=1,this.shadow=new dt,this.triangles=new ht,this.width=1,this.warp=!1}load(e){e&&(void 0!==e.id&&(this.id=e.id),void 0!==e.blink&&(this.blink=e.blink),this.color=s.O.create(this.color,e.color),void 0!==e.consent&&(this.consent=e.consent),void 0!==e.distance&&(this.distance=e.distance),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.frequency&&(this.frequency=e.frequency),void 0!==e.opacity&&(this.opacity=e.opacity),this.shadow.load(e.shadow),this.triangles.load(e.triangles),void 0!==e.width&&(this.width=e.width),void 0!==e.warp&&(this.warp=e.warp))}}function ft(e,t,n,i,s){const{dx:o,dy:a,distance:l}=(0,r.vr)(e,t);if(!s||l<=n)return l;const c={x:Math.abs(o),y:Math.abs(a)},u=Math.min(c.x,i.width-c.x),d=Math.min(c.y,i.height-c.y);return Math.sqrt(u**2+d**2)}class mt extends it{constructor(e){super(e),this._setColor=e=>{if(!e.options.links)return;const t=this.linkContainer,n=e.options.links;let i=void 0===n.id?t.particles.linksColor:t.particles.linksColors.get(n.id);if(i)return;const s=n.color;i=(0,d.PG)(s,n.blink,n.consent),void 0===n.id?t.particles.linksColor=i:t.particles.linksColors.set(n.id,i)},this.linkContainer=e}clear(){}init(){this.linkContainer.particles.linksColor=void 0,this.linkContainer.particles.linksColors=new Map}async interact(e){if(!e.options.links)return;e.links=[];const t=e.getPosition(),n=this.container,i=n.canvas.size;if(t.x<0||t.y<0||t.x>i.width||t.y>i.height)return;const s=e.options.links,r=s.opacity,o=e.retina.linksDistance??0,a=s.warp,l=a?new ut(t.x,t.y,o,i):new se.j(t.x,t.y,o),c=n.particles.quadTree.query(l);for(const u of c){const n=u.options.links;if(e===u||!n?.enable||s.id!==n.id||u.spawning||u.destroyed||!u.links||e.links.some((e=>e.destination===u))||u.links.some((t=>t.destination===e)))continue;const l=u.getPosition();if(l.x<0||l.y<0||l.x>i.width||l.y>i.height)continue;const c=ft(t,l,o,i,a&&n.warp);if(c>o)continue;const d=(1-c/o)*r;this._setColor(e),e.links.push({destination:u,opacity:d})}}isEnabled(e){return!!e.options.links?.enable}loadParticlesOptions(e,...t){e.links||(e.links=new pt);for(const n of t)e.links.load(n?.links??n?.lineLinked??n?.line_linked)}reset(){}}function vt(e,t){const n=((i=e.map((e=>e.id))).sort(((e,t)=>e-t)),i.join("_"));var i;let s=t.get(n);return void 0===s&&(s=(0,r.G0)(),t.set(n,s)),s}class gt{constructor(e){this.container=e,this._drawLinkLine=(e,t)=>{const n=e.options.links;if(!n?.enable)return;const i=this.container,s=i.actualOptions,o=t.destination,a=e.getPosition(),l=o.getPosition();let c=t.opacity;i.canvas.draw((t=>{let u;const h=e.options.twinkle?.lines;if(h?.enable){const e=h.frequency,t=(0,d.BN)(h.color);(0,r.G0)()<e&&t&&(u=t,c=(0,r.VG)(h.opacity))}if(!u){const t=void 0!==n.id?i.particles.linksColors.get(n.id):i.particles.linksColor;u=(0,d._h)(e,o,t)}if(!u)return;const p=e.retina.linksWidth??0,f=e.retina.linksDistance??0,{backgroundMask:m}=s;!function(e){let t=!1;const{begin:n,end:i,maxDistance:s,context:o,canvasSize:a,width:l,backgroundMask:c,colorLine:u,opacity:h,links:p}=e;if((0,r.Yf)(n,i)<=s)(0,ye.V6)(o,n,i),t=!0;else if(p.warp){let e,l;const c={x:i.x-a.width,y:i.y},u=(0,r.vr)(n,c);if(u.distance<=s){const t=n.y-u.dy/u.dx*n.x;e={x:0,y:t},l={x:a.width,y:t}}else{const t={x:i.x,y:i.y-a.height},o=(0,r.vr)(n,t);if(o.distance<=s){const t=-(n.y-o.dy/o.dx*n.x)/(o.dy/o.dx);e={x:t,y:0},l={x:t,y:a.height}}else{const t={x:i.x-a.width,y:i.y-a.height},o=(0,r.vr)(n,t);if(o.distance<=s){const t=n.y-o.dy/o.dx*n.x;e={x:-t/(o.dy/o.dx),y:t},l={x:e.x+a.width,y:e.y+a.height}}}}e&&l&&((0,ye.V6)(o,n,e),(0,ye.V6)(o,i,l),t=!0)}if(!t)return;o.lineWidth=l,c.enable&&(o.globalCompositeOperation=c.composite),o.strokeStyle=(0,d.xx)(u,h);const{shadow:f}=p;if(f.enable){const e=(0,d.BN)(f.color);e&&(o.shadowBlur=f.blur,o.shadowColor=(0,d.xx)(e))}o.stroke()}({context:t,width:p,begin:a,end:l,maxDistance:f,canvasSize:i.canvas.size,links:n,backgroundMask:m,colorLine:u,opacity:c})}))},this._drawLinkTriangle=(e,t,n)=>{const i=e.options.links;if(!i?.enable)return;const s=i.triangles;if(!s.enable)return;const o=this.container,a=o.actualOptions,l=t.destination,c=n.destination,u=s.opacity??(t.opacity+n.opacity)/2;u<=0||o.canvas.draw((t=>{const n=e.getPosition(),h=l.getPosition(),p=c.getPosition(),f=e.retina.linksDistance??0;if((0,r.Yf)(n,h)>f||(0,r.Yf)(p,h)>f||(0,r.Yf)(p,n)>f)return;let m=(0,d.BN)(s.color);if(!m){const t=void 0!==i.id?o.particles.linksColors.get(i.id):o.particles.linksColor;m=(0,d._h)(e,l,t)}m&&function(e){const{context:t,pos1:n,pos2:i,pos3:s,backgroundMask:r,colorTriangle:o,opacityTriangle:a}=e;(0,ye.D4)(t,n,i,s),r.enable&&(t.globalCompositeOperation=r.composite),t.fillStyle=(0,d.xx)(o,a),t.fill()}({context:t,pos1:n,pos2:h,pos3:p,backgroundMask:a.backgroundMask,colorTriangle:m,opacityTriangle:u})}))},this._drawTriangles=(e,t,n,i)=>{const s=n.destination;if(!e.links?.triangles.enable||!s.options.links?.triangles.enable)return;const r=s.links?.filter((e=>{const t=this._getLinkFrequency(s,e.destination);return s.options.links&&t<=s.options.links.frequency&&i.findIndex((t=>t.destination===e.destination))>=0}));if(r?.length)for(const o of r){const i=o.destination;this._getTriangleFrequency(t,s,i)>e.links.triangles.frequency||this._drawLinkTriangle(t,n,o)}},this._getLinkFrequency=(e,t)=>vt([e,t],this._freqs.links),this._getTriangleFrequency=(e,t,n)=>vt([e,t,n],this._freqs.triangles),this._freqs={links:new Map,triangles:new Map}}drawParticle(e,t){const{links:n,options:i}=t;if(!n||n.length<=0)return;const s=n.filter((e=>i.links&&this._getLinkFrequency(t,e.destination)<=i.links.frequency));for(const r of s)this._drawTriangles(i,t,r,s),r.opacity>0&&(t.retina.linksWidth??0)>0&&this._drawLinkLine(t,r)}async init(){this._freqs.links=new Map,this._freqs.triangles=new Map}particleCreated(e){if(e.links=[],!e.options.links)return;const t=this.container.retina.pixelRatio,{retina:n}=e,{distance:i,width:s}=e.options.links;n.linksDistance=i*t,n.linksWidth=s*t}particleDestroyed(e){e.links=[]}}class yt{constructor(){this.id="links"}getPlugin(e){return new gt(e)}loadOptions(){}needsPlugin(){return!0}}async function bt(e,t=!0){await async function(e,t=!0){await e.addInteractor("particlesLinks",(e=>new mt(e)),t)}(e,t),await async function(e,t=!0){const n=new yt;await e.addPlugin(n,t)}(e,t)}class _t{draw(e,t,n){const i=this.getCenter(t,n),s=this.getSidesData(t,n),r=s.count.numerator*s.count.denominator,o=s.count.numerator/s.count.denominator,a=180*(o-2)/o,l=Math.PI-Math.PI*a/180;if(e){e.beginPath(),e.translate(i.x,i.y),e.moveTo(0,0);for(let t=0;t<r;t++)e.lineTo(s.length,0),e.translate(s.length,0),e.rotate(l)}}getSidesCount(e){const t=e.shapeData;return Math.round((0,r.VG)(t?.sides??t?.nb_sides??5))}}class wt extends _t{getCenter(e,t){return{x:-t/(e.sides/3.5),y:-t/.76}}getSidesData(e,t){const n=e.sides;return{count:{denominator:1,numerator:n},length:2.66*t/(n/3)}}}class kt extends _t{getCenter(e,t){return{x:-t,y:t/1.66}}getSidesCount(){return 3}getSidesData(e,t){return{count:{denominator:2,numerator:3},length:2*t}}}async function xt(e,t=!0){await async function(e,t=!0){await e.addShape("polygon",new wt,t)}(e,t),await async function(e,t=!0){await e.addShape("triangle",new kt,t)}(e,t)}class St{constructor(){this.enable=!1,this.speed=0,this.decay=0,this.sync=!1}load(e){e&&(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.speed&&(this.speed=(0,r.DT)(e.speed)),void 0!==e.decay&&(this.decay=(0,r.DT)(e.decay)),void 0!==e.sync&&(this.sync=e.sync))}}class Et extends o.PV{constructor(){super(),this.animation=new St,this.direction="clockwise",this.path=!1,this.value=0}load(e){e&&(super.load(e),void 0!==e.direction&&(this.direction=e.direction),this.animation.load(e.animation),void 0!==e.path&&(this.path=e.path))}}class Ct{constructor(e){this.container=e}init(e){const t=e.options.rotate;if(!t)return;e.rotate={enable:t.animation.enable,value:(0,r.VG)(t.value)*Math.PI/180},e.pathRotation=t.path;let n=t.direction;if("random"===n){n=Math.floor(2*(0,r.G0)())>0?"counter-clockwise":"clockwise"}switch(n){case"counter-clockwise":case"counterClockwise":e.rotate.status="decreasing";break;case"clockwise":e.rotate.status="increasing"}const i=t.animation;i.enable&&(e.rotate.decay=1-(0,r.VG)(i.decay),e.rotate.velocity=(0,r.VG)(i.speed)/360*this.container.retina.reduceFactor,i.sync||(e.rotate.velocity*=(0,r.G0)())),e.rotation=e.rotate.value}isEnabled(e){const t=e.options.rotate;return!!t&&(!e.destroyed&&!e.spawning&&t.animation.enable&&!t.path)}loadOptions(e,...t){e.rotate||(e.rotate=new Et);for(const n of t)e.rotate.load(n?.rotate)}update(e,t){this.isEnabled(e)&&(!function(e,t){const n=e.rotate,i=e.options.rotate;if(!n||!i)return;const s=i.animation,r=(n.velocity??0)*t.factor,o=2*Math.PI,a=n.decay??1;s.enable&&("increasing"===n.status?(n.value+=r,n.value>o&&(n.value-=o)):(n.value-=r,n.value<0&&(n.value+=o)),n.velocity&&1!==a&&(n.velocity*=a))}(e,t),e.rotation=e.rotate?.value??0)}}const Tt=Math.sqrt(2);class Mt{draw(e,t,n){const i=n/Tt,s=2*i;e.rect(-i,-i,s,s)}getSidesCount(){return 4}}class At{draw(e,t,n){const i=t.sides,s=t.starInset??2;e.moveTo(0,0-n);for(let r=0;r<i;r++)e.rotate(Math.PI/i),e.lineTo(0,0-n*s),e.rotate(Math.PI/i),e.lineTo(0,0-n)}getSidesCount(e){const t=e.shapeData;return Math.round((0,r.VG)(t?.sides??t?.nb_sides??5))}particleInit(e,t){const n=t.shapeData,i=(0,r.VG)(n?.inset??2);t.starInset=i}}function It(e,t,n,i,s){if(!t||!n.enable||(t.maxLoops??0)>0&&(t.loops??0)>(t.maxLoops??0))return;if(t.time||(t.time=0),(t.delayTime??0)>0&&t.time<(t.delayTime??0)&&(t.time+=e.value),(t.delayTime??0)>0&&t.time<(t.delayTime??0))return;const o=(0,r.U4)(n.offset),a=(t.velocity??0)*e.factor+3.6*o,l=t.decay??1;s&&"increasing"!==t.status?(t.value-=a,t.value<0&&(t.loops||(t.loops=0),t.loops++,t.status="increasing",t.value+=t.value)):(t.value+=a,t.value>i&&(t.loops||(t.loops=0),t.loops++,s&&(t.status="decreasing",t.value-=t.value%i))),t.velocity&&1!==l&&(t.velocity*=l),t.value>i&&(t.value%=i)}class Rt{constructor(e){this.container=e}init(e){const t=this.container,n=e.options,s=(0,i.TA)(n.stroke,e.id,n.reduceDuplicates);e.strokeWidth=(0,r.VG)(s.width)*t.retina.pixelRatio,e.strokeOpacity=(0,r.VG)(s.opacity??1),e.strokeAnimation=s.color?.animation;const o=(0,d.R5)(s.color)??e.getFillColor();o&&(e.strokeColor=(0,d.pz)(o,e.strokeAnimation,t.retina.reduceFactor))}isEnabled(e){const t=e.strokeAnimation,{strokeColor:n}=e;return!e.destroyed&&!e.spawning&&!!t&&(void 0!==n?.h.value&&n.h.enable||void 0!==n?.s.value&&n.s.enable||void 0!==n?.l.value&&n.l.enable)}update(e,t){this.isEnabled(e)&&function(e,t){if(!e.strokeColor||!e.strokeAnimation)return;const{h:n,s:i,l:s}=e.strokeColor,{h:r,s:o,l:a}=e.strokeAnimation;n&&It(t,n,r,360,!1),i&&It(t,i,o,100,!0),s&&It(t,s,a,100,!0)}(e,t)}}const Ot=["text","character","char"];class Lt{draw(e,t,n,s){const r=t.shapeData;if(void 0===r)return;const o=r.value;if(void 0===o)return;void 0===t.text&&(t.text=(0,i.TA)(o,t.randomIndexData));const a=t.text,l=r.style??"",c=r.weight??"400",u=2*Math.round(n),d=r.font??"Verdana",h=t.fill,p=a.length*n/2;e.font=`${l} ${c} ${u}px "${d}"`;const f={x:-p,y:n/2};e.globalAlpha=s,h?e.fillText(a,f.x,f.y):e.strokeText(a,f.x,f.y),e.globalAlpha=1}getSidesCount(){return 12}async init(e){const t=e.actualOptions;if(Ot.find((e=>(0,i.hn)(e,t.particles.shape.type)))){const e=Ot.map((e=>t.particles.shape.options[e])).find((e=>!!e)),n=[];(0,i.wJ)(e,(e=>{n.push((0,i.Al)(e.font,e.weight))})),await Promise.all(n)}}particleInit(e,t){if(!t.shape||!Ot.includes(t.shape))return;const n=t.shapeData;if(void 0===n)return;const s=n.value;void 0!==s&&(t.text=(0,i.TA)(s,t.randomIndexData))}}async function Pt(e,t=!0){H(e),await async function(e,t=!0){await e.addMover("parallax",(()=>new nt),t)}(e,!1),await async function(e,t=!0){await e.addInteractor("externalAttract",(t=>new ae(e,t)),t)}(e,!1),await async function(e,t=!0){await e.addInteractor("externalBounce",(e=>new ue(e)),t)}(e,!1),await async function(e,t=!0){await e.addInteractor("externalBubble",(e=>new me(e)),t)}(e,!1),await async function(e,t=!0){await e.addInteractor("externalConnect",(e=>new we(e)),t)}(e,!1),await async function(e,t=!0){await e.addInteractor("externalGrab",(e=>new Ee(e)),t)}(e,!1),await async function(e,t=!0){await e.addInteractor("externalPause",(e=>new Ce(e)),t)}(e,!1),await async function(e,t=!0){await e.addInteractor("externalPush",(e=>new Me(e)),t)}(e,!1),await async function(e,t=!0){await e.addInteractor("externalRemove",(e=>new Ie(e)),t)}(e,!1),await async function(e,t=!0){await e.addInteractor("externalRepulse",(t=>new Pe(e,t)),t)}(e,!1),await async function(e,t=!0){await e.addInteractor("externalSlow",(e=>new Ne(e)),t)}(e,!1),await async function(e,t=!0){await e.addInteractor("particlesAttract",(e=>new st(e)),t)}(e,!1),await async function(e,t=!0){await e.addInteractor("particlesCollisions",(e=>new ct(e)),t)}(e,!1),await bt(e,!1),await async function(){(0,r.nL)("ease-in-quad",(e=>e**2)),(0,r.nL)("ease-out-quad",(e=>1-(1-e)**2)),(0,r.nL)("ease-in-out-quad",(e=>e<.5?2*e**2:1-(-2*e+2)**2/2))}(),await Ze(e,!1),await async function(e,t=!0){await e.addShape("line",new tt,t)}(e,!1),await xt(e,!1),await async function(e,t=!0){await e.addShape(["edge","square"],new Mt,t)}(e,!1),await async function(e,t=!0){await e.addShape("star",new At,t)}(e,!1),await async function(e,t=!0){await e.addShape(Ot,new Lt,t)}(e,!1),await async function(e,t=!0){await e.addParticleUpdater("life",(e=>new et(e)),t)}(e,!1),await async function(e,t=!0){await e.addParticleUpdater("rotate",(e=>new Ct(e)),t)}(e,!1),await async function(e,t=!0){await e.addParticleUpdater("strokeColor",(e=>new Rt(e)),t)}(e,!1),await ie(e,t)}class Dt{constructor(){this.enable=!1,this.speed=0,this.decay=0,this.sync=!1}load(e){e&&(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.speed&&(this.speed=(0,r.DT)(e.speed)),void 0!==e.decay&&(this.decay=(0,r.DT)(e.decay)),void 0!==e.sync&&(this.sync=e.sync))}}class Nt extends o.PV{constructor(){super(),this.animation=new Dt,this.direction="clockwise",this.enable=!1,this.value=0}load(e){super.load(e),e&&(this.animation.load(e.animation),void 0!==e.direction&&(this.direction=e.direction),void 0!==e.enable&&(this.enable=e.enable))}}class zt{constructor(e){this.container=e}getTransformValues(e){const t=e.tilt?.enable&&e.tilt;return{b:t?Math.cos(t.value)*t.cosDirection:void 0,c:t?Math.sin(t.value)*t.sinDirection:void 0}}init(e){const t=e.options.tilt;if(!t)return;e.tilt={enable:t.enable,value:(0,r.VG)(t.value)*Math.PI/180,sinDirection:(0,r.G0)()>=.5?1:-1,cosDirection:(0,r.G0)()>=.5?1:-1};let n=t.direction;if("random"===n){n=Math.floor(2*(0,r.G0)())>0?"counter-clockwise":"clockwise"}switch(n){case"counter-clockwise":case"counterClockwise":e.tilt.status="decreasing";break;case"clockwise":e.tilt.status="increasing"}const i=e.options.tilt?.animation;i?.enable&&(e.tilt.decay=1-(0,r.VG)(i.decay),e.tilt.velocity=(0,r.VG)(i.speed)/360*this.container.retina.reduceFactor,i.sync||(e.tilt.velocity*=(0,r.G0)()))}isEnabled(e){const t=e.options.tilt?.animation;return!e.destroyed&&!e.spawning&&!!t?.enable}loadOptions(e,...t){e.tilt||(e.tilt=new Nt);for(const n of t)e.tilt.load(n?.tilt)}update(e,t){this.isEnabled(e)&&function(e,t){if(!e.tilt||!e.options.tilt)return;const n=e.options.tilt.animation,i=(e.tilt.velocity??0)*t.factor,s=2*Math.PI,r=e.tilt.decay??1;n.enable&&("increasing"===e.tilt.status?(e.tilt.value+=i,e.tilt.value>s&&(e.tilt.value-=s)):(e.tilt.value-=i,e.tilt.value<0&&(e.tilt.value+=s)),e.tilt.velocity&&1!==r&&(e.tilt.velocity*=r))}(e,t)}}class Bt{constructor(){this.enable=!1,this.frequency=.05,this.opacity=1}load(e){e&&(void 0!==e.color&&(this.color=s.O.create(this.color,e.color)),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.frequency&&(this.frequency=e.frequency),void 0!==e.opacity&&(this.opacity=(0,r.DT)(e.opacity)))}}class Ft{constructor(){this.lines=new Bt,this.particles=new Bt}load(e){e&&(this.lines.load(e.lines),this.particles.load(e.particles))}}class Ut{getColorStyles(e,t,n,i){const s=e.options.twinkle;if(!s)return{};const o=s.particles,a=o.enable&&(0,r.G0)()<o.frequency,l=e.options.zIndex,c=(1-e.zIndexFactor)**l.opacityRate,u=a?(0,r.VG)(o.opacity)*c:i,h=(0,d.R5)(o.color),p=h?(0,d.LC)(h,u):void 0,f={},m=a&&p;return f.fill=m?p:void 0,f.stroke=m?p:void 0,f}init(){}isEnabled(e){const t=e.options.twinkle;return!!t&&t.particles.enable}loadOptions(e,...t){e.twinkle||(e.twinkle=new Ft);for(const n of t)e.twinkle.load(n?.twinkle)}update(){}}class jt{constructor(){this.angle=50,this.move=10}load(e){e&&(void 0!==e.angle&&(this.angle=(0,r.DT)(e.angle)),void 0!==e.move&&(this.move=(0,r.DT)(e.move)))}}class qt{constructor(){this.distance=5,this.enable=!1,this.speed=new jt}load(e){if(e&&(void 0!==e.distance&&(this.distance=(0,r.DT)(e.distance)),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.speed))if((0,i.Et)(e.speed))this.speed.load({angle:e.speed});else{const t=e.speed;void 0!==t.min?this.speed.load({angle:t}):this.speed.load(e.speed)}}}class Vt{constructor(e){this.container=e}init(e){const t=e.options.wobble;e.wobble=t?.enable?{angle:(0,r.G0)()*Math.PI*2,angleSpeed:(0,r.VG)(t.speed.angle)/360,moveSpeed:(0,r.VG)(t.speed.move)/10}:{angle:0,angleSpeed:0,moveSpeed:0},e.retina.wobbleDistance=(0,r.VG)(t?.distance??0)*this.container.retina.pixelRatio}isEnabled(e){return!e.destroyed&&!e.spawning&&!!e.options.wobble?.enable}loadOptions(e,...t){e.wobble||(e.wobble=new qt);for(const n of t)e.wobble.load(n?.wobble)}update(e,t){this.isEnabled(e)&&function(e,t){const{wobble:n}=e.options,{wobble:i}=e;if(!n?.enable||!i)return;const s=i.angleSpeed*t.factor,r=i.moveSpeed*t.factor*((e.retina.wobbleDistance??0)*t.factor)/(1e3/60),o=2*Math.PI,{position:a}=e;i.angle+=s,i.angle>o&&(i.angle-=o),a.x+=r*Math.cos(i.angle),a.y+=r*Math.abs(Math.sin(i.angle))}(e,t)}}async function Ht(e,t=!0){await async function(e,t=!0){await e.addParticleUpdater("destroy",(t=>new k(e,t)),t)}(e,!1),await async function(e,t=!0){await e.addParticleUpdater("roll",(()=>new j),t)}(e,!1),await async function(e,t=!0){await e.addParticleUpdater("tilt",(e=>new zt(e)),t)}(e,!1),await async function(e,t=!0){await e.addParticleUpdater("twinkle",(()=>new Ut),t)}(e,!1),await async function(e,t=!0){await e.addParticleUpdater("wobble",(e=>new Vt(e)),t)}(e,!1),await async function(e,t=!0){await e.addInteractor("externalTrail",(e=>new B(e)),t)}(e,!1),await async function(e,t=!0){await e.addPlugin(new f,t)}(e,!1),await async function(e,t=!0){e.emitterShapeManager||(e.emitterShapeManager=new O(e)),e.addEmitterShape||(e.addEmitterShape=(t,n)=>{e.emitterShapeManager?.addShape(t,n)});const n=new D(e);await e.addPlugin(n,t),e.addEmitterShape("circle",new x),e.addEmitterShape("square",new P)}(e,!1),await Pt(e,t)}},8118:(e,t,n)=>{n.d(t,{A:()=>r});n(2340);var i=n(1287),s=n(8040);function r(e){let{children:t,fallback:n}=e;return(0,i.A)()?(0,s.jsx)(s.Fragment,{children:t?.()}):n??null}},3295:(e,t,n)=>{n.d(t,{A:()=>u});var i=n(2340),s=n(3134);const r=e=>"object"==typeof e&&null!==e;function o(e,t,n=()=>!1){if(!r(e)||!r(t))return e===t;const i=Object.keys(e).filter((e=>!n(e))),s=Object.keys(t).filter((e=>!n(e)));if(i.length!==s.length)return!1;for(const l of i){const i=e[l],s=t[l];if(r(i)&&r(s)){if(i===t&&s===e)continue;if(!o(i,s,n))return!1}else if(Array.isArray(i)&&Array.isArray(s)){if(!a(i,s,n))return!1}else if(i!==s)return!1}return!0}function a(e,t,n){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++){const s=e[i],l=t[i];if(Array.isArray(s)&&Array.isArray(l)){if(!a(s,l,n))return!1}else if(r(s)&&r(l)){if(!o(s,l,n))return!1}else if(s!==l)return!1}return!0}const l="tsparticles";class c extends i.Component{constructor(e){super(e),this.state={init:!1,library:void 0}}destroy(){this.state.library&&(this.state.library.destroy(),this.setState({library:void 0}))}shouldComponentUpdate(e){const t=e.options??e.params,n=this.props.options??this.props.params;return e.url!==this.props.url||e.id!==this.props.id||e.canvasClassName!==this.props.canvasClassName||e.className!==this.props.className||e.height!==this.props.height||e.width!==this.props.width||!o(e.style,this.props.style)||e.init!==this.props.init||e.loaded!==this.props.loaded||!o(t,n,(e=>e.startsWith("_")))}componentDidUpdate(){this.refresh()}forceUpdate(){this.refresh().then((()=>{super.forceUpdate()}))}componentDidMount(){(async()=>{this.props.init&&await this.props.init(s.$k),this.setState({init:!0},(async()=>{await this.loadParticles()}))})()}componentWillUnmount(){this.destroy()}render(){const{width:e,height:t,className:n,canvasClassName:s,id:r}=this.props;return i.createElement("div",{className:n,id:r},i.createElement("canvas",{className:s,style:{...this.props.style,width:e,height:t}}))}async refresh(){this.destroy(),await this.loadParticles()}async loadParticles(){if(!this.state.init)return;const e=this.props.id??c.defaultProps.id??l,t=await s.$k.load({url:this.props.url,id:e,options:this.props.options??this.props.params});this.props.container&&(this.props.container.current=t),this.setState({library:t}),this.props.loaded&&await this.props.loaded(t)}}c.defaultProps={width:"100%",height:"100%",options:{},style:{},url:void 0,id:l};const u=c},1724:(e,t,n)=>{n.d(t,{j:()=>o});var i=n(8899),s=n(963),r=n(5190);class o extends i.Q{constructor(e,t,n){super(e,t),this.radius=n}contains(e){return(0,r.Yf)(e,this.position)<=this.radius}intersects(e){const t=this.position,n=e.position,i=Math.abs(n.x-t.x),r=Math.abs(n.y-t.y),a=this.radius;if(e instanceof o){return a+e.radius>Math.sqrt(i**2+r**2)}if(e instanceof s.M){const{width:t,height:n}=e.size;return Math.pow(i-t,2)+Math.pow(r-n,2)<=a**2||i<=a+t&&r<=a+n||i<=t||r<=n}return!1}}},3887:(e,t,n)=>{n.d(t,{Bp:()=>u,DG:()=>d,G3:()=>h,NF:()=>p,Rb:()=>l,Z0:()=>o,dI:()=>m,eb:()=>i,ms:()=>s,nK:()=>f,s7:()=>c,sf:()=>a,vo:()=>r});const i="generated",s="pointerdown",r="pointerup",o="pointerleave",a="pointerout",l="pointermove",c="touchstart",u="touchend",d="touchmove",h="touchcancel",p="resize",f="visibilitychange",m="tsParticles - Error"},8899:(e,t,n)=>{n.d(t,{Q:()=>i});class i{constructor(e,t){this.position={x:e,y:t}}}},963:(e,t,n)=>{n.d(t,{M:()=>r});var i=n(1724),s=n(8899);class r extends s.Q{constructor(e,t,n,i){super(e,t),this.size={height:i,width:n}}contains(e){const t=this.size.width,n=this.size.height,i=this.position;return e.x>=i.x&&e.x<=i.x+t&&e.y>=i.y&&e.y<=i.y+n}intersects(e){e instanceof i.j&&e.intersects(this);const t=this.size.width,n=this.size.height,s=this.position,o=e.position,a=e instanceof r?e.size:{width:0,height:0},l=a.width,c=a.height;return o.x<s.x+t&&o.x+l>s.x&&o.y<s.y+n&&o.y+c>s.y}}},7883:(e,t,n)=>{n.d(t,{M:()=>s});var i=n(7328);class s extends i.p{constructor(e,t){super(e,t,0)}static get origin(){return s.create(0,0)}static clone(e){return s.create(e.x,e.y)}static create(e,t){return new s(e,t)}}},7328:(e,t,n)=>{n.d(t,{p:()=>r});var i=n(3887),s=n(2529);class r{constructor(e,t,n){if(this._updateFromAngle=(e,t)=>{this.x=Math.cos(e)*t,this.y=Math.sin(e)*t},!(0,s.Et)(e)&&e){this.x=e.x,this.y=e.y;const t=e;this.z=t.z?t.z:0}else{if(void 0===e||void 0===t)throw new Error(`${i.dI} Vector3d not initialized correctly`);this.x=e,this.y=t,this.z=n??0}}static get origin(){return r.create(0,0,0)}get angle(){return Math.atan2(this.y,this.x)}set angle(e){this._updateFromAngle(e,this.length)}get length(){return Math.sqrt(this.getLengthSq())}set length(e){this._updateFromAngle(this.angle,e)}static clone(e){return r.create(e.x,e.y,e.z)}static create(e,t,n){return new r(e,t,n)}add(e){return r.create(this.x+e.x,this.y+e.y,this.z+e.z)}addTo(e){this.x+=e.x,this.y+=e.y,this.z+=e.z}copy(){return r.clone(this)}distanceTo(e){return this.sub(e).length}distanceToSq(e){return this.sub(e).getLengthSq()}div(e){return r.create(this.x/e,this.y/e,this.z/e)}divTo(e){this.x/=e,this.y/=e,this.z/=e}getLengthSq(){return this.x**2+this.y**2}mult(e){return r.create(this.x*e,this.y*e,this.z*e)}multTo(e){this.x*=e,this.y*=e,this.z*=e}normalize(){const e=this.length;0!=e&&this.multTo(1/e)}rotate(e){return r.create(this.x*Math.cos(e)-this.y*Math.sin(e),this.x*Math.sin(e)+this.y*Math.cos(e),0)}setTo(e){this.x=e.x,this.y=e.y;const t=e;this.z=t.z?t.z:0}sub(e){return r.create(this.x-e.x,this.y-e.y,this.z-e.z)}subFrom(e){this.x-=e.x,this.y-=e.y,this.z-=e.z}}},5337:(e,t,n)=>{n.d(t,{A:()=>l});var i=n(2529),s=n(5190);class r{constructor(){this.count=0,this.enable=!1,this.offset=0,this.speed=1,this.delay=0,this.decay=0,this.sync=!0}load(e){e&&(void 0!==e.count&&(this.count=(0,s.DT)(e.count)),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.offset&&(this.offset=(0,s.DT)(e.offset)),void 0!==e.speed&&(this.speed=(0,s.DT)(e.speed)),void 0!==e.decay&&(this.decay=(0,s.DT)(e.decay)),void 0!==e.delay&&(this.delay=(0,s.DT)(e.delay)),void 0!==e.sync&&(this.sync=e.sync))}}class o{constructor(){this.h=new r,this.s=new r,this.l=new r}load(e){e&&(this.h.load(e.h),this.s.load(e.s),this.l.load(e.l))}}var a=n(2300);class l extends a.O{constructor(){super(),this.animation=new o}static create(e,t){const n=new l;return n.load(e),void 0!==t&&((0,i.Kg)(t)||(0,i.cy)(t)?n.load({value:t}):n.load(t)),n}load(e){if(super.load(e),!e)return;const t=e.animation;void 0!==t&&(void 0!==t.enable?this.animation.h.load(t):this.animation.load(e.animation))}}},5782:(e,t,n)=>{n.d(t,{Q:()=>r,p:()=>s});var i=n(5190);class s{constructor(){this.count=0,this.enable=!1,this.speed=1,this.decay=0,this.delay=0,this.sync=!1}load(e){e&&(void 0!==e.count&&(this.count=(0,i.DT)(e.count)),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.speed&&(this.speed=(0,i.DT)(e.speed)),void 0!==e.decay&&(this.decay=(0,i.DT)(e.decay)),void 0!==e.delay&&(this.delay=(0,i.DT)(e.delay)),void 0!==e.sync&&(this.sync=e.sync))}}class r extends s{constructor(){super(),this.mode="auto",this.startValue="random"}load(e){super.load(e),e&&(void 0!==e.minimumValue&&(this.minimumValue=e.minimumValue),void 0!==e.mode&&(this.mode=e.mode),void 0!==e.startValue&&(this.startValue=e.startValue))}}},2300:(e,t,n)=>{n.d(t,{O:()=>s});var i=n(2529);class s{constructor(){this.value=""}static create(e,t){const n=new s;return n.load(e),void 0!==t&&((0,i.Kg)(t)||(0,i.cy)(t)?n.load({value:t}):n.load(t)),n}load(e){void 0!==e?.value&&(this.value=e.value)}}},2068:(e,t,n)=>{n.d(t,{PV:()=>o});n(5782);class i{constructor(){this.enable=!1,this.minimumValue=0}load(e){e&&(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.minimumValue&&(this.minimumValue=e.minimumValue))}}var s=n(2529),r=n(5190);class o{constructor(){this.random=new i,this.value=0}load(e){e&&((0,s.Lm)(e.random)?this.random.enable=e.random:this.random.load(e.random),void 0!==e.value&&(this.value=(0,r.DT)(e.value,this.random.enable?this.random.minimumValue:void 0)))}}},1525:(e,t,n)=>{n.d(t,{D4:()=>r,IU:()=>l,Md:()=>a,Sn:()=>o,V6:()=>s,Wb:()=>d,e_:()=>u,p0:()=>c,yx:()=>h});var i=n(5118);function s(e,t,n){e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(n.x,n.y),e.closePath()}function r(e,t,n,i){e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(n.x,n.y),e.lineTo(i.x,i.y),e.closePath()}function o(e,t,n){e.fillStyle=n??"rgba(0,0,0,0)",e.fillRect(0,0,t.width,t.height)}function a(e,t,n,i){n&&(e.globalAlpha=i,e.drawImage(n,0,0,t.width,t.height),e.globalAlpha=1)}function l(e,t){e.clearRect(0,0,t.width,t.height)}function c(e){const{container:t,context:n,particle:s,delta:r,colorStyles:o,backgroundMask:a,composite:l,radius:c,opacity:u,shadow:d,transform:h}=e,p=s.getPosition(),f=s.rotation+(s.pathRotation?s.velocity.angle:0),m=Math.sin(f),v=Math.cos(f),g={a:v*(h.a??1),b:m*(h.b??1),c:-m*(h.c??1),d:v*(h.d??1)};n.setTransform(g.a,g.b,g.c,g.d,p.x,p.y),n.beginPath(),a&&(n.globalCompositeOperation=l);const y=s.shadowColor;d.enable&&y&&(n.shadowBlur=d.blur,n.shadowColor=(0,i.xx)(y),n.shadowOffsetX=d.offset.x,n.shadowOffsetY=d.offset.y),o.fill&&(n.fillStyle=o.fill);const b=s.strokeWidth??0;n.lineWidth=b,o.stroke&&(n.strokeStyle=o.stroke),function(e,t,n,i,s,r){if(!n.shape)return;const o=e.drawers.get(n.shape);if(!o)return;o.draw(t,n,i,s,r,e.retina.pixelRatio)}(t,n,s,c,u,r),b>0&&n.stroke(),s.close&&n.closePath(),s.fill&&n.fill(),function(e,t,n,i,s,r){if(!n.shape)return;const o=e.drawers.get(n.shape);if(!o||!o.afterEffect)return;o.afterEffect(t,n,i,s,r,e.retina.pixelRatio)}(t,n,s,c,u,r),n.globalCompositeOperation="source-over",n.setTransform(1,0,0,1,0,0)}function u(e,t,n){t.draw&&t.draw(e,n)}function d(e,t,n,i){t.drawParticle&&t.drawParticle(e,n,i)}function h(e,t,n){return{h:e.h,s:e.s,l:e.l+("darken"===t?-1:1)*n}}},5118:(e,t,n)=>{n.d(t,{BN:()=>d,EY:()=>_,K6:()=>f,LC:()=>b,O_:()=>x,PG:()=>k,R5:()=>p,YL:()=>m,_h:()=>w,a9:()=>l,ay:()=>v,pz:()=>S,xx:()=>y});var i=n(5190),s=n(2529);const r="random",o="mid",a=new Map;function l(e){a.set(e.key,e)}function c(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function u(e){for(const[,i]of a)if(e.startsWith(i.stringPrefix))return i.parseString(e);const t=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])([a-f\d])?$/i,((e,t,n,i,s)=>t+t+n+n+i+i+(void 0!==s?s+s:""))),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(t);return n?{a:void 0!==n[4]?parseInt(n[4],16)/255:1,b:parseInt(n[3],16),g:parseInt(n[2],16),r:parseInt(n[1],16)}:void 0}function d(e,t,n=!0){if(!e)return;const i=(0,s.Kg)(e)?{value:e}:e;if((0,s.Kg)(i.value))return h(i.value,t,n);if((0,s.cy)(i.value))return d({value:(0,s.Vh)(i.value,t,n)});for(const[,s]of a){const e=s.handleRangeColor(i);if(e)return e}}function h(e,t,n=!0){if(!e)return;const i=(0,s.Kg)(e)?{value:e}:e;if((0,s.Kg)(i.value))return i.value===r?g():function(e){return u(e)}(i.value);if((0,s.cy)(i.value))return h({value:(0,s.Vh)(i.value,t,n)});for(const[,s]of a){const e=s.handleColor(i);if(e)return e}}function p(e,t,n=!0){const i=d(e,t,n);return i?f(i):void 0}function f(e){const t=e.r/255,n=e.g/255,i=e.b/255,s=Math.max(t,n,i),r=Math.min(t,n,i),o={h:0,l:(s+r)/2,s:0};return s!==r&&(o.s=o.l<.5?(s-r)/(s+r):(s-r)/(2-s-r),o.h=t===s?(n-i)/(s-r):o.h=n===s?2+(i-t)/(s-r):4+(t-n)/(s-r)),o.l*=100,o.s*=100,o.h*=60,o.h<0&&(o.h+=360),o.h>=360&&(o.h-=360),o}function m(e){const t={b:0,g:0,r:0},n={h:e.h/360,l:e.l/100,s:e.s/100};if(n.s){const e=n.l<.5?n.l*(1+n.s):n.l+n.s-n.l*n.s,i=2*n.l-e;t.r=c(i,e,n.h+1/3),t.g=c(i,e,n.h),t.b=c(i,e,n.h-1/3)}else t.r=t.g=t.b=n.l;return t.r=Math.floor(255*t.r),t.g=Math.floor(255*t.g),t.b=Math.floor(255*t.b),t}function v(e){const t=m(e);return{a:e.a,b:t.b,g:t.g,r:t.r}}function g(e){const t=e??0;return{b:Math.floor((0,i.U4)((0,i.DT)(t,256))),g:Math.floor((0,i.U4)((0,i.DT)(t,256))),r:Math.floor((0,i.U4)((0,i.DT)(t,256)))}}function y(e,t){return`rgba(${e.r}, ${e.g}, ${e.b}, ${t??1})`}function b(e,t){return`hsla(${e.h}, ${e.s}%, ${e.l}%, ${t??1})`}function _(e,t,n,s){let r=e,o=t;return void 0===r.r&&(r=m(e)),void 0===o.r&&(o=m(t)),{b:(0,i.jh)(r.b,o.b,n,s),g:(0,i.jh)(r.g,o.g,n,s),r:(0,i.jh)(r.r,o.r,n,s)}}function w(e,t,n){if(n===r)return g();if(n!==o)return n;{const n=e.getFillColor()??e.getStrokeColor(),i=t?.getFillColor()??t?.getStrokeColor();if(n&&i&&t)return _(n,i,e.getRadius(),t.getRadius());{const e=n??i;if(e)return m(e)}}}function k(e,t,n){const i=(0,s.Kg)(e)?e:e.value;return i===r?n?d({value:i}):t?r:o:i===o?o:d({value:i})}function x(e){return void 0!==e?{h:e.h.value,s:e.s.value,l:e.l.value}:void 0}function S(e,t,n){const i={h:{enable:!1,value:e.h},s:{enable:!1,value:e.s},l:{enable:!1,value:e.l}};return t&&(E(i.h,t.h,n),E(i.s,t.s,n),E(i.l,t.l,n)),i}function E(e,t,n){e.enable=t.enable,e.enable?(e.velocity=(0,i.VG)(t.speed)/100*n,e.decay=1-(0,i.VG)(t.decay),e.status="increasing",e.loops=0,e.maxLoops=(0,i.VG)(t.count),e.time=0,e.delayTime=1e3*(0,i.VG)(t.delay),t.sync||(e.velocity*=(0,i.G0)(),e.value*=(0,i.G0)()),e.initialValue=e.value):e.velocity=0}},5190:(e,t,n)=>{n.d(t,{$m:()=>w,DT:()=>v,G0:()=>c,JY:()=>_,M3:()=>C,Mh:()=>x,Nx:()=>E,OW:()=>k,Sg:()=>f,U4:()=>h,VG:()=>p,W9:()=>m,Yf:()=>b,_W:()=>g,il:()=>l,jh:()=>d,l1:()=>S,nL:()=>a,qE:()=>u,vr:()=>y});var i=n(2529),s=n(7883);let r=Math.random;const o=new Map;function a(e,t){o.get(e)||o.set(e,t)}function l(e){return o.get(e)||(e=>e)}function c(){return u(r(),0,1-1e-16)}function u(e,t,n){return Math.min(Math.max(e,t),n)}function d(e,t,n,i){return Math.floor((e*n+t*i)/(n+i))}function h(e){const t=m(e);let n=f(e);return t===n&&(n=0),c()*(t-n)+n}function p(e){return(0,i.Et)(e)?e:h(e)}function f(e){return(0,i.Et)(e)?e:e.min}function m(e){return(0,i.Et)(e)?e:e.max}function v(e,t){if(e===t||void 0===t&&(0,i.Et)(e))return e;const n=f(e),s=m(e);return void 0!==t?{min:Math.min(n,t),max:Math.max(s,t)}:v(n,s)}function g(e){const t=e.random,{enable:n,minimumValue:s}=(0,i.Lm)(t)?{enable:t,minimumValue:0}:t;return p(n?v(e.value,s):e.value)}function y(e,t){const n=e.x-t.x,i=e.y-t.y;return{dx:n,dy:i,distance:Math.sqrt(n**2+i**2)}}function b(e,t){return y(e,t).distance}function _(e,t,n){if((0,i.Et)(e))return e*Math.PI/180;switch(e){case"top":return-Math.PI/2;case"top-right":return-Math.PI/4;case"right":return 0;case"bottom-right":return Math.PI/4;case"bottom":return Math.PI/2;case"bottom-left":return 3*Math.PI/4;case"left":return Math.PI;case"top-left":return-3*Math.PI/4;case"inside":return Math.atan2(n.y-t.y,n.x-t.x);case"outside":return Math.atan2(t.y-n.y,t.x-n.x);default:return c()*Math.PI*2}}function w(e){const t=s.M.origin;return t.length=1,t.angle=e,t}function k(e,t,n,i){return s.M.create(e.x*(n-i)/(n+i)+2*t.x*i/(n+i),e.y)}function x(e){return{x:(e.position?.x??100*c())*e.size.width/100,y:(e.position?.y??100*c())*e.size.height/100}}function S(e){const t={x:void 0!==e.position?.x?p(e.position.x):void 0,y:void 0!==e.position?.y?p(e.position.y):void 0};return x({size:e.size,position:t})}function E(e){return{x:e.position?.x??c()*e.size.width,y:e.position?.y??c()*e.size.height}}function C(e){return e?e.endsWith("%")?parseFloat(e)/100:parseFloat(e):1}},2935:(e,t,n)=>{n.d(t,{Z:()=>j,y:()=>q});var i=n(2529),s=n(5337);class r{constructor(){this.speed=2}load(e){e&&void 0!==e.speed&&(this.speed=e.speed)}}class o{constructor(){this.enable=!0,this.retries=0}load(e){e&&(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.retries&&(this.retries=e.retries))}}var a=n(2068);class l extends a.PV{constructor(){super(),this.random.minimumValue=.1,this.value=1}}class c{constructor(){this.horizontal=new l,this.vertical=new l}load(e){e&&(this.horizontal.load(e.horizontal),this.vertical.load(e.vertical))}}var u=n(5190);class d{constructor(){this.absorb=new r,this.bounce=new c,this.enable=!1,this.maxSpeed=50,this.mode="bounce",this.overlap=new o}load(e){e&&(this.absorb.load(e.absorb),this.bounce.load(e.bounce),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.maxSpeed&&(this.maxSpeed=(0,u.DT)(e.maxSpeed)),void 0!==e.mode&&(this.mode=e.mode),this.overlap.load(e.overlap))}}class h{constructor(){this.offset=0,this.value=90}load(e){e&&(void 0!==e.offset&&(this.offset=(0,u.DT)(e.offset)),void 0!==e.value&&(this.value=(0,u.DT)(e.value)))}}class p{constructor(){this.distance=200,this.enable=!1,this.rotate={x:3e3,y:3e3}}get rotateX(){return this.rotate.x}set rotateX(e){this.rotate.x=e}get rotateY(){return this.rotate.y}set rotateY(e){this.rotate.y=e}load(e){if(!e)return;void 0!==e.distance&&(this.distance=(0,u.DT)(e.distance)),void 0!==e.enable&&(this.enable=e.enable);const t=e.rotate?.x??e.rotateX;void 0!==t&&(this.rotate.x=t);const n=e.rotate?.y??e.rotateY;void 0!==n&&(this.rotate.y=n)}}class f{constructor(){this.x=50,this.y=50,this.mode="percent",this.radius=0}load(e){e&&(void 0!==e.x&&(this.x=e.x),void 0!==e.y&&(this.y=e.y),void 0!==e.mode&&(this.mode=e.mode),void 0!==e.radius&&(this.radius=e.radius))}}class m{constructor(){this.acceleration=9.81,this.enable=!1,this.inverse=!1,this.maxSpeed=50}load(e){e&&(void 0!==e.acceleration&&(this.acceleration=(0,u.DT)(e.acceleration)),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.inverse&&(this.inverse=e.inverse),void 0!==e.maxSpeed&&(this.maxSpeed=(0,u.DT)(e.maxSpeed)))}}class v{constructor(){this.clamp=!0,this.delay=new a.PV,this.enable=!1,this.options={}}load(e){e&&(void 0!==e.clamp&&(this.clamp=e.clamp),this.delay.load(e.delay),void 0!==e.enable&&(this.enable=e.enable),this.generator=e.generator,e.options&&(this.options=(0,i.zw)(this.options,e.options)))}}var g=n(2300);class y{load(e){e&&(void 0!==e.color&&(this.color=g.O.create(this.color,e.color)),void 0!==e.image&&(this.image=e.image))}}class b{constructor(){this.enable=!1,this.length=10,this.fill=new y}get fillColor(){return this.fill.color}set fillColor(e){this.fill.load({color:e})}load(e){e&&(void 0!==e.enable&&(this.enable=e.enable),void 0===e.fill&&void 0===e.fillColor||this.fill.load(e.fill||{color:e.fillColor}),void 0!==e.length&&(this.length=e.length))}}class _{constructor(){this.default="out"}load(e){e&&(void 0!==e.default&&(this.default=e.default),this.bottom=e.bottom??e.default,this.left=e.left??e.default,this.right=e.right??e.default,this.top=e.top??e.default)}}class w{constructor(){this.acceleration=0,this.enable=!1}load(e){e&&(void 0!==e.acceleration&&(this.acceleration=(0,u.DT)(e.acceleration)),void 0!==e.enable&&(this.enable=e.enable),e.position&&(this.position=(0,i.zw)({},e.position)))}}class k{constructor(){this.angle=new h,this.attract=new p,this.center=new f,this.decay=0,this.distance={},this.direction="none",this.drift=0,this.enable=!1,this.gravity=new m,this.path=new v,this.outModes=new _,this.random=!1,this.size=!1,this.speed=2,this.spin=new w,this.straight=!1,this.trail=new b,this.vibrate=!1,this.warp=!1}get bounce(){return this.collisions}set bounce(e){this.collisions=e}get collisions(){return!1}set collisions(e){}get noise(){return this.path}set noise(e){this.path=e}get outMode(){return this.outModes.default}set outMode(e){this.outModes.default=e}get out_mode(){return this.outMode}set out_mode(e){this.outMode=e}load(e){if(!e)return;this.angle.load((0,i.Et)(e.angle)?{value:e.angle}:e.angle),this.attract.load(e.attract),this.center.load(e.center),void 0!==e.decay&&(this.decay=(0,u.DT)(e.decay)),void 0!==e.direction&&(this.direction=e.direction),void 0!==e.distance&&(this.distance=(0,i.Et)(e.distance)?{horizontal:e.distance,vertical:e.distance}:{...e.distance}),void 0!==e.drift&&(this.drift=(0,u.DT)(e.drift)),void 0!==e.enable&&(this.enable=e.enable),this.gravity.load(e.gravity);const t=e.outModes??e.outMode??e.out_mode;void 0!==t&&((0,i.Gv)(t)?this.outModes.load(t):this.outModes.load({default:t})),this.path.load(e.path??e.noise),void 0!==e.random&&(this.random=e.random),void 0!==e.size&&(this.size=e.size),void 0!==e.speed&&(this.speed=(0,u.DT)(e.speed)),this.spin.load(e.spin),void 0!==e.straight&&(this.straight=e.straight),this.trail.load(e.trail),void 0!==e.vibrate&&(this.vibrate=e.vibrate),void 0!==e.warp&&(this.warp=e.warp)}}var x=n(5782);class S extends x.Q{constructor(){super(),this.destroy="none",this.speed=2}get opacity_min(){return this.minimumValue}set opacity_min(e){this.minimumValue=e}load(e){void 0!==e?.opacity_min&&void 0===e.minimumValue&&(e.minimumValue=e.opacity_min),super.load(e),e&&void 0!==e.destroy&&(this.destroy=e.destroy)}}class E extends a.PV{constructor(){super(),this.animation=new S,this.random.minimumValue=.1,this.value=1}get anim(){return this.animation}set anim(e){this.animation=e}load(e){if(!e)return;super.load(e);const t=e.animation??e.anim;void 0!==t&&(this.animation.load(t),this.value=(0,u.DT)(this.value,this.animation.enable?this.animation.minimumValue:void 0))}}class C{constructor(){this.enable=!1,this.width=1920,this.height=1080}get area(){return this.width}set area(e){this.width=e}get factor(){return this.height}set factor(e){this.height=e}get value_area(){return this.area}set value_area(e){this.area=e}load(e){if(!e)return;void 0!==e.enable&&(this.enable=e.enable);const t=e.width??e.area??e.value_area;void 0!==t&&(this.width=t);const n=e.height??e.factor;void 0!==n&&(this.height=n)}}class T{constructor(){this.density=new C,this.limit=0,this.value=0}get max(){return this.limit}set max(e){this.limit=e}load(e){if(!e)return;this.density.load(e.density);const t=e.limit??e.max;void 0!==t&&(this.limit=t),void 0!==e.value&&(this.value=e.value)}}class M{constructor(){this.blur=0,this.color=new g.O,this.enable=!1,this.offset={x:0,y:0},this.color.value="#000"}load(e){e&&(void 0!==e.blur&&(this.blur=e.blur),this.color=g.O.create(this.color,e.color),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.offset&&(void 0!==e.offset.x&&(this.offset.x=e.offset.x),void 0!==e.offset.y&&(this.offset.y=e.offset.y)))}}const A="character",I="char",R="image",O="images",L="polygon",P="star";class D{constructor(){this.loadShape=(e,t,n,s)=>{if(!e)return;const r=(0,i.cy)(e),o=r?[]:{},a=r!==(0,i.cy)(this.options[t]),l=r!==(0,i.cy)(this.options[n]);a&&(this.options[t]=o),l&&s&&(this.options[n]=o),this.options[t]=(0,i.zw)(this.options[t]??o,e),this.options[n]&&!s||(this.options[n]=(0,i.zw)(this.options[n]??o,e))},this.close=!0,this.fill=!0,this.options={},this.type="circle"}get character(){return this.options[A]??this.options[I]}set character(e){this.options[I]=this.options[A]=e}get custom(){return this.options}set custom(e){this.options=e}get image(){return this.options[R]??this.options[O]}set image(e){this.options[O]=this.options[R]=e}get images(){return this.image}set images(e){this.image=e}get polygon(){return this.options[L]??this.options[P]}set polygon(e){this.options[P]=this.options[L]=e}get stroke(){return[]}set stroke(e){}load(e){if(!e)return;const t=e.options??e.custom;if(void 0!==t)for(const n in t){const e=t[n];e&&(this.options[n]=(0,i.zw)(this.options[n]??{},e))}this.loadShape(e.character,A,I,!0),this.loadShape(e.polygon,L,P,!1),this.loadShape(e.image??e.images,R,O,!0),void 0!==e.close&&(this.close=e.close),void 0!==e.fill&&(this.fill=e.fill),void 0!==e.type&&(this.type=e.type)}}class N extends x.Q{constructor(){super(),this.destroy="none",this.speed=5}get size_min(){return this.minimumValue}set size_min(e){this.minimumValue=e}load(e){void 0!==e?.size_min&&void 0===e.minimumValue&&(e.minimumValue=e.size_min),super.load(e),e&&void 0!==e.destroy&&(this.destroy=e.destroy)}}class z extends a.PV{constructor(){super(),this.animation=new N,this.random.minimumValue=1,this.value=3}get anim(){return this.animation}set anim(e){this.animation=e}load(e){if(super.load(e),!e)return;const t=e.animation??e.anim;void 0!==t&&(this.animation.load(t),this.value=(0,u.DT)(this.value,this.animation.enable?this.animation.minimumValue:void 0))}}class B{constructor(){this.width=0}load(e){e&&(void 0!==e.color&&(this.color=s.A.create(this.color,e.color)),void 0!==e.width&&(this.width=(0,u.DT)(e.width)),void 0!==e.opacity&&(this.opacity=(0,u.DT)(e.opacity)))}}class F extends a.PV{constructor(){super(),this.opacityRate=1,this.sizeRate=1,this.velocityRate=1}load(e){super.load(e),e&&(void 0!==e.opacityRate&&(this.opacityRate=e.opacityRate),void 0!==e.sizeRate&&(this.sizeRate=e.sizeRate),void 0!==e.velocityRate&&(this.velocityRate=e.velocityRate))}}class U{constructor(e,t){this._engine=e,this._container=t,this.bounce=new c,this.collisions=new d,this.color=new s.A,this.color.value="#fff",this.groups={},this.move=new k,this.number=new T,this.opacity=new E,this.reduceDuplicates=!1,this.shadow=new M,this.shape=new D,this.size=new z,this.stroke=new B,this.zIndex=new F}load(e){if(!e)return;if(this.bounce.load(e.bounce),this.color.load(s.A.create(this.color,e.color)),void 0!==e.groups)for(const s in e.groups){const t=e.groups[s];void 0!==t&&(this.groups[s]=(0,i.zw)(this.groups[s]??{},t))}this.move.load(e.move),this.number.load(e.number),this.opacity.load(e.opacity),void 0!==e.reduceDuplicates&&(this.reduceDuplicates=e.reduceDuplicates),this.shape.load(e.shape),this.size.load(e.size),this.shadow.load(e.shadow),this.zIndex.load(e.zIndex);const t=e.move?.collisions??e.move?.bounce;void 0!==t&&(this.collisions.enable=t),this.collisions.load(e.collisions),void 0!==e.interactivity&&(this.interactivity=(0,i.zw)({},e.interactivity));const n=e.stroke??e.shape?.stroke;if(n&&(this.stroke=(0,i.wJ)(n,(e=>{const t=new B;return t.load(e),t}))),this._container){const t=this._engine.plugins.updaters.get(this._container);if(t)for(const i of t)i.loadOptions&&i.loadOptions(this,e);const n=this._engine.plugins.interactors.get(this._container);if(n)for(const i of n)i.loadParticlesOptions&&i.loadParticlesOptions(this,e)}}}function j(e,...t){for(const n of t)e.load(n)}function q(e,t,...n){const i=new U(e,t);return j(i,...n),i}},2529:(e,t,n)=>{n.d(t,{AE:()=>v,Al:()=>h,B9:()=>l,E9:()=>A,Et:()=>L,Gv:()=>D,Kg:()=>O,Lm:()=>R,NV:()=>_,TA:()=>E,Tg:()=>w,Tj:()=>m,Tn:()=>P,U6:()=>b,Vh:()=>f,Xs:()=>T,YC:()=>I,cy:()=>N,hn:()=>d,iK:()=>y,jo:()=>x,lV:()=>c,n0:()=>p,pE:()=>k,tG:()=>u,tZ:()=>o,wJ:()=>S,zw:()=>g});var i=n(5190),s=n(7883);const r={debug:console.debug,error:console.error,info:console.info,log:console.log,verbose:console.log,warning:console.warn};function o(){return r}function a(e){const t={bounced:!1},{pSide:n,pOtherSide:i,rectSide:s,rectOtherSide:r,velocity:o,factor:a}=e;return i.min<r.min||i.min>r.max||i.max<r.min||i.max>r.max||(n.max>=s.min&&n.max<=(s.max+s.min)/2&&o>0||n.min<=s.max&&n.min>(s.max+s.min)/2&&o<0)&&(t.velocity=o*-a,t.bounced=!0),t}function l(){return"undefined"==typeof window||!window||void 0===window.document||!window.document}function c(e){if(!l()&&"undefined"!=typeof matchMedia)return matchMedia(e)}function u(e){if(!l()&&"undefined"!=typeof MutationObserver)return new MutationObserver(e)}function d(e,t){return e===t||N(t)&&t.indexOf(e)>-1}async function h(e,t){try{await document.fonts.load(`${t??"400"} 36px '${e??"Verdana"}'`)}catch{}}function p(e){return Math.floor((0,i.G0)()*e.length)}function f(e,t,n=!0){return e[void 0!==t&&n?t%e.length:p(e)]}function m(e,t,n,i,s){return function(e,t,n,i){let s=!0;i&&"bottom"!==i||(s=e.top<t.height+n.x);!s||i&&"left"!==i||(s=e.right>n.x);!s||i&&"right"!==i||(s=e.left<t.width+n.y);!s||i&&"top"!==i||(s=e.bottom>n.y);return s}(v(e,i??0),t,n,s)}function v(e,t){return{bottom:e.y+t,left:e.x-t,right:e.x+t,top:e.y-t}}function g(e,...t){for(const n of t){if(null==n)continue;if(!D(n)){e=n;continue}const t=Array.isArray(n);!t||!D(e)&&e&&Array.isArray(e)?t||!D(e)&&e&&!Array.isArray(e)||(e={}):e=[];for(const i in n){if("__proto__"===i)continue;const t=n[i],s=e;s[i]=D(t)&&Array.isArray(t)?t.map((e=>g(s[i],e))):g(s[i],t)}}return e}function y(e,t){return!!C(t,(t=>t.enable&&d(e,t.mode)))}function b(e,t,n){S(t,(t=>{const i=t.mode;t.enable&&d(e,i)&&function(e,t){const n=e.selectors;S(n,(n=>{t(n,e)}))}(t,n)}))}function _(e,t){if(t&&e)return C(e,(e=>function(e,t){const n=S(t,(t=>e.matches(t)));return N(n)?n.some((e=>e)):n}(t,e.selectors)))}function w(e){return{position:e.getPosition(),radius:e.getRadius(),mass:e.getMass(),velocity:e.velocity,factor:s.M.create((0,i._W)(e.options.bounce.horizontal),(0,i._W)(e.options.bounce.vertical))}}function k(e,t){const{x:n,y:s}=e.velocity.sub(t.velocity),[r,o]=[e.position,t.position],{dx:a,dy:l}=(0,i.vr)(o,r);if(n*a+s*l<0)return;const c=-Math.atan2(l,a),u=e.mass,d=t.mass,h=e.velocity.rotate(c),p=t.velocity.rotate(c),f=(0,i.OW)(h,p,u,d),m=(0,i.OW)(p,h,u,d),v=f.rotate(-c),g=m.rotate(-c);e.velocity.x=v.x*e.factor.x,e.velocity.y=v.y*e.factor.y,t.velocity.x=g.x*t.factor.x,t.velocity.y=g.y*t.factor.y}function x(e,t){const n=v(e.getPosition(),e.getRadius()),s=a({pSide:{min:n.left,max:n.right},pOtherSide:{min:n.top,max:n.bottom},rectSide:{min:t.left,max:t.right},rectOtherSide:{min:t.top,max:t.bottom},velocity:e.velocity.x,factor:(0,i._W)(e.options.bounce.horizontal)});s.bounced&&(void 0!==s.velocity&&(e.velocity.x=s.velocity),void 0!==s.position&&(e.position.x=s.position));const r=a({pSide:{min:n.top,max:n.bottom},pOtherSide:{min:n.left,max:n.right},rectSide:{min:t.top,max:t.bottom},rectOtherSide:{min:t.left,max:t.right},velocity:e.velocity.y,factor:(0,i._W)(e.options.bounce.vertical)});r.bounced&&(void 0!==r.velocity&&(e.velocity.y=r.velocity),void 0!==r.position&&(e.position.y=r.position))}function S(e,t){return N(e)?e.map(((e,n)=>t(e,n))):t(e,0)}function E(e,t,n){return N(e)?f(e,t,n):e}function C(e,t){return N(e)?e.find(((e,n)=>t(e,n))):t(e,0)?e:void 0}function T(e,t){const n=e.value,s=e.animation,r={delayTime:1e3*(0,i.VG)(s.delay),enable:s.enable,value:(0,i.VG)(e.value)*t,max:(0,i.W9)(n)*t,min:(0,i.Sg)(n)*t,loops:0,maxLoops:(0,i.VG)(s.count),time:0};if(s.enable){switch(r.decay=1-(0,i.VG)(s.decay),s.mode){case"increase":r.status="increasing";break;case"decrease":r.status="decreasing";break;case"random":r.status=(0,i.G0)()>=.5?"increasing":"decreasing"}const e="auto"===s.mode;switch(s.startValue){case"min":r.value=r.min,e&&(r.status="increasing");break;case"max":r.value=r.max,e&&(r.status="decreasing");break;default:r.value=(0,i.U4)(r),e&&(r.status=(0,i.G0)()>=.5?"increasing":"decreasing")}}return r.initialValue=r.value,r}function M(e,t){if(!("percent"===e.mode)){const{mode:t,...n}=e;return n}return"x"in e?{x:e.x/100*t.width,y:e.y/100*t.height}:{width:e.width/100*t.width,height:e.height/100*t.height}}function A(e,t){return M(e,t)}function I(e,t){return M(e,t)}function R(e){return"boolean"==typeof e}function O(e){return"string"==typeof e}function L(e){return"number"==typeof e}function P(e){return"function"==typeof e}function D(e){return"object"==typeof e&&null!==e}function N(e){return Array.isArray(e)}},3134:(e,t,n)=>{n.d(t,{$k:()=>Q});var i=n(3887),s=n(2529),r=n(1525),o=n(5118);function a(e,t,n){const i=t[n];void 0!==i&&(e[n]=(e[n]??1)*i)}class l{constructor(e){this.container=e,this._applyPostDrawUpdaters=e=>{for(const t of this._postDrawUpdaters)t.afterDraw&&t.afterDraw(e)},this._applyPreDrawUpdaters=(e,t,n,i,s,r)=>{for(const o of this._preDrawUpdaters){if(o.getColorStyles){const{fill:r,stroke:a}=o.getColorStyles(t,e,n,i);r&&(s.fill=r),a&&(s.stroke=a)}if(o.getTransformValues){const e=o.getTransformValues(t);for(const t in e)a(r,e,t)}o.beforeDraw&&o.beforeDraw(t)}},this._applyResizePlugins=()=>{for(const e of this._resizePlugins)e.resize&&e.resize()},this._getPluginParticleColors=e=>{let t,n;for(const i of this._colorPlugins)if(!t&&i.particleFillColor&&(t=(0,o.R5)(i.particleFillColor(e))),!n&&i.particleStrokeColor&&(n=(0,o.R5)(i.particleStrokeColor(e))),t&&n)break;return[t,n]},this._initCover=()=>{const e=this.container.actualOptions.backgroundMask.cover,t=e.color,n=(0,o.BN)(t);if(n){const t={...n,a:e.opacity};this._coverColorStyle=(0,o.xx)(t,t.a)}},this._initStyle=()=>{const e=this.element,t=this.container.actualOptions;if(e){this._fullScreen?(this._originalStyle=(0,s.zw)({},e.style),this._setFullScreenStyle()):this._resetOriginalStyle();for(const n in t.style){if(!n||!t.style)continue;const i=t.style[n];i&&e.style.setProperty(n,i,"important")}}},this._initTrail=async()=>{const e=this.container.actualOptions,t=e.particles.move.trail,n=t.fill;if(t.enable)if(n.color){const t=(0,o.BN)(n.color);if(!t)return;const i=e.particles.move.trail;this._trailFill={color:{...t},opacity:1/i.length}}else await new Promise(((e,i)=>{if(!n.image)return;const s=document.createElement("img");s.addEventListener("load",(()=>{this._trailFill={image:s,opacity:1/t.length},e()})),s.addEventListener("error",(e=>{i(e.error)})),s.src=n.image}))},this._paintBase=e=>{this.draw((t=>(0,r.Sn)(t,this.size,e)))},this._paintImage=(e,t)=>{this.draw((n=>(0,r.Md)(n,this.size,e,t)))},this._repairStyle=()=>{const e=this.element;e&&(this._safeMutationObserver((e=>e.disconnect())),this._initStyle(),this.initBackground(),this._safeMutationObserver((t=>t.observe(e,{attributes:!0}))))},this._resetOriginalStyle=()=>{const e=this.element,t=this._originalStyle;if(!e||!t)return;const n=e.style;n.position=t.position,n.zIndex=t.zIndex,n.top=t.top,n.left=t.left,n.width=t.width,n.height=t.height},this._safeMutationObserver=e=>{this._mutationObserver&&e(this._mutationObserver)},this._setFullScreenStyle=()=>{const e=this.element;if(!e)return;const t="important",n=e.style;n.setProperty("position","fixed",t),n.setProperty("z-index",this.container.actualOptions.fullScreen.zIndex.toString(10),t),n.setProperty("top","0",t),n.setProperty("left","0",t),n.setProperty("width","100%",t),n.setProperty("height","100%",t)},this.size={height:0,width:0},this._context=null,this._generated=!1,this._preDrawUpdaters=[],this._postDrawUpdaters=[],this._resizePlugins=[],this._colorPlugins=[]}get _fullScreen(){return this.container.actualOptions.fullScreen.enable}clear(){const e=this.container.actualOptions,t=e.particles.move.trail,n=this._trailFill;e.backgroundMask.enable?this.paint():t.enable&&t.length>0&&n?n.color?this._paintBase((0,o.xx)(n.color,n.opacity)):n.image&&this._paintImage(n.image,n.opacity):this.draw((e=>{(0,r.IU)(e,this.size)}))}destroy(){if(this.stop(),this._generated){const e=this.element;e&&e.remove()}else this._resetOriginalStyle();this._preDrawUpdaters=[],this._postDrawUpdaters=[],this._resizePlugins=[],this._colorPlugins=[]}draw(e){const t=this._context;if(t)return e(t)}drawParticle(e,t){if(e.spawning||e.destroyed)return;const n=e.getRadius();if(n<=0)return;const i=e.getFillColor(),s=e.getStrokeColor()??i;let[a,l]=this._getPluginParticleColors(e);a||(a=i),l||(l=s),(a||l)&&this.draw((i=>{const s=this.container,c=s.actualOptions,u=e.options.zIndex,d=(1-e.zIndexFactor)**u.opacityRate,h=e.bubble.opacity??e.opacity?.value??1,p=h*d,f=(e.strokeOpacity??h)*d,m={},v={fill:a?(0,o.LC)(a,p):void 0};v.stroke=l?(0,o.LC)(l,f):v.fill,this._applyPreDrawUpdaters(i,e,n,p,v,m),(0,r.p0)({container:s,context:i,particle:e,delta:t,colorStyles:v,backgroundMask:c.backgroundMask.enable,composite:c.backgroundMask.composite,radius:n*(1-e.zIndexFactor)**u.sizeRate,opacity:p,shadow:e.options.shadow,transform:m}),this._applyPostDrawUpdaters(e)}))}drawParticlePlugin(e,t,n){this.draw((i=>(0,r.Wb)(i,e,t,n)))}drawPlugin(e,t){this.draw((n=>(0,r.e_)(n,e,t)))}async init(){this._safeMutationObserver((e=>e.disconnect())),this._mutationObserver=(0,s.tG)((e=>{for(const t of e)"attributes"===t.type&&"style"===t.attributeName&&this._repairStyle()})),this.resize(),this._initStyle(),this._initCover();try{await this._initTrail()}catch(e){(0,s.tZ)().error(e)}this.initBackground(),this._safeMutationObserver((e=>{this.element&&e.observe(this.element,{attributes:!0})})),this.initUpdaters(),this.initPlugins(),this.paint()}initBackground(){const e=this.container.actualOptions.background,t=this.element;if(!t)return;const n=t.style;if(n){if(e.color){const t=(0,o.BN)(e.color);n.backgroundColor=t?(0,o.xx)(t,e.opacity):""}else n.backgroundColor="";n.backgroundImage=e.image||"",n.backgroundPosition=e.position||"",n.backgroundRepeat=e.repeat||"",n.backgroundSize=e.size||""}}initPlugins(){this._resizePlugins=[];for(const[,e]of this.container.plugins)e.resize&&this._resizePlugins.push(e),(e.particleFillColor||e.particleStrokeColor)&&this._colorPlugins.push(e)}initUpdaters(){this._preDrawUpdaters=[],this._postDrawUpdaters=[];for(const e of this.container.particles.updaters)e.afterDraw&&this._postDrawUpdaters.push(e),(e.getColorStyles||e.getTransformValues||e.beforeDraw)&&this._preDrawUpdaters.push(e)}loadCanvas(e){this._generated&&this.element&&this.element.remove(),this._generated=e.dataset&&i.eb in e.dataset?"true"===e.dataset[i.eb]:this._generated,this.element=e,this.element.ariaHidden="true",this._originalStyle=(0,s.zw)({},this.element.style),this.size.height=e.offsetHeight,this.size.width=e.offsetWidth,this._context=this.element.getContext("2d"),this._safeMutationObserver((e=>{this.element&&e.observe(this.element,{attributes:!0})})),this.container.retina.init(),this.initBackground()}paint(){const e=this.container.actualOptions;this.draw((t=>{e.backgroundMask.enable&&e.backgroundMask.cover?((0,r.IU)(t,this.size),this._paintBase(this._coverColorStyle)):this._paintBase()}))}resize(){if(!this.element)return!1;const e=this.container,t=e.retina.pixelRatio,n=e.canvas.size,i=this.element.offsetWidth*t,s=this.element.offsetHeight*t;if(s===n.height&&i===n.width&&s===this.element.height&&i===this.element.width)return!1;const r={...n};return this.element.width=n.width=this.element.offsetWidth*t,this.element.height=n.height=this.element.offsetHeight*t,this.container.started&&(this.resizeFactor={width:n.width/r.width,height:n.height/r.height}),!0}stop(){this._safeMutationObserver((e=>e.disconnect())),this._mutationObserver=void 0,this.draw((e=>(0,r.IU)(e,this.size)))}async windowResize(){if(!this.element||!this.resize())return;const e=this.container,t=e.updateActualOptions();e.particles.setDensity(),this._applyResizePlugins(),t&&await e.refresh()}}function c(e,t,n,i,r){if(i){let i={passive:!0};(0,s.Lm)(r)?i.capture=r:void 0!==r&&(i=r),e.addEventListener(t,n,i)}else{const i=r;e.removeEventListener(t,n,i)}}class u{constructor(e){this.container=e,this._doMouseTouchClick=e=>{const t=this.container,n=t.actualOptions;if(this._canPush){const e=t.interactivity.mouse,i=e.position;if(!i)return;e.clickPosition={...i},e.clickTime=(new Date).getTime();const r=n.interactivity.events.onClick;(0,s.wJ)(r.mode,(e=>this.container.handleClickMode(e)))}"touchend"===e.type&&setTimeout((()=>this._mouseTouchFinish()),500)},this._handleThemeChange=e=>{const t=e,n=this.container,i=n.options,s=i.defaultThemes,r=t.matches?s.dark:s.light,o=i.themes.find((e=>e.name===r));o&&o.default.auto&&n.loadTheme(r)},this._handleVisibilityChange=()=>{const e=this.container,t=e.actualOptions;this._mouseTouchFinish(),t.pauseOnBlur&&(document&&document.hidden?(e.pageHidden=!0,e.pause()):(e.pageHidden=!1,e.getAnimationStatus()?e.play(!0):e.draw(!0)))},this._handleWindowResize=async()=>{this._resizeTimeout&&(clearTimeout(this._resizeTimeout),delete this._resizeTimeout),this._resizeTimeout=setTimeout((async()=>{const e=this.container.canvas;e&&await e.windowResize()}),1e3*this.container.actualOptions.interactivity.events.resize.delay)},this._manageInteractivityListeners=(e,t)=>{const n=this._handlers,s=this.container,r=s.actualOptions,o=s.interactivity.element;if(!o)return;const a=o,l=s.canvas.element;l&&(l.style.pointerEvents=a===l?"initial":"none"),(r.interactivity.events.onHover.enable||r.interactivity.events.onClick.enable)&&(c(o,i.Rb,n.mouseMove,t),c(o,i.s7,n.touchStart,t),c(o,i.DG,n.touchMove,t),r.interactivity.events.onClick.enable?(c(o,i.Bp,n.touchEndClick,t),c(o,i.vo,n.mouseUp,t),c(o,i.ms,n.mouseDown,t)):c(o,i.Bp,n.touchEnd,t),c(o,e,n.mouseLeave,t),c(o,i.G3,n.touchCancel,t))},this._manageListeners=e=>{const t=this._handlers,n=this.container,s=n.actualOptions.interactivity.detectsOn,r=n.canvas.element;let o=i.Z0;"window"===s?(n.interactivity.element=window,o=i.sf):n.interactivity.element="parent"===s&&r?r.parentElement??r.parentNode:r,this._manageMediaMatch(e),this._manageResize(e),this._manageInteractivityListeners(o,e),document&&c(document,i.nK,t.visibilityChange,e,!1)},this._manageMediaMatch=e=>{const t=this._handlers,n=(0,s.lV)("(prefers-color-scheme: dark)");n&&(void 0===n.addEventListener?void 0!==n.addListener&&(e?n.addListener(t.oldThemeChange):n.removeListener(t.oldThemeChange)):c(n,"change",t.themeChange,e))},this._manageResize=e=>{const t=this._handlers,n=this.container;if(!n.actualOptions.interactivity.events.resize)return;if("undefined"==typeof ResizeObserver)return void c(window,i.NF,t.resize,e);const s=n.canvas.element;this._resizeObserver&&!e?(s&&this._resizeObserver.unobserve(s),this._resizeObserver.disconnect(),delete this._resizeObserver):!this._resizeObserver&&e&&s&&(this._resizeObserver=new ResizeObserver((async e=>{e.find((e=>e.target===s))&&await this._handleWindowResize()})),this._resizeObserver.observe(s))},this._mouseDown=()=>{const{interactivity:e}=this.container;if(!e)return;const{mouse:t}=e;t.clicking=!0,t.downPosition=t.position},this._mouseTouchClick=e=>{const t=this.container,n=t.actualOptions,{mouse:i}=t.interactivity;i.inside=!0;let s=!1;const r=i.position;if(r&&n.interactivity.events.onClick.enable){for(const[,e]of t.plugins)if(e.clickPositionValid&&(s=e.clickPositionValid(r),s))break;s||this._doMouseTouchClick(e),i.clicking=!1}},this._mouseTouchFinish=()=>{const e=this.container.interactivity;if(!e)return;const t=e.mouse;delete t.position,delete t.clickPosition,delete t.downPosition,e.status=i.Z0,t.inside=!1,t.clicking=!1},this._mouseTouchMove=e=>{const t=this.container,n=t.actualOptions,s=t.interactivity,r=t.canvas.element;if(!s||!s.element)return;let o;if(s.mouse.inside=!0,e.type.startsWith("pointer")){this._canPush=!0;const t=e;if(s.element===window){if(r){const e=r.getBoundingClientRect();o={x:t.clientX-e.left,y:t.clientY-e.top}}}else if("parent"===n.interactivity.detectsOn){const e=t.target,n=t.currentTarget;if(e&&n&&r){const i=e.getBoundingClientRect(),s=n.getBoundingClientRect(),a=r.getBoundingClientRect();o={x:t.offsetX+2*i.left-(s.left+a.left),y:t.offsetY+2*i.top-(s.top+a.top)}}else o={x:t.offsetX??t.clientX,y:t.offsetY??t.clientY}}else t.target===r&&(o={x:t.offsetX??t.clientX,y:t.offsetY??t.clientY})}else if(this._canPush="touchmove"!==e.type,r){const t=e,n=t.touches[t.touches.length-1],i=r.getBoundingClientRect();o={x:n.clientX-(i.left??0),y:n.clientY-(i.top??0)}}const a=t.retina.pixelRatio;o&&(o.x*=a,o.y*=a),s.mouse.position=o,s.status=i.Rb},this._touchEnd=e=>{const t=e,n=Array.from(t.changedTouches);for(const i of n)this._touches.delete(i.identifier);this._mouseTouchFinish()},this._touchEndClick=e=>{const t=e,n=Array.from(t.changedTouches);for(const i of n)this._touches.delete(i.identifier);this._mouseTouchClick(e)},this._touchStart=e=>{const t=e,n=Array.from(t.changedTouches);for(const i of n)this._touches.set(i.identifier,performance.now());this._mouseTouchMove(e)},this._canPush=!0,this._touches=new Map,this._handlers={mouseDown:()=>this._mouseDown(),mouseLeave:()=>this._mouseTouchFinish(),mouseMove:e=>this._mouseTouchMove(e),mouseUp:e=>this._mouseTouchClick(e),touchStart:e=>this._touchStart(e),touchMove:e=>this._mouseTouchMove(e),touchEnd:e=>this._touchEnd(e),touchCancel:e=>this._touchEnd(e),touchEndClick:e=>this._touchEndClick(e),visibilityChange:()=>this._handleVisibilityChange(),themeChange:e=>this._handleThemeChange(e),oldThemeChange:e=>this._handleThemeChange(e),resize:()=>{this._handleWindowResize()}}}addListeners(){this._manageListeners(!0)}removeListeners(){this._manageListeners(!1)}}var d=n(2300);class h{constructor(){this.color=new d.O,this.color.value="",this.image="",this.position="",this.repeat="",this.size="",this.opacity=1}load(e){e&&(void 0!==e.color&&(this.color=d.O.create(this.color,e.color)),void 0!==e.image&&(this.image=e.image),void 0!==e.position&&(this.position=e.position),void 0!==e.repeat&&(this.repeat=e.repeat),void 0!==e.size&&(this.size=e.size),void 0!==e.opacity&&(this.opacity=e.opacity))}}class p{constructor(){this.color=new d.O,this.color.value="#fff",this.opacity=1}load(e){e&&(void 0!==e.color&&(this.color=d.O.create(this.color,e.color)),void 0!==e.opacity&&(this.opacity=e.opacity))}}class f{constructor(){this.composite="destination-out",this.cover=new p,this.enable=!1}load(e){if(e){if(void 0!==e.composite&&(this.composite=e.composite),void 0!==e.cover){const t=e.cover,n=(0,s.Kg)(e.cover)?{color:e.cover}:e.cover;this.cover.load(void 0!==t.color?t:{color:n})}void 0!==e.enable&&(this.enable=e.enable)}}}class m{constructor(){this.enable=!0,this.zIndex=0}load(e){e&&(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.zIndex&&(this.zIndex=e.zIndex))}}class v{constructor(){this.enable=!1,this.mode=[]}load(e){e&&(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.mode&&(this.mode=e.mode))}}class g{constructor(){this.selectors=[],this.enable=!1,this.mode=[],this.type="circle"}get el(){return this.elementId}set el(e){this.elementId=e}get elementId(){return this.ids}set elementId(e){this.ids=e}get ids(){return(0,s.wJ)(this.selectors,(e=>e.replace("#","")))}set ids(e){this.selectors=(0,s.wJ)(e,(e=>`#${e}`))}load(e){if(!e)return;const t=e.ids??e.elementId??e.el;void 0!==t&&(this.ids=t),void 0!==e.selectors&&(this.selectors=e.selectors),void 0!==e.enable&&(this.enable=e.enable),void 0!==e.mode&&(this.mode=e.mode),void 0!==e.type&&(this.type=e.type)}}class y{constructor(){this.enable=!1,this.force=2,this.smooth=10}load(e){e&&(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.force&&(this.force=e.force),void 0!==e.smooth&&(this.smooth=e.smooth))}}class b{constructor(){this.enable=!1,this.mode=[],this.parallax=new y}load(e){e&&(void 0!==e.enable&&(this.enable=e.enable),void 0!==e.mode&&(this.mode=e.mode),this.parallax.load(e.parallax))}}class _{constructor(){this.delay=.5,this.enable=!0}load(e){void 0!==e&&(void 0!==e.delay&&(this.delay=e.delay),void 0!==e.enable&&(this.enable=e.enable))}}class w{constructor(){this.onClick=new v,this.onDiv=new g,this.onHover=new b,this.resize=new _}get onclick(){return this.onClick}set onclick(e){this.onClick=e}get ondiv(){return this.onDiv}set ondiv(e){this.onDiv=e}get onhover(){return this.onHover}set onhover(e){this.onHover=e}load(e){if(!e)return;this.onClick.load(e.onClick??e.onclick);const t=e.onDiv??e.ondiv;void 0!==t&&(this.onDiv=(0,s.wJ)(t,(e=>{const t=new g;return t.load(e),t}))),this.onHover.load(e.onHover??e.onhover),(0,s.Lm)(e.resize)?this.resize.enable=e.resize:this.resize.load(e.resize)}}class k{constructor(e,t){this._engine=e,this._container=t}load(e){if(!e)return;if(!this._container)return;const t=this._engine.plugins.interactors.get(this._container);if(t)for(const n of t)n.loadModeOptions&&n.loadModeOptions(this,e)}}class x{constructor(e,t){this.detectsOn="window",this.events=new w,this.modes=new k(e,t)}get detect_on(){return this.detectsOn}set detect_on(e){this.detectsOn=e}load(e){if(!e)return;const t=e.detectsOn??e.detect_on;void 0!==t&&(this.detectsOn=t),this.events.load(e.events),this.modes.load(e.modes)}}class S{load(e){e&&(e.position&&(this.position={x:e.position.x??50,y:e.position.y??50,mode:e.position.mode??"percent"}),e.options&&(this.options=(0,s.zw)({},e.options)))}}class E{constructor(){this.maxWidth=1/0,this.options={},this.mode="canvas"}load(e){e&&(void 0!==e.maxWidth&&(this.maxWidth=e.maxWidth),void 0!==e.mode&&("screen"===e.mode?this.mode="screen":this.mode="canvas"),void 0!==e.options&&(this.options=(0,s.zw)({},e.options)))}}class C{constructor(){this.auto=!1,this.mode="any",this.value=!1}load(e){e&&(void 0!==e.auto&&(this.auto=e.auto),void 0!==e.mode&&(this.mode=e.mode),void 0!==e.value&&(this.value=e.value))}}class T{constructor(){this.name="",this.default=new C}load(e){e&&(void 0!==e.name&&(this.name=e.name),this.default.load(e.default),void 0!==e.options&&(this.options=(0,s.zw)({},e.options)))}}var M=n(2935),A=n(5190);class I{constructor(e,t){this._findDefaultTheme=e=>this.themes.find((t=>t.default.value&&t.default.mode===e))??this.themes.find((e=>e.default.value&&"any"===e.default.mode)),this._importPreset=e=>{this.load(this._engine.plugins.getPreset(e))},this._engine=e,this._container=t,this.autoPlay=!0,this.background=new h,this.backgroundMask=new f,this.defaultThemes={},this.delay=0,this.fullScreen=new m,this.detectRetina=!0,this.duration=0,this.fpsLimit=120,this.interactivity=new x(e,t),this.manualParticles=[],this.particles=(0,M.y)(this._engine,this._container),this.pauseOnBlur=!0,this.pauseOnOutsideViewport=!0,this.responsive=[],this.smooth=!1,this.style={},this.themes=[],this.zLayers=100}get backgroundMode(){return this.fullScreen}set backgroundMode(e){this.fullScreen.load(e)}get fps_limit(){return this.fpsLimit}set fps_limit(e){this.fpsLimit=e}get retina_detect(){return this.detectRetina}set retina_detect(e){this.detectRetina=e}load(e){if(!e)return;void 0!==e.preset&&(0,s.wJ)(e.preset,(e=>this._importPreset(e))),void 0!==e.autoPlay&&(this.autoPlay=e.autoPlay),void 0!==e.delay&&(this.delay=(0,A.DT)(e.delay));const t=e.detectRetina??e.retina_detect;void 0!==t&&(this.detectRetina=t),void 0!==e.duration&&(this.duration=(0,A.DT)(e.duration));const n=e.fpsLimit??e.fps_limit;void 0!==n&&(this.fpsLimit=n),void 0!==e.pauseOnBlur&&(this.pauseOnBlur=e.pauseOnBlur),void 0!==e.pauseOnOutsideViewport&&(this.pauseOnOutsideViewport=e.pauseOnOutsideViewport),void 0!==e.zLayers&&(this.zLayers=e.zLayers),this.background.load(e.background);const i=e.fullScreen??e.backgroundMode;(0,s.Lm)(i)?this.fullScreen.enable=i:this.fullScreen.load(i),this.backgroundMask.load(e.backgroundMask),this.interactivity.load(e.interactivity),e.manualParticles&&(this.manualParticles=e.manualParticles.map((e=>{const t=new S;return t.load(e),t}))),this.particles.load(e.particles),this.style=(0,s.zw)(this.style,e.style),this._engine.plugins.loadOptions(this,e),void 0!==e.smooth&&(this.smooth=e.smooth);const r=this._engine.plugins.interactors.get(this._container);if(r)for(const s of r)s.loadOptions&&s.loadOptions(this,e);if(void 0!==e.responsive)for(const s of e.responsive){const e=new E;e.load(s),this.responsive.push(e)}if(this.responsive.sort(((e,t)=>e.maxWidth-t.maxWidth)),void 0!==e.themes)for(const s of e.themes){const e=this.themes.find((e=>e.name===s.name));if(e)e.load(s);else{const e=new T;e.load(s),this.themes.push(e)}}this.defaultThemes.dark=this._findDefaultTheme("dark")?.name,this.defaultThemes.light=this._findDefaultTheme("light")?.name}setResponsive(e,t,n){this.load(n);const i=this.responsive.find((n=>"screen"===n.mode&&screen?n.maxWidth>screen.availWidth:n.maxWidth*t>e));return this.load(i?.options),i?.maxWidth}setTheme(e){if(e){const t=this.themes.find((t=>t.name===e));t&&this.load(t.options)}else{const e=(0,s.lV)("(prefers-color-scheme: dark)"),t=e&&e.matches,n=this._findDefaultTheme(t?"dark":"light");n&&this.load(n.options)}}}class R{constructor(e,t){this.container=t,this._engine=e,this._interactors=e.plugins.getInteractors(this.container,!0),this._externalInteractors=[],this._particleInteractors=[]}async externalInteract(e){for(const t of this._externalInteractors)t.isEnabled()&&await t.interact(e)}handleClickMode(e){for(const t of this._externalInteractors)t.handleClickMode&&t.handleClickMode(e)}init(){this._externalInteractors=[],this._particleInteractors=[];for(const e of this._interactors){switch(e.type){case"external":this._externalInteractors.push(e);break;case"particles":this._particleInteractors.push(e)}e.init()}}async particlesInteract(e,t){for(const n of this._externalInteractors)n.clear(e,t);for(const n of this._particleInteractors)n.isEnabled(e)&&await n.interact(e,t)}async reset(e){for(const t of this._externalInteractors)t.isEnabled()&&t.reset(e);for(const t of this._particleInteractors)t.isEnabled(e)&&t.reset(e)}}var O=n(7883),L=n(7328);const P=e=>{if(!(0,s.hn)(e.outMode,e.checkModes))return;const t=2*e.radius;e.coord>e.maxCoord-t?e.setCb(-e.radius):e.coord<t&&e.setCb(e.radius)};class D{constructor(e,t,n,o,a,l){this.container=n,this._calcPosition=(e,t,n,i=0)=>{for(const[,d]of e.plugins){const e=void 0!==d.particlePosition?d.particlePosition(t,this):void 0;if(e)return L.p.create(e.x,e.y,n)}const s=e.canvas.size,r=(0,A.Nx)({size:s,position:t}),o=L.p.create(r.x,r.y,n),a=this.getRadius(),l=this.options.move.outModes,c=t=>{P({outMode:t,checkModes:["bounce","bounce-horizontal"],coord:o.x,maxCoord:e.canvas.size.width,setCb:e=>o.x+=e,radius:a})},u=t=>{P({outMode:t,checkModes:["bounce","bounce-vertical"],coord:o.y,maxCoord:e.canvas.size.height,setCb:e=>o.y+=e,radius:a})};return c(l.left??l.default),c(l.right??l.default),u(l.top??l.default),u(l.bottom??l.default),this._checkOverlap(o,i)?this._calcPosition(e,void 0,n,i+1):o},this._calculateVelocity=()=>{const e=(0,A.$m)(this.direction).copy(),t=this.options.move;if("inside"===t.direction||"outside"===t.direction)return e;const n=Math.PI/180*(0,A.VG)(t.angle.value),i=Math.PI/180*(0,A.VG)(t.angle.offset),s={left:i-n/2,right:i+n/2};return t.straight||(e.angle+=(0,A.U4)((0,A.DT)(s.left,s.right))),t.random&&"number"==typeof t.speed&&(e.length*=(0,A.G0)()),e},this._checkOverlap=(e,t=0)=>{const n=this.options.collisions,s=this.getRadius();if(!n.enable)return!1;const r=n.overlap;if(r.enable)return!1;const o=r.retries;if(o>=0&&t>o)throw new Error(`${i.dI} particle is overlapping and can't be placed`);return!!this.container.particles.find((t=>(0,A.Yf)(e,t.position)<s+t.getRadius()))},this._getRollColor=e=>{if(!e||!this.roll||!this.backColor&&!this.roll.alter)return e;const t=this.roll.horizontal&&this.roll.vertical?2:1,n=this.roll.horizontal?Math.PI/2:0;return Math.floor(((this.roll.angle??0)+n)/(Math.PI/t))%2?this.backColor?this.backColor:this.roll.alter?(0,r.yx)(e,this.roll.alter.type,this.roll.alter.value):e:e},this._initPosition=e=>{const t=this.container,n=(0,A.VG)(this.options.zIndex.value);this.position=this._calcPosition(t,e,(0,A.qE)(n,0,t.zLayers)),this.initialPosition=this.position.copy();const i=t.canvas.size;switch(this.moveCenter={...(0,s.E9)(this.options.move.center,i),radius:this.options.move.center.radius??0,mode:this.options.move.center.mode??"percent"},this.direction=(0,A.JY)(this.options.move.direction,this.position,this.moveCenter),this.options.move.direction){case"inside":this.outType="inside";break;case"outside":this.outType="outside"}this.offset=O.M.origin},this._loadShapeData=(e,t)=>{const n=e.options[this.shape];if(n)return(0,s.zw)({close:e.close,fill:e.fill},(0,s.TA)(n,this.id,t))},this._engine=e,this.init(t,o,a,l)}destroy(e){if(this.unbreakable||this.destroyed)return;this.destroyed=!0,this.bubble.inRange=!1,this.slow.inRange=!1;const t=this.container,n=this.pathGenerator;for(const[,i]of t.plugins)i.particleDestroyed&&i.particleDestroyed(this,e);for(const i of t.particles.updaters)i.particleDestroyed&&i.particleDestroyed(this,e);n&&n.reset(this)}draw(e){const t=this.container;for(const[,n]of t.plugins)t.canvas.drawParticlePlugin(n,this,e);t.canvas.drawParticle(this,e)}getFillColor(){return this._getRollColor(this.bubble.color??(0,o.O_)(this.color))}getMass(){return this.getRadius()**2*Math.PI/2}getPosition(){return{x:this.position.x+this.offset.x,y:this.position.y+this.offset.y,z:this.position.z}}getRadius(){return this.bubble.radius??this.size.value}getStrokeColor(){return this._getRollColor(this.bubble.color??(0,o.O_)(this.strokeColor))}init(e,t,n,i){const r=this.container,a=this._engine;this.id=e,this.group=i,this.fill=!0,this.pathRotation=!1,this.close=!0,this.lastPathTime=0,this.destroyed=!1,this.unbreakable=!1,this.rotation=0,this.misplaced=!1,this.retina={maxDistance:{}},this.outType="normal",this.ignoresResizeRatio=!0;const l=r.retina.pixelRatio,c=r.actualOptions,u=(0,M.y)(this._engine,r,c.particles),d=u.shape.type,{reduceDuplicates:h}=u;this.shape=(0,s.TA)(d,this.id,h);const p=u.shape;if(n&&n.shape&&n.shape.type){const e=n.shape.type,t=(0,s.TA)(e,this.id,h);t&&(this.shape=t,p.load(n.shape))}this.shapeData=this._loadShapeData(p,h),u.load(n);const f=this.shapeData;f&&u.load(f.particles);const m=new x(a,r);m.load(r.actualOptions.interactivity),m.load(u.interactivity),this.interactivity=m,this.fill=f?.fill??u.shape.fill,this.close=f?.close??u.shape.close,this.options=u;const v=this.options.move.path;this.pathDelay=1e3*(0,A._W)(v.delay),v.generator&&(this.pathGenerator=this._engine.plugins.getPathGenerator(v.generator),this.pathGenerator&&r.addPath(v.generator,this.pathGenerator)&&this.pathGenerator.init(r)),r.retina.initParticle(this),this.size=(0,s.Xs)(this.options.size,l),this.bubble={inRange:!1},this.slow={inRange:!1,factor:1},this._initPosition(t),this.initialVelocity=this._calculateVelocity(),this.velocity=this.initialVelocity.copy(),this.moveDecay=1-(0,A.VG)(this.options.move.decay);const g=r.particles;g.needsSort=g.needsSort||g.lastZIndex<this.position.z,g.lastZIndex=this.position.z,this.zIndexFactor=this.position.z/r.zLayers,this.sides=24;let y=r.drawers.get(this.shape);y||(y=this._engine.plugins.getShapeDrawer(this.shape),y&&r.drawers.set(this.shape,y)),y&&y.loadShape&&y.loadShape(this);const b=y?.getSidesCount;b&&(this.sides=b(this)),this.spawning=!1,this.shadowColor=(0,o.BN)(this.options.shadow.color);for(const s of r.particles.updaters)s.init(this);for(const s of r.particles.movers)s.init&&s.init(this);y&&y.particleInit&&y.particleInit(r,this);for(const[,s]of r.plugins)s.particleCreated&&s.particleCreated(this)}isInsideCanvas(){const e=this.getRadius(),t=this.container.canvas.size,n=this.position;return n.x>=-e&&n.y>=-e&&n.y<=t.height+e&&n.x<=t.width+e}isVisible(){return!this.destroyed&&!this.spawning&&this.isInsideCanvas()}reset(){for(const e of this.container.particles.updaters)e.reset&&e.reset(this)}}class N{constructor(e,t){this.position=e,this.particle=t}}var z=n(1724),B=n(963);class F{constructor(e,t){this.rectangle=e,this.capacity=t,this._subdivide=()=>{const{x:e,y:t}=this.rectangle.position,{width:n,height:i}=this.rectangle.size,{capacity:s}=this;for(let r=0;r<4;r++)this._subs.push(new F(new B.M(e+n/2*(r%2),t+i/2*(Math.round(r/2)-r%2),n/2,i/2),s));this._divided=!0},this._points=[],this._divided=!1,this._subs=[]}insert(e){return!!this.rectangle.contains(e.position)&&(this._points.length<this.capacity?(this._points.push(e),!0):(this._divided||this._subdivide(),this._subs.some((t=>t.insert(e)))))}query(e,t,n){const i=n||[];if(!e.intersects(this.rectangle))return[];for(const s of this._points)!e.contains(s.position)&&(0,A.Yf)(e.position,s.position)>s.particle.getRadius()&&(!t||t(s.particle))||i.push(s.particle);if(this._divided)for(const s of this._subs)s.query(e,t,i);return i}queryCircle(e,t,n){return this.query(new z.j(e.x,e.y,t),n)}queryRectangle(e,t,n){return this.query(new B.M(e.x,e.y,t.width,t.height),n)}}const U=e=>new B.M(-e.width/4,-e.height/4,3*e.width/2,3*e.height/2);class j{constructor(e,t){this._applyDensity=(e,t,n)=>{if(!e.number.density?.enable)return;const i=e.number,s=this._initDensityFactor(i.density),r=i.value,o=i.limit>0?i.limit:r,a=Math.min(r,o)*s+t,l=Math.min(this.count,this.filter((e=>e.group===n)).length);this.limit=i.limit*s,l<a?this.push(Math.abs(a-l),void 0,e,n):l>a&&this.removeQuantity(l-a,n)},this._initDensityFactor=e=>{const t=this._container;if(!t.canvas.element||!e.enable)return 1;const n=t.canvas.element,i=t.retina.pixelRatio;return n.width*n.height/(e.factor*i**2*e.area)},this._pushParticle=(e,t,n,r)=>{try{let i=this.pool.pop();i?i.init(this._nextId,e,t,n):i=new D(this._engine,this._nextId,this._container,e,t,n);let s=!0;if(r&&(s=r(i)),!s)return;return this._array.push(i),this._zArray.push(i),this._nextId++,this._engine.dispatchEvent("particleAdded",{container:this._container,data:{particle:i}}),i}catch(o){return void(0,s.tZ)().warning(`${i.dI} adding particle: ${o}`)}},this._removeParticle=(e,t,n)=>{const i=this._array[e];if(!i||i.group!==t)return!1;i.destroy(n);const s=this._zArray.indexOf(i);return this._array.splice(e,1),this._zArray.splice(s,1),this.pool.push(i),this._engine.dispatchEvent("particleRemoved",{container:this._container,data:{particle:i}}),!0},this._engine=e,this._container=t,this._nextId=0,this._array=[],this._zArray=[],this.pool=[],this.limit=0,this.needsSort=!1,this.lastZIndex=0,this._interactionManager=new R(e,t);const n=t.canvas.size;this.quadTree=new F(U(n),4),this.movers=this._engine.plugins.getMovers(t,!0),this.updaters=this._engine.plugins.getUpdaters(t,!0)}get count(){return this._array.length}addManualParticles(){const e=this._container,t=e.actualOptions;for(const n of t.manualParticles)this.addParticle(n.position?(0,s.E9)(n.position,e.canvas.size):void 0,n.options)}addParticle(e,t,n,i){const s=this._container.actualOptions.particles.number.limit;if(s>0){const e=this.count+1-s;e>0&&this.removeQuantity(e)}return this._pushParticle(e,t,n,i)}clear(){this._array=[],this._zArray=[]}destroy(){this._array=[],this._zArray=[],this.movers=[],this.updaters=[]}async draw(e){const t=this._container;t.canvas.clear(),await this.update(e);for(const[,n]of t.plugins)t.canvas.drawPlugin(n,e);for(const n of this._zArray)n.draw(e)}filter(e){return this._array.filter(e)}find(e){return this._array.find(e)}handleClickMode(e){this._interactionManager.handleClickMode(e)}init(){const e=this._container,t=e.actualOptions;this.lastZIndex=0,this.needsSort=!1;let n=!1;this.updaters=this._engine.plugins.getUpdaters(e,!0),this._interactionManager.init();for(const[,i]of e.plugins)if(void 0!==i.particlesInitialization&&(n=i.particlesInitialization()),n)break;this._interactionManager.init();for(const[,i]of e.pathGenerators)i.init(e);if(this.addManualParticles(),!n){for(const e in t.particles.groups){const n=t.particles.groups[e];for(let i=this.count,s=0;s<n.number?.value&&i<t.particles.number.value;i++,s++)this.addParticle(void 0,n,e)}for(let e=this.count;e<t.particles.number.value;e++)this.addParticle()}}push(e,t,n,i){this.pushing=!0;for(let s=0;s<e;s++)this.addParticle(t?.position,n,i);this.pushing=!1}async redraw(){this.clear(),this.init(),await this.draw({value:0,factor:0})}remove(e,t,n){this.removeAt(this._array.indexOf(e),void 0,t,n)}removeAt(e,t=1,n,i){if(e<0||e>this.count)return;let s=0;for(let r=e;s<t&&r<this.count;r++)this._removeParticle(r--,n,i)&&s++}removeQuantity(e,t){this.removeAt(0,e,t)}setDensity(){const e=this._container.actualOptions,t=e.particles.groups;for(const n in t)this._applyDensity(t[n],0,n);this._applyDensity(e.particles,e.manualParticles.length)}async update(e){const t=this._container,n=new Set;this.quadTree=new F(U(t.canvas.size),4);for(const[,i]of t.pathGenerators)i.update();for(const[,i]of t.plugins)i.update&&i.update(e);for(const i of this._array){const s=t.canvas.resizeFactor;s&&!i.ignoresResizeRatio&&(i.position.x*=s.width,i.position.y*=s.height,i.initialPosition.x*=s.width,i.initialPosition.y*=s.height),i.ignoresResizeRatio=!1,await this._interactionManager.reset(i);for(const[,t]of this._container.plugins){if(i.destroyed)break;t.particleUpdate&&t.particleUpdate(i,e)}for(const t of this.movers)t.isEnabled(i)&&t.move(i,e);i.destroyed?n.add(i):this.quadTree.insert(new N(i.getPosition(),i))}if(n.size){const e=e=>!n.has(e);this._array=this.filter(e),this._zArray=this._zArray.filter(e),this.pool.push(...n)}await this._interactionManager.externalInteract(e);for(const i of this._array){for(const t of this.updaters)t.update(i,e);i.destroyed||i.spawning||await this._interactionManager.particlesInteract(i,e)}if(delete t.canvas.resizeFactor,this.needsSort){const e=this._zArray;e.sort(((e,t)=>t.position.z-e.position.z||e.id-t.id)),this.lastZIndex=e[e.length-1].position.z,this.needsSort=!1}}}class q{constructor(e){this.container=e,this.pixelRatio=1,this.reduceFactor=1}init(){const e=this.container,t=e.actualOptions;this.pixelRatio=!t.detectRetina||(0,s.B9)()?1:window.devicePixelRatio,this.reduceFactor=1;const n=this.pixelRatio;if(e.canvas.element){const t=e.canvas.element;e.canvas.size.width=t.offsetWidth*n,e.canvas.size.height=t.offsetHeight*n}const i=t.particles,r=i.move;this.attractDistance=(0,A.VG)(r.attract.distance)*n,this.maxSpeed=(0,A.VG)(r.gravity.maxSpeed)*n,this.sizeAnimationSpeed=(0,A.VG)(i.size.animation.speed)*n}initParticle(e){const t=e.options,n=this.pixelRatio,i=t.move,s=i.distance,r=e.retina;r.attractDistance=(0,A.VG)(i.attract.distance)*n,r.moveDrift=(0,A.VG)(i.drift)*n,r.moveSpeed=(0,A.VG)(i.speed)*n,r.sizeAnimationSpeed=(0,A.VG)(t.size.animation.speed)*n;const o=r.maxDistance;o.horizontal=void 0!==s.horizontal?s.horizontal*n:void 0,o.vertical=void 0!==s.vertical?s.vertical*n:void 0,r.maxSpeed=(0,A.VG)(i.gravity.maxSpeed)*n}}function V(e){return e&&!e.destroyed}function H(e,t,...n){const i=new I(e,t);return(0,M.Z)(i,...n),i}const G={generate:e=>e.velocity,init:()=>{},update:()=>{},reset:()=>{}};class W{constructor(e,t,n){this.id=t,this._intersectionManager=e=>{if(V(this)&&this.actualOptions.pauseOnOutsideViewport)for(const t of e)t.target===this.interactivity.element&&(t.isIntersecting?this.play:this.pause)()},this._nextFrame=async e=>{try{if(!this.smooth&&void 0!==this.lastFrameTime&&e<this.lastFrameTime+1e3/this.fpsLimit)return void this.draw(!1);this.lastFrameTime??=e;const t=function(e,t=60,n=!1){return{value:e,factor:n?60/t:60*e/1e3}}(e-this.lastFrameTime,this.fpsLimit,this.smooth);if(this.addLifeTime(t.value),this.lastFrameTime=e,t.value>1e3)return void this.draw(!1);if(await this.particles.draw(t),!this.alive())return void this.destroy();this.getAnimationStatus()&&this.draw(!1)}catch(t){(0,s.tZ)().error(`${i.dI} in animation loop`,t)}},this._engine=e,this.fpsLimit=120,this.smooth=!1,this._delay=0,this._duration=0,this._lifeTime=0,this._firstStart=!0,this.started=!1,this.destroyed=!1,this._paused=!0,this.lastFrameTime=0,this.zLayers=100,this.pageHidden=!1,this._sourceOptions=n,this._initialSourceOptions=n,this.retina=new q(this),this.canvas=new l(this),this.particles=new j(this._engine,this),this.pathGenerators=new Map,this.interactivity={mouse:{clicking:!1,inside:!1}},this.plugins=new Map,this.drawers=new Map,this._options=H(this._engine,this),this.actualOptions=H(this._engine,this),this._eventListeners=new u(this),"undefined"!=typeof IntersectionObserver&&IntersectionObserver&&(this._intersectionObserver=new IntersectionObserver((e=>this._intersectionManager(e)))),this._engine.dispatchEvent("containerBuilt",{container:this})}get options(){return this._options}get sourceOptions(){return this._sourceOptions}addClickHandler(e){if(!V(this))return;const t=this.interactivity.element;if(!t)return;const n=(t,n,i)=>{if(!V(this))return;const s=this.retina.pixelRatio,r={x:n.x*s,y:n.y*s},o=this.particles.quadTree.queryCircle(r,i*s);e(t,o)};let i=!1,s=!1;t.addEventListener("click",(e=>{if(!V(this))return;const t=e,i={x:t.offsetX||t.clientX,y:t.offsetY||t.clientY};n(e,i,1)})),t.addEventListener("touchstart",(()=>{V(this)&&(i=!0,s=!1)})),t.addEventListener("touchmove",(()=>{V(this)&&(s=!0)})),t.addEventListener("touchend",(e=>{if(V(this)){if(i&&!s){const t=e;let i=t.touches[t.touches.length-1];if(!i&&(i=t.changedTouches[t.changedTouches.length-1],!i))return;const s=this.canvas.element,r=s?s.getBoundingClientRect():void 0,o={x:i.clientX-(r?r.left:0),y:i.clientY-(r?r.top:0)};n(e,o,Math.max(i.radiusX,i.radiusY))}i=!1,s=!1}})),t.addEventListener("touchcancel",(()=>{V(this)&&(i=!1,s=!1)}))}addLifeTime(e){this._lifeTime+=e}addPath(e,t,n=!1){return!(!V(this)||!n&&this.pathGenerators.has(e))&&(this.pathGenerators.set(e,t??G),!0)}alive(){return!this._duration||this._lifeTime<=this._duration}destroy(){if(!V(this))return;this.stop(),this.particles.destroy(),this.canvas.destroy();for(const[,n]of this.drawers)n.destroy&&n.destroy(this);for(const n of this.drawers.keys())this.drawers.delete(n);this._engine.plugins.destroy(this),this.destroyed=!0;const e=this._engine.dom(),t=e.findIndex((e=>e===this));t>=0&&e.splice(t,1),this._engine.dispatchEvent("containerDestroyed",{container:this})}draw(e){if(!V(this))return;let t=e;this._drawAnimationFrame=requestAnimationFrame((async e=>{t&&(this.lastFrameTime=void 0,t=!1),await this._nextFrame(e)}))}async export(e,t={}){for(const[,n]of this.plugins){if(!n.export)continue;const i=await n.export(e,t);if(i.supported)return i.blob}(0,s.tZ)().error(`${i.dI} - Export plugin with type ${e} not found`)}getAnimationStatus(){return!this._paused&&!this.pageHidden&&V(this)}handleClickMode(e){if(V(this)){this.particles.handleClickMode(e);for(const[,t]of this.plugins)t.handleClickMode&&t.handleClickMode(e)}}async init(){if(!V(this))return;const e=this._engine.plugins.getSupportedShapes();for(const n of e){const e=this._engine.plugins.getShapeDrawer(n);e&&this.drawers.set(n,e)}this._options=H(this._engine,this,this._initialSourceOptions,this.sourceOptions),this.actualOptions=H(this._engine,this,this._options);const t=this._engine.plugins.getAvailablePlugins(this);for(const[n,i]of t)this.plugins.set(n,i);this.retina.init(),await this.canvas.init(),this.updateActualOptions(),this.canvas.initBackground(),this.canvas.resize(),this.zLayers=this.actualOptions.zLayers,this._duration=1e3*(0,A.VG)(this.actualOptions.duration),this._delay=1e3*(0,A.VG)(this.actualOptions.delay),this._lifeTime=0,this.fpsLimit=this.actualOptions.fpsLimit>0?this.actualOptions.fpsLimit:120,this.smooth=this.actualOptions.smooth;for(const[,n]of this.drawers)n.init&&await n.init(this);for(const[,n]of this.plugins)n.init&&await n.init();this._engine.dispatchEvent("containerInit",{container:this}),this.particles.init(),this.particles.setDensity();for(const[,n]of this.plugins)n.particlesSetup&&n.particlesSetup();this._engine.dispatchEvent("particlesSetup",{container:this})}async loadTheme(e){V(this)&&(this._currentTheme=e,await this.refresh())}pause(){if(V(this)&&(void 0!==this._drawAnimationFrame&&(cancelAnimationFrame(this._drawAnimationFrame),delete this._drawAnimationFrame),!this._paused)){for(const[,e]of this.plugins)e.pause&&e.pause();this.pageHidden||(this._paused=!0),this._engine.dispatchEvent("containerPaused",{container:this})}}play(e){if(!V(this))return;const t=this._paused||e;if(!this._firstStart||this.actualOptions.autoPlay){if(this._paused&&(this._paused=!1),t)for(const[,e]of this.plugins)e.play&&e.play();this._engine.dispatchEvent("containerPlay",{container:this}),this.draw(t||!1)}else this._firstStart=!1}async refresh(){if(V(this))return this.stop(),this.start()}async reset(){if(V(this))return this._initialSourceOptions=void 0,this._options=H(this._engine,this),this.actualOptions=H(this._engine,this,this._options),this.refresh()}setNoise(e,t,n){V(this)&&this.setPath(e,t,n)}setPath(e,t,n){if(!e||!V(this))return;const i={...G};if((0,s.Tn)(e))i.generate=e,t&&(i.init=t),n&&(i.update=n);else{const t=i;i.generate=e.generate||t.generate,i.init=e.init||t.init,i.update=e.update||t.update}this.addPath("default",i,!0)}async start(){V(this)&&!this.started&&(await this.init(),this.started=!0,await new Promise((e=>{this._delayTimeout=setTimeout((async()=>{this._eventListeners.addListeners(),this.interactivity.element instanceof HTMLElement&&this._intersectionObserver&&this._intersectionObserver.observe(this.interactivity.element);for(const[,e]of this.plugins)e.start&&await e.start();this._engine.dispatchEvent("containerStarted",{container:this}),this.play(),e()}),this._delay)})))}stop(){if(V(this)&&this.started){this._delayTimeout&&(clearTimeout(this._delayTimeout),delete this._delayTimeout),this._firstStart=!0,this.started=!1,this._eventListeners.removeListeners(),this.pause(),this.particles.clear(),this.canvas.stop(),this.interactivity.element instanceof HTMLElement&&this._intersectionObserver&&this._intersectionObserver.unobserve(this.interactivity.element);for(const[,e]of this.plugins)e.stop&&e.stop();for(const e of this.plugins.keys())this.plugins.delete(e);this._sourceOptions=this._options,this._engine.dispatchEvent("containerStopped",{container:this})}}updateActualOptions(){this.actualOptions.responsive=[];const e=this.actualOptions.setResponsive(this.canvas.size.width,this.retina.pixelRatio,this._options);return this.actualOptions.setTheme(this._currentTheme),this.responsiveMaxWidth!==e&&(this.responsiveMaxWidth=e,!0)}}class K{constructor(){this._listeners=new Map}addEventListener(e,t){this.removeEventListener(e,t);let n=this._listeners.get(e);n||(n=[],this._listeners.set(e,n)),n.push(t)}dispatchEvent(e,t){const n=this._listeners.get(e);n&&n.forEach((e=>e(t)))}hasEventListener(e){return!!this._listeners.get(e)}removeAllEventListeners(e){e?this._listeners.delete(e):this._listeners=new Map}removeEventListener(e,t){const n=this._listeners.get(e);if(!n)return;const i=n.length,s=n.indexOf(t);s<0||(1===i?this._listeners.delete(e):n.splice(s,1))}}function J(e,t,n,i=!1){let s=t.get(e);return s&&!i||(s=[...n.values()].map((t=>t(e))),t.set(e,s)),s}class Y{constructor(e){this._engine=e,this.plugins=[],this._initializers={interactors:new Map,movers:new Map,updaters:new Map},this.interactors=new Map,this.movers=new Map,this.updaters=new Map,this.presets=new Map,this.drawers=new Map,this.pathGenerators=new Map}addInteractor(e,t){this._initializers.interactors.set(e,t)}addParticleMover(e,t){this._initializers.movers.set(e,t)}addParticleUpdater(e,t){this._initializers.updaters.set(e,t)}addPathGenerator(e,t){!this.getPathGenerator(e)&&this.pathGenerators.set(e,t)}addPlugin(e){!this.getPlugin(e.id)&&this.plugins.push(e)}addPreset(e,t,n=!1){(n||!this.getPreset(e))&&this.presets.set(e,t)}addShapeDrawer(e,t){(0,s.wJ)(e,(e=>{!this.getShapeDrawer(e)&&this.drawers.set(e,t)}))}destroy(e){this.updaters.delete(e),this.movers.delete(e),this.interactors.delete(e)}getAvailablePlugins(e){const t=new Map;for(const n of this.plugins)n.needsPlugin(e.actualOptions)&&t.set(n.id,n.getPlugin(e));return t}getInteractors(e,t=!1){return J(e,this.interactors,this._initializers.interactors,t)}getMovers(e,t=!1){return J(e,this.movers,this._initializers.movers,t)}getPathGenerator(e){return this.pathGenerators.get(e)}getPlugin(e){return this.plugins.find((t=>t.id===e))}getPreset(e){return this.presets.get(e)}getShapeDrawer(e){return this.drawers.get(e)}getSupportedShapes(){return this.drawers.keys()}getUpdaters(e,t=!1){return J(e,this.updaters,this._initializers.updaters,t)}loadOptions(e,t){for(const n of this.plugins)n.loadOptions(e,t)}loadParticlesOptions(e,t,...n){const i=this.updaters.get(e);if(i)for(const s of i)s.loadOptions&&s.loadOptions(t,...n)}}class Z{constructor(){this._configs=new Map,this._domArray=[],this._eventDispatcher=new K,this._initialized=!1,this.plugins=new Y(this)}get configs(){const e={};for(const[t,n]of this._configs)e[t]=n;return e}get version(){return"2.12.0"}addConfig(e,t){(0,s.Kg)(e)?t&&(t.name=e,this._configs.set(e,t)):this._configs.set(e.name??"default",e)}addEventListener(e,t){this._eventDispatcher.addEventListener(e,t)}async addInteractor(e,t,n=!0){this.plugins.addInteractor(e,t),await this.refresh(n)}async addMover(e,t,n=!0){this.plugins.addParticleMover(e,t),await this.refresh(n)}async addParticleUpdater(e,t,n=!0){this.plugins.addParticleUpdater(e,t),await this.refresh(n)}async addPathGenerator(e,t,n=!0){this.plugins.addPathGenerator(e,t),await this.refresh(n)}async addPlugin(e,t=!0){this.plugins.addPlugin(e),await this.refresh(t)}async addPreset(e,t,n=!1,i=!0){this.plugins.addPreset(e,t,n),await this.refresh(i)}async addShape(e,t,n,i,r,o=!0){let a,l,c,u,d=o;(0,s.Lm)(n)?(d=n,l=void 0):l=n,(0,s.Lm)(i)?(d=i,c=void 0):c=i,(0,s.Lm)(r)?(d=r,u=void 0):u=r,a=(0,s.Tn)(t)?{afterEffect:c,destroy:u,draw:t,init:l}:t,this.plugins.addShapeDrawer(e,a),await this.refresh(d)}dispatchEvent(e,t){this._eventDispatcher.dispatchEvent(e,t)}dom(){return this._domArray}domItem(e){const t=this.dom(),n=t[e];if(n&&!n.destroyed)return n;t.splice(e,1)}init(){this._initialized||(this._initialized=!0)}async load(e,t){return this.loadFromArray(e,t)}async loadFromArray(e,t,n){let i;return!function(e){return!!((t=e).id||t.element||t.url||t.options);var t}(e)?(i={},(0,s.Kg)(e)?i.id=e:i.options=e,(0,s.Et)(t)?i.index=t:i.options=t??i.options,i.index=n??i.index):i=e,this._loadParams(i)}async loadJSON(e,t,n){let i,r;return(0,s.Et)(t)||void 0===t?i=e:(r=e,i=t),this._loadParams({id:r,url:i,index:n})}async refresh(e=!0){e&&this.dom().forEach((e=>e.refresh()))}removeEventListener(e,t){this._eventDispatcher.removeEventListener(e,t)}async set(e,t,n,i){const r={index:i};return(0,s.Kg)(e)?r.id=e:r.element=e,t instanceof HTMLElement?r.element=t:r.options=t,(0,s.Et)(n)?r.index=n:r.options=n??r.options,this._loadParams(r)}async setJSON(e,t,n,i){const s={};return e instanceof HTMLElement?(s.element=e,s.url=t,s.index=n):(s.id=e,s.element=t,s.url=n,s.index=i),this._loadParams(s)}setOnClickHandler(e){const t=this.dom();if(!t.length)throw new Error(`${i.dI} can only set click handlers after calling tsParticles.load()`);for(const n of t)n.addClickHandler(e)}async _loadParams(e){const t=e.id??`tsparticles${Math.floor(1e4*(0,A.G0)())}`,{index:n,url:r}=e,o=r?await async function(e){const t=(0,s.TA)(e.url,e.index);if(!t)return e.fallback;const n=await fetch(t);return n.ok?n.json():((0,s.tZ)().error(`${i.dI} ${n.status} while retrieving config file`),e.fallback)}({fallback:e.options,url:r,index:n}):e.options;let a=e.element??document.getElementById(t);a||(a=document.createElement("div"),a.id=t,document.body.append(a));const l=(0,s.TA)(o,n),c=this.dom(),u=c.findIndex((e=>e.id===t));if(u>=0){const e=this.domItem(u);e&&!e.destroyed&&(e.destroy(),c.splice(u,1))}let d;if("canvas"===a.tagName.toLowerCase())d=a,d.dataset[i.eb]="false";else{const e=a.getElementsByTagName("canvas");e.length?(d=e[0],d.dataset[i.eb]="false"):(d=document.createElement("canvas"),d.dataset[i.eb]="true",a.appendChild(d))}d.style.width||(d.style.width="100%"),d.style.height||(d.style.height="100%");const h=new W(this,t,l);return u>=0?c.splice(u,0,h):c.push(h),h.canvas.loadCanvas(d),await h.start(),h}}class X{constructor(){this.key="hsl",this.stringPrefix="hsl"}handleColor(e){const t=e.value.hsl??e.value;if(void 0!==t.h&&void 0!==t.s&&void 0!==t.l)return(0,o.YL)(t)}handleRangeColor(e){const t=e.value.hsl??e.value;if(void 0!==t.h&&void 0!==t.l)return(0,o.YL)({h:(0,A.VG)(t.h),l:(0,A.VG)(t.l),s:(0,A.VG)(t.s)})}parseString(e){if(!e.startsWith("hsl"))return;const t=/hsla?\(\s*(\d+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([\d.%]+)\s*)?\)/i.exec(e);return t?(0,o.ay)({a:t.length>4?(0,A.M3)(t[5]):1,h:parseInt(t[1],10),l:parseInt(t[3],10),s:parseInt(t[2],10)}):void 0}}class ${constructor(){this.key="rgb",this.stringPrefix="rgb"}handleColor(e){const t=e.value.rgb??e.value;if(void 0!==t.r)return t}handleRangeColor(e){const t=e.value.rgb??e.value;if(void 0!==t.r)return{r:(0,A.VG)(t.r),g:(0,A.VG)(t.g),b:(0,A.VG)(t.b)}}parseString(e){if(!e.startsWith(this.stringPrefix))return;const t=/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([\d.%]+)\s*)?\)/i.exec(e);return t?{a:t.length>4?(0,A.M3)(t[5]):1,b:parseInt(t[3],10),g:parseInt(t[2],10),r:parseInt(t[1],10)}:void 0}}const Q=function(){const e=new $,t=new X;(0,o.a9)(e),(0,o.a9)(t);const n=new Z;return n.init(),n}();(0,s.B9)()||(window.tsParticles=Q)},4389:(e,t,n)=>{function i(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=v(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,s=function(){};return{s:s,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw r}}}}function s(e){var t="function"==typeof Map?new Map:void 0;return s=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(so){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(a())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,t);var s=new(e.bind.apply(e,i));return n&&u(s,n.prototype),s}(e,arguments,l(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),u(n,e)},s(e)}function r(e,t,n){return t=l(t),function(e,t){if(t&&("object"==w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o(e)}(e,a()?Reflect.construct(t,n||[],l(e).constructor):t.apply(e,n))}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(a=function(){return!!e})()}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,s,r,o,a=[],l=!0,c=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=r.call(n)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(e){c=!0,s=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw s}}return a}}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(){h=function(){return t};var e,t={},n=Object.prototype,i=n.hasOwnProperty,s=Object.defineProperty||function(e,t,n){e[t]=n.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",l=r.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,i){var r=t&&t.prototype instanceof y?t:y,o=Object.create(r.prototype),a=new O(i||[]);return s(o,"_invoke",{value:M(e,n,a)}),o}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var p="suspendedStart",f="suspendedYield",m="executing",v="completed",g={};function y(){}function b(){}function _(){}var k={};c(k,o,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(L([])));S&&S!==n&&i.call(S,o)&&(k=S);var E=_.prototype=y.prototype=Object.create(k);function C(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function n(s,r,o,a){var l=d(e[s],e,r);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==w(u)&&i.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,o,a)}),(function(e){n("throw",e,o,a)})):t.resolve(u).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,a)}))}a(l.arg)}var r;s(this,"_invoke",{value:function(e,i){function s(){return new t((function(t,s){n(e,i,t,s)}))}return r=r?r.then(s,s):s()}})}function M(t,n,i){var s=p;return function(r,o){if(s===m)throw Error("Generator is already running");if(s===v){if("throw"===r)throw o;return{value:e,done:!0}}for(i.method=r,i.arg=o;;){var a=i.delegate;if(a){var l=A(a,i);if(l){if(l===g)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(s===p)throw s=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);s=m;var c=d(t,n,i);if("normal"===c.type){if(s=i.done?v:f,c.arg===g)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(s=v,i.method="throw",i.arg=c.arg)}}}function A(t,n){var i=n.method,s=t.iterator[i];if(s===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,A(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),g;var r=d(s,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,g;var o=r.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var s=-1,r=function n(){for(;++s<t.length;)if(i.call(t,s))return n.value=t[s],n.done=!1,n;return n.value=e,n.done=!0,n};return r.next=r}}throw new TypeError(w(t)+" is not iterable")}return b.prototype=_,s(E,"constructor",{value:_,configurable:!0}),s(_,"constructor",{value:b,configurable:!0}),b.displayName=c(_,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,c(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},C(T.prototype),c(T.prototype,a,(function(){return this})),t.AsyncIterator=T,t.async=function(e,n,i,s,r){void 0===r&&(r=Promise);var o=new T(u(e,n,i,s),r);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},C(E),c(E,l,"Generator"),c(E,o,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},t.values=L,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function s(i,s){return a.type="throw",a.arg=t,n.next=i,s&&(n.method="next",n.arg=e),!!s}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return s("end");if(o.tryLoc<=this.prev){var l=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return s(o.catchLoc,!0);if(this.prev<o.finallyLoc)return s(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return s(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return s(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&i.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var r=s;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=e,o.arg=t,r?(this.method="next",this.next=r.finallyLoc,g):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var s=i.arg;R(n)}return s}}throw Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:L(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),g}},t}function p(e,t,n,i,s,r,o){try{var a=e[r](o),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(i,s)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(i,s){var r=e.apply(t,n);function o(e){p(r,i,s,o,a,"next",e)}function a(e){p(r,i,s,o,a,"throw",e)}o(void 0)}))}}function m(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return g(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return(t=E(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,E(i.key),i)}}function S(e,t,n){return t&&x(e.prototype,t),n&&x(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function E(e){var t=function(e,t){if("object"!=w(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=w(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==w(t)?t:t+""}n.d(t,{v:()=>ao});var C=function(){return S((function e(){k(this,e)}),null,[{key:"render",value:function(e,t){var n=document.createElement("div");n.id="error-view",n.innerText=t,e.replaceChildren(n)}}])}(),T=function(){function e(){k(this,e)}return S(e,null,[{key:"onLoad",value:function(e){e.innerHTML='<div id="loading-validate-key-property"></div>'}},{key:"createElements",value:function(){var e=document.createElement("div");return e.id="validate-property-key-view",e}},{key:"render",value:function(t,n,i){var s=e.createElements(),r={onSuccess:n,onFail:C.render.bind(this,t,"Your 'key' has failed authentication"),onLoad:e.onLoad.bind(this,s)};i.key&&i.verifyKey(i.key,r),t.replaceChildren(s)}}])}(),M=function(){function e(){k(this,e)}return S(e,null,[{key:"unsetStyle",value:function(e,t){var n=Object.keys(t).reduce((function(e,t){return e[t]="",e}),{});Object.assign(e.style,n)}},{key:"unsetActivityCSSMouseStates",value:function(t,n){n.click&&e.unsetStyle(t,n.click),n.hover&&e.unsetStyle(t,n.hover)}},{key:"unsetAllCSSMouseStates",value:function(t,n){e.unsetActivityCSSMouseStates(t,n),n.default&&e.unsetStyle(t,n.default)}},{key:"processStateful",value:function(e,t,n){var i=e.default||{},s=Object.assign(JSON.parse(JSON.stringify(b(b({},i),t))),null==e?void 0:e.hover);return{default:i,hover:s,click:Object.assign(JSON.parse(JSON.stringify(b(b({},s),n))),null==e?void 0:e.click)}}},{key:"mergeStatefulStyles",value:function(e){var t={default:{},hover:{},click:{}};return e.forEach((function(e){t.default=Object.assign(t.default,e.default),t.hover=Object.assign(t.hover,e.hover),t.click=Object.assign(t.click,e.click)})),t}},{key:"overwriteDefaultWithAlreadyApplied",value:function(e,t){Object.keys(e.default||[]).forEach((function(n){var i,s=n;t.style[s]&&null!=(i=e.default)&&i[s]&&(e.default[n]=t.style[s])}))}},{key:"applyToStyleIfNotDefined",value:function(e,t){for(var n in t){var i=t[n];""===e[n]&&i&&(e[n]=i)}}}])}(),A=function(){function e(){k(this,e)}return S(e,null,[{key:"attemptAppendStyleSheetToHead",value:function(t){if(!t.fontFamily||t.fontFamily===e.DEFAULT_FONT_FAMILY){var n=document.getElementsByTagName("head")[0];if(!Array.from(n.getElementsByTagName("link")).some((function(t){return t.getAttribute("href")===e.FONT_URL}))){var i=document.createElement("link");i.rel="stylesheet",i.href=e.FONT_URL,n.appendChild(i)}}}}])}();A.FONT_URL="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap",A.DEFAULT_FONT_FAMILY="'Inter', sans-serif, Avenir, Helvetica, Arial";var I=A,R=function(){function e(){k(this,e)}return S(e,null,[{key:"apply",value:function(t,n){if(n)try{e.applyStyleSheet(t,n)}catch(i){e.addStyleElement(t,n)}}},{key:"applyStyleSheet",value:function(e,t){var n=new CSSStyleSheet;n.replaceSync(e),t.adoptedStyleSheets.push(n)}},{key:"addStyleElement",value:function(e,t){var n=document.createElement("style");n.innerHTML=e,t.appendChild(n)}},{key:"applyDefaultStyleToComponent",value:function(t,n){n&&M.applyToStyleIfNotDefined(t,n),M.applyToStyleIfNotDefined(t,e.DEFAULT_COMPONENT_STYLE)}}])}();R.DEFAULT_COMPONENT_STYLE={height:"350px",width:"320px",borderTop:"1px solid #cacaca",borderRight:"1px solid #cacaca",borderLeft:"1px solid #cacaca",borderBottom:"1px solid #cacaca",fontFamily:I.DEFAULT_FONT_FAMILY,fontSize:"0.9rem",backgroundColor:"white",position:"relative",overflow:"hidden"};var O,L=R,P=((O=S((function e(){k(this,e)}))).IS_SAFARI=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),O.IS_CHROMIUM=window.chrome,O),D=function(e){return e.ESCAPE="Escape",e.ENTER="Enter",e.TAB="Tab",e.ARROW_UP="ArrowUp",e.ARROW_DOWN="ArrowDown",e.ARROW_RIGHT="ArrowRight",e.ARROW_LEFT="ArrowLeft",e.BACKSPACE="Backspace",e.DELETE="Delete",e.META="Meta",e.CONTROL="Control",e}(D||{}),N=function(){function e(){k(this,e)}return S(e,null,[{key:"add",value:function(t,n,i,s){void 0!==i&&t.addEventListener("keydown",e.onKeyDown.bind(this,i)),t.oninput=e.onInput.bind(this,i,s),t.addEventListener("paste",(function(e){var t;e.preventDefault(),null!=(t=e.clipboardData)&&t.files.length&&n.addFilesToAnyType(Array.from(e.clipboardData.files))}))}},{key:"onKeyDown",value:function(t,n){var i=n.target.textContent;i&&i.length>=t&&!e.PERMITTED_KEYS.has(n.key)&&!e.isKeyCombinationPermitted(n)&&n.preventDefault()}},{key:"isKeyCombinationPermitted",value:function(e){return"a"===e.key&&(e.ctrlKey||e.metaKey)}},{key:"onInput",value:function(e,t,n){var i=n.target,s=i.textContent||"";void 0!==e&&s.length>e&&(i.textContent=s.substring(0,e),j.focusEndOfInput(i)),null==t||t()}}])}();N.PERMITTED_KEYS=new Set([D.BACKSPACE,D.DELETE,D.ARROW_RIGHT,D.ARROW_LEFT,D.ARROW_DOWN,D.ARROW_UP,D.META,D.CONTROL,D.ENTER]);var z=N,B=function(){return S((function e(){k(this,e)}),null,[{key:"sanitizePastedTextContent",value:function(e){var t,n;e.preventDefault();var i=null==(t=e.clipboardData)?void 0:t.getData("text/plain");i&&(null==(n=document.execCommand)||n.call(document,"insertText",!1,i))}}])}(),F=function(){function e(t,n,i){var s,r,o=this;k(this,e);var a=e.processConfig(n,t.textInput);this.elementRef=e.createContainerElement(null==(s=null==a?void 0:a.styles)?void 0:s.container),this._config=a,this.inputElementRef=this.createInputElement(),this.elementRef.appendChild(this.inputElementRef),t.setPlaceholderText=this.setPlaceholderText.bind(this),t.setPlaceholderText((null==(r=this._config.placeholder)?void 0:r.text)||"Ask me anything!"),setTimeout((function(){z.add(o.inputElementRef,i,o._config.characterLimit,t._validationHandler)}))}return S(e,[{key:"clear",value:function(){var e,t=window.scrollY;this.inputElementRef.classList.contains("text-input-disabled")||(Object.assign(this.inputElementRef.style,null==(e=this._config.placeholder)?void 0:e.style),this.inputElementRef.textContent="",j.focusEndOfInput(this.inputElementRef)),P.IS_CHROMIUM&&window.scrollTo({top:t})}},{key:"createInputElement",value:function(){var t,n,i,s,r=document.createElement("div");return r.id=e.TEXT_INPUT_ID,r.classList.add("text-input-styling"),P.IS_CHROMIUM&&e.preventAutomaticScrollUpOnNewLine(r),"boolean"==typeof this._config.disabled&&!0===this._config.disabled?(r.contentEditable="false",r.classList.add("text-input-disabled")):(r.contentEditable="true",this.addEventListeners(r)),Object.assign(r.style,null==(t=this._config.styles)?void 0:t.text),Object.assign(r.style,null==(n=this._config.placeholder)?void 0:n.style),null!=(s=null==(i=this._config.placeholder)?void 0:i.style)&&s.color||r.setAttribute("textcolor",""),r}},{key:"removePlaceholderStyle",value:function(){var e,t,n,i;!this.inputElementRef.classList.contains("text-input-disabled")&&null!=(e=this._config.placeholder)&&e.style&&(M.unsetStyle(this.inputElementRef,null==(t=this._config.placeholder)?void 0:t.style),Object.assign(this.inputElementRef.style,null==(i=null==(n=this._config)?void 0:n.styles)?void 0:i.text))}},{key:"addEventListeners",value:function(e){var t,n,i=this;null!=(t=this._config.styles)&&t.focus&&(e.onfocus=function(){var e;return Object.assign(i.elementRef.style,null==(e=i._config.styles)?void 0:e.focus)},e.onblur=this.onBlur.bind(this,this._config.styles.focus,null==(n=this._config.styles)?void 0:n.container)),e.addEventListener("keydown",this.onKeydown.bind(this)),e.addEventListener("input",this.onInput.bind(this)),e.addEventListener("paste",B.sanitizePastedTextContent)}},{key:"onBlur",value:function(e,t){M.unsetStyle(this.elementRef,e),t&&Object.assign(this.elementRef.style,t)}},{key:"onKeydown",value:function(e){var t;e.key===D.ENTER&&!e.ctrlKey&&!e.shiftKey&&(e.preventDefault(),null==(t=this.submit)||t.call(this))}},{key:"onInput",value:function(){var e;this.isTextInputEmpty()?Object.assign(this.inputElementRef.style,null==(e=this._config.placeholder)?void 0:e.style):this.removePlaceholderStyle()}},{key:"setPlaceholderText",value:function(e){this.inputElementRef.setAttribute("deep-chat-placeholder-text",e)}},{key:"isTextInputEmpty",value:function(){return""===this.inputElementRef.textContent}}],[{key:"processConfig",value:function(e,t){var n,i,s,r,o;return null!==(n=t)&&void 0!==n||(t={}),null!==(i=t.disabled)&&void 0!==i||(t.disabled=e.isTextInputDisabled),null!==(s=t.placeholder)&&void 0!==s||(t.placeholder={}),null!==(r=(o=t.placeholder).text)&&void 0!==r||(o.text=e.textInputPlaceholderText),t}},{key:"createContainerElement",value:function(e){var t=document.createElement("div");return t.id="text-input-container",Object.assign(t.style,e),t}},{key:"preventAutomaticScrollUpOnNewLine",value:function(e){var t;e.addEventListener("keydown",(function(){t=window.scrollY})),e.addEventListener("input",(function(){t!==window.scrollY&&window.scrollTo({top:t})}))}}])}();F.TEXT_INPUT_ID="text-input";var U=F,j=function(){function e(){k(this,e)}return S(e,null,[{key:"focusEndOfInput",value:function(e){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var n=window.getSelection();null==n||n.removeAllRanges(),null==n||n.addRange(t)}},{key:"focusFromParentElement",value:function(t){var n=t.querySelector("#".concat(U.TEXT_INPUT_ID));n&&(P.IS_SAFARI&&n.focus(),e.focusEndOfInput(n))}}])}();function q(e){return e.charAt(0).toUpperCase()+e.slice(1)}function V(e,t,n,i){var s="\n".concat(q(t)," message: ").concat(JSON.stringify(e)," \n"),r=n?"".concat(q(t)," message after interceptor: ").concat(function(e){return e&&JSON.stringify(e)}(i)," \n"):"";return s+r}var H="Make sure the events are using {text: string} or {html: string} format.\nYou can also augment them using the responseInterceptor property: https://deepchat.dev/docs/interceptors#responseInterceptor",G={INVALID_KEY:"Invalid API Key",CONNECTION_FAILED:"Failed to connect",INVALID_RESPONSE:function(e,t,n,i){return"".concat(V(e,t,n,i),"Make sure the ").concat(t," message is using the Response format: https://deepchat.dev/docs/connect/#Response \nYou can also augment it using the responseInterceptor property: https://deepchat.dev/docs/interceptors#responseInterceptor")},INVALID_MODEL_REQUEST:function(e,t){var n="request";return"".concat(V(e,n,t),"Make sure the ").concat(n,' message is using the {body: {text: string}} format, e.g: {body: {text: "Model Response"}}')},INVALID_MODEL_RESPONSE:function(e,t,n){var i="response";return"".concat(V(e,i,t,n),"Make sure the ").concat(i,' message is using the {text: string} format, e.g: {text: "Model Response"}')},INVALID_STREAM_EVENT:H,INVALID_STREAM_EVENT_MIX:"Cannot mix {text: string} and {html: string} responses.",NO_VALID_STREAM_EVENTS_SENT:"No valid stream events were sent.\n".concat(H)},W=function(){function e(){k(this,e)}return S(e,null,[{key:"addElements",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];n.forEach((function(t){return e.appendChild(t)}))}},{key:"isScrollbarAtBottomOfElement",value:function(t){var n=t.scrollHeight,i=t.clientHeight;return t.scrollTop>=n-i-e.CODE_SNIPPET_GENERATION_JUMP}},{key:"cloneElement",value:function(e){var t=e.cloneNode(!0);return e.parentNode.replaceChild(t,e),t}},{key:"scrollToBottom",value:function(e){e.scrollTop=e.scrollHeight}},{key:"scrollToTop",value:function(e){e.scrollTop=0}}])}();W.CODE_SNIPPET_GENERATION_JUMP=.5;var K=W,J=function(){function e(){k(this,e)}return S(e,null,[{key:"speak",value:function(e,t){if(window.SpeechSynthesisUtterance){var n=new SpeechSynthesisUtterance(e);Object.assign(n,t),speechSynthesis.speak(n)}}},{key:"processConfig",value:function(t,n){var i={};setTimeout((function(){if("object"==w(t)&&(t.lang&&(i.lang=t.lang),t.pitch&&(i.pitch=t.pitch),t.rate&&(i.rate=t.rate),t.volume&&(i.volume=t.volume),t.voiceName)){var e=window.speechSynthesis.getVoices().find((function(e){var n;return e.name.toLocaleLowerCase()===(null==(n=t.voiceName)?void 0:n.toLocaleLowerCase())}));e&&(i.voice=e)}n(i)}),e.LOAD_VOICES_MS)}}])}();J.LOAD_VOICES_MS=200;var Y=J,Z=function(){function e(){k(this,e)}return S(e,null,[{key:"colorToHex",value:function(e){var t=document.createElement("div");return t.style.color=e,document.body.appendChild(t),"#".concat(window.getComputedStyle(t).color.match(/\d+/g).map((function(e){return parseInt(e).toString(16).padStart(2,"0")})).join(""))}},{key:"setDots",value:function(t,n){var i,s,r,o;if(null!=(o=null==(r=null==(s=null==(i=null==n?void 0:n.loading)?void 0:i.message)?void 0:s.styles)?void 0:r.bubble)&&o.color){var a=e.colorToHex(n.loading.message.styles.bubble.color);t.style.setProperty("--loading-message-color",a),t.style.setProperty("--loading-message-color-fade","".concat(a,"33"))}else t.style.setProperty("--loading-message-color","#848484"),t.style.setProperty("--loading-message-color-fade","#55555533")}},{key:"setRing",value:function(t,n){var i=n||{},s=i.color,r=i.width,o=i.height,a=i.margin,l=i.border;if(s){var c=e.colorToHex(s);t.style.setProperty("--loading-history-color",c)}else t.style.setProperty("--loading-history-color","#dbdbdb");t.style.setProperty("--loading-history-height",o||"57px"),t.style.setProperty("--loading-history-width",r||"57px"),t.style.setProperty("--loading-history-margin",a||"7px"),t.style.setProperty("--loading-history-border",l||"6px solid")}}])}();Z.BUBBLE_CLASS="deep-chat-loading-message-bubble",Z.DOTS_CONTAINER_CLASS="deep-chat-loading-message-dots-container";var X=Z,$=function(){function e(){k(this,e)}return S(e,null,[{key:"setElementProps",value:function(t,n,i,s){var r;"loading"!==i&&(t.applyCustomStyles(n,s,!0,null==(r=t.messageStyles)?void 0:r[i]),n.bubbleElement.classList.add(e.FILE_BUBBLE_CLASS))}},{key:"addMessage",value:function(t,n,i,s,r){e.setElementProps(t,n,i,s),r||(t.elementRef.appendChild(n.outerContainer),t.elementRef.scrollTop=t.elementRef.scrollHeight)}},{key:"wrapInLink",value:function(t,n,i){var s=document.createElement("a");return s.href=n,s.download=i||e.DEFAULT_FILE_NAME,s.target="_blank",s.appendChild(t),s}},{key:"isNonLinkableDataUrl",value:function(e,t){return!(!t.startsWith("data")||"image"===e)&&("any"===e&&t.startsWith("data:text/javascript")||!t.startsWith("data:image")&&!t.startsWith("data:application"))}},{key:"processContent",value:function(t,n,i,s){return!i||e.isNonLinkableDataUrl(t,i)?n:e.wrapInLink(n,i,s)}},{key:"waitToLoadThenScroll",value:function(e){setTimeout((function(){e.scrollTop=e.scrollHeight}),60)}},{key:"scrollDownOnImageLoad",value:function(t,n){if(t.startsWith("data"))e.waitToLoadThenScroll(n);else try{fetch(t,{mode:"no-cors"}).catch((function(){})).finally((function(){e.waitToLoadThenScroll(n)}))}catch(i){n.scrollTop=n.scrollHeight}}},{key:"reAddFileRefToObject",value:function(e,t){var n;null==(n=e.files)||n.forEach((function(e,n){var i;e.ref&&null!=(i=t.message.files)&&i[n]&&(t.message.files[n].ref=e.ref)}))}},{key:"removeFileRef",value:function(e){var t=b({},e);return delete t.ref,t}},{key:"isAudioFile",value:function(e){var t=e.type,n=e.src;return"audio"===t||(null==n?void 0:n.startsWith("data:audio"))||n&&/\.(mp3|ogg|wav|aac|webm|4a)$/i.test(n)}},{key:"isImageFile",value:function(t){var n=t.type,i=t.src;return"image"===n||(null==i?void 0:i.startsWith("data:image"))||i&&e.isImageFileExtension(i)}},{key:"isImageFileExtension",value:function(e){return/\.(jpg|jpeg|png|gif|bmp)$/i.test(e)}}])}();$.DEFAULT_FILE_NAME="file",$.FILE_BUBBLE_CLASS="file-message";var Q=$,ee=function(){return S((function e(){k(this,e)}),null,[{key:"checkForContainerStyles",value:function(e,t){var n=e.containerStyle;n&&(Object.assign(t.style,n),console.error("The containerStyle property is deprecated since version 1.3.14."),console.error("Please change to using the style property instead: https://deepchat.dev/docs/styles#style"))}},{key:"handleResponseProperty",value:function(e){return console.error("The {result: ....} response object type is deprecated since version 1.3.0."),console.error("Please change to using the new response object: https://deepchat.dev/docs/connect#Response"),e.result}},{key:"processHistory",value:function(e){var t=e.initialMessages;if(t)return console.error("The initialMessages property is deprecated since version 2.0.0."),console.error("Please change to using the history property instead: https://deepchat.dev/docs/messages/#history"),t}},{key:"processHistoryFile",value:function(e){var t=e.file;t&&(console.error("The file property in MessageContent is deprecated since version 1.3.17."),console.error("Please change to using the files array property: https://deepchat.dev/docs/messages/#MessageContent"),e.files=[t])}},{key:"processValidateInput",value:function(e){var t=e.validateMessageBeforeSending;if(t)return console.error("The validateMessageBeforeSending property is deprecated since version 1.3.24."),console.error("Please change to using validateInput: https://deepchat.dev/docs/interceptors#validateInput"),t}},{key:"processSubmitUserMessage",value:function(e){return console.error("The submitUserMessage(text: string) argument string type is deprecated since version 1.4.4."),console.error("Please change to using the new argument type: https://deepchat.dev/docs/methods#submitUserMessage"),{text:e}}},{key:"flagHTMLUpdateClass",value:function(e){var t;null!=(t=e.children[0])&&t.classList.contains("deep-chat-update-message")&&(console.error('The "deep-chat-update-message" html class is deprecated since version 1.4.4.'),console.error("Please change to using {..., overwrite: true} object: https://deepchat.dev/docs/connect#Response"))}},{key:"processConnect",value:function(e){var t=e;t.request&&(t.connect?Object.assign(t.connect,t.request):t.connect=t.request,console.error("The request property is deprecated since version 2.0.0."),console.error("Please see the connect object: https://deepchat.dev/docs/connect#connect-1"))}},{key:"checkForStream",value:function(e){var t=e.stream;if(t)return console.error("The stream property has been moved to the connect object in version 2.0.0."),console.error("Please see the connect object: https://deepchat.dev/docs/connect#connect-1"),t}},{key:"fireOnNewMessage",value:function(e,t){var n,i=e;i.onNewMessage&&(console.error("The onNewMessage event has been deprecated since version 2.0.0."),console.error("Please see the onMessage event: https://deepchat.dev/docs/events#onMessage"),null==(n=i.onNewMessage)||n.call(i,t)),e.dispatchEvent(new CustomEvent("new-message",{detail:t}))}},{key:"processFileConfigConnect",value:function(e){var t=e;t.request&&(console.error("The request property in file configuration is deprecated since version 2.0.0."),console.error("Please use the connect property instead: https://deepchat.dev/docs/files"),t.connect||(t.connect=t.request))}},{key:"processMessageStyles",value:function(e){if(e){var t=structuredClone(e),n=t.loading;return n&&(n.outerContainer||n.innerContainer||n.bubble||n.media)&&(console.error("The loading message styles are defined using LoadingMessageStyles interface since version 2.1.0."),console.error("Check it out here: https://deepchat.dev/docs/messages/styles#LoadingMessageStyles"),t.loading={message:{styles:n}}),t}}},{key:"processDemo",value:function(e){return"boolean"==typeof e||e.displayLoadingBubble&&(console.error("The demo displayLoadingBubble property is deprecated since version 2.1.0."),console.error("Please use displayLoading instead: https://deepchat.dev/docs/demo#demo"),e.displayLoading={message:!0}),e}}])}(),te=function(){function e(){k(this,e)}return S(e,null,[{key:"mouseUp",value:function(e,t){M.unsetAllCSSMouseStates(e,t),Object.assign(e.style,t.default),Object.assign(e.style,t.hover)}},{key:"mouseDown",value:function(e,t){Object.assign(e.style,t.click)}},{key:"mouseLeave",value:function(e,t){M.unsetAllCSSMouseStates(e,t),Object.assign(e.style,t.default)}},{key:"mouseEnter",value:function(e,t){Object.assign(e.style,t.hover)}},{key:"add",value:function(t,n){t.addEventListener("mouseenter",e.mouseEnter.bind(this,t,n)),t.addEventListener("mouseleave",e.mouseLeave.bind(this,t,n)),t.addEventListener("mousedown",e.mouseDown.bind(this,t,n)),t.addEventListener("mouseup",e.mouseUp.bind(this,t,n))}}])}(),ne={"deep-chat-button":{styles:{default:{backgroundColor:"white",padding:"5px",paddingLeft:"7px",paddingRight:"7px",border:"1px solid #c2c2c2",borderRadius:"6px",cursor:"pointer"},hover:{backgroundColor:"#fafafa"},click:{backgroundColor:"#f1f1f1"}}}},ie=Object.keys(ne),se=function(){function e(){k(this,e)}return S(e,null,[{key:"applySuggestionEvent",value:function(e,t){setTimeout((function(){t.addEventListener("click",(function(){var n,i;null==(i=e.submitUserMessage)||i.call(e,{text:(null==(n=t.textContent)?void 0:n.trim())||""})}))}))}},{key:"isElementTemporary",value:function(e){var t;return!!e&&(null==(t=e.bubbleElement.children[0])?void 0:t.classList.contains("deep-chat-temporary-message"))}},{key:"doesElementContainDeepChatClass",value:function(e){return ie.find((function(t){return e.classList.contains(t)}))}},{key:"applyEvents",value:function(e,t){var n=ne[t].events;Object.keys(n||[]).forEach((function(t){e.addEventListener(t,null==n?void 0:n[t])}))}},{key:"getProcessedStyles",value:function(e,t,n){var i=Array.from(t.classList).reduce((function(t,n){var i,s=null==(i=e[n])?void 0:i.styles;return s&&e[n].styles&&t.push(s),t}),[]),s=ne[n].styles;if(s){var r=JSON.parse(JSON.stringify(s));r.default&&M.overwriteDefaultWithAlreadyApplied(r,t),i.unshift(r)}var o=M.mergeStatefulStyles(i);return M.processStateful(o,{},{})}},{key:"applyDeepChatUtilities",value:function(t,n,i){ie.forEach((function(t){var s=i.getElementsByClassName(t);Array.from(s||[]).forEach((function(i){var s=e.getProcessedStyles(n,i,t);re.applyStylesToElement(i,s),e.applyEvents(i,t)}))}));var s=i.getElementsByClassName("deep-chat-suggestion-button");Array.from(s).forEach((function(n){return e.applySuggestionEvent(t,n)}))}}])}(),re=function(){function e(){k(this,e)}return S(e,null,[{key:"applyStylesToElement",value:function(e,t){var n=M.processStateful(t,{},{});te.add(e,n),Object.assign(e.style,n.default)}},{key:"applyEventsToElement",value:function(e,t){Object.keys(t).forEach((function(n){var i=t[n];i&&e.addEventListener(n,i)}))}},{key:"applyClassUtilitiesToElement",value:function(t,n){var i=n.events,s=n.styles;i&&e.applyEventsToElement(t,i),s&&!se.doesElementContainDeepChatClass(t)&&e.applyStylesToElement(t,s)}},{key:"applyCustomClassUtilities",value:function(t,n){Object.keys(t).forEach((function(i){var s=n.getElementsByClassName(i);Array.from(s).forEach((function(n){t[i]&&e.applyClassUtilitiesToElement(n,t[i])}))}))}},{key:"apply",value:function(t,n){se.applyDeepChatUtilities(t,t.htmlClassUtilities,n),e.applyCustomClassUtilities(t.htmlClassUtilities,n)}},{key:"traverseNodes",value:function(t,n){t.nodeType===Node.ELEMENT_NODE&&n.push(t.outerHTML),t.childNodes.forEach((function(t){e.traverseNodes(t,n)}))}},{key:"splitHTML",value:function(t){var n=(new DOMParser).parseFromString(t,"text/html"),i=[];return n.body.childNodes.forEach((function(t){e.traverseNodes(t,i)})),i}}])}(),oe=function(){function e(){k(this,e)}return S(e,null,[{key:"addElement",value:function(e,t){e.elementRef.appendChild(t),e.elementRef.scrollTop=e.elementRef.scrollHeight}},{key:"createElements",value:function(t,n,i,s){var r=t.createMessageElementsOnOrientation("",i,s);return r.bubbleElement.classList.add(e.HTML_BUBBLE_CLASS),r.bubbleElement.innerHTML=n,r}},{key:"overwriteElements",value:function(e,t,n){n.bubbleElement.innerHTML=t,re.apply(e,n.outerContainer),ee.flagHTMLUpdateClass(n.bubbleElement)}},{key:"overwrite",value:function(t,n,i,s){var r=t.messageToElements,o=Wt.overwriteMessage(r,s,n,i,"html",e.HTML_BUBBLE_CLASS);return o&&e.overwriteElements(t,n,o),o}},{key:"create",value:function(t,n,i){var s,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e.createElements(t,n,i,r);return Wt.fillEmptyMessageElement(o.bubbleElement,n),re.apply(t,o.outerContainer),ee.flagHTMLUpdateClass(o.bubbleElement),t.applyCustomStyles(o,i,!1,null==(s=t.messageStyles)?void 0:s.html),o}},{key:"add",value:function(t,n,i,s,r){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(null!=r&&r.status){var a=this.overwrite(t,n,i,s);if(a)return a;r.status=!1}var l=e.create(t,n,i,o);return o||e.addElement(t,l.outerContainer),l}}])}();oe.HTML_BUBBLE_CLASS="html-message";var ae,le=oe;function ce(e){return(ae=ae||document.createElement("textarea")).innerHTML="&"+e+";",ae.value}var ue=Object.prototype.hasOwnProperty;function de(e){return[].slice.call(arguments,1).forEach((function(t){if(t){if("object"!=w(t))throw new TypeError(t+"must be object");Object.keys(t).forEach((function(n){e[n]=t[n]}))}})),e}var he=/\\([\\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function pe(e){return e.indexOf("\\")<0?e:e.replace(he,"$1")}function fe(e){return!(e>=55296&&e<=57343||e>=64976&&e<=65007||!(65535&~e)||65534==(65535&e)||e>=0&&e<=8||11===e||e>=14&&e<=31||e>=127&&e<=159||e>1114111)}function me(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}var ve=/&([a-z#][a-z0-9]{1,31});/gi,ge=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i;function ye(e,t){var n=0,i=ce(t);return t!==i?i:35===t.charCodeAt(0)&&ge.test(t)&&fe(n="x"===t[1].toLowerCase()?parseInt(t.slice(2),16):parseInt(t.slice(1),10))?me(n):e}function be(e){return e.indexOf("&")<0?e:e.replace(ve,ye)}var _e=/[&<>"]/,we=/[&<>"]/g,ke={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function xe(e){return ke[e]}function Se(e){return _e.test(e)?e.replace(we,xe):e}var Ee={};function Ce(e,t){return++t>=e.length-2?t:"paragraph_open"===e[t].type&&e[t].tight&&"inline"===e[t+1].type&&0===e[t+1].content.length&&"paragraph_close"===e[t+2].type&&e[t+2].tight?Ce(e,t+2):t}Ee.blockquote_open=function(){return"<blockquote>\n"},Ee.blockquote_close=function(e,t){return"</blockquote>"+Te(e,t)},Ee.code=function(e,t){return e[t].block?"<pre><code>"+Se(e[t].content)+"</code></pre>"+Te(e,t):"<code>"+Se(e[t].content)+"</code>"},Ee.fence=function(e,t,n,i,s){var r,o,a=e[t],l="",c=n.langPrefix;if(a.params){if(o=(r=a.params.split(/\s+/g)).join(" "),function(e,t){return!!e&&ue.call(e,t)}(s.rules.fence_custom,r[0]))return s.rules.fence_custom[r[0]](e,t,n,i,s);l=' class="'+c+Se(be(pe(o)))+'"'}return"<pre><code"+l+">"+(n.highlight&&n.highlight.apply(n.highlight,[a.content].concat(r))||Se(a.content))+"</code></pre>"+Te(e,t)},Ee.fence_custom={},Ee.heading_open=function(e,t){return"<h"+e[t].hLevel+">"},Ee.heading_close=function(e,t){return"</h"+e[t].hLevel+">\n"},Ee.hr=function(e,t,n){return(n.xhtmlOut?"<hr />":"<hr>")+Te(e,t)},Ee.bullet_list_open=function(){return"<ul>\n"},Ee.bullet_list_close=function(e,t){return"</ul>"+Te(e,t)},Ee.list_item_open=function(){return"<li>"},Ee.list_item_close=function(){return"</li>\n"},Ee.ordered_list_open=function(e,t){var n=e[t];return"<ol"+(n.order>1?' start="'+n.order+'"':"")+">\n"},Ee.ordered_list_close=function(e,t){return"</ol>"+Te(e,t)},Ee.paragraph_open=function(e,t){return e[t].tight?"":"<p>"},Ee.paragraph_close=function(e,t){var n=!(e[t].tight&&t&&"inline"===e[t-1].type&&!e[t-1].content);return(e[t].tight?"":"</p>")+(n?Te(e,t):"")},Ee.link_open=function(e,t,n){var i=e[t].title?' title="'+Se(be(e[t].title))+'"':"",s=n.linkTarget?' target="'+n.linkTarget+'"':"";return'<a href="'+Se(e[t].href)+'"'+i+s+">"},Ee.link_close=function(){return"</a>"},Ee.image=function(e,t,n){var i=' src="'+Se(e[t].src)+'"',s=e[t].title?' title="'+Se(be(e[t].title))+'"':"";return"<img"+i+(' alt="'+(e[t].alt?Se(be(pe(e[t].alt))):"")+'"')+s+(n.xhtmlOut?" /":"")+">"},Ee.table_open=function(){return"<table>\n"},Ee.table_close=function(){return"</table>\n"},Ee.thead_open=function(){return"<thead>\n"},Ee.thead_close=function(){return"</thead>\n"},Ee.tbody_open=function(){return"<tbody>\n"},Ee.tbody_close=function(){return"</tbody>\n"},Ee.tr_open=function(){return"<tr>"},Ee.tr_close=function(){return"</tr>\n"},Ee.th_open=function(e,t){var n=e[t];return"<th"+(n.align?' style="text-align:'+n.align+'"':"")+">"},Ee.th_close=function(){return"</th>"},Ee.td_open=function(e,t){var n=e[t];return"<td"+(n.align?' style="text-align:'+n.align+'"':"")+">"},Ee.td_close=function(){return"</td>"},Ee.strong_open=function(){return"<strong>"},Ee.strong_close=function(){return"</strong>"},Ee.em_open=function(){return"<em>"},Ee.em_close=function(){return"</em>"},Ee.del_open=function(){return"<del>"},Ee.del_close=function(){return"</del>"},Ee.ins_open=function(){return"<ins>"},Ee.ins_close=function(){return"</ins>"},Ee.mark_open=function(){return"<mark>"},Ee.mark_close=function(){return"</mark>"},Ee.sub=function(e,t){return"<sub>"+Se(e[t].content)+"</sub>"},Ee.sup=function(e,t){return"<sup>"+Se(e[t].content)+"</sup>"},Ee.hardbreak=function(e,t,n){return n.xhtmlOut?"<br />\n":"<br>\n"},Ee.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?"<br />\n":"<br>\n":"\n"},Ee.text=function(e,t){return Se(e[t].content)},Ee.htmlblock=function(e,t){return e[t].content},Ee.htmltag=function(e,t){return e[t].content},Ee.abbr_open=function(e,t){return'<abbr title="'+Se(be(e[t].title))+'">'},Ee.abbr_close=function(){return"</abbr>"},Ee.footnote_ref=function(e,t){var n=Number(e[t].id+1).toString(),i="fnref"+n;return e[t].subId>0&&(i+=":"+e[t].subId),'<sup class="footnote-ref"><a href="#fn'+n+'" id="'+i+'">['+n+"]</a></sup>"},Ee.footnote_block_open=function(e,t,n){return(n.xhtmlOut?'<hr class="footnotes-sep" />\n':'<hr class="footnotes-sep">\n')+'<section class="footnotes">\n<ol class="footnotes-list">\n'},Ee.footnote_block_close=function(){return"</ol>\n</section>\n"},Ee.footnote_open=function(e,t){return'<li id="fn'+Number(e[t].id+1).toString()+'"  class="footnote-item">'},Ee.footnote_close=function(){return"</li>\n"},Ee.footnote_anchor=function(e,t){var n="fnref"+Number(e[t].id+1).toString();return e[t].subId>0&&(n+=":"+e[t].subId),' <a href="#'+n+'" class="footnote-backref">\u21a9</a>'},Ee.dl_open=function(){return"<dl>\n"},Ee.dt_open=function(){return"<dt>"},Ee.dd_open=function(){return"<dd>"},Ee.dl_close=function(){return"</dl>\n"},Ee.dt_close=function(){return"</dt>\n"},Ee.dd_close=function(){return"</dd>\n"};var Te=Ee.getBreak=function(e,t){return(t=Ce(e,t))<e.length&&"list_item_close"===e[t].type?"":"\n"};function Me(){this.rules=de({},Ee),this.getBreak=Ee.getBreak}function Ae(){this.__rules__=[],this.__cache__=null}function Ie(e,t,n,i,s){this.src=e,this.env=i,this.options=n,this.parser=t,this.tokens=s,this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache=[],this.isInLabel=!1,this.linkLevel=0,this.linkContent="",this.labelUnmatchedScopes=0}function Re(e,t){var n,i,s,r=-1,o=e.posMax,a=e.pos,l=e.isInLabel;if(e.isInLabel)return-1;if(e.labelUnmatchedScopes)return e.labelUnmatchedScopes--,-1;for(e.pos=t+1,e.isInLabel=!0,n=1;e.pos<o;){if(91===(s=e.src.charCodeAt(e.pos)))n++;else if(93===s&&0===--n){i=!0;break}e.parser.skipToken(e)}return i?(r=e.pos,e.labelUnmatchedScopes=0):e.labelUnmatchedScopes=n-1,e.pos=a,e.isInLabel=l,r}function Oe(e,t,n,i){var s,r,o,a,l,c;if(42!==e.charCodeAt(0)||91!==e.charCodeAt(1)||-1===e.indexOf("]:")||((r=Re(s=new Ie(e,t,n,i,[]),1))<0||58!==e.charCodeAt(r+1)))return-1;for(a=s.posMax,o=r+2;o<a&&10!==s.src.charCodeAt(o);o++);return l=e.slice(2,r),0===(c=e.slice(r+2,o).trim()).length?-1:(i.abbreviations||(i.abbreviations={}),w(i.abbreviations[":"+l])>"u"&&(i.abbreviations[":"+l]=c),o)}function Le(e){var t=be(e);try{t=decodeURI(t)}catch(n){}return encodeURI(t)}function Pe(e,t){var n,i,s,r=t,o=e.posMax;if(60===e.src.charCodeAt(t)){for(t++;t<o;){if(10===(n=e.src.charCodeAt(t)))return!1;if(62===n)return s=Le(pe(e.src.slice(r+1,t))),!!e.parser.validateLink(s)&&(e.pos=t+1,e.linkContent=s,!0);92===n&&t+1<o?t+=2:t++}return!1}for(i=0;t<o&&!(32===(n=e.src.charCodeAt(t))||n<32||127===n);)if(92===n&&t+1<o)t+=2;else{if(40===n&&++i>1||41===n&&--i<0)break;t++}return!(r===t||(s=pe(e.src.slice(r,t)),!e.parser.validateLink(s)))&&(e.linkContent=s,e.pos=t,!0)}function De(e,t){var n,i=t,s=e.posMax,r=e.src.charCodeAt(t);if(34!==r&&39!==r&&40!==r)return!1;for(t++,40===r&&(r=41);t<s;){if((n=e.src.charCodeAt(t))===r)return e.pos=t+1,e.linkContent=pe(e.src.slice(i+1,t)),!0;92===n&&t+1<s?t+=2:t++}return!1}function Ne(e){return e.trim().replace(/\s+/g," ").toUpperCase()}function ze(e,t,n,i){var s,r,o,a,l,c,u,d,h;if(91!==e.charCodeAt(0)||-1===e.indexOf("]:")||((r=Re(s=new Ie(e,t,n,i,[]),0))<0||58!==e.charCodeAt(r+1)))return-1;for(a=s.posMax,o=r+2;o<a&&(32===(l=s.src.charCodeAt(o))||10===l);o++);if(!Pe(s,o))return-1;for(u=s.linkContent,c=o=s.pos,o+=1;o<a&&(32===(l=s.src.charCodeAt(o))||10===l);o++);for(o<a&&c!==o&&De(s,o)?(d=s.linkContent,o=s.pos):(d="",o=c);o<a&&32===s.src.charCodeAt(o);)o++;return o<a&&10!==s.src.charCodeAt(o)?-1:(h=Ne(e.slice(1,r)),w(i.references[h])>"u"&&(i.references[h]={title:d,href:u}),o)}Me.prototype.renderInline=function(e,t,n){for(var i=this.rules,s=e.length,r=0,o="";s--;)o+=i[e[r].type](e,r++,t,n,this);return o},Me.prototype.render=function(e,t,n){for(var i=this.rules,s=e.length,r=-1,o="";++r<s;)"inline"===e[r].type?o+=this.renderInline(e[r].children,t,n):o+=i[e[r].type](e,r,t,n,this);return o},Ae.prototype.__find__=function(e){for(var t=this.__rules__.length,n=-1;t--;)if(this.__rules__[++n].name===e)return n;return-1},Ae.prototype.__compile__=function(){var e=this,t=[""];e.__rules__.forEach((function(e){e.enabled&&e.alt.forEach((function(e){t.indexOf(e)<0&&t.push(e)}))})),e.__cache__={},t.forEach((function(t){e.__cache__[t]=[],e.__rules__.forEach((function(n){n.enabled&&(t&&n.alt.indexOf(t)<0||e.__cache__[t].push(n.fn))}))}))},Ae.prototype.at=function(e,t,n){var i=this.__find__(e),s=n||{};if(-1===i)throw new Error("Parser rule not found: "+e);this.__rules__[i].fn=t,this.__rules__[i].alt=s.alt||[],this.__cache__=null},Ae.prototype.before=function(e,t,n,i){var s=this.__find__(e),r=i||{};if(-1===s)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s,0,{name:t,enabled:!0,fn:n,alt:r.alt||[]}),this.__cache__=null},Ae.prototype.after=function(e,t,n,i){var s=this.__find__(e),r=i||{};if(-1===s)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s+1,0,{name:t,enabled:!0,fn:n,alt:r.alt||[]}),this.__cache__=null},Ae.prototype.push=function(e,t,n){var i=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:i.alt||[]}),this.__cache__=null},Ae.prototype.enable=function(e,t){e=Array.isArray(e)?e:[e],t&&this.__rules__.forEach((function(e){e.enabled=!1})),e.forEach((function(e){var t=this.__find__(e);if(t<0)throw new Error("Rules manager: invalid rule name "+e);this.__rules__[t].enabled=!0}),this),this.__cache__=null},Ae.prototype.disable=function(e){(e=Array.isArray(e)?e:[e]).forEach((function(e){var t=this.__find__(e);if(t<0)throw new Error("Rules manager: invalid rule name "+e);this.__rules__[t].enabled=!1}),this),this.__cache__=null},Ae.prototype.getRules=function(e){return null===this.__cache__&&this.__compile__(),this.__cache__[e]||[]},Ie.prototype.pushPending=function(){this.tokens.push({type:"text",content:this.pending,level:this.pendingLevel}),this.pending=""},Ie.prototype.push=function(e){this.pending&&this.pushPending(),this.tokens.push(e),this.pendingLevel=this.level},Ie.prototype.cacheSet=function(e,t){for(var n=this.cache.length;n<=e;n++)this.cache.push(0);this.cache[e]=t},Ie.prototype.cacheGet=function(e){return e<this.cache.length?this.cache[e]:0};var Be=" \n()[]'\".,!?-";function Fe(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1")}var Ue=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,je=/\((c|tm|r|p)\)/gi,qe={c:"\xa9",r:"\xae",p:"\xa7",tm:"\u2122"};function Ve(e){return e.indexOf("(")<0?e:e.replace(je,(function(e,t){return qe[t.toLowerCase()]}))}var He=/['"]/,Ge=/['"]/g,We=/[-\s()\[\]]/;function Ke(e,t){return!(t<0||t>=e.length)&&!We.test(e[t])}function Je(e,t,n){return e.substr(0,t)+n+e.substr(t+1)}var Ye=[["block",function(e){e.inlineMode?e.tokens.push({type:"inline",content:e.src.replace(/\n/g," ").trim(),level:0,lines:[0,1],children:[]}):e.block.parse(e.src,e.options,e.env,e.tokens)}],["abbr",function(e){var t,n,i,s,r=e.tokens;if(!e.inlineMode)for(t=1,n=r.length-1;t<n;t++)if("paragraph_open"===r[t-1].type&&"inline"===r[t].type&&"paragraph_close"===r[t+1].type){for(i=r[t].content;i.length&&!((s=Oe(i,e.inline,e.options,e.env))<0);)i=i.slice(s).trim();r[t].content=i,i.length||(r[t-1].tight=!0,r[t+1].tight=!0)}}],["references",function(e){var t,n,i,s,r=e.tokens;if(e.env.references=e.env.references||{},!e.inlineMode)for(t=1,n=r.length-1;t<n;t++)if("inline"===r[t].type&&"paragraph_open"===r[t-1].type&&"paragraph_close"===r[t+1].type){for(i=r[t].content;i.length&&!((s=ze(i,e.inline,e.options,e.env))<0);)i=i.slice(s).trim();r[t].content=i,i.length||(r[t-1].tight=!0,r[t+1].tight=!0)}}],["inline",function(e){var t,n,i,s=e.tokens;for(n=0,i=s.length;n<i;n++)"inline"===(t=s[n]).type&&e.inline.parse(t.content,e.options,e.env,t.children)}],["footnote_tail",function(e){var t,n,i,s,r,o,a,l,c,u=0,d=!1,h={};if(e.env.footnotes&&(e.tokens=e.tokens.filter((function(e){return"footnote_reference_open"===e.type?(d=!0,l=[],c=e.label,!1):"footnote_reference_close"===e.type?(d=!1,h[":"+c]=l,!1):(d&&l.push(e),!d)})),e.env.footnotes.list)){for(o=e.env.footnotes.list,e.tokens.push({type:"footnote_block_open",level:u++}),t=0,n=o.length;t<n;t++){for(e.tokens.push({type:"footnote_open",id:t,level:u++}),o[t].tokens?((a=[]).push({type:"paragraph_open",tight:!1,level:u++}),a.push({type:"inline",content:"",level:u,children:o[t].tokens}),a.push({type:"paragraph_close",tight:!1,level:--u})):o[t].label&&(a=h[":"+o[t].label]),e.tokens=e.tokens.concat(a),r="paragraph_close"===e.tokens[e.tokens.length-1].type?e.tokens.pop():null,s=o[t].count>0?o[t].count:1,i=0;i<s;i++)e.tokens.push({type:"footnote_anchor",id:t,subId:i,level:u});r&&e.tokens.push(r),e.tokens.push({type:"footnote_close",level:--u})}e.tokens.push({type:"footnote_block_close",level:--u})}}],["abbr2",function(e){var t,n,i,s,r,o,a,l,c,u,d,h,p=e.tokens;if(e.env.abbreviations)for(e.env.abbrRegExp||(h="(^|["+Be.split("").map(Fe).join("")+"])("+Object.keys(e.env.abbreviations).map((function(e){return e.substr(1)})).sort((function(e,t){return t.length-e.length})).map(Fe).join("|")+")($|["+Be.split("").map(Fe).join("")+"])",e.env.abbrRegExp=new RegExp(h,"g")),u=e.env.abbrRegExp,n=0,i=p.length;n<i;n++)if("inline"===p[n].type)for(t=(s=p[n].children).length-1;t>=0;t--)if("text"===(r=s[t]).type){for(l=0,o=r.content,u.lastIndex=0,c=r.level,a=[];d=u.exec(o);)u.lastIndex>l&&a.push({type:"text",content:o.slice(l,d.index+d[1].length),level:c}),a.push({type:"abbr_open",title:e.env.abbreviations[":"+d[2]],level:c++}),a.push({type:"text",content:d[2],level:c}),a.push({type:"abbr_close",level:--c}),l=u.lastIndex-d[3].length;a.length&&(l<o.length&&a.push({type:"text",content:o.slice(l),level:c}),p[n].children=s=[].concat(s.slice(0,t),a,s.slice(t+1)))}}],["replacements",function(e){var t,n,i,s,r;if(e.options.typographer)for(r=e.tokens.length-1;r>=0;r--)if("inline"===e.tokens[r].type)for(t=(s=e.tokens[r].children).length-1;t>=0;t--)"text"===(n=s[t]).type&&(i=Ve(i=n.content),Ue.test(i)&&(i=i.replace(/\+-/g,"\xb1").replace(/\.{2,}/g,"\u2026").replace(/([?!])\u2026/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---([^-]|$)/gm,"$1\u2014$2").replace(/(^|\s)--(\s|$)/gm,"$1\u2013$2").replace(/(^|[^-\s])--([^-\s]|$)/gm,"$1\u2013$2")),n.content=i)}],["smartquotes",function(e){var t,n,i,s,r,o,a,l,c,u,d,h,p,f,m,v,g;if(e.options.typographer)for(g=[],m=e.tokens.length-1;m>=0;m--)if("inline"===e.tokens[m].type)for(v=e.tokens[m].children,g.length=0,t=0;t<v.length;t++)if("text"===(n=v[t]).type&&!He.test(n.text)){for(a=v[t].level,p=g.length-1;p>=0&&!(g[p].level<=a);p--);g.length=p+1,r=0,o=(i=n.content).length;e:for(;r<o&&(Ge.lastIndex=r,s=Ge.exec(i),s);)if(l=!Ke(i,s.index-1),r=s.index+1,f="'"===s[0],(c=!Ke(i,r))||l){if(d=!c,h=!l)for(p=g.length-1;p>=0&&(u=g[p],!(g[p].level<a));p--)if(u.single===f&&g[p].level===a){u=g[p],f?(v[u.token].content=Je(v[u.token].content,u.pos,e.options.quotes[2]),n.content=Je(n.content,s.index,e.options.quotes[3])):(v[u.token].content=Je(v[u.token].content,u.pos,e.options.quotes[0]),n.content=Je(n.content,s.index,e.options.quotes[1])),g.length=p;continue e}d?g.push({token:t,pos:s.index,single:f,level:a}):h&&f&&(n.content=Je(n.content,s.index,"\u2019"))}else f&&(n.content=Je(n.content,s.index,"\u2019"))}}]];function Ze(){this.options={},this.ruler=new Ae;for(var e=0;e<Ye.length;e++)this.ruler.push(Ye[e][0],Ye[e][1])}function Xe(e,t,n,i,s){var r,o,a,l,c,u,d;for(this.src=e,this.parser=t,this.options=n,this.env=i,this.tokens=s,this.bMarks=[],this.eMarks=[],this.tShift=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.parentType="root",this.ddIndent=-1,this.level=0,this.result="",u=0,d=!1,a=l=u=0,c=(o=this.src).length;l<c;l++){if(r=o.charCodeAt(l),!d){if(32===r){u++;continue}d=!0}(10===r||l===c-1)&&(10!==r&&l++,this.bMarks.push(a),this.eMarks.push(l),this.tShift.push(u),d=!1,u=0,a=l+1)}this.bMarks.push(o.length),this.eMarks.push(o.length),this.tShift.push(0),this.lineMax=this.bMarks.length-1}function $e(e,t){var n,i,s;return(i=e.bMarks[t]+e.tShift[t])>=(s=e.eMarks[t])||42!==(n=e.src.charCodeAt(i++))&&45!==n&&43!==n||i<s&&32!==e.src.charCodeAt(i)?-1:i}function Qe(e,t){var n,i=e.bMarks[t]+e.tShift[t],s=e.eMarks[t];if(i+1>=s||((n=e.src.charCodeAt(i++))<48||n>57))return-1;for(;;){if(i>=s)return-1;if(!((n=e.src.charCodeAt(i++))>=48&&n<=57)){if(41===n||46===n)break;return-1}}return i<s&&32!==e.src.charCodeAt(i)?-1:i}Ze.prototype.process=function(e){var t,n,i;for(t=0,n=(i=this.ruler.getRules("")).length;t<n;t++)i[t](e)},Xe.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]},Xe.prototype.skipEmptyLines=function(e){for(var t=this.lineMax;e<t&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e},Xe.prototype.skipSpaces=function(e){for(var t=this.src.length;e<t&&32===this.src.charCodeAt(e);e++);return e},Xe.prototype.skipChars=function(e,t){for(var n=this.src.length;e<n&&this.src.charCodeAt(e)===t;e++);return e},Xe.prototype.skipCharsBack=function(e,t,n){if(e<=n)return e;for(;e>n;)if(t!==this.src.charCodeAt(--e))return e+1;return e},Xe.prototype.getLines=function(e,t,n,i){var s,r,o,a,l,c=e;if(e>=t)return"";if(c+1===t)return r=this.bMarks[c]+Math.min(this.tShift[c],n),o=i?this.eMarks[c]+1:this.eMarks[c],this.src.slice(r,o);for(a=new Array(t-e),s=0;c<t;c++,s++)(l=this.tShift[c])>n&&(l=n),l<0&&(l=0),r=this.bMarks[c]+l,o=c+1<t||i?this.eMarks[c]+1:this.eMarks[c],a[s]=this.src.slice(r,o);return a.join("")};var et={};["article","aside","button","blockquote","body","canvas","caption","col","colgroup","dd","div","dl","dt","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","iframe","li","map","object","ol","output","p","pre","progress","script","section","style","table","tbody","td","textarea","tfoot","th","tr","thead","ul","video"].forEach((function(e){et[e]=!0}));var tt=/^<([a-zA-Z]{1,15})[\s\/>]/,nt=/^<\/([a-zA-Z]{1,15})[\s>]/;function it(e,t){var n=e.bMarks[t]+e.blkIndent,i=e.eMarks[t];return e.src.substr(n,i-n)}function st(e,t){var n,i,s=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];return s>=r||126!==(i=e.src.charCodeAt(s++))&&58!==i||s===(n=e.skipSpaces(s))||n>=r?-1:n}var rt=[["code",function(e,t,n){var i,s;if(e.tShift[t]-e.blkIndent<4)return!1;for(s=i=t+1;i<n;)if(e.isEmpty(i))i++;else{if(!(e.tShift[i]-e.blkIndent>=4))break;s=++i}return e.line=i,e.tokens.push({type:"code",content:e.getLines(t,s,4+e.blkIndent,!0),block:!0,lines:[t,e.line],level:e.level}),!0}],["fences",function(e,t,n,i){var s,r,o,a,l,c=!1,u=e.bMarks[t]+e.tShift[t],d=e.eMarks[t];if(u+3>d||126!==(s=e.src.charCodeAt(u))&&96!==s||(l=u,(r=(u=e.skipChars(u,s))-l)<3)||(o=e.src.slice(u,d).trim()).indexOf("`")>=0)return!1;if(i)return!0;for(a=t;!(++a>=n||(u=l=e.bMarks[a]+e.tShift[a],d=e.eMarks[a],u<d&&e.tShift[a]<e.blkIndent));)if(!(e.src.charCodeAt(u)!==s||e.tShift[a]-e.blkIndent>=4||(u=e.skipChars(u,s),u-l<r||(u=e.skipSpaces(u),u<d)))){c=!0;break}return r=e.tShift[t],e.line=a+(c?1:0),e.tokens.push({type:"fence",params:o,content:e.getLines(t+1,a,r,!0),lines:[t,e.line],level:e.level}),!0},["paragraph","blockquote","list"]],["blockquote",function(e,t,n,i){var s,r,o,a,l,c,u,d,h,p,f,m=e.bMarks[t]+e.tShift[t],v=e.eMarks[t];if(m>v||62!==e.src.charCodeAt(m++)||e.level>=e.options.maxNesting)return!1;if(i)return!0;for(32===e.src.charCodeAt(m)&&m++,l=e.blkIndent,e.blkIndent=0,a=[e.bMarks[t]],e.bMarks[t]=m,r=(m=m<v?e.skipSpaces(m):m)>=v,o=[e.tShift[t]],e.tShift[t]=m-e.bMarks[t],d=e.parser.ruler.getRules("blockquote"),s=t+1;s<n&&!((m=e.bMarks[s]+e.tShift[s])>=(v=e.eMarks[s]));s++)if(62!==e.src.charCodeAt(m++)){if(r)break;for(f=!1,h=0,p=d.length;h<p;h++)if(d[h](e,s,n,!0)){f=!0;break}if(f)break;a.push(e.bMarks[s]),o.push(e.tShift[s]),e.tShift[s]=-1337}else 32===e.src.charCodeAt(m)&&m++,a.push(e.bMarks[s]),e.bMarks[s]=m,r=(m=m<v?e.skipSpaces(m):m)>=v,o.push(e.tShift[s]),e.tShift[s]=m-e.bMarks[s];for(c=e.parentType,e.parentType="blockquote",e.tokens.push({type:"blockquote_open",lines:u=[t,0],level:e.level++}),e.parser.tokenize(e,t,s),e.tokens.push({type:"blockquote_close",level:--e.level}),e.parentType=c,u[1]=e.line,h=0;h<o.length;h++)e.bMarks[h+t]=a[h],e.tShift[h+t]=o[h];return e.blkIndent=l,!0},["paragraph","blockquote","list"]],["hr",function(e,t,n,i){var s,r,o,a=e.bMarks[t],l=e.eMarks[t];if((a+=e.tShift[t])>l||42!==(s=e.src.charCodeAt(a++))&&45!==s&&95!==s)return!1;for(r=1;a<l;){if((o=e.src.charCodeAt(a++))!==s&&32!==o)return!1;o===s&&r++}return!(r<3)&&(i||(e.line=t+1,e.tokens.push({type:"hr",lines:[t,e.line],level:e.level})),!0)},["paragraph","blockquote","list"]],["list",function(e,t,n,i){var s,r,o,a,l,c,u,d,h,p,f,m,v,g,y,b,_,w,k,x,S,E=!0;if((d=Qe(e,t))>=0)m=!0;else{if(!((d=$e(e,t))>=0))return!1;m=!1}if(e.level>=e.options.maxNesting)return!1;if(f=e.src.charCodeAt(d-1),i)return!0;for(g=e.tokens.length,m?(u=e.bMarks[t]+e.tShift[t],p=Number(e.src.substr(u,d-u-1)),e.tokens.push({type:"ordered_list_open",order:p,lines:b=[t,0],level:e.level++})):e.tokens.push({type:"bullet_list_open",lines:b=[t,0],level:e.level++}),s=t,y=!1,w=e.parser.ruler.getRules("list");s<n&&((h=(v=e.skipSpaces(d))>=e.eMarks[s]?1:v-d)>4&&(h=1),h<1&&(h=1),r=d-e.bMarks[s]+h,e.tokens.push({type:"list_item_open",lines:_=[t,0],level:e.level++}),a=e.blkIndent,l=e.tight,o=e.tShift[t],c=e.parentType,e.tShift[t]=v-e.bMarks[t],e.blkIndent=r,e.tight=!0,e.parentType="list",e.parser.tokenize(e,t,n,!0),(!e.tight||y)&&(E=!1),y=e.line-t>1&&e.isEmpty(e.line-1),e.blkIndent=a,e.tShift[t]=o,e.tight=l,e.parentType=c,e.tokens.push({type:"list_item_close",level:--e.level}),s=t=e.line,_[1]=s,v=e.bMarks[t],!(s>=n||e.isEmpty(s)||e.tShift[s]<e.blkIndent));){for(S=!1,k=0,x=w.length;k<x;k++)if(w[k](e,s,n,!0)){S=!0;break}if(S)break;if(m){if((d=Qe(e,s))<0)break}else if((d=$e(e,s))<0)break;if(f!==e.src.charCodeAt(d-1))break}return e.tokens.push({type:m?"ordered_list_close":"bullet_list_close",level:--e.level}),b[1]=s,e.line=s,E&&function(e,t){var n,i,s=e.level+2;for(n=t+2,i=e.tokens.length-2;n<i;n++)e.tokens[n].level===s&&"paragraph_open"===e.tokens[n].type&&(e.tokens[n+2].tight=!0,e.tokens[n].tight=!0,n+=2)}(e,g),!0},["paragraph","blockquote"]],["footnote",function(e,t,n,i){var s,r,o,a,l,c=e.bMarks[t]+e.tShift[t],u=e.eMarks[t];if(c+4>u||91!==e.src.charCodeAt(c)||94!==e.src.charCodeAt(c+1)||e.level>=e.options.maxNesting)return!1;for(a=c+2;a<u;a++){if(32===e.src.charCodeAt(a))return!1;if(93===e.src.charCodeAt(a))break}return!(a===c+2||a+1>=u||58!==e.src.charCodeAt(++a))&&(i||(a++,e.env.footnotes||(e.env.footnotes={}),e.env.footnotes.refs||(e.env.footnotes.refs={}),l=e.src.slice(c+2,a-2),e.env.footnotes.refs[":"+l]=-1,e.tokens.push({type:"footnote_reference_open",label:l,level:e.level++}),s=e.bMarks[t],r=e.tShift[t],o=e.parentType,e.tShift[t]=e.skipSpaces(a)-a,e.bMarks[t]=a,e.blkIndent+=4,e.parentType="footnote",e.tShift[t]<e.blkIndent&&(e.tShift[t]+=e.blkIndent,e.bMarks[t]-=e.blkIndent),e.parser.tokenize(e,t,n,!0),e.parentType=o,e.blkIndent-=4,e.tShift[t]=r,e.bMarks[t]=s,e.tokens.push({type:"footnote_reference_close",level:--e.level})),!0)},["paragraph"]],["heading",function(e,t,n,i){var s,r,o,a=e.bMarks[t]+e.tShift[t],l=e.eMarks[t];if(a>=l||(35!==(s=e.src.charCodeAt(a))||a>=l))return!1;for(r=1,s=e.src.charCodeAt(++a);35===s&&a<l&&r<=6;)r++,s=e.src.charCodeAt(++a);return!(r>6||a<l&&32!==s)&&(i||(l=e.skipCharsBack(l,32,a),(o=e.skipCharsBack(l,35,a))>a&&32===e.src.charCodeAt(o-1)&&(l=o),e.line=t+1,e.tokens.push({type:"heading_open",hLevel:r,lines:[t,e.line],level:e.level}),a<l&&e.tokens.push({type:"inline",content:e.src.slice(a,l).trim(),level:e.level+1,lines:[t,e.line],children:[]}),e.tokens.push({type:"heading_close",hLevel:r,level:e.level})),!0)},["paragraph","blockquote"]],["lheading",function(e,t,n){var i,s,r,o=t+1;return!(o>=n||e.tShift[o]<e.blkIndent||e.tShift[o]-e.blkIndent>3||(s=e.bMarks[o]+e.tShift[o],r=e.eMarks[o],s>=r)||(i=e.src.charCodeAt(s),45!==i&&61!==i)||(s=e.skipChars(s,i),s=e.skipSpaces(s),s<r))&&(s=e.bMarks[t]+e.tShift[t],e.line=o+1,e.tokens.push({type:"heading_open",hLevel:61===i?1:2,lines:[t,e.line],level:e.level}),e.tokens.push({type:"inline",content:e.src.slice(s,e.eMarks[t]).trim(),level:e.level+1,lines:[t,e.line-1],children:[]}),e.tokens.push({type:"heading_close",hLevel:61===i?1:2,level:e.level}),!0)}],["htmlblock",function(e,t,n,i){var s,r,o,a=e.bMarks[t],l=e.eMarks[t],c=e.tShift[t];if(a+=c,!e.options.html||c>3||a+2>=l||60!==e.src.charCodeAt(a))return!1;if(33===(s=e.src.charCodeAt(a+1))||63===s){if(i)return!0}else{if(47!==s&&!function(e){var t=32|e;return t>=97&&t<=122}(s))return!1;if(47===s){if(!(r=e.src.slice(a,l).match(nt)))return!1}else if(!(r=e.src.slice(a,l).match(tt)))return!1;if(!0!==et[r[1].toLowerCase()])return!1;if(i)return!0}for(o=t+1;o<e.lineMax&&!e.isEmpty(o);)o++;return e.line=o,e.tokens.push({type:"htmlblock",level:e.level,lines:[t,e.line],content:e.getLines(t,o,0,!0)}),!0},["paragraph","blockquote"]],["table",function(e,t,n,i){var s,r,o,a,l,c,u,d,h,p,f;if(t+2>n||(l=t+1,e.tShift[l]<e.blkIndent)||(o=e.bMarks[l]+e.tShift[l])>=e.eMarks[l]||124!==(s=e.src.charCodeAt(o))&&45!==s&&58!==s||(r=it(e,t+1),!/^[-:| ]+$/.test(r))||(c=r.split("|"))<=2)return!1;for(d=[],a=0;a<c.length;a++){if(!(h=c[a].trim())){if(0===a||a===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(h))return!1;58===h.charCodeAt(h.length-1)?d.push(58===h.charCodeAt(0)?"center":"right"):58===h.charCodeAt(0)?d.push("left"):d.push("")}if(-1===(r=it(e,t).trim()).indexOf("|")||(c=r.replace(/^\||\|$/g,"").split("|"),d.length!==c.length))return!1;if(i)return!0;for(e.tokens.push({type:"table_open",lines:p=[t,0],level:e.level++}),e.tokens.push({type:"thead_open",lines:[t,t+1],level:e.level++}),e.tokens.push({type:"tr_open",lines:[t,t+1],level:e.level++}),a=0;a<c.length;a++)e.tokens.push({type:"th_open",align:d[a],lines:[t,t+1],level:e.level++}),e.tokens.push({type:"inline",content:c[a].trim(),lines:[t,t+1],level:e.level,children:[]}),e.tokens.push({type:"th_close",level:--e.level});for(e.tokens.push({type:"tr_close",level:--e.level}),e.tokens.push({type:"thead_close",level:--e.level}),e.tokens.push({type:"tbody_open",lines:f=[t+2,0],level:e.level++}),l=t+2;l<n&&!(e.tShift[l]<e.blkIndent||(r=it(e,l).trim(),-1===r.indexOf("|")));l++){for(c=r.replace(/^\||\|$/g,"").split("|"),e.tokens.push({type:"tr_open",level:e.level++}),a=0;a<c.length;a++)e.tokens.push({type:"td_open",align:d[a],level:e.level++}),u=c[a].substring(124===c[a].charCodeAt(0)?1:0,124===c[a].charCodeAt(c[a].length-1)?c[a].length-1:c[a].length).trim(),e.tokens.push({type:"inline",content:u,level:e.level,children:[]}),e.tokens.push({type:"td_close",level:--e.level});e.tokens.push({type:"tr_close",level:--e.level})}return e.tokens.push({type:"tbody_close",level:--e.level}),e.tokens.push({type:"table_close",level:--e.level}),p[1]=f[1]=l,e.line=l,!0},["paragraph"]],["deflist",function(e,t,n,i){var s,r,o,a,l,c,u,d,h,p,f,m,v,g;if(i)return!(e.ddIndent<0)&&st(e,t)>=0;if(u=t+1,e.isEmpty(u)&&++u>n||e.tShift[u]<e.blkIndent||(s=st(e,u))<0||e.level>=e.options.maxNesting)return!1;c=e.tokens.length,e.tokens.push({type:"dl_open",lines:l=[t,0],level:e.level++}),o=t,r=u;e:for(;;){for(g=!0,v=!1,e.tokens.push({type:"dt_open",lines:[o,o],level:e.level++}),e.tokens.push({type:"inline",content:e.getLines(o,o+1,e.blkIndent,!1).trim(),level:e.level+1,lines:[o,o],children:[]}),e.tokens.push({type:"dt_close",level:--e.level});;){if(e.tokens.push({type:"dd_open",lines:a=[u,0],level:e.level++}),m=e.tight,h=e.ddIndent,d=e.blkIndent,f=e.tShift[r],p=e.parentType,e.blkIndent=e.ddIndent=e.tShift[r]+2,e.tShift[r]=s-e.bMarks[r],e.tight=!0,e.parentType="deflist",e.parser.tokenize(e,r,n,!0),(!e.tight||v)&&(g=!1),v=e.line-r>1&&e.isEmpty(e.line-1),e.tShift[r]=f,e.tight=m,e.parentType=p,e.blkIndent=d,e.ddIndent=h,e.tokens.push({type:"dd_close",level:--e.level}),a[1]=u=e.line,u>=n||e.tShift[u]<e.blkIndent)break e;if((s=st(e,u))<0)break;r=u}if(u>=n||(o=u,e.isEmpty(o))||e.tShift[o]<e.blkIndent||(r=o+1)>=n||(e.isEmpty(r)&&r++,r>=n)||e.tShift[r]<e.blkIndent||(s=st(e,r))<0)break}return e.tokens.push({type:"dl_close",level:--e.level}),l[1]=u,e.line=u,g&&function(e,t){var n,i,s=e.level+2;for(n=t+2,i=e.tokens.length-2;n<i;n++)e.tokens[n].level===s&&"paragraph_open"===e.tokens[n].type&&(e.tokens[n+2].tight=!0,e.tokens[n].tight=!0,n+=2)}(e,c),!0},["paragraph"]],["paragraph",function(e,t){var n,i,s,r,o,a,l=t+1;if(l<(n=e.lineMax)&&!e.isEmpty(l))for(a=e.parser.ruler.getRules("paragraph");l<n&&!e.isEmpty(l);l++)if(!(e.tShift[l]-e.blkIndent>3)){for(s=!1,r=0,o=a.length;r<o;r++)if(a[r](e,l,n,!0)){s=!0;break}if(s)break}return i=e.getLines(t,l,e.blkIndent,!1).trim(),e.line=l,i.length&&(e.tokens.push({type:"paragraph_open",tight:!1,lines:[t,e.line],level:e.level}),e.tokens.push({type:"inline",content:i,level:e.level+1,lines:[t,e.line],children:[]}),e.tokens.push({type:"paragraph_close",tight:!1,level:e.level})),!0}]];function ot(){this.ruler=new Ae;for(var e=0;e<rt.length;e++)this.ruler.push(rt[e][0],rt[e][1],{alt:(rt[e][2]||[]).slice()})}ot.prototype.tokenize=function(e,t,n){for(var i,s=this.ruler.getRules(""),r=s.length,o=t,a=!1;o<n&&(e.line=o=e.skipEmptyLines(o),!(o>=n||e.tShift[o]<e.blkIndent));){for(i=0;i<r&&!s[i](e,o,n,!1);i++);if(e.tight=!a,e.isEmpty(e.line-1)&&(a=!0),(o=e.line)<n&&e.isEmpty(o)){if(a=!0,++o<n&&"list"===e.parentType&&e.isEmpty(o))break;e.line=o}}};var at=/[\n\t]/g,lt=/\r[\n\u0085]|[\u2424\u2028\u0085]/g,ct=/\u00a0/g;function ut(e){switch(e){case 10:case 92:case 96:case 42:case 95:case 94:case 91:case 93:case 33:case 38:case 60:case 62:case 123:case 125:case 36:case 37:case 64:case 126:case 43:case 61:case 58:return!0;default:return!1}}ot.prototype.parse=function(e,t,n,i){var s,r=0,o=0;if(!e)return[];(e=(e=e.replace(ct," ")).replace(lt,"\n")).indexOf("\t")>=0&&(e=e.replace(at,(function(t,n){var i;return 10===e.charCodeAt(n)?(r=n+1,o=0,t):(i="    ".slice((n-r-o)%4),o=n-r+1,i)}))),s=new Xe(e,this,t,n,i),this.tokenize(s,s.line,s.lineMax)};for(var dt=[],ht=0;ht<256;ht++)dt.push(0);function pt(e){return e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122}function ft(e,t){var n,i,s,r=t,o=!0,a=!0,l=e.posMax,c=e.src.charCodeAt(t);for(n=t>0?e.src.charCodeAt(t-1):-1;r<l&&e.src.charCodeAt(r)===c;)r++;return r>=l&&(o=!1),(s=r-t)>=4?o=a=!1:((32===(i=r<l?e.src.charCodeAt(r):-1)||10===i)&&(o=!1),(32===n||10===n)&&(a=!1),95===c&&(pt(n)&&(o=!1),pt(i)&&(a=!1))),{can_open:o,can_close:a,delims:s}}"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach((function(e){dt[e.charCodeAt(0)]=1}));var mt=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;var vt=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;var gt=["coap","doi","javascript","aaa","aaas","about","acap","cap","cid","crid","data","dav","dict","dns","file","ftp","geo","go","gopher","h323","http","https","iax","icap","im","imap","info","ipp","iris","iris.beep","iris.xpc","iris.xpcs","iris.lwz","ldap","mailto","mid","msrp","msrps","mtqp","mupdate","news","nfs","ni","nih","nntp","opaquelocktoken","pop","pres","rtsp","service","session","shttp","sieve","sip","sips","sms","snmp","soap.beep","soap.beeps","tag","tel","telnet","tftp","thismessage","tn3270","tip","tv","urn","vemmi","ws","wss","xcon","xcon-userid","xmlrpc.beep","xmlrpc.beeps","xmpp","z39.50r","z39.50s","adiumxtra","afp","afs","aim","apt","attachment","aw","beshare","bitcoin","bolo","callto","chrome","chrome-extension","com-eventbrite-attendee","content","cvs","dlna-playsingle","dlna-playcontainer","dtn","dvb","ed2k","facetime","feed","finger","fish","gg","git","gizmoproject","gtalk","hcp","icon","ipn","irc","irc6","ircs","itms","jar","jms","keyparc","lastfm","ldaps","magnet","maps","market","message","mms","ms-help","msnim","mumble","mvn","notes","oid","palm","paparazzi","platform","proxy","psyc","query","res","resource","rmi","rsync","rtmp","secondlife","sftp","sgn","skype","smb","soldat","spotify","ssh","steam","svn","teamspeak","things","udp","unreal","ut2004","ventrilo","view-source","webcal","wtai","wyciwyg","xfire","xri","ymsgr"],yt=/^<([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)>/,bt=/^<([a-zA-Z.\-]{1,25}):([^<>\x00-\x20]*)>/;function _t(e,t){return e=e.source,t=t||"",function n(i,s){return i?(s=s.source||s,e=e.replace(i,s),n):new RegExp(e,t)}}var wt=_t(/(?:unquoted|single_quoted|double_quoted)/)("unquoted",/[^"'=<>`\x00-\x20]+/)("single_quoted",/'[^']*'/)("double_quoted",/"[^"]*"/)(),kt=_t(/(?:\s+attr_name(?:\s*=\s*attr_value)?)/)("attr_name",/[a-zA-Z_:][a-zA-Z0-9:._-]*/)("attr_value",wt)(),xt=_t(/<[A-Za-z][A-Za-z0-9]*attribute*\s*\/?>/)("attribute",kt)(),St=_t(/^(?:open_tag|close_tag|comment|processing|declaration|cdata)/)("open_tag",xt)("close_tag",/<\/[A-Za-z][A-Za-z0-9]*\s*>/)("comment",/<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->/)("processing",/<[?].*?[?]>/)("declaration",/<![A-Z]+\s+[^>]*>/)("cdata",/<!\[CDATA\[[\s\S]*?\]\]>/)();var Et=/^&#((?:x[a-f0-9]{1,8}|[0-9]{1,8}));/i,Ct=/^&([a-z][a-z0-9]{1,31});/i;var Tt=[["text",function(e,t){for(var n=e.pos;n<e.posMax&&!ut(e.src.charCodeAt(n));)n++;return n!==e.pos&&(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}],["newline",function(e,t){var n,i,s=e.pos;if(10!==e.src.charCodeAt(s))return!1;if(n=e.pending.length-1,i=e.posMax,!t)if(n>=0&&32===e.pending.charCodeAt(n))if(n>=1&&32===e.pending.charCodeAt(n-1)){for(var r=n-2;r>=0;r--)if(32!==e.pending.charCodeAt(r)){e.pending=e.pending.substring(0,r+1);break}e.push({type:"hardbreak",level:e.level})}else e.pending=e.pending.slice(0,-1),e.push({type:"softbreak",level:e.level});else e.push({type:"softbreak",level:e.level});for(s++;s<i&&32===e.src.charCodeAt(s);)s++;return e.pos=s,!0}],["escape",function(e,t){var n,i=e.pos,s=e.posMax;if(92!==e.src.charCodeAt(i))return!1;if(++i<s){if((n=e.src.charCodeAt(i))<256&&0!==dt[n])return t||(e.pending+=e.src[i]),e.pos+=2,!0;if(10===n){for(t||e.push({type:"hardbreak",level:e.level}),i++;i<s&&32===e.src.charCodeAt(i);)i++;return e.pos=i,!0}}return t||(e.pending+="\\"),e.pos++,!0}],["backticks",function(e,t){var n,i,s,r,o,a=e.pos;if(96!==e.src.charCodeAt(a))return!1;for(n=a,a++,i=e.posMax;a<i&&96===e.src.charCodeAt(a);)a++;for(s=e.src.slice(n,a),r=o=a;-1!==(r=e.src.indexOf("`",o));){for(o=r+1;o<i&&96===e.src.charCodeAt(o);)o++;if(o-r===s.length)return t||e.push({type:"code",content:e.src.slice(a,r).replace(/[ \n]+/g," ").trim(),block:!1,level:e.level}),e.pos=o,!0}return t||(e.pending+=s),e.pos+=s.length,!0}],["del",function(e,t){var n,i,s,r,o,a=e.posMax,l=e.pos;if(126!==e.src.charCodeAt(l)||t||l+4>=a||126!==e.src.charCodeAt(l+1)||e.level>=e.options.maxNesting||(r=l>0?e.src.charCodeAt(l-1):-1,o=e.src.charCodeAt(l+2),126===r)||126===o||32===o||10===o)return!1;for(i=l+2;i<a&&126===e.src.charCodeAt(i);)i++;if(i>l+3)return e.pos+=i-l,t||(e.pending+=e.src.slice(l,i)),!0;for(e.pos=l+2,s=1;e.pos+1<a;){if(126===e.src.charCodeAt(e.pos)&&126===e.src.charCodeAt(e.pos+1)&&(r=e.src.charCodeAt(e.pos-1),126!==(o=e.pos+2<a?e.src.charCodeAt(e.pos+2):-1)&&126!==r&&(32!==r&&10!==r?s--:32!==o&&10!==o&&s++,s<=0))){n=!0;break}e.parser.skipToken(e)}return n?(e.posMax=e.pos,e.pos=l+2,t||(e.push({type:"del_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"del_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=a,!0):(e.pos=l,!1)}],["ins",function(e,t){var n,i,s,r,o,a=e.posMax,l=e.pos;if(43!==e.src.charCodeAt(l)||t||l+4>=a||43!==e.src.charCodeAt(l+1)||e.level>=e.options.maxNesting||(r=l>0?e.src.charCodeAt(l-1):-1,o=e.src.charCodeAt(l+2),43===r)||43===o||32===o||10===o)return!1;for(i=l+2;i<a&&43===e.src.charCodeAt(i);)i++;if(i!==l+2)return e.pos+=i-l,t||(e.pending+=e.src.slice(l,i)),!0;for(e.pos=l+2,s=1;e.pos+1<a;){if(43===e.src.charCodeAt(e.pos)&&43===e.src.charCodeAt(e.pos+1)&&(r=e.src.charCodeAt(e.pos-1),43!==(o=e.pos+2<a?e.src.charCodeAt(e.pos+2):-1)&&43!==r&&(32!==r&&10!==r?s--:32!==o&&10!==o&&s++,s<=0))){n=!0;break}e.parser.skipToken(e)}return n?(e.posMax=e.pos,e.pos=l+2,t||(e.push({type:"ins_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"ins_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=a,!0):(e.pos=l,!1)}],["mark",function(e,t){var n,i,s,r,o,a=e.posMax,l=e.pos;if(61!==e.src.charCodeAt(l)||t||l+4>=a||61!==e.src.charCodeAt(l+1)||e.level>=e.options.maxNesting||(r=l>0?e.src.charCodeAt(l-1):-1,o=e.src.charCodeAt(l+2),61===r)||61===o||32===o||10===o)return!1;for(i=l+2;i<a&&61===e.src.charCodeAt(i);)i++;if(i!==l+2)return e.pos+=i-l,t||(e.pending+=e.src.slice(l,i)),!0;for(e.pos=l+2,s=1;e.pos+1<a;){if(61===e.src.charCodeAt(e.pos)&&61===e.src.charCodeAt(e.pos+1)&&(r=e.src.charCodeAt(e.pos-1),61!==(o=e.pos+2<a?e.src.charCodeAt(e.pos+2):-1)&&61!==r&&(32!==r&&10!==r?s--:32!==o&&10!==o&&s++,s<=0))){n=!0;break}e.parser.skipToken(e)}return n?(e.posMax=e.pos,e.pos=l+2,t||(e.push({type:"mark_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"mark_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=a,!0):(e.pos=l,!1)}],["emphasis",function(e,t){var n,i,s,r,o,a,l,c=e.posMax,u=e.pos,d=e.src.charCodeAt(u);if(95!==d&&42!==d||t)return!1;if(n=(l=ft(e,u)).delims,!l.can_open)return e.pos+=n,t||(e.pending+=e.src.slice(u,e.pos)),!0;if(e.level>=e.options.maxNesting)return!1;for(e.pos=u+n,a=[n];e.pos<c;)if(e.src.charCodeAt(e.pos)!==d)e.parser.skipToken(e);else{if(i=(l=ft(e,e.pos)).delims,l.can_close){for(r=a.pop(),o=i;r!==o;){if(o<r){a.push(r-o);break}if(o-=r,0===a.length)break;e.pos+=r,r=a.pop()}if(0===a.length){n=r,s=!0;break}e.pos+=i;continue}l.can_open&&a.push(i),e.pos+=i}return s?(e.posMax=e.pos,e.pos=u+n,t||((2===n||3===n)&&e.push({type:"strong_open",level:e.level++}),(1===n||3===n)&&e.push({type:"em_open",level:e.level++}),e.parser.tokenize(e),(1===n||3===n)&&e.push({type:"em_close",level:--e.level}),(2===n||3===n)&&e.push({type:"strong_close",level:--e.level})),e.pos=e.posMax+n,e.posMax=c,!0):(e.pos=u,!1)}],["sub",function(e,t){var n,i,s=e.posMax,r=e.pos;if(126!==e.src.charCodeAt(r)||t||r+2>=s||e.level>=e.options.maxNesting)return!1;for(e.pos=r+1;e.pos<s;){if(126===e.src.charCodeAt(e.pos)){n=!0;break}e.parser.skipToken(e)}return!n||r+1===e.pos||(i=e.src.slice(r+1,e.pos)).match(/(^|[^\\])(\\\\)*\s/)?(e.pos=r,!1):(e.posMax=e.pos,e.pos=r+1,t||e.push({type:"sub",level:e.level,content:i.replace(mt,"$1")}),e.pos=e.posMax+1,e.posMax=s,!0)}],["sup",function(e,t){var n,i,s=e.posMax,r=e.pos;if(94!==e.src.charCodeAt(r)||t||r+2>=s||e.level>=e.options.maxNesting)return!1;for(e.pos=r+1;e.pos<s;){if(94===e.src.charCodeAt(e.pos)){n=!0;break}e.parser.skipToken(e)}return!n||r+1===e.pos||(i=e.src.slice(r+1,e.pos)).match(/(^|[^\\])(\\\\)*\s/)?(e.pos=r,!1):(e.posMax=e.pos,e.pos=r+1,t||e.push({type:"sup",level:e.level,content:i.replace(vt,"$1")}),e.pos=e.posMax+1,e.posMax=s,!0)}],["links",function(e,t){var n,i,s,r,o,a,l,c,u=!1,d=e.pos,h=e.posMax,p=e.pos,f=e.src.charCodeAt(p);if(33===f&&(u=!0,f=e.src.charCodeAt(++p)),91!==f||e.level>=e.options.maxNesting||(n=p+1,(i=Re(e,p))<0))return!1;if((a=i+1)<h&&40===e.src.charCodeAt(a)){for(a++;a<h&&(32===(c=e.src.charCodeAt(a))||10===c);a++);if(a>=h)return!1;for(p=a,Pe(e,a)?(r=e.linkContent,a=e.pos):r="",p=a;a<h&&(32===(c=e.src.charCodeAt(a))||10===c);a++);if(a<h&&p!==a&&De(e,a))for(o=e.linkContent,a=e.pos;a<h&&(32===(c=e.src.charCodeAt(a))||10===c);a++);else o="";if(a>=h||41!==e.src.charCodeAt(a))return e.pos=d,!1;a++}else{if(e.linkLevel>0)return!1;for(;a<h&&(32===(c=e.src.charCodeAt(a))||10===c);a++);if(a<h&&91===e.src.charCodeAt(a)&&(p=a+1,(a=Re(e,a))>=0?s=e.src.slice(p,a++):a=p-1),s||(w(s)>"u"&&(a=i+1),s=e.src.slice(n,i)),!(l=e.env.references[Ne(s)]))return e.pos=d,!1;r=l.href,o=l.title}return t||(e.pos=n,e.posMax=i,u?e.push({type:"image",src:r,title:o,alt:e.src.substr(n,i-n),level:e.level}):(e.push({type:"link_open",href:r,title:o,level:e.level++}),e.linkLevel++,e.parser.tokenize(e),e.linkLevel--,e.push({type:"link_close",level:--e.level}))),e.pos=a,e.posMax=h,!0}],["footnote_inline",function(e,t){var n,i,s,r,o=e.posMax,a=e.pos;return!(a+2>=o||94!==e.src.charCodeAt(a)||91!==e.src.charCodeAt(a+1)||e.level>=e.options.maxNesting||(n=a+2,i=Re(e,a+1),i<0))&&(t||(e.env.footnotes||(e.env.footnotes={}),e.env.footnotes.list||(e.env.footnotes.list=[]),s=e.env.footnotes.list.length,e.pos=n,e.posMax=i,e.push({type:"footnote_ref",id:s,level:e.level}),e.linkLevel++,r=e.tokens.length,e.parser.tokenize(e),e.env.footnotes.list[s]={tokens:e.tokens.splice(r)},e.linkLevel--),e.pos=i+1,e.posMax=o,!0)}],["footnote_ref",function(e,t){var n,i,s,r,o=e.posMax,a=e.pos;if(a+3>o||!e.env.footnotes||!e.env.footnotes.refs||91!==e.src.charCodeAt(a)||94!==e.src.charCodeAt(a+1)||e.level>=e.options.maxNesting)return!1;for(i=a+2;i<o;i++){if(32===e.src.charCodeAt(i)||10===e.src.charCodeAt(i))return!1;if(93===e.src.charCodeAt(i))break}return!(i===a+2||i>=o||(i++,n=e.src.slice(a+2,i-1),w(e.env.footnotes.refs[":"+n])>"u"))&&(t||(e.env.footnotes.list||(e.env.footnotes.list=[]),e.env.footnotes.refs[":"+n]<0?(s=e.env.footnotes.list.length,e.env.footnotes.list[s]={label:n,count:0},e.env.footnotes.refs[":"+n]=s):s=e.env.footnotes.refs[":"+n],r=e.env.footnotes.list[s].count,e.env.footnotes.list[s].count++,e.push({type:"footnote_ref",id:s,subId:r,level:e.level})),e.pos=i,e.posMax=o,!0)}],["autolink",function(e,t){var n,i,s,r,o,a=e.pos;return!(60!==e.src.charCodeAt(a)||(n=e.src.slice(a),n.indexOf(">")<0))&&((i=n.match(bt))?!(gt.indexOf(i[1].toLowerCase())<0||(r=i[0].slice(1,-1),o=Le(r),!e.parser.validateLink(r)))&&(t||(e.push({type:"link_open",href:o,level:e.level}),e.push({type:"text",content:r,level:e.level+1}),e.push({type:"link_close",level:e.level})),e.pos+=i[0].length,!0):!!(s=n.match(yt))&&(o=Le("mailto:"+(r=s[0].slice(1,-1))),!!e.parser.validateLink(o)&&(t||(e.push({type:"link_open",href:o,level:e.level}),e.push({type:"text",content:r,level:e.level+1}),e.push({type:"link_close",level:e.level})),e.pos+=s[0].length,!0)))}],["htmltag",function(e,t){var n,i,s,r=e.pos;return!(!e.options.html||(s=e.posMax,60!==e.src.charCodeAt(r)||r+2>=s)||(n=e.src.charCodeAt(r+1),33!==n&&63!==n&&47!==n&&!function(e){var t=32|e;return t>=97&&t<=122}(n))||(i=e.src.slice(r).match(St),!i))&&(t||e.push({type:"htmltag",content:e.src.slice(r,r+i[0].length),level:e.level}),e.pos+=i[0].length,!0)}],["entity",function(e,t){var n,i,s=e.pos,r=e.posMax;if(38!==e.src.charCodeAt(s))return!1;if(s+1<r)if(35===e.src.charCodeAt(s+1)){if(i=e.src.slice(s).match(Et))return t||(n="x"===i[1][0].toLowerCase()?parseInt(i[1].slice(1),16):parseInt(i[1],10),e.pending+=fe(n)?me(n):me(65533)),e.pos+=i[0].length,!0}else if(i=e.src.slice(s).match(Ct)){var o=ce(i[1]);if(i[1]!==o)return t||(e.pending+=o),e.pos+=i[0].length,!0}return t||(e.pending+="&"),e.pos++,!0}]];function Mt(){this.ruler=new Ae;for(var e=0;e<Tt.length;e++)this.ruler.push(Tt[e][0],Tt[e][1]);this.validateLink=At}function At(e){var t=e.trim().toLowerCase();return!(-1!==(t=be(t)).indexOf(":")&&-1!==["vbscript","javascript","file","data"].indexOf(t.split(":")[0]))}Mt.prototype.skipToken=function(e){var t,n,i=this.ruler.getRules(""),s=i.length,r=e.pos;if((n=e.cacheGet(r))>0)e.pos=n;else{for(t=0;t<s;t++)if(i[t](e,!0))return void e.cacheSet(r,e.pos);e.pos++,e.cacheSet(r,e.pos)}},Mt.prototype.tokenize=function(e){for(var t,n,i=this.ruler.getRules(""),s=i.length,r=e.posMax;e.pos<r;){for(n=0;n<s&&!(t=i[n](e,!1));n++);if(t){if(e.pos>=r)break}else e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()},Mt.prototype.parse=function(e,t,n,i){var s=new Ie(e,this,t,n,i);this.tokenize(s)};var It={default:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"\u201c\u201d\u2018\u2019",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","replacements","smartquotes","references","abbr2","footnote_tail"]},block:{rules:["blockquote","code","fences","footnote","heading","hr","htmlblock","lheading","list","paragraph","table"]},inline:{rules:["autolink","backticks","del","emphasis","entity","escape","footnote_ref","htmltag","links","newline","text"]}}},full:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"\u201c\u201d\u2018\u2019",highlight:null,maxNesting:20},components:{core:{},block:{},inline:{}}},commonmark:{options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"\u201c\u201d\u2018\u2019",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","abbr2"]},block:{rules:["blockquote","code","fences","heading","hr","htmlblock","lheading","list","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","htmltag","links","newline","text"]}}}};function Rt(e,t,n){this.src=t,this.env=n,this.options=e.options,this.tokens=[],this.inlineMode=!1,this.inline=e.inline,this.block=e.block,this.renderer=e.renderer,this.typographer=e.typographer}function Ot(e,t){"string"!=typeof e&&(t=e,e="default"),t&&null!=t.linkify&&console.warn("linkify option is removed. Use linkify plugin instead:\n\nimport Remarkable from 'remarkable';\nimport linkify from 'remarkable/linkify';\nnew Remarkable().use(linkify)\n"),this.inline=new Mt,this.block=new ot,this.core=new Ze,this.renderer=new Me,this.ruler=new Ae,this.options={},this.configure(It[e]),this.set(t||{})}Ot.prototype.set=function(e){de(this.options,e)},Ot.prototype.configure=function(e){var t=this;if(!e)throw new Error("Wrong `remarkable` preset, check name/content");e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach((function(n){e.components[n].rules&&t[n].ruler.enable(e.components[n].rules,!0)}))},Ot.prototype.use=function(e,t){return e(this,t),this},Ot.prototype.parse=function(e,t){var n=new Rt(this,e,t);return this.core.process(n),n.tokens},Ot.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)},Ot.prototype.parseInline=function(e,t){var n=new Rt(this,e,t);return n.inlineMode=!0,this.core.process(n),n.tokens},Ot.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)};var Lt=function(){function e(){k(this,e)}return S(e,null,[{key:"instantiate",value:function(t){if(t)return new Ot(b(b({},e.DEFAULT_PROPERTIES),t));if(window.hljs){var n=window.hljs;return new Ot({highlight:function(e,t){if(t&&n.getLanguage(t))try{return n.highlight(t,e).value}catch(i){console.error("failed to setup the highlight dependency")}try{return n.highlightAuto(e).value}catch(s){console.error("failed to automatically highlight messages")}return""},html:!1,xhtmlOut:!1,breaks:!0,langPrefix:"language-",linkTarget:"_blank",typographer:!0})}return new Ot(e.DEFAULT_PROPERTIES)}},{key:"createNew",value:function(t){var n=e.instantiate(t);return n.inline.validateLink=function(){return!0},n}}])}();Lt.DEFAULT_PROPERTIES={breaks:!0,linkTarget:"_blank"};var Pt=Lt,Dt=function(){function e(){k(this,e)}return S(e,null,[{key:"applyCustomStylesToElements",value:function(e,t,n){if(n&&(Object.assign(e.outerContainer.style,n.outerContainer),Object.assign(e.innerContainer.style,n.innerContainer),Object.assign(e.bubbleElement.style,n.bubble),t)){var i=e.bubbleElement.children[0],s="a"!==i.tagName.toLocaleLowerCase()?i:i.children[0];Object.assign(s.style,n.media)}}},{key:"applySideStyles",value:function(t,n,i,s){s&&(e.applyCustomStylesToElements(t,i,s.shared),n===Wt.USER_ROLE?e.applyCustomStylesToElements(t,i,s.user):(e.applyCustomStylesToElements(t,i,s.ai),e.applyCustomStylesToElements(t,i,s[n])))}},{key:"isElementsStyles",value:function(e){return!!(e.outerContainer||e.innerContainer||e.bubble||e.media)}},{key:"applyCustomStyles",value:function(t,n,i,s,r){var o;r&&t.default!==r?e.isElementsStyles(r)?(e.applyCustomStylesToElements(n,s,null==(o=t.default)?void 0:o.shared),e.applyCustomStylesToElements(n,s,r)):(e.applySideStyles(n,i,s,t.default),e.applySideStyles(n,i,s,r)):e.applySideStyles(n,i,s,t.default)}},{key:"extractParticularSharedStyles",value:function(e,t){if(null!=t&&t.shared){var n=t.shared,i={outerContainer:{},innerContainer:{},bubble:{},media:{}};return e.forEach((function(e){var t,s,r,o;i.outerContainer[e]=(null==(t=n.outerContainer)?void 0:t[e])||"",i.innerContainer[e]=(null==(s=n.innerContainer)?void 0:s[e])||"",i.bubble[e]=(null==(r=n.bubble)?void 0:r[e])||"",i.media[e]=(null==(o=n.media)?void 0:o[e])||""})),i}}}])}(),Nt=function(){return S((function e(){k(this,e)}),null,[{key:"onMessage",value:function(e,t,n){var i,s=JSON.parse(JSON.stringify({message:t,isHistory:n,isInitial:n}));Q.reAddFileRefToObject(t,s),null==(i=e.onMessage)||i.call(e,s),e.dispatchEvent(new CustomEvent("message",{detail:s})),ee.fireOnNewMessage(e,s)}},{key:"onClearMessages",value:function(e){var t;null==(t=e.onClearMessages)||t.call(e),e.dispatchEvent(new CustomEvent("clear-messages"))}},{key:"onRender",value:function(e){var t;null==(t=e.onComponentRender)||t.call(e,e),e.dispatchEvent(new CustomEvent("render",{detail:e}))}},{key:"onError",value:function(e,t){var n;null==(n=e.onError)||n.call(e,t),e.dispatchEvent(new CustomEvent("error",{detail:t}))}}])}(),zt=function(){function e(){k(this,e)}return S(e,null,[{key:"generateLoadingRingElement",value:function(){var e=document.createElement("div");return e.classList.add("loading-history"),e.appendChild(document.createElement("div")),e.appendChild(document.createElement("div")),e.appendChild(document.createElement("div")),e.appendChild(document.createElement("div")),e}},{key:"apply",value:function(e,t,n){X.setRing(t.bubbleElement,null==n?void 0:n.bubble),null!=n&&n.bubble&&delete(n=JSON.parse(JSON.stringify(n))).bubble,e.applyCustomStyles(t,"history",!1,n)}},{key:"addLoadHistoryMessage",value:function(t,n){var i,s,r,o,a,l,c,u,d=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t.bubbleElement.classList.add(e.CLASS);var h=d?e.FULL_VIEW_CLASS:e.SMALL_CLASS;t.outerContainer.classList.add(h);var p=d?null==(o=null==(r=null==(s=null==(i=n.messageStyles)?void 0:i.loading)?void 0:s.history)?void 0:r.full)?void 0:o.styles:null==(u=null==(c=null==(l=null==(a=n.messageStyles)?void 0:a.loading)?void 0:l.history)?void 0:c.small)?void 0:u.styles;e.apply(n,t,p),n.elementRef.prepend(t.outerContainer)}},{key:"createDefaultElements",value:function(t){var n=t.createMessageElements("",Wt.AI_ROLE),i=n.bubbleElement,s=e.generateLoadingRingElement();return i.appendChild(s),n}},{key:"addMessage",value:function(t){var n,i,s,r,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=null==(r=null==(s=null==(i=null==(n=t.messageStyles)?void 0:n.loading)?void 0:i.history)?void 0:s.full)?void 0:r.html,l=a?le.createElements(t,a,Wt.AI_ROLE,!0):e.createDefaultElements(t);return e.addLoadHistoryMessage(l,t,o),l}},{key:"tryChangeViewToSmall",value:function(t,n){var i,s,r,o,a,l,c,u;if(null!=n&&n.outerContainer.classList.contains(e.FULL_VIEW_CLASS)){n.outerContainer.classList.replace(e.FULL_VIEW_CLASS,e.SMALL_CLASS);var d=null==(o=null==(r=null==(s=null==(i=t.messageStyles)?void 0:i.loading)?void 0:s.history)?void 0:r.small)?void 0:o.styles;d&&e.apply(t,n,d);var h=null==(u=null==(c=null==(l=null==(a=t.messageStyles)?void 0:a.loading)?void 0:l.history)?void 0:c.small)?void 0:u.html;return h&&(n.bubbleElement.innerHTML=h),!0}return!1}},{key:"changeFullViewToSmall",value:function(t){var n=t.messageElementRefs[t.messageElementRefs.length-1];e.tryChangeViewToSmall(t,n)||e.tryChangeViewToSmall(t,t.messageElementRefs[0])}}])}();zt.CLASS="loading-history-message",zt.FULL_VIEW_CLASS="loading-history-message-full-view",zt.SMALL_CLASS="loading-history-message-small";var Bt=zt,Ft=function(){function e(t){var n=this;k(this,e),this.messageElementRefs=[],this.htmlClassUtilities={},this.messageToElements=[],this.elementRef=e.createContainerElement(),this.messageStyles=ee.processMessageStyles(t.messageStyles),this._remarkable=Pt.createNew(t.remarkable),this._avatars=t.avatars,this._names=t.names,this._onMessage=Nt.onMessage.bind(this,t),t.htmlClassUtilities&&(this.htmlClassUtilities=t.htmlClassUtilities),setTimeout((function(){n.submitUserMessage=t.submitUserMessage}))}return S(e,[{key:"addNewTextMessage",value:function(t,n,i){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(null!=i&&i.status){var r=this.overwriteText(n,t,this.messageElementRefs);if(r)return r;i.status=!1}var o=s?this.createAndPrependNewMessageElement(t,n,s):this.createAndAppendNewMessageElement(t,n);return o.bubbleElement.classList.add(e.TEXT_BUBBLE_CLASS),this.applyCustomStyles(o,n,!1),Wt.fillEmptyMessageElement(o.bubbleElement,t),o}},{key:"overwriteText",value:function(t,n,i){var s=Wt.overwriteMessage(this.messageToElements,i,n,t,"text",e.TEXT_BUBBLE_CLASS);return s&&this.renderText(s.bubbleElement,n),s}},{key:"createAndAppendNewMessageElement",value:function(e,t){var n=this,i=this.createNewMessageElement(e,t);return this.elementRef.appendChild(i.outerContainer),setTimeout((function(){return K.scrollToBottom(n.elementRef)})),i}},{key:"createAndPrependNewMessageElement",value:function(t,n,i){var s,r=this.createNewMessageElement(t,n,i);if(i&&null!=(s=this.elementRef.firstChild)&&s.classList.contains(e.INTRO_CLASS)){this.elementRef.firstChild.insertAdjacentElement("afterend",r.outerContainer);var o=this.messageElementRefs[0];this.messageElementRefs[0]=this.messageElementRefs[1],this.messageElementRefs[1]=o}else this.elementRef.insertBefore(r.outerContainer,this.elementRef.firstChild);return r}},{key:"createMessageElementsOnOrientation",value:function(e,t,n){return n?this.createAndPrependNewMessageElement(e,t,!0):this.createNewMessageElement(e,t)}},{key:"createNewMessageElement",value:function(t,n){var i,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];null==(i=this._introPanel)||i.hide();var r=this.messageElementRefs[this.messageElementRefs.length-1];return Bt.changeFullViewToSmall(this),e.isTemporaryElement(r)&&(this.revealRoleElementsIfTempRemoved(r,n),r.outerContainer.remove(),this.messageElementRefs.pop()),this.createMessageElements(t,n,s)}},{key:"revealRoleElementsIfTempRemoved",value:function(e,t){if((this._avatars||this._names)&&se.isElementTemporary(e)){var n=this.messageElementRefs[this.messageElementRefs.length-2];n&&this.messageToElements.length>0&&!e.bubbleElement.classList.contains(Wt.getRoleClass(t))&&Wt.revealRoleElements(n.innerContainer,this._avatars,this._names)}}},{key:"createElements",value:function(t,n){var i=e.createBaseElements(n),s=i.outerContainer,r=i.innerContainer,o=i.bubbleElement;return s.appendChild(r),this.addInnerContainerElements(o,t,n),i}},{key:"createMessageElements",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.createElements(e,t);return Wt.updateRefArr(this.messageElementRefs,i,n),Wt.classifyMessages(t,this.messageElementRefs),i}},{key:"addInnerContainerElements",value:function(e,t,n){var i;return(null==(i=this.messageToElements[this.messageToElements.length-1])?void 0:i[0].role)===n&&!this.isLastMessageError()&&Wt.hideRoleElements(this.messageElementRefs,!!this._avatars,!!this._names),e.classList.add("message-bubble",Wt.getRoleClass(n),n===Wt.USER_ROLE?"user-message-text":"ai-message-text"),this.renderText(e,t),Wt.addRoleElements(e,n,this._avatars,this._names),{bubbleElement:e}}},{key:"applyCustomStyles",value:function(e,t,n,i){e&&this.messageStyles&&Dt.applyCustomStyles(this.messageStyles,e,t,n,i)}},{key:"removeMessage",value:function(e){e.outerContainer.remove();var t=this.messageElementRefs.findIndex((function(t){return t===e}));this.messageElementRefs.splice(t,1)}},{key:"removeLastMessage",value:function(){this.messageElementRefs[this.messageElementRefs.length-1].outerContainer.remove(),this.messageElementRefs.pop()}},{key:"isLastMessageError",value:function(){var e;return null==(e=Wt.getLastMessageBubbleElement(this.elementRef))?void 0:e.classList.contains("error-message-text")}},{key:"sendClientUpdate",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null==(t=this._onMessage)||t.call(this,e,n)}},{key:"renderText",value:function(e,t){e.innerHTML=this._remarkable.render(t),0===e.innerText.trim().length&&(e.innerText=t)}},{key:"refreshTextMessages",value:function(e){var t=this;this._remarkable=Pt.createNew(e),this.messageToElements.forEach((function(e){e[1].text&&e[0].text&&t.renderText(e[1].text.bubbleElement,e[0].text)}))}}],[{key:"createContainerElement",value:function(){var e=document.createElement("div");return e.id="messages",e}},{key:"isTemporaryElement",value:function(t){return e.isLoadingMessage(t)||se.isElementTemporary(t)}},{key:"createBaseElements",value:function(e){var t=document.createElement("div"),n=document.createElement("div");n.classList.add("inner-message-container"),t.appendChild(n),t.classList.add("outer-message-container"),t.classList.add(Wt.buildRoleContainerClass(e));var i=document.createElement("div");return i.classList.add("message-bubble"),n.appendChild(i),{outerContainer:t,innerContainer:n,bubbleElement:i}}},{key:"createMessageContent",value:function(e){var t=e.text,n=e.files,i=e.html,s=e._sessionId,r={role:e.role||Wt.AI_ROLE};return t&&(r.text=t),n&&(r.files=n),i&&(r.html=i),!t&&!n&&!i&&(r.text=""),s&&(r._sessionId=s),r}},{key:"isLoadingMessage",value:function(e){return null==e?void 0:e.bubbleElement.classList.contains(X.BUBBLE_CLASS)}}])}();Ft.TEXT_BUBBLE_CLASS="text-message",Ft.INTRO_CLASS="deep-chat-intro";var Ut=Ft,jt=function(){function e(){k(this,e)}return S(e,null,[{key:"hide",value:function(t){var n;(n=t.getElementsByClassName(e.CONTAINER_CLASS)[0].style).visibility||(n.visibility="hidden")}},{key:"reveal",value:function(t){t.getElementsByClassName(e.CONTAINER_CLASS)[0].style.visibility=""}},{key:"applyCustomStylesToElements",value:function(e,t,n){Object.assign(e.style,n.container),Object.assign(t.style,n.avatar)}},{key:"applyCustomStyles",value:function(t,n,i,s){var r,o,a,l;if(null!=(r=i.default)&&r.styles&&e.applyCustomStylesToElements(t,n,i.default.styles),s===Wt.USER_ROLE)null!=(o=i.user)&&o.styles&&e.applyCustomStylesToElements(t,n,i.user.styles);else{null!=(a=i.ai)&&a.styles&&e.applyCustomStylesToElements(t,n,i.ai.styles);var c=null==(l=i[s])?void 0:l.styles;c&&e.applyCustomStylesToElements(t,n,c)}}},{key:"createAvatar",value:function(t,n){var i,s,r,o,a,l=document.createElement("img");t===Wt.USER_ROLE?l.src=(null==(i=null==n?void 0:n.user)?void 0:i.src)||(null==(s=null==n?void 0:n.default)?void 0:s.src)||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPoAAAD6CAMAAAC/MqoPAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAADNQTFRF////9vX18vLy/Pz86enp4+Li2tnZ1tbWzczM+fn57Ozs4N/f09LS0M/P5uXl7+/v3dzcwtncCAAAAAFiS0dEAIgFHUgAAAAJcEhZcwAAAEgAAABIAEbJaz4AAAZNSURBVHja7d3bdtsqEABQYABZSLH9/3+ZpnUsIcF5iOM6PfElNoMHMfPQdq3GmL0GkLhEUqLaUExnOtOZznSmM53pTGc605nOdKYznelMZzrTmV4LXSqllKyJDkob26xWq8Zae/iH0QoWTm9d1xur4WuypQJtTd+5dqn0VjcxzNO5/57mEBvdLo8Oron6aseWOjYOFkVvjQs3DmgyONMuht52EfztP+4hdu0i6LCO808/M8c1lE/fuPGej41uUzgdtoO/75N+2ELJ9I3b3//hPXbiMenm3pR/Jt4USgcLBIp4Bh10gqKVhvLo0klCxeSky96nKcj3siw6pJIL4XsoiQ7apyvMY/V3HHrSRioLopvEhSpTCn2TPEuwKYMOIX0tAxRBf/Hpa+lfSqBv9gi1FPsNfTrMAiVmIE/vJhz61FGnQxRIEYE4vfNYdN8Rp6MlHaHotHTn8ejekaZPAjEmyvQWdZFTtYTpXqCGJ0zvcek9Yfoel76nS0ffv1NMp1ca+pkgyfRCGind4L7OWWc605l+cxjsyhqy9AGbPpClc1/nvl5VX0c/3Alk6RU3+Am7shNZ+h6bvidLr7jBB+zKBrL0irOOudmIUDzTmf5gIP+iEuXtRuTVaEmY/oZLfyNMrzjryPc0gerMTdpVg0tvjJUU6bLPcGOoUv46SLL6Wi8yhLf06C7TUyekI0efRaaYqdFltkeNpPumRPSMDxgBYvSM035FrKAmH72hRW99PrpvSdEHkTEGUvSsK3yKVDkuJ92RohcZaehzzirPpOg+J92Tolfc4Cumx5xVXpGiZ34+ICX6W84qv5GiR5NPbiIpOv6BCoSvSkTX+eiaGP092zINvBOj4x8mSf9FqejvNo/cvpOji19ZbmviL0GPLsYMFzgzCor0+Bv/ePDvSJKOb9dJ5UlnbnEHiHgzv6cdTpJOWuc/u3FEucLDOL75xGtBiefrcwgoC9NDSH/jkH6pAuXmBqPQ9HSUPVdZBH1GGOrMXAQdYxcKZfxAoK+KKBKFLosoEoX+u4giUehz8jlcnAuhp78I46yDYNAd+QLR6K+pr+yvxdBTHyVDubQh0UfSxaHSd0lbvNkVRE87JGOtc+PQd2QLQ6fHhJkKsSh6yg13tO08JPprsgrrXWH0dJd2vH1MLPprot4eXoujpzrdhngiD40ek2y92lggPcnWa8qN1Yz0BFuvZhRl0uOfR0v4Ewuli/Bg4Qr3lArqGdndQ3UPO1EunXYwnelMZzrTmc50pjOd6UxnOtOZznSmM53pTGf6kuj6oedFKV0s3fX6sX1S3bsi6a4PD7+/YAqYeBw6pIB/4qEgOqxdSPbGiim4NRRCbzs3Jj0L4UfXtQXQVRfn5IdA/Bw7RZzurEV6EtdsLeGXkIPuA+K1UoVeA0l62zmN/LqfSSft9KkepmoRuvi3nd5uKNFB9zbbXEANqdr941XO0NJx2v2jdJenpf+/3bvn0ts16ph+sd6hX7dPo2+2cZzE02Ia43bzDHqr+2Evnhz74ZHU30ffbKOeng1/NPV30Ns1gYQnSP2P6e65Pfxc6h02XZqXQCjhJ6kPL6bFo4NrGvAU4UII4SE2P1vQuZkuOxckVfehisF1MjUddN/MZBN+kvq5uf0O/xa66gyNS9ktMWlz44rO1Z8C19i5FPdHzPamXn+F3hryPfxMr78+4F+kq22kO6Rf6fUQt+puuustyWv4rbG3l/duztFB96GYoe1cTBdXMr+nw9qVM6ZfxOvzezff0nXi/ZOndvrR6Zvpm0c3h6nhdb+5iS7tsIim/qXZD9+97/Jf+rpZ5BET1ayv0GUzLhEuhBBjIy/RdVPgndutIRt9nt7p5cKFEEJ3Z+jQFDZL+XnMDXxHB73gxn5s9Kc3d3/pFciFkN/QTSXHJpX5l66gDrkQoP6hL3xsPw39la4qOiV8tH78XeSbue6N9mvWa6J/ybpc1CT1Wnh5Qq9meP8IOKH3ddH7E/ri1iYux/SXDrXR4UiPdck/wUpU+FtPf6/orja6O9KL3l56LOvVxe5Ib2qjN0d6Vbex4ghWlU3bPqI90If66MNng680FNpbJijH6kCvaF3uMzQ3+IrpFerV4Y9dffQdN3im10ivbuImhD3Qq5u4HdZkua8znelMZ/pS4z9CPVKkxowNxgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNy0wMy0yN1QxNTo0NToxNSswMDowMN1xSg4AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTctMDMtMjdUMTU6NDU6MTUrMDA6MDCsLPKyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAABJRU5ErkJggg==":l.src=(null==(r=null==n?void 0:n[t])?void 0:r.src)||(null==(o=null==n?void 0:n.ai)?void 0:o.src)||(null==(a=null==n?void 0:n.default)?void 0:a.src)||"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='iso-8859-1'?%3e%3csvg%20fill='%23000000'%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0%200%2032%2032'%20xml:space='preserve'%3e%3cpath%20d='M23,30.36H9c-2.404,0-4.36-1.956-4.36-4.36V15c0-2.404,1.956-4.36,4.36-4.36h3.659%20c0.167-1.566,1.415-2.813,2.981-2.981V5.333c-1.131-0.174-2-1.154-2-2.333c0-1.301,1.059-2.36,2.36-2.36%20c1.302,0,2.36,1.059,2.36,2.36c0,1.179-0.869,2.159-2,2.333V7.66c1.566,0.167,2.814,1.415,2.981,2.981H23%20c2.404,0,4.36,1.956,4.36,4.36v11C27.36,28.404,25.404,30.36,23,30.36z%20M9,11.36c-2.007,0-3.64,1.633-3.64,3.64v11%20c0,2.007,1.633,3.64,3.64,3.64h14c2.007,0,3.64-1.633,3.64-3.64V15c0-2.007-1.633-3.64-3.64-3.64H9z%20M13.384,10.64h5.231%20C18.439,9.354,17.334,8.36,16,8.36C14.667,8.36,13.561,9.354,13.384,10.64z%20M16,1.36c-0.904,0-1.64,0.736-1.64,1.64%20S15.096,4.64,16,4.64c0.904,0,1.64-0.736,1.64-1.64S16.904,1.36,16,1.36z%20M20,27.36h-8c-1.301,0-2.36-1.059-2.36-2.36%20s1.059-2.36,2.36-2.36h8c1.302,0,2.36,1.059,2.36,2.36S21.302,27.36,20,27.36z%20M12,23.36c-0.904,0-1.64,0.735-1.64,1.64%20s0.736,1.64,1.64,1.64h8c0.904,0,1.64-0.735,1.64-1.64s-0.735-1.64-1.64-1.64H12z%20M31,23.86h-2c-0.199,0-0.36-0.161-0.36-0.36V15%20c0-0.199,0.161-0.36,0.36-0.36h2c0.199,0,0.36,0.161,0.36,0.36v8.5C31.36,23.699,31.199,23.86,31,23.86z%20M29.36,23.14h1.279v-7.78%20H29.36V23.14z%20M3,23.86H1c-0.199,0-0.36-0.161-0.36-0.36V15c0-0.199,0.161-0.36,0.36-0.36h2c0.199,0,0.36,0.161,0.36,0.36v8.5%20C3.36,23.699,3.199,23.86,3,23.86z%20M1.36,23.14h1.28v-7.78H1.36V23.14z%20M20,20.36c-1.302,0-2.36-1.059-2.36-2.36%20s1.059-2.36,2.36-2.36s2.36,1.059,2.36,2.36C22.36,19.302,21.302,20.36,20,20.36z%20M20,16.36c-0.904,0-1.64,0.736-1.64,1.64%20s0.735,1.64,1.64,1.64s1.64-0.735,1.64-1.64S20.904,16.36,20,16.36z%20M12,20.36c-1.301,0-2.36-1.059-2.36-2.36s1.059-2.36,2.36-2.36%20s2.36,1.059,2.36,2.36C14.36,19.302,13.301,20.36,12,20.36z%20M12,16.36c-0.904,0-1.64,0.736-1.64,1.64s0.736,1.64,1.64,1.64%20s1.64-0.735,1.64-1.64S12.904,16.36,12,16.36z'/%3e%3crect%20style='fill:none;'%20width='32'%20height='32'/%3e%3c/svg%3e",l.classList.add("avatar"),l.alt="".concat(t," avatar");var c=document.createElement("div");return c.classList.add(e.CONTAINER_CLASS),c.appendChild(l),n&&e.applyCustomStyles(c,l,n,t),c}},{key:"getPosition",value:function(e,t){var n,i,s,r,o,a,l,c,u,d=null==(o=null==(r=null==t?void 0:t[e])?void 0:r.styles)?void 0:o.position;return e!==Wt.USER_ROLE&&(null!==(n=d)&&void 0!==n||(d=null==(l=null==(a=null==t?void 0:t.ai)?void 0:a.styles)?void 0:l.position)),null!==(i=d)&&void 0!==i||(d=null==(u=null==(c=null==t?void 0:t.default)?void 0:c.styles)?void 0:u.position),null!==(s=d)&&void 0!==s||(d=e===Wt.USER_ROLE?"right":"left"),d}},{key:"add",value:function(t,n,i){var s="boolean"==typeof i?void 0:i,r=e.createAvatar(n,s),o=e.getPosition(n,s);r.classList.add("left"===o?"left-item-position":"right-item-position"),t.insertAdjacentElement("left"===o?"beforebegin":"afterend",r)}}])}();jt.CONTAINER_CLASS="avatar-container";var qt=jt,Vt=function(){function e(){k(this,e)}return S(e,null,[{key:"hide",value:function(t){var n;(n=t.getElementsByClassName(e.NAME_CLASS)[0].style).visibility||(n.visibility="hidden")}},{key:"reveal",value:function(t){t.getElementsByClassName(e.NAME_CLASS)[0].style.visibility=""}},{key:"getPosition",value:function(e,t){var n,i,s,r,o,a,l=null==(r=null==t?void 0:t[e])?void 0:r.position;return e!==Wt.USER_ROLE&&(null!==(n=l)&&void 0!==n||(l=null==(o=null==t?void 0:t.ai)?void 0:o.position)),null!==(i=l)&&void 0!==i||(l=null==(a=null==t?void 0:t.default)?void 0:a.position),null!==(s=l)&&void 0!==s||(l=e===Wt.USER_ROLE?"right":"left"),l}},{key:"applyStyle",value:function(e,t,n){var i,s,r,o;Object.assign(e.style,null==(i=n.default)?void 0:i.style),t===Wt.USER_ROLE?Object.assign(e.style,null==(s=n.user)?void 0:s.style):(Object.assign(e.style,null==(r=n.ai)?void 0:r.style),Object.assign(e.style,null==(o=n[t])?void 0:o.style))}},{key:"getNameText",value:function(e,t){var n,i,s,r,o,a;return e===Wt.USER_ROLE?(null==(n=t.user)?void 0:n.text)||(null==(i=t.default)?void 0:i.text)||"User":e===Wt.AI_ROLE?(null==(s=t.ai)?void 0:s.text)||(null==(r=t.default)?void 0:r.text)||"AI":(null==(o=t[e])?void 0:o.text)||(null==(a=t.default)?void 0:a.text)||e}},{key:"createName",value:function(t,n){var i=document.createElement("div");return i.classList.add(e.NAME_CLASS),i.textContent=e.getNameText(t,n),e.applyStyle(i,t,n),i}},{key:"add",value:function(t,n,i){var s="boolean"==typeof i?{}:i,r=e.createName(n,s),o=e.getPosition(n,s);r.classList.add("left"===o?"left-item-position":"right-item-position"),t.insertAdjacentElement("left"===o?"beforebegin":"afterend",r)}}])}();Vt.NAME_CLASS="name";var Ht=Vt,Gt=function(){function e(){k(this,e)}return S(e,null,[{key:"getLastElementsByClass",value:function(e,t,n){for(var i,s=function(){var i=e[r];if(i.bubbleElement.classList.contains(t[0])&&!t.slice(1).find((function(e){return!i.bubbleElement.classList.contains(e)}))){if(!n)return{v:i};if(!n.find((function(e){return i.bubbleElement.classList.contains(e)})))return{v:i}}},r=e.length-1;r>=0;r-=1)if(i=s())return i.v}},{key:"getLastMessage",value:function(e,t,n){for(var i=e.length-1;i>=0;i-=1)if(e[i][0].role===t){if(!n)return e[i][0];if(e[i][0][n])return e[i][0]}}},{key:"getLastTextToElement",value:function(e,t){for(var n=e.length-1;n>=0;n-=1)if(e[n][0]===t)return e[n]}},{key:"overwriteMessage",value:function(t,n,i,s,r,o){var a=e.getLastElementsByClass(n,[e.getRoleClass(s),o],[X.BUBBLE_CLASS]),l=e.getLastMessage(t,s,r);return l&&(l[r]=i),a}},{key:"getRoleClass",value:function(e){return"".concat(e,"-message")}},{key:"fillEmptyMessageElement",value:function(t,n){0===n.trim().length&&(t.classList.add(e.EMPTY_MESSAGE_CLASS),t.innerHTML='<div style="color:#00000000">.</div>')}},{key:"unfillEmptyMessageElement",value:function(t,n){t.classList.contains(e.EMPTY_MESSAGE_CLASS)&&n.trim().length>0&&t.replaceChildren()}},{key:"getLastMessageBubbleElement",value:function(t){var n,i,s;return Array.from((null==(s=null==(i=null==(n=e.getLastMessageElement(t))?void 0:n.children)?void 0:i[0])?void 0:s.children)||[]).find((function(e){return e.classList.contains("message-bubble")}))}},{key:"getLastMessageElement",value:function(e){return e.children[e.children.length-1]}},{key:"addRoleElements",value:function(e,t,n,i){n&&qt.add(e,t,n),i&&Ht.add(e,t,i)}},{key:"hideRoleElements",value:function(e,t,n){var i=e[e.length-1].innerContainer;t&&qt.hide(i),n&&Ht.hide(i)}},{key:"revealRoleElements",value:function(e,t,n){t&&qt.reveal(e),n&&Ht.reveal(e)}},{key:"updateRefArr",value:function(e,t,n){n?e.unshift(t):e.push(t)}},{key:"buildRoleContainerClass",value:function(e){return"deep-chat-".concat(e,"-container")}},{key:"addNewPositionClasses",value:function(t,n){var i;t.outerContainer.classList.remove(e.POSITION_TOP_MESSAGE_CLASS,e.POSITION_MIDDLE_MESSAGE_CLASS,e.POSITION_BOTTOM_MESSAGE_CLASS),(i=t.outerContainer.classList).add.apply(i,m(n))}},{key:"getNumberOfElements",value:function(e){var t=0;return void 0!==e.text&&(t+=1),void 0!==e.html&&(t+=1),e.files&&(t+=e.files.length),t}},{key:"filterdMessageElements",value:function(e,t){return e.filter((function(e){return e.bubbleElement.classList.contains(t)}))}},{key:"findMessageElements",value:function(e,t){return e.find((function(e){return e.bubbleElement.classList.contains(t)}))}},{key:"generateMessageBodyElements",value:function(t,n){var i={};return t.text&&(i.text=e.findMessageElements(n,Ut.TEXT_BUBBLE_CLASS)),t.html&&(i.html=e.findMessageElements(n,le.HTML_BUBBLE_CLASS)),t.files&&(i.files=e.filterdMessageElements(n,Q.FILE_BUBBLE_CLASS)),i}},{key:"generateMessageBody",value:function(t,n){var i=e.getNumberOfElements(t),s=n.slice(n.length-i);return e.generateMessageBodyElements(t,s)}},{key:"classifyMessages",value:function(t,n){var i=e.buildRoleContainerClass(t);n.forEach((function(t,s){var r=t.outerContainer.classList.contains(i),o=n[s-1],a=n[s+1],l=null==o?void 0:o.outerContainer.classList.contains(i),c=null==a?void 0:a.outerContainer.classList.contains(i);r&&(!l&&c?e.addNewPositionClasses(t,[e.POSITION_TOP_MESSAGE_CLASS]):l&&c?e.addNewPositionClasses(t,[e.POSITION_MIDDLE_MESSAGE_CLASS]):l&&!c?e.addNewPositionClasses(t,[e.POSITION_BOTTOM_MESSAGE_CLASS]):!l&&!c&&e.addNewPositionClasses(t,[e.POSITION_TOP_MESSAGE_CLASS,e.POSITION_BOTTOM_MESSAGE_CLASS]))}))}}])}();Gt.AI_ROLE="ai",Gt.USER_ROLE="user",Gt.EMPTY_MESSAGE_CLASS="empty-message",Gt.POSITION_TOP_MESSAGE_CLASS="deep-chat-top-message",Gt.POSITION_MIDDLE_MESSAGE_CLASS="deep-chat-middle-message",Gt.POSITION_BOTTOM_MESSAGE_CLASS="deep-chat-bottom-message";var Wt=Gt,Kt=function(){function e(t){k(this,e),this._fileAdded=!1,this._streamType="",this._hasStreamEnded=!1,this._messages=t}return S(e,[{key:"upsertStreamedMessage",value:function(e){var t;if(!this._hasStreamEnded){if(void 0===(null==e?void 0:e.text)&&void 0===(null==e?void 0:e.html))return console.error(G.INVALID_STREAM_EVENT);var n=(null==e?void 0:e.text)||(null==e?void 0:e.html)||"",i=K.isScrollbarAtBottomOfElement(this._messages.elementRef),s=void 0!==(null==e?void 0:e.text)?"text":"html";if(this._elements||this._message){if(this._streamType!==s)return console.error(G.INVALID_STREAM_EVENT_MIX);this.updateBasedOnType(n,s,null==(t=this._elements)?void 0:t.bubbleElement,null==e?void 0:e.overwrite)}else this.setInitialState(s,n,null==e?void 0:e.role);i&&K.scrollToBottom(this._messages.elementRef)}}},{key:"setInitialState",value:function(t,n,i){var s;this._streamType=t,null!==(s=i)&&void 0!==s||(i=Wt.AI_ROLE),this._elements="text"===t?this._messages.addNewTextMessage(n,i):le.add(this._messages,n,i,this._messages.messageElementRefs),this._elements.bubbleElement.classList.add(e.MESSAGE_CLASS),this._activeMessageRole=i,this._message=_({role:this._activeMessageRole},t,n),this._messages.messageToElements.push([this._message,_({},t,this._elements)])}},{key:"updateBasedOnType",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Wt.unfillEmptyMessageElement(n,e),("text"===t?this.updateText:this.updateHTML).bind(this)(e,n,i)}},{key:"updateText",value:function(e,t,n){this._message&&(this._message.text=n?e:this._message.text+e,this._messages.renderText(t,this._message.text))}},{key:"updateHTML",value:function(e,t,n){if(this._message)if(n)this._message.html=e,t.innerHTML=e;else{var i=document.createElement("span");i.innerHTML=e,t.appendChild(i),this._message.html=(null==t?void 0:t.innerHTML)||""}}},{key:"finaliseStreamedMessage",value:function(){var t;if(!this._endStreamAfterOperation&&this._message&&(!this._fileAdded||this._elements)){if(!this._elements)throw Error(G.NO_VALID_STREAM_EVENTS_SENT);null!=(t=this._elements.bubbleElement)&&t.classList.contains(e.MESSAGE_CLASS)&&("text"===this._streamType?this._messages.textToSpeech&&Y.speak(this._message.text||"",this._messages.textToSpeech):"html"===this._streamType&&this._elements&&re.apply(this._messages,this._elements.outerContainer),this._elements.bubbleElement.classList.remove(e.MESSAGE_CLASS),this._message&&this._messages.sendClientUpdate(Ut.createMessageContent(this._message),!1),this._hasStreamEnded=!0)}}},{key:"markFileAdded",value:function(){this._fileAdded=!0}},{key:"newMessage",value:function(){this.finaliseStreamedMessage(),this._elements=void 0,delete this._message,this._fileAdded=!1,this._hasStreamEnded=!1,this._activeMessageRole=void 0}},{key:"endStreamAfterFileDownloaded",value:(t=f(h().mark((function e(t,n){var i,s,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._endStreamAfterOperation=!0,e.next=3,n();case 3:s=e.sent,r=s.text,o=s.files,r&&this.updateBasedOnType(r,"text",null==(i=this._elements)?void 0:i.bubbleElement,!0),this._endStreamAfterOperation=!1,this.finaliseStreamedMessage(),o&&t.addNewMessage({files:o});case 7:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]);var t}();Kt.MESSAGE_CLASS="streamed-message";var Jt=Kt,Yt=function(){function e(){k(this,e)}return S(e,null,[{key:"tempRemoveContentHeader",value:(n=f(h().mark((function t(n,i,s){var r,o;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=n&&n.headers){t.next=2;break}throw new Error("Request settings have not been set up");case 2:return r=n.headers[e.CONTENT_TYPE],delete n.headers[e.CONTENT_TYPE],t.prev=4,t.next=7,i(s);case 7:o=t.sent,t.next=13;break;case 10:throw t.prev=10,t.t0=t.catch(4),n.headers[e.CONTENT_TYPE]=r,t.t0;case 13:return t.abrupt("return",(n.headers[e.CONTENT_TYPE]=r,o));case 14:case"end":return t.stop()}}),t,null,[[4,10]])}))),function(e,t,i){return n.apply(this,arguments)})},{key:"displayError",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Service error, please try again.";if(console.error(t),"object"==w(t))return t instanceof Error?e.addNewErrorMessage("service",t.message):Array.isArray(t)||"string"==typeof t.error?e.addNewErrorMessage("service",t):0===Object.keys(t).length?e.addNewErrorMessage("service",n):e.addNewErrorMessage("service",JSON.stringify(t));e.addNewErrorMessage("service",t)}},{key:"fetch",value:function(e){function t(t,n,i,s){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n,i){var s,r,o={method:(null==(s=e.connectSettings)?void 0:s.method)||"POST",headers:t};return"GET"!==o.method&&(o.body=n?JSON.stringify(i):i),e.connectSettings.credentials&&(o.credentials=e.connectSettings.credentials),fetch((null==(r=e.connectSettings)?void 0:r.url)||e.url||"",o)}))},{key:"processResponseByType",value:function(e){var t=e.headers.get("content-type");return null!=t&&t.includes("application/json")?e.json():null!=t&&t.includes("text/plain")||!t?e:e.blob()}},{key:"processRequestInterceptor",value:(t=f(h().mark((function e(t,n){var i,s,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(i=t.requestInterceptor)?void 0:i.call(t,n);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=n;case 5:return s=e.t0,r=s,o=s,e.abrupt("return",{body:r.body,headers:r.headers,error:o.error});case 9:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},{key:"validateResponseFormat",value:function(e){return e&&"object"==w(e)&&("string"==typeof e.error||"string"==typeof e.text||"string"==typeof e.html||Array.isArray(e.files))}},{key:"onInterceptorError",value:function(e,t,n){e.addNewErrorMessage("service",t),null==n||n()}}]);var t,n}();Yt.CONTENT_TYPE="Content-Type";var Zt=Yt;function Xt(e,t){return $t.apply(this,arguments)}function $t(){return $t=f(h().mark((function e(t,n){var i,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=t.getReader();case 1:return e.next=3,i.read();case 3:if((s=e.sent).done){e.next=7;break}n(s.value);case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e)}))),$t.apply(this,arguments)}function Qt(e){var t,n,i,s=!1;return function(r){void 0===t?(t=r,n=0,i=-1):t=function(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(t,r);for(var o=t.length,a=0;n<o;){s&&(10===t[n]&&(a=++n),s=!1);for(var l=-1;n<o&&-1===l;++n)switch(t[n]){case 58:-1===i&&(i=n-a);break;case 13:s=!0;case 10:l=n}if(-1===l)break;e(t.subarray(a,l),i),a=n,i=-1}a===o?t=void 0:0!==a&&(t=t.subarray(a),n-=a)}}function en(e,t,n){var i={data:"",event:"",id:"",retry:void 0},s=new TextDecoder;return function(r,o){if(0===r.length)null==n||n(i),i={data:"",event:"",id:"",retry:void 0};else if(o>0){var a=s.decode(r.subarray(0,o)),l=o+(32===r[o+1]?2:1),c=s.decode(r.subarray(l));switch(a){case"data":i.data=i.data?i.data+"\n"+c:c;break;case"event":i.event=c;break;case"id":e(i.id=c);break;case"retry":var u=parseInt(c,10);isNaN(u)||t(i.retry=u)}}}}var tn="text/event-stream",nn="last-event-id";function sn(e,t){var n=t.signal,i=t.headers,s=t.onopen,r=t.onmessage,o=t.onclose,a=t.onerror,l=t.openWhenHidden,c=t.fetch,u=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n}(t,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise((function(t,d){var p,m=Object.assign({},i);function v(){p.abort(),document.hidden||k()}m.accept||(m.accept=tn),l||document.addEventListener("visibilitychange",v);var g=1e3,y=0;function b(){document.removeEventListener("visibilitychange",v),window.clearTimeout(y),p.abort()}null==n||n.addEventListener("abort",(function(){b(),t()}));var _=null!=c?c:window.fetch,w=null!=s?s:rn;function k(){return x.apply(this,arguments)}function x(){return(x=f(h().mark((function n(){var i,s,l;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return p=new AbortController,n.prev=1,n.next=4,_(e,Object.assign(Object.assign({},u),{headers:m,signal:p.signal}));case 4:return s=n.sent,n.next=7,w(s);case 7:return n.next=9,Xt(s.body,Qt(en((function(e){e?m[nn]=e:delete m[nn]}),(function(e){g=e}),r)));case 9:null==o||o(),b(),t(),n.next=17;break;case 14:if(n.prev=14,n.t0=n.catch(1),!p.signal.aborted)try{l=null!==(i=null==a?void 0:a(n.t0))&&void 0!==i?i:g,window.clearTimeout(y),y=window.setTimeout(k,l)}catch(l){b(),d(l)}case 17:case"end":return n.stop()}}),n,null,[[1,14]])})))).apply(this,arguments)}k()}))}function rn(e){var t=e.headers.get("content-type");if(null==t||!t.startsWith(tn))throw new Error("Expected content-type to be ".concat(tn,", Actual: ").concat(t))}var on=function(){function e(){k(this,e)}return S(e,null,[{key:"request",value:(t=f(h().mark((function t(n,i,s){var r,o,a,l,c,u,d,p,m,v,g,y,b,_,w,k,x,S,E,C=arguments;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=!(C.length>3&&void 0!==C[3])||C[3],o=C.length>4&&void 0!==C[4]&&C[4],m={body:i,headers:null==(a=n.connectSettings)?void 0:a.headers},t.next=5,Zt.processRequestInterceptor(n.deepChat,m);case 5:if(v=t.sent,g=v.body,y=v.headers,b=v.error,_=n.streamHandlers,w=_.onOpen,k=_.onClose,x=_.abortStream,!b){t.next=15;break}return t.abrupt("return",Zt.onInterceptorError(s,b,k));case 15:if(null==(l=n.connectSettings)||!l.handler){t.next=17;break}return t.abrupt("return",un.stream(n,g,s));case 17:if((null==(c=n.connectSettings)?void 0:c.url)!==ln.URL){t.next=19;break}return t.abrupt("return",ln.requestStream(s,n.streamHandlers));case 19:return S=new Jt(s),E=Zt.fetch.bind(this,n,y,r),t.abrupt("return",(sn((null==(u=n.connectSettings)?void 0:u.url)||n.url||"",{method:(null==(d=n.connectSettings)?void 0:d.method)||"POST",headers:y,credentials:null==(p=n.connectSettings)?void 0:p.credentials,body:r?JSON.stringify(g):g,openWhenHidden:!0,onopen:function(e){return f(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.ok){t.next=2;break}return t.abrupt("return",w());case 2:return t.next=4,Zt.processResponseByType(e);case 4:throw t.sent;case 5:case"end":return t.stop()}}),t)})))()},onmessage:function(t){return f(h().mark((function i(){var r,o,a,l,c;return h().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(JSON.stringify(t.data)===JSON.stringify("[DONE]")){i.next=9;break}try{l=JSON.parse(t.data)}catch(u){l={}}return i.next=4,null==(o=(r=n.deepChat).responseInterceptor)?void 0:o.call(r,l);case 4:if(i.t0=i.sent,i.t0){i.next=7;break}i.t0=l;case 7:c=i.t0,null==(a=n.extractResultData)||a.call(n,c,E,g).then((function(t){n.asyncCallInProgress&&t&&""!==t.text?(e.simulate(s,n.streamHandlers,t),k(),n.asyncCallInProgress=!1):e.upsertWFiles(s,S.upsertStreamedMessage.bind(S),S,t)})).catch((function(e){return Zt.displayError(s,e)}));case 9:case"end":return i.stop()}}),i)})))()},onerror:function(e){throw k(),e},onclose:function(){if(!n.asyncCallInProgress)try{S.finaliseStreamedMessage(),k()}catch(e){if(!o)throw e}},signal:x.signal}).catch((function(e){var t;s.isLastMessageError()||null==(t=n.extractResultData)||t.call(n,e).then((function(){Zt.displayError(s,e)})).catch((function(e){Zt.displayError(s,e)}))})),S));case 21:case"end":return t.stop()}}),t,this)}))),function(e,n,i){return t.apply(this,arguments)})},{key:"simulate",value:function(t,n,i){var s=n;if(i.files&&t.addNewMessage(b({sendUpdate:!1,ignoreText:!0},i),!1),i.text){n.onOpen();var r=i.text.split("");e.populateMessages(r,new Jt(t),s,"text")}if(i.html){n.onOpen();var o=re.splitHTML(i.html);0===o.length&&(o=i.html.split("")),e.populateMessages(o,new Jt(t),s,"html")}}},{key:"populateMessages",value:function(t,n,i,s){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=t[r];if(o){n.upsertStreamedMessage(_({},s,o));var a=setTimeout((function(){e.populateMessages(t,n,i,s,r+1)}),i.simulationInterim||6);i.abortStream.abort=function(){e.abort(a,n,i.onClose)}}else n.finaliseStreamedMessage(),i.onClose()}},{key:"isSimulation",value:function(e){return"object"==w(e)&&!!e.simulation}},{key:"isSimulatable",value:function(t,n){return e.isSimulation(t)&&n&&(n.text||n.html)}},{key:"abort",value:function(e,t,n){clearTimeout(e),t.finaliseStreamedMessage(),n()}},{key:"upsertWFiles",value:function(e,t,n,i){if(null!=i&&i.text||null!=i&&i.html){var s,r=t(i);null!==(s=n)&&void 0!==s||(n=r||void 0)}null!=i&&i.files&&(e.addNewMessage({files:i.files}),null==n||n.markFileAdded())}}]);var t}(),an=function(){function e(){k(this,e)}return S(e,null,[{key:"generateResponse",value:function(e){var t=e[e.length-1][0];if(t.files&&t.files.length>0){if(t.files.length>1)return"These are interesting files!";var n=t.files[0];return n.src&&n.src.startsWith("data:image/gif")?"That is a nice gif!":"image"===n.type?"That is a nice image!":"audio"===n.type?"I like the sound of that!":"That is an interesting file!"}if(t.text){if("?"===t.text.charAt(t.text.length-1))return"I'm sorry but I can't answer that question...";if(t.text.includes("updog"))return"What's updog?"}return"Hi there! This is a demo response!"}},{key:"getCustomResponse",value:function(e,t){return"function"==typeof e?e(t):e}},{key:"getResponse",value:function(t){var n=t.customDemoResponse,i=t.messageToElements;return n?e.getCustomResponse(n,i[i.length-1][0]):{text:e.generateResponse(i)}}},{key:"request",value:function(t,n){var i=e.getResponse(n);setTimeout(f(h().mark((function e(){var s,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=(s=t.deepChat).responseInterceptor)?void 0:r.call(s,i);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=i;case 5:(o=e.t0).error?(n.addNewErrorMessage("service",o.error),t.completionsHandlers.onFinish()):on.isSimulatable(t.stream,o)?on.simulate(n,t.streamHandlers,o):(n.addNewMessage(o),t.completionsHandlers.onFinish());case 7:case"end":return e.stop()}}),e)}))),400)}},{key:"requestStream",value:function(t,n){setTimeout((function(){var i=e.getResponse(t);on.simulate(t,n,i)}),400)}}])}();an.URL="deep-chat-demo";var ln=an,cn=function(){function e(){k(this,e)}return S(e,null,[{key:"setup",value:function(e){e.connectSettings.url!==ln.URL&&(e.permittedErrorPrefixes=["Connection error","Error in server message"],e.websocket="pending")}},{key:"isElementPresentInDOM",value:function(e){return e.getRootNode({composed:!0})instanceof Document}},{key:"createConnection",value:function(t,n){if(e.isElementPresentInDOM(t.deepChat)){var i=t.connectSettings.websocket;if(i){if(t.connectSettings.handler)return un.websocket(t,n);try{var s="boolean"!=typeof i?i:void 0,r=new WebSocket(t.connectSettings.url||"",s);t.websocket=r,t.websocket.onopen=function(){var i,s;n.removeError(),t.websocket&&"object"==w(t.websocket)&&e.assignListeners(t,r,n),null==(s=(i=t.deepChat)._validationHandler)||s.call(i)},t.websocket.onerror=function(i){console.error(i),e.retryConnection(t,n)}}catch(s){console.error(s),e.retryConnection(t,n)}}}}},{key:"retryConnection",value:function(t,n){var i,s;null==(s=(i=t.deepChat)._validationHandler)||s.call(i),e.isElementPresentInDOM(t.deepChat)&&(t.websocket="pending",n.isLastMessageError()||n.addNewErrorMessage("service","Connection error"),setTimeout((function(){e.createConnection(t,n)}),5e3))}},{key:"assignListeners",value:function(t,n,i){var s=this,r={};n.onmessage=function(){var n=f(h().mark((function n(o){var a,l,c,u,d,p,f;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.extractResultData){n.next=20;break}return n.prev=1,c=JSON.parse(o.data),n.next=5,null==(l=(a=t.deepChat).responseInterceptor)?void 0:l.call(a,c);case 5:if(n.t0=n.sent,n.t0){n.next=8;break}n.t0=c;case 8:return u=n.t0,n.next=11,t.extractResultData(u);case 11:if((d=n.sent)&&"object"==w(d)){n.next=14;break}throw Error(G.INVALID_RESPONSE(c,"server",!!t.deepChat.responseInterceptor,u));case 14:on.isSimulation(t.stream)?(p=e.stream.bind(s,t,i,r),f=r[c.role||Wt.AI_ROLE],on.upsertWFiles(i,p,f,d)):i.addNewMessage(d),n.next=20;break;case 17:n.prev=17,n.t1=n.catch(1),Zt.displayError(i,n.t1,"Error in server message");case 20:case"end":return n.stop()}}),n,null,[[1,17]])})));return function(e){return n.apply(this,arguments)}}(),n.onclose=function(){console.error("Connection closed"),i.isLastMessageError()||i.addNewErrorMessage("service","Connection error"),t.stream&&t.streamHandlers.abortStream.abort(),e.createConnection(t,i)}}},{key:"sendWebsocket",value:(t=f(h().mark((function t(n,i,s){var r,o,a,l,c,u,d,p,f,m=arguments;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=!(m.length>3&&void 0!==m[3])||m[3],(l=n.websocket)&&"pending"!==l){t.next=4;break}return t.abrupt("return");case 4:return c={body:i,headers:null==(o=n.connectSettings)?void 0:o.headers},t.next=7,Zt.processRequestInterceptor(n.deepChat,c);case 7:if(u=t.sent,d=u.body,!(p=u.error)){t.next=12;break}return t.abrupt("return",s.addNewErrorMessage("service",p));case 12:if(e.isWebSocket(l)){t.next=14;break}return t.abrupt("return",l.newUserMessage.listener(d));case 14:if(f=r?JSON.stringify(d):d,(null==(a=n.connectSettings)?void 0:a.url)!==ln.URL){t.next=17;break}return t.abrupt("return",ln.request(n,s));case 17:void 0===l.readyState||l.readyState!==l.OPEN?(console.error("Connection is not open"),s.isLastMessageError()||s.addNewErrorMessage("service","Connection error")):(l.send(JSON.stringify(f)),n.completionsHandlers.onFinish());case 18:case"end":return t.stop()}}),t)}))),function(e,n,i){return t.apply(this,arguments)})},{key:"canSendMessage",value:function(t){return!t||"pending"!==t&&(e.isWebSocket(t)?void 0!==t.readyState&&t.readyState===t.OPEN:t.isOpen)}},{key:"isWebSocket",value:function(e){return void 0!==e.send}},{key:"stream",value:function(e,t,n,i){if(i){var s=e.stream.simulation;if("string"==typeof s){var r,o=i.role||Wt.AI_ROLE,a=n[o];i.text===s||i.html===s?(null==a||a.finaliseStreamedMessage(),delete n[o]):(null!==(r=n[o])&&void 0!==r||(n[o]=new Jt(t)),n[o].upsertStreamedMessage(i))}else on.simulate(t,e.streamHandlers,i)}}}]);var t}(),un=function(){function e(){k(this,e)}return S(e,null,[{key:"request",value:(t=f(h().mark((function t(n,i,s){var r,o,a,l,c;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=!0,l=function(){var e=f(h().mark((function e(t){var i,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return a=!1,e.next=5,null==(r=(i=n.deepChat).responseInterceptor)?void 0:r.call(i,t);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0=t;case 8:o=e.t0,Zt.validateResponseFormat(o)?"string"==typeof o.error?(console.error(o.error),s.addNewErrorMessage("service",o.error),n.completionsHandlers.onFinish()):on.isSimulatable(n.stream,o)?on.simulate(s,n.streamHandlers,o):(s.addNewMessage(o),n.completionsHandlers.onFinish()):(console.error(G.INVALID_RESPONSE(t,"server",!!n.deepChat.responseInterceptor,o)),s.addNewErrorMessage("service","Error in server message"),n.completionsHandlers.onFinish());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=e.generateOptionalSignals(),null==(o=(r=n.connectSettings).handler)||o.call(r,i,b(b({},c),{},{onResponse:l}));case 3:case"end":return t.stop()}}),t)}))),function(e,n,i){return t.apply(this,arguments)})},{key:"attemptToFinaliseStream",value:function(e,t){try{var n=t.messageElementRefs[t.messageElementRefs.length-1];Ut.isLoadingMessage(n)?t.removeLastMessage():e.finaliseStreamedMessage()}catch(n){console.error(n),t.addNewErrorMessage("service",n)}}},{key:"stream",value:function(t,n,i){var s,r,o=!0,a=!1,l=new Jt(i),c=function(){var e=f(h().mark((function e(n){var s,r,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,null==(r=(s=t.deepChat).responseInterceptor)?void 0:r.call(s,n);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=n;case 7:a=e.t0,Zt.validateResponseFormat(a)?a.error?(console.error(a.error),l.finaliseStreamedMessage(),i.addNewErrorMessage("service",a.error),t.streamHandlers.onClose(),o=!1):on.upsertWFiles(i,l.upsertStreamedMessage.bind(l),l,a):console.error(G.INVALID_RESPONSE(n,"server",!!t.deepChat.responseInterceptor,a));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.streamHandlers.abortStream.abort=function(){e.attemptToFinaliseStream(l,i),t.streamHandlers.onClose(),o=!1};var u=e.generateOptionalSignals();null==(r=(s=t.connectSettings).handler)||r.call(s,n,b(b({},u),{},{onOpen:function(){a||!o||(t.streamHandlers.onOpen(),a=!0)},onResponse:c,onClose:function(){o&&(e.attemptToFinaliseStream(l,i),t.streamHandlers.onClose(),o=!1)},stopClicked:t.streamHandlers.stopClicked}))}},{key:"websocket",value:function(t,n){var i,s,r=this,o={isOpen:!1,newUserMessage:{listener:function(){}},roleToStream:{}};t.websocket=o;var a=function(){var e=f(h().mark((function e(i){var s,a,l,c,u;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.isOpen){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,null==(a=(s=t.deepChat).responseInterceptor)?void 0:a.call(s,i);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=i;case 7:l=e.t0,Zt.validateResponseFormat(l)?"string"==typeof l.error?(console.error(l.error),n.isLastMessageError()||n.addNewErrorMessage("service",l.error)):on.isSimulation(t.stream)?(c=cn.stream.bind(r,t,n,o.roleToStream),u=o.roleToStream[i.role||Wt.AI_ROLE],on.upsertWFiles(n,c,u,i)):n.addNewMessage(l):(console.error(G.INVALID_RESPONSE(i,"server",!!t.deepChat.responseInterceptor,l)),n.addNewErrorMessage("service","Error in server message"));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=e.generateOptionalSignals();null==(s=(i=t.connectSettings).handler)||s.call(i,void 0,b(b({},l),{},{onOpen:function(){n.removeError(),o.isOpen=!0},onResponse:a,onClose:function(){o.isOpen=!1},newUserMessage:o.newUserMessage}))}},{key:"generateOptionalSignals",value:function(){return{onClose:function(){},onOpen:function(){},stopClicked:{listener:function(){}},newUserMessage:{listener:function(){}}}}}]);var t}(),dn=function(){function e(){k(this,e)}return S(e,null,[{key:"request",value:(n=f(h().mark((function e(t,n,i){var s,r,o,a,l,c,u,d,p,m,v,g,y=arguments;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=!(y.length>3&&void 0!==y[3])||y[3],l={body:n,headers:null==(r=t.connectSettings)?void 0:r.headers},e.next=4,Zt.processRequestInterceptor(t.deepChat,l);case 4:if(c=e.sent,u=c.body,d=c.headers,p=c.error,m=t.completionsHandlers.onFinish,!p){e.next=11;break}return e.abrupt("return",Zt.onInterceptorError(i,p,m));case 11:if(null==(o=t.connectSettings)||!o.handler){e.next=13;break}return e.abrupt("return",un.request(t,u,i));case 13:if((null==(a=t.connectSettings)?void 0:a.url)!==ln.URL){e.next=15;break}return e.abrupt("return",ln.request(t,i));case 15:v=!0,(g=Zt.fetch.bind(this,t,d,s))(u).then((function(e){return v=!!e.ok,e})).then((function(e){return Zt.processResponseByType(e)})).then(function(){var e=f(h().mark((function e(n){var s,r,o,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.extractResultData){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,null==(r=(s=t.deepChat).responseInterceptor)?void 0:r.call(s,n);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=n;case 7:return o=e.t0,e.next=10,t.extractResultData(o,g,u);case 10:if(a=e.sent,v){e.next=13;break}throw n;case 13:if(a&&"object"==w(a)){e.next=15;break}throw Error(G.INVALID_RESPONSE(n,"response",!!t.deepChat.responseInterceptor,o));case 15:a.makingAnotherRequest||(on.isSimulatable(t.stream,a)?on.simulate(i,t.streamHandlers,a):(i.addNewMessage(a),m()));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){Zt.displayError(i,e),m()}));case 18:case"end":return e.stop()}}),e,this)}))),function(e,t,i){return n.apply(this,arguments)})},{key:"executePollRequest",value:function(t,n,i,s){var r=t.completionsHandlers.onFinish;fetch(n,i).then((function(e){return e.json()})).then(function(){var o=f(h().mark((function o(a){var l,c,u;return h().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(t.extractPollResultData){o.next=2;break}return o.abrupt("return");case 2:return o.t0=t,o.next=5,null==(c=(l=t.deepChat).responseInterceptor)?void 0:c.call(l,a);case 5:if(o.t1=o.sent,o.t1){o.next=8;break}o.t1=a;case 8:return o.t2=o.t1,o.next=11,o.t0.extractPollResultData.call(o.t0,o.t2);case 11:(u=o.sent).timeoutMS?setTimeout((function(){e.executePollRequest(t,n,i,s)}),u.timeoutMS):on.isSimulatable(t.stream,u)?on.simulate(s,t.streamHandlers,u):(s.addNewMessage(u),r());case 13:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}()).catch((function(e){Zt.displayError(s,e),r()}))}},{key:"poll",value:(t=f(h().mark((function t(n,i,s){var r,o,a,l,c,u,d,p,f,m,v,g,y,b=arguments;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=!(b.length>3&&void 0!==b[3])||b[3],c={body:i,headers:null==(o=n.connectSettings)?void 0:o.headers},t.next=4,Zt.processRequestInterceptor(n.deepChat,c);case 4:if(u=t.sent,d=u.body,p=u.headers,!(f=u.error)){t.next=10;break}return t.abrupt("return",Zt.onInterceptorError(s,f));case 10:m=(null==(a=n.connectSettings)?void 0:a.url)||n.url||"",v=(null==(l=n.connectSettings)?void 0:l.method)||"POST",g=r?JSON.stringify(d):d,y={method:v,body:g,headers:p},n.connectSettings.credentials&&(y.credentials=n.connectSettings.credentials),e.executePollRequest(n,m,y,s);case 12:case"end":return t.stop()}}),t)}))),function(e,n,i){return t.apply(this,arguments)})},{key:"verifyKey",value:function(e,t,n,i,s,r,o,a,l){if(""===e)return r(G.INVALID_KEY);o(),fetch(t,{method:i,headers:n,body:l||null}).then((function(e){return Zt.processResponseByType(e)})).then((function(t){a(t,e,s,r)})).catch((function(e){r(G.CONNECTION_FAILED),console.error(e)}))}}]);var t,n}(),hn=function(){function e(t,n,i){k(this,e),this._isLoading=!1,this._isPaginationComplete=!1,this._index=0,this._messages=n,i.fetchHistory&&this.fetchHistory(i.fetchHistory),t.loadHistory&&this.setupLoadHistoryOnScroll(t.loadHistory),this.setupInitialHistory(t)}return S(e,[{key:"fetchHistory",value:(s=f(h().mark((function e(t){var n,i,s=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Bt.addMessage(this._messages),e.next=3,t();case 3:i=e.sent,this._messages.removeMessage(n),i.forEach((function(e){return s._messages.addAnyMessage(e,!0)})),setTimeout((function(){return K.scrollToBottom(s._messages.elementRef)}),0);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"processLoadedHistory",value:function(e){var t,n=this,i=this._messages,s=i.messageElementRefs,r=i.messageToElements,o=i.elementRef,a=null==(t=s.find((function(e){return!e.outerContainer.classList.contains(Ut.INTRO_CLASS)})))?void 0:t.outerContainer,l=o.scrollTop;null==e||e.reverse().map((function(e){var t=n._messages.addAnyMessage(b(b({},e),{},{sendUpdate:!0}),!0,!0);if(t){var i=Wt.generateMessageBody(t,s);r.unshift([t,i])}return t})).filter((function(e){return!!e})).reverse().forEach((function(e){return n._messages.sendClientUpdate(e,!0)})),a&&(o.scrollTop=l+a.offsetTop-40)}},{key:"populateMessages",value:function(e,t){this._messages.removeMessage(e),this._isPaginationComplete=t.findIndex((function(e){return!e}))<0;var n=t.filter((function(e){return!!e}));this.processLoadedHistory(n)}},{key:"setupLoadHistoryOnScroll",value:(i=f(h().mark((function t(n){var i=this;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._messages.elementRef.onscroll=f(h().mark((function t(){var s,r;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i._isLoading||i._isPaginationComplete||0!==i._messages.elementRef.scrollTop){t.next=13;break}return i._isLoading=!0,s=Bt.addMessage(i._messages,!1),t.prev=3,t.next=6,n(i._index++);case 6:r=t.sent,i.populateMessages(s,r),i._isLoading=!1,t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),i._messages.removeMessage(s),i._isPaginationComplete=!0,i._messages.addNewErrorMessage("service",e.FAILED_ERROR_MESSAGE,!0),console.error(t.t0);case 13:case"end":return t.stop()}}),t,null,[[3,10]])})));case 1:case"end":return t.stop()}}),t,this)}))),function(e){return i.apply(this,arguments)})},{key:"populateInitialHistory",value:function(e){var t=this;e.forEach((function(e){ee.processHistoryFile(e),t._messages.addNewMessage(e,!0)}))}},{key:"loadInitialHistory",value:(n=f(h().mark((function t(n){var i,s,r,o=this;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._isLoading=!0,i=Bt.addMessage(this._messages),t.prev=2,t.next=5,n(this._index++);case 5:s=t.sent,r=this._messages.elementRef.scrollTop,this.populateMessages(i,s),0===r&&setTimeout((function(){return K.scrollToBottom(o._messages.elementRef)}),0),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),this._messages.removeMessage(i),this._isPaginationComplete=!0,this._messages.addNewErrorMessage("service",e.FAILED_ERROR_MESSAGE,!0),console.error(t.t0);case 13:this._isLoading=!1;case 14:case"end":return t.stop()}}),t,this,[[2,10]])}))),function(e){return n.apply(this,arguments)})},{key:"setupInitialHistory",value:(t=f(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.loadHistory&&this.loadInitialHistory(t.loadHistory),(n=t.history||ee.processHistory(t))&&(this.populateInitialHistory(n),this._index+=1);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}],[{key:"addErrorPrefix",value:function(t){var n;null!==(n=t.permittedErrorPrefixes)&&void 0!==n||(t.permittedErrorPrefixes=[]),t.permittedErrorPrefixes.push(e.FAILED_ERROR_MESSAGE)}}]);var t,n,i,s}();hn.FAILED_ERROR_MESSAGE="Failed to load history";var pn=hn,fn=function(){function e(){k(this,e)}return S(e,null,[{key:"getCharacterLimitMessages",value:function(e,t){var n;if(-1===t)return e;for(var i=0,s=e.length-1;s>=0;s-=1){var r=null==(n=e[s])?void 0:n.text;if(void 0!==r&&(i+=r.length)>t){e[s].text=r.substring(0,r.length-(i-t));break}}return e.slice(Math.max(s,0))}},{key:"getMaxMessages",value:function(e,t){return e.slice(Math.max(e.length-t,0))}},{key:"processMessages",value:function(t,n,i){return void 0!==n?n>0&&(t=e.getMaxMessages(t,n)):t=[t[t.length-1]],t=JSON.parse(JSON.stringify(t)),void 0===i?t:e.getCharacterLimitMessages(t,i)}}])}(),mn=function(){function e(){k(this,e)}return S(e,null,[{key:"parseConfig",value:function(e,t,n,i){var s,r={files:t};if("object"==w(i)){ee.processFileConfigConnect(i);var o=i.files,a=i.connect,l=i.button;o&&(o.infoModal&&(r.files.infoModal=o.infoModal,null!=(s=o.infoModal)&&s.textMarkDown&&(r.infoModalTextMarkUp=n.render(o.infoModal.textMarkDown))),o.acceptedFormats&&(r.files.acceptedFormats=o.acceptedFormats),o.maxNumberOfFiles&&(r.files.maxNumberOfFiles=o.maxNumberOfFiles)),r.button=l,a&&(a.headers||a.method||a.url||a.credentials||e.headers||e.method||e.url||e.credentials)&&(r.connect={url:(null==a?void 0:a.url)||e.url,method:(null==a?void 0:a.method)||e.method,headers:(null==a?void 0:a.headers)||e.headers,credentials:(null==a?void 0:a.credentials)||e.credentials})}return r}},{key:"processMixedFiles",value:function(t,n,i){if(i){t.fileTypes.mixedFiles=e.parseConfig(t.connectSettings,{acceptedFormats:""},n,i)}}},{key:"processMicrophone",value:function(t,n,i,s){var r,o,a,l,c,u,d,h,p=b({acceptedFormats:"audio/*"},(null==(a=t.fileTypes.audio)?void 0:a.files)||{});i&&(void 0!==navigator.mediaDevices.getUserMedia?(t.recordAudio=e.parseConfig(t.connectSettings,p,n,i),"object"==w(i)&&i.files&&(null!==(r=(l=t.recordAudio).files)&&void 0!==r||(l.files={}),t.recordAudio.files.format=null==(c=i.files)?void 0:c.format,t.recordAudio.files.maxDurationSeconds=null==(u=i.files)?void 0:u.maxDurationSeconds,null!=(d=t.fileTypes.audio)&&d.files&&(null!==(o=(h=t.fileTypes.audio.files).maxNumberOfFiles)&&void 0!==o||(h.maxNumberOfFiles=i.files.maxNumberOfFiles)))):s||(t.fileTypes.audio=e.parseConfig(t.connectSettings,p,n,i)))}},{key:"processAudioConfig",value:function(t,n,i,s){if(i||s){var r=b({acceptedFormats:"audio/*"},(null==s?void 0:s.files)||{});t.fileTypes.audio=e.parseConfig(t.connectSettings,r,n,i)}}},{key:"processGifConfig",value:function(t,n,i,s){if(i||s){var r=b({acceptedFormats:"image/gif"},(null==s?void 0:s.files)||{});t.fileTypes.gifs=e.parseConfig(t.connectSettings,r,n,i)}}},{key:"processCamera",value:function(t,n,i,s){var r,o,a,l,c,u=b({acceptedFormats:"image/*"},(null==(o=t.fileTypes.images)?void 0:o.files)||{});i&&(void 0!==navigator.mediaDevices.getUserMedia?(t.camera=e.parseConfig(t.connectSettings,u,n,i),"object"==w(i)&&(t.camera.modalContainerStyle=i.modalContainerStyle,i.files&&(null!==(r=(a=t.camera).files)&&void 0!==r||(a.files={}),t.camera.files.format=null==(l=i.files)?void 0:l.format,t.camera.files.dimensions=null==(c=i.files)?void 0:c.dimensions))):s||(t.fileTypes.images=e.parseConfig(t.connectSettings,u,n,i)))}},{key:"processImagesConfig",value:function(t,n,i,s){if(i||s){var r=b({acceptedFormats:"image/*"},(null==s?void 0:s.files)||{});t.fileTypes.images=e.parseConfig(t.connectSettings,r,n,i)}}},{key:"populateDefaultFileIO",value:function(e,t){var n,i,s,r,o;e&&(null!==(n=e.files)&&void 0!==n||(e.files={}),null!==(i=(r=e.files).acceptedFormats)&&void 0!==i||(r.acceptedFormats=t),null!==(s=(o=e.files).maxNumberOfFiles)&&void 0!==s||(o.maxNumberOfFiles=1))}},{key:"set",value:function(t,n,i){e.populateDefaultFileIO(null==i?void 0:i.audio,".4a,.mp3,.webm,.mp4,.mpga,.wav,.mpeg,.m4a"),e.populateDefaultFileIO(null==i?void 0:i.images,".png,.jpg");var s=Pt.createNew(t.remarkable);e.processImagesConfig(n,s,t.images,null==i?void 0:i.images),e.processCamera(n,s,t.camera,t.images),e.processGifConfig(n,s,t.gifs,null==i?void 0:i.gifs),e.processAudioConfig(n,s,t.audio,null==i?void 0:i.audio),e.processMicrophone(n,s,t.microphone,t.audio),e.processMixedFiles(n,s,t.mixedFiles)}}])}(),vn=function(){function e(t,n,i){var s,r,o,a,l,c;k(this,e),this.rawBody={},this.validateKeyProperty=!1,this.canSendMessage=e.canSendMessage,this.connectSettings={},this.fileTypes={},this.completionsHandlers={},this.streamHandlers={},this.deepChat=t,this.demo=i,Object.assign(this.rawBody,null==(r=t.connect)?void 0:r.additionalBodyProps),this.totalMessagesMaxCharLength=null==(o=null==t?void 0:t.requestBodyLimits)?void 0:o.totalMessagesMaxCharLength,this.maxMessages=null==(a=null==t?void 0:t.requestBodyLimits)?void 0:a.maxMessages,mn.set(t,this,n),t.connect&&(this.connectSettings=t.connect),this.demo&&(null!==(s=(l=this.connectSettings).url)&&void 0!==s||(l.url=ln.URL)),this.connectSettings.websocket&&cn.setup(this),this.stream=(null==(c=this.deepChat.connect)?void 0:c.stream)||ee.checkForStream(this.deepChat),t.loadHistory&&pn.addErrorPrefix(this)}return S(e,[{key:"verifyKey",value:function(e,t){}},{key:"getServiceIOByType",value:function(e){if(e.type.startsWith("audio")&&this.fileTypes.audio)return this.fileTypes.audio;if(e.type.startsWith("image")){if(this.fileTypes.gifs&&e.type.endsWith("/gif"))return this.fileTypes.gifs;if(this.fileTypes.images)return this.fileTypes.images;if(this.camera)return this.camera}return this.fileTypes.mixedFiles}},{key:"request",value:(o=f(h().mark((function e(t,n){var i,s=arguments;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=!(s.length>2&&void 0!==s[2])||s[2],e.abrupt("return",this.stream&&!on.isSimulation(this.stream)?on.request(this,t,n,i):dn.request(this,t,n,i));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"callAPIWithText",value:(r=f(h().mark((function e(t,n){var i,s,r,o,a,l,c,u;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=b({messages:n},this.rawBody),u=!1,null!=(r=this.connectSettings.headers)&&r["Content-Type"]||(null!==(i=(o=this.connectSettings).headers)&&void 0!==i||(o.headers={}),null!==(s=(a=this.connectSettings.headers)["Content-Type"])&&void 0!==s||(a["Content-Type"]="application/json"),u=!0),e.next=5,this.request(c,t);case 5:u&&(null==(l=this.connectSettings.headers)||delete l["Content-Type"]);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"callApiWithFiles",value:(s=f(h().mark((function t(n,i,s){var r,o,a;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.createCustomFormDataBody(this.rawBody,i,s),o=this.connectSettings,a=this.getServiceIOByType(s[0]),this.connectSettings=(null==a?void 0:a.connect)||this.connectSettings,t.next=4,this.request(r,n,!1);case 4:this.connectSettings=o;case 5:case"end":return t.stop()}}),t,this)}))),function(e,t,n){return s.apply(this,arguments)})},{key:"callServiceAPI",value:(i=f(h().mark((function e(t,n,i){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i?this.callApiWithFiles(t,n,i):this.callAPIWithText(t,n);case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"callAPI",value:(n=f(h().mark((function e(t,n){var i,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:i=fn.processMessages(n.messageToElements.map((function(e){return d(e,1)[0]})),this.maxMessages,this.totalMessagesMaxCharLength),this.connectSettings.websocket?(s=b({messages:i},this.rawBody),cn.sendWebsocket(this,s,n,!1)):this.callServiceAPI(n,i,t.files);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"extractResultData",value:(t=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:if(!t.result){e.next=4;break}return e.abrupt("return",ee.handleResponseProperty(t));case 4:if(!Zt.validateResponseFormat(t)){e.next=6;break}return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"isDirectConnection",value:function(){return!1}},{key:"isWebModel",value:function(){return!1}}],[{key:"canSendMessage",value:function(e,t,n){return!!n||(!(!e||""===e.trim())||!!(t&&t.length>0))}},{key:"createCustomFormDataBody",value:function(e,t,n){var i=new FormData;n.forEach((function(e){return i.append("files",e)})),Object.keys(e).forEach((function(t){return i.append(t,String(e[t]))}));var s=0;t.slice(0,t.length-1).forEach((function(e){i.append("message".concat(s+=1),JSON.stringify(e))}));var r=t[t.length-1];return r.text&&(delete r.files,i.append("message".concat(s+=1),JSON.stringify(r))),i}}]);var t,n,i,s,r,o}(),gn=function(e){function t(e,n,i,s,o){var a,l;return k(this,t),(a=r(this,t,[e,o])).insertKeyPlaceholderText="API Key",a.keyHelpUrl="",Object.assign(a.rawBody,null==(l=e.connect)?void 0:l.additionalBodyProps),a.keyVerificationDetails=n,a.buildHeadersFunc=i,s&&a.setApiKeyProperties(s),a.connectSettings=a.buildConnectSettings(a.key||"",e.connect),a}return c(t,e),S(t,[{key:"setApiKeyProperties",value:function(e){this.key=e.key,e.validateKeyProperty&&(this.validateKeyProperty=e.validateKeyProperty)}},{key:"buildConnectSettings",value:function(e,t){var n,i=null!=t?t:{};return null!==(n=i.headers)&&void 0!==n||(i.headers={}),Object.assign(i.headers,this.buildHeadersFunc(e)),i}},{key:"keyAuthenticated",value:function(e,t){this.connectSettings=this.buildConnectSettings(t,this.connectSettings),this.key=t,e()}},{key:"verifyKey",value:function(e,t){var n=this.keyVerificationDetails,i=n.url,s=n.method,r=n.handleVerificationResult,o=n.createHeaders,a=n.body,l=(null==o?void 0:o(e))||this.buildHeadersFunc(e);dn.verifyKey(e,i,l,s,this.keyAuthenticated.bind(this,t.onSuccess),t.onFail,t.onLoad,r,a)}},{key:"isDirectConnection",value:function(){return!0}}])}(vn),yn=function(){function e(){k(this,e)}return S(e,null,[{key:"waitForPropertiesToBeUpdatedBeforeRender",value:function(t){t._propUpdated_=!1,setTimeout((function(){t._propUpdated_?e.waitForPropertiesToBeUpdatedBeforeRender(t):(t._waitingToRender_=!1,t.onRender())}))}},{key:"attemptRender",value:function(t){t._propUpdated_=!0,t._waitingToRender_||(t._waitingToRender_=!0,e.waitForPropertiesToBeUpdatedBeforeRender(t))}}])}(),bn=function(e){function t(){var e;return k(this,t),(e=r(this,t))._waitingToRender_=!1,e._propUpdated_=!1,Object.keys(t._attributeToProperty_).forEach((function(n){var i=t._attributeToProperty_[n];e.constructPropertyAccessors(i),e.hasOwnProperty(n)||e.constructPropertyAccessors(i,n)})),e}return c(t,e),S(t,[{key:"constructPropertyAccessors",value:function(e,t){var n;Object.defineProperty(this,t||e,{get:function(){return n},set:function(i){n=i,t?this[e]=i:yn.attemptRender(this)}})}},{key:"attributeChangedCallback",value:function(e,n,i){if(n!==i){var s=t._attributes_[e](i);this[t._attributeToProperty_[e]]=s}}},{key:"onRender",value:function(){}}],[{key:"observedAttributes",get:function(){return Object.keys(t._attributes_)||[]}}])}(s(HTMLElement));bn._attributes_={},bn._attributeToProperty_={};var _n=bn,wn=function(){return S((function e(){k(this,e)}),null,[{key:"createSVGElement",value:function(e){return(new DOMParser).parseFromString(e,"image/svg+xml").documentElement}}])}(),kn=function(){function e(){k(this,e)}return S(e,null,[{key:"changeVisibility",value:function(t,n,i,s){s.target.id===e.VISIBLE_ICON_ID?(n.style.display="none",i.style.display="block",t.type="password"):(n.style.display="block",i.style.display="none",t.type="text")}},{key:"createIconElement",value:function(e,t){var n=wn.createSVGElement(e);return n.id=t,n.classList.add("visibility-icon"),n}},{key:"create",value:function(t){var n=document.createElement("div");n.id="visibility-icon-container";var i=e.createIconElement('<?xml version="1.0" standalone="no"?>\n<svg version="1.1"\n\txmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n\txmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="0.9em" height="0.9em"\n\tviewBox="0 0 1200 1200" enable-background="new 0 0 1200 1200">\n\t\t<path id="path6686" inkscape:connector-curvature="0" d="M779.843,599.925c0,95.331-80.664,172.612-180.169,172.612\n\t\t\tc-99.504,0-180.168-77.281-180.168-172.612c0-95.332,80.664-172.612,180.168-172.612\n\t\t\tC699.179,427.312,779.843,504.594,779.843,599.925z M600,240.521c-103.025,0.457-209.814,25.538-310.904,73.557\n\t\t\tc-75.058,37.122-148.206,89.496-211.702,154.141C46.208,501.218,6.431,549,0,599.981c0.76,44.161,48.13,98.669,77.394,131.763\n\t\t\tc59.543,62.106,130.786,113.018,211.702,154.179c94.271,45.751,198.616,72.092,310.904,73.557\n\t\t\tc103.123-0.464,209.888-25.834,310.866-73.557c75.058-37.122,148.243-89.534,211.74-154.179\n\t\t\tc31.185-32.999,70.962-80.782,77.394-131.763c-0.76-44.161-48.13-98.671-77.394-131.764\n\t\t\tc-59.543-62.106-130.824-112.979-211.74-154.141C816.644,268.36,712.042,242.2,600,240.521z M599.924,329.769\n\t\t\tc156.119,0,282.675,120.994,282.675,270.251c0,149.256-126.556,270.25-282.675,270.25S317.249,749.275,317.249,600.02\n\t\t\tC317.249,450.763,443.805,329.769,599.924,329.769L599.924,329.769z"/>\n</svg>\n',e.VISIBLE_ICON_ID);i.style.display="none",n.appendChild(i);var s=e.createIconElement('<?xml version="1.0" standalone="no"?>\n<svg version="1.1"\n\txmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n\txmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="0.9em" height="0.9em"\n\tviewBox="0 0 1200 1200" enable-background="new 0 0 1200 1200">\n\t\t<path d="\n\t\t\tM669.727,273.516c-22.891-2.476-46.15-3.895-69.727-4.248c-103.025,0.457-209.823,25.517-310.913,73.536\n\t\t\tc-75.058,37.122-148.173,89.529-211.67,154.174C46.232,529.978,6.431,577.76,0,628.74c0.76,44.162,48.153,98.67,77.417,131.764\n\t\t\tc59.543,62.106,130.754,113.013,211.67,154.174c2.75,1.335,5.51,2.654,8.276,3.955l-75.072,131.102l102.005,60.286l551.416-960.033\n\t\t\tl-98.186-60.008L669.727,273.516z M902.563,338.995l-74.927,129.857c34.47,44.782,54.932,100.006,54.932,159.888\n\t\t\tc0,149.257-126.522,270.264-282.642,270.264c-6.749,0-13.29-0.728-19.922-1.172l-49.585,85.84c22.868,2.449,45.99,4.233,69.58,4.541\n\t\t\tc103.123-0.463,209.861-25.812,310.84-73.535c75.058-37.122,148.246-89.529,211.743-154.174\n\t\t\tc31.186-32.999,70.985-80.782,77.417-131.764c-0.76-44.161-48.153-98.669-77.417-131.763\n\t\t\tc-59.543-62.106-130.827-113.013-211.743-154.175C908.108,341.478,905.312,340.287,902.563,338.995L902.563,338.995z\n\t\t\tM599.927,358.478c6.846,0,13.638,0.274,20.361,0.732l-58.081,100.561c-81.514,16.526-142.676,85.88-142.676,168.897\n\t\t\tc0,20.854,3.841,40.819,10.913,59.325c0.008,0.021-0.008,0.053,0,0.074l-58.228,100.854\n\t\t\tc-34.551-44.823-54.932-100.229-54.932-160.182C317.285,479.484,443.808,358.477,599.927,358.478L599.927,358.478z M768.896,570.513\n\t\t\tL638.013,797.271c81.076-16.837,141.797-85.875,141.797-168.603C779.81,608.194,775.724,588.729,768.896,570.513L768.896,570.513z"\n\t\t\t/>\n</svg>\n',"not-visible-icon");return n.appendChild(s),n.onclick=e.changeVisibility.bind(this,t,i,s),n}}])}();kn.VISIBLE_ICON_ID="visible-icon";var xn=kn,Sn=function(){function e(){k(this,e)}return S(e,null,[{key:"createCautionText",value:function(){var e=document.createElement("a");return e.classList.add("insert-key-input-help-text"),e.innerText="Please exercise CAUTION when inserting your API key outside of deepchat.dev or localhost!!",e}},{key:"createHelpLink",value:function(e){var t=document.createElement("a");return t.classList.add("insert-key-input-help-text"),t.href=e,t.innerText="Find more info here",t.target="_blank",t}},{key:"createFailText",value:function(){var e=document.createElement("div");return e.id="insert-key-input-invalid-text",e.style.display="none",e}},{key:"createHelpTextContainer",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=document.createElement("div");i.id="insert-key-help-text-container";var s=document.createElement("div");s.id="insert-key-help-text-contents";var r=e.createFailText();if(s.appendChild(r),t){var o=e.createHelpLink(t);s.appendChild(o)}if(!0===n){var a=e.createCautionText();s.appendChild(a)}return i.appendChild(s),{helpTextContainerElement:i,failTextElement:r}}},{key:"onFail",value:function(e,t,n,i){e.classList.replace("insert-key-input-valid","insert-key-input-invalid"),n.innerText=i,n.style.display="block",t.innerText="Start",e.classList.remove("loading")}},{key:"onLoad",value:function(e,t){e.classList.add("loading"),t.innerHTML='<div id="loading-key"></div>'}},{key:"verifyKey",value:function(e,t,n){var i=e.value.trim();n.verifyKey(i,t)}},{key:"addVerificationEvents",value:function(t,n,i,s,r){var o={onSuccess:s,onFail:e.onFail.bind(this,t,n,i),onLoad:e.onLoad.bind(this,t,n)},a=e.verifyKey.bind(this,t,o,r);n.onclick=a,t.onkeydown=function(e){!t.classList.contains("loading")&&e.key===D.ENTER&&a()}}},{key:"createStartButton",value:function(){var e=document.createElement("div");return e.id="start-button",e.innerText="Start",e}},{key:"onInputFocus",value:function(e){e.target.classList.replace("insert-key-input-invalid","insert-key-input-valid")}},{key:"createInput",value:function(t){var n=document.createElement("div");n.id="insert-key-input-container";var i=document.createElement("input");return i.id="insert-key-input",i.placeholder=t||"API Key",i.type="password",i.classList.add("insert-key-input-valid"),i.onfocus=e.onInputFocus,n.appendChild(i),n}},{key:"createContents",value:function(t,n){var i,s=document.createElement("div");s.id="insert-key-contents";var r=e.createInput(n.insertKeyPlaceholderText),o=r.children[0],a=xn.create(o);r.appendChild(a),s.appendChild(r);var l=e.createStartButton(),c=e.createHelpTextContainer(n.keyHelpUrl,null==(i=n.deepChat._insertKeyViewStyles)?void 0:i.displayCautionText),u=c.helpTextContainerElement,d=c.failTextElement;return s.appendChild(l),s.appendChild(u),e.addVerificationEvents(o,l,d,t,n),s}},{key:"createElements",value:function(t,n){var i=document.createElement("div");i.id="insert-key-view";var s=e.createContents(t,n);return i.appendChild(s),i}},{key:"render",value:function(t,n,i){var s=e.createElements(n,i);t.replaceChildren(s)}}])}(),En=function(){function e(){k(this,e)}return S(e,null,[{key:"enableButtons",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;window.webLLM?(t&&(t.disabled=!1),n&&(n.disabled=!1)):i<4*An.MODULE_SEARCH_LIMIT_S&&setTimeout((function(){return e.enableButtons(t,n,i+1)}),250)}},{key:"setUpInitial",value:function(t,n,i,s){var r=(null==n?void 0:n.downloadClass)||e.DOWNLOAD_BUTTON_CLASS,o=(null==n?void 0:n.uploadClass)||e.UPLOAD_BUTTON_CLASS,a=(null==n?void 0:n.fileInputClass)||e.FILE_INPUT_CLASS;return setTimeout((function(){var n=null==i?void 0:i.getElementsByClassName(r)[0],s=null==i?void 0:i.getElementsByClassName(a)[0],l=null==i?void 0:i.getElementsByClassName(o)[0];n&&(n.onclick=function(){return t()}),s&&(s.onchange=function(){s.files&&s.files.length>0&&t(s.files)}),l&&(l.onclick=function(){return s.click()}),(n||l)&&e.enableButtons(n,l)})),(null==n?void 0:n.initialHtml)||'<div>\n        Download or upload a web model that will run entirely on your browser: <br/> \n        <button disabled class="'.concat(r,' deep-chat-button deep-chat-web-model-button">Download</button>\n        ').concat(s?"":'<input type="file" class="'.concat(a,'" hidden multiple />\n          <button disabled class="').concat(o,' deep-chat-button deep-chat-web-model-button">Upload</button>'),"\n      </div>")}},{key:"exportFile",value:function(e){for(var t=document.createElement("a"),n=function(n){setTimeout((function(){for(var i=4*n,s=i;s<Math.min(i+4,e.length);s+=1){var r=URL.createObjectURL(e[s]);t.href=r,t.download=e[s].name,document.body.appendChild(t),t.click(),URL.revokeObjectURL(r)}}),500*n)},i=0;i<e.length/4;i+=1)n(i)}},{key:"setUpAfterLoad",value:function(t,n,i,s){var r=(null==n?void 0:n.exportFilesClass)||e.EXPORT_BUTTON_CLASS;return setTimeout((function(){var n=null==i?void 0:i.getElementsByClassName(r)[0];n&&(n.onclick=function(){return e.exportFile(t)})})),(null==n?void 0:n.afterLoadHtml)||"<div>\n        Model loaded successfully and has been cached for future requests.\n        ".concat(s?"":'<br/> <button style="margin-top: 5px" class="'.concat(r,' deep-chat-button">Export</button>'),"\n      </div>")}}])}();En.DOWNLOAD_BUTTON_CLASS="deep-chat-download-button",En.UPLOAD_BUTTON_CLASS="deep-chat-upload-button",En.FILE_INPUT_CLASS="deep-chat-file-input",En.EXPORT_BUTTON_CLASS="deep-chat-export-button";var Cn=En,Tn={model_list:[{model_url:"https://huggingface.co/mlc-ai/Llama-2-7b-chat-hf-q4f32_1-MLC/resolve/main/",local_id:"Llama-2-7b-chat-hf-q4f32_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Llama-2-7b-chat-hf/Llama-2-7b-chat-hf-q4f32_1-ctx4k_cs1k-webgpu.wasm",vram_required_MB:9109.03,low_resource_required:!1},{model_url:"https://huggingface.co/mlc-ai/Llama-2-7b-chat-hf-q4f16_1-MLC/resolve/main/",local_id:"Llama-2-7b-chat-hf-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Llama-2-7b-chat-hf/Llama-2-7b-chat-hf-q4f16_1-ctx4k_cs1k-webgpu.wasm",vram_required_MB:6749.02,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/Llama-2-7b-chat-hf-q4f16_1-MLC/resolve/main/",local_id:"Llama-2-7b-chat-hf-q4f16_1-1k",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Llama-2-7b-chat-hf/Llama-2-7b-chat-hf-q4f16_1-ctx1k-webgpu.wasm",vram_required_MB:4618.52,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/Llama-2-13b-chat-hf-q4f16_1-MLC/resolve/main/",local_id:"Llama-2-13b-chat-hf-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Llama-2-13b-chat-hf/Llama-2-13b-chat-hf-q4f16_1-ctx4k_cs1k-webgpu.wasm",vram_required_MB:11814.09,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/Llama-2-70b-chat-hf-q4f16_1-MLC/resolve/main/",local_id:"Llama-2-70b-chat-hf-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Llama-2-70b-chat-hf/Llama-2-70b-chat-hf-q4f16_1-ctx4k_cs1k-webgpu.wasm",vram_required_MB:43729.05,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/RedPajama-INCITE-Chat-3B-v1-q4f16_1-MLC/resolve/main/",local_id:"RedPajama-INCITE-Chat-3B-v1-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/RedPajama-INCITE-Chat-3B-v1/RedPajama-INCITE-Chat-3B-v1-q4f16_1-ctx2k-webgpu.wasm",vram_required_MB:2972.09,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/RedPajama-INCITE-Chat-3B-v1-q4f32_1-MLC/resolve/main/",local_id:"RedPajama-INCITE-Chat-3B-v1-q4f32_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/RedPajama-INCITE-Chat-3B-v1/RedPajama-INCITE-Chat-3B-v1-q4f32_1-ctx2k-webgpu.wasm",vram_required_MB:3928.09,low_resource_required:!1},{model_url:"https://huggingface.co/mlc-ai/RedPajama-INCITE-Chat-3B-v1-q4f16_1-MLC/resolve/main/",local_id:"RedPajama-INCITE-Chat-3B-v1-q4f16_1-1k",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/RedPajama-INCITE-Chat-3B-v1/RedPajama-INCITE-Chat-3B-v1-q4f16_1-ctx1k-webgpu.wasm",vram_required_MB:2041.09,low_resource_required:!0,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/RedPajama-INCITE-Chat-3B-v1-q4f32_1-MLC/resolve/main/",local_id:"RedPajama-INCITE-Chat-3B-v1-q4f32_1-1k",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/RedPajama-INCITE-Chat-3B-v1/RedPajama-INCITE-Chat-3B-v1-q4f32_1-ctx1k-webgpu.wasm",vram_required_MB:2558.09,low_resource_required:!0},{model_url:"https://huggingface.co/mlc-ai/WizardMath-7B-V1.1-q4f16_1-MLC/resolve/main/",local_id:"WizardMath-7B-V1.1-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Mistral-7B-Instruct-v0.2/Mistral-7B-Instruct-v0.2-q4f16_1-sw4k_cs1k-webgpu.wasm",vram_required_MB:6079.02,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/Mistral-7B-Instruct-v0.2-q4f16_1-MLC/resolve/main/",local_id:"Mistral-7B-Instruct-v0.2-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Mistral-7B-Instruct-v0.2/Mistral-7B-Instruct-v0.2-q4f16_1-sw4k_cs1k-webgpu.wasm",vram_required_MB:6079.02,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/OpenHermes-2.5-Mistral-7B-q4f16_1-MLC/resolve/main/",local_id:"OpenHermes-2.5-Mistral-7B-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Mistral-7B-Instruct-v0.2/Mistral-7B-Instruct-v0.2-q4f16_1-sw4k_cs1k-webgpu.wasm",vram_required_MB:6079.02,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/NeuralHermes-2.5-Mistral-7B-q4f16_1-MLC/resolve/main/",local_id:"NeuralHermes-2.5-Mistral-7B-q4f16_1",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/Mistral-7B-Instruct-v0.2/Mistral-7B-Instruct-v0.2-q4f16_1-sw4k_cs1k-webgpu.wasm",vram_required_MB:6079.02,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/TinyLlama-1.1B-Chat-v0.4-q0f16-MLC/resolve/main/",local_id:"TinyLlama-1.1B-Chat-v0.4-q0f16",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/TinyLlama-1.1B-Chat-v0.4/TinyLlama-1.1B-Chat-v0.4-q0f16-ctx2k-webgpu.wasm",vram_required_MB:5063.52,low_resource_required:!1,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/TinyLlama-1.1B-Chat-v0.4-q0f32-MLC/resolve/main/",local_id:"TinyLlama-1.1B-Chat-v0.4-q0f32",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/TinyLlama-1.1B-Chat-v0.4/TinyLlama-1.1B-Chat-v0.4-q0f32-ctx2k-webgpu.wasm",vram_required_MB:5394.53,low_resource_required:!1},{model_url:"https://huggingface.co/mlc-ai/TinyLlama-1.1B-Chat-v0.4-q4f16_1-MLC/resolve/main/",local_id:"TinyLlama-1.1B-Chat-v0.4-q4f16_1-1k",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/TinyLlama-1.1B-Chat-v0.4/TinyLlama-1.1B-Chat-v0.4-q4f16_1-ctx1k-webgpu.wasm",vram_required_MB:899.11,low_resource_required:!0,required_features:["shader-f16"]},{model_url:"https://huggingface.co/mlc-ai/TinyLlama-1.1B-Chat-v0.4-q4f32_1-MLC/resolve/main/",local_id:"TinyLlama-1.1B-Chat-v0.4-q4f32_1-1k",model_lib_url:"https://raw.githubusercontent.com/mlc-ai/binary-mlc-llm-libs/main/TinyLlama-1.1B-Chat-v0.4/TinyLlama-1.1B-Chat-v0.4-q4f32_1-ctx1k-webgpu.wasm",vram_required_MB:992.11,low_resource_required:!0}],use_web_worker:!0},Mn=function(e){function t(e){var n,i,s;return k(this,t),(n=r(this,t,[e]))._isModelLoaded=!1,n._isModelLoading=!1,n._loadOnFirstMessage=!1,n._webModel={},n.permittedErrorPrefixes=[t.MULTIPLE_MODELS_ERROR,t.WEB_LLM_NOT_FOUND_ERROR,t.GENERIC_ERROR],n._conversationHistory=[],"object"==w(e.webModel)&&(n._webModel=e.webModel),null!=(i=n._webModel.load)&&i.clearCache&&t.clearAllCache(),n.findModelInWindow(e),n.canSendMessage=n.canSubmit.bind(o(n)),n._chatEl=null==(s=e.shadowRoot)?void 0:s.children[0],e.history&&t.setUpHistory(n._conversationHistory,e.history),n}return c(t,e),S(t,[{key:"setUpMessages",value:function(e){var t=this;this._messages=e,this._removeIntro=function(){e.removeIntroductoryMessage(),t._removeIntro=void 0}}},{key:"findModelInWindow",value:function(e){var n,i=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;window.webLLM?this.configureInit(this.shouldAddIntroMessage(e.introMessage)):s>t.MODULE_SEARCH_LIMIT_S?(null==(n=this._messages)||n.addNewErrorMessage("service",t.WEB_LLM_NOT_FOUND_ERROR),console.error("The deep-chat-web-llm module has not been attached to the window object. Please see the following guide:"),console.error("https://deepchat.dev/examples/externalModules")):setTimeout((function(){return i.findModelInWindow(e,s+1)}),1e3)}},{key:"shouldAddIntroMessage",value:function(e){var t;return!e&&this._webModel&&!1!==(null==(t=this._webModel.introMessage)?void 0:t.displayed)}},{key:"scrollToTop",value:function(e){var t,n=this;!1!==(null==(t=this._webModel.introMessage)?void 0:t.autoScroll)&&setTimeout((function(){var e,t;null!=(e=n._messages)&&e.elementRef&&K.scrollToTop(null==(t=n._messages)?void 0:t.elementRef)}),e)}},{key:"getIntroMessage",value:function(e){if(this.shouldAddIntroMessage(e)&&this._chatEl){var t=Cn.setUpInitial(this.init.bind(this),this._webModel.introMessage,this._chatEl,!!this._webModel.worker);return this.scrollToTop(1),{role:Wt.AI_ROLE,html:t,sendUpdate:!1}}}},{key:"configureInit",value:(v=f(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this._webModel.load)){e.next=8;break}if(!n.onInit){e.next=5;break}return this.init(),e.abrupt("return");case 5:if(!n.onMessage){e.next=8;break}return this._loadOnFirstMessage=!0,e.abrupt("return");case 8:t||this.init();case 9:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"init",value:(m=f(h().mark((function e(t){var n,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(n=this._messages)||n.removeError(),i=this.attemptToCreateChat(),e.t0=i,!e.t0){e.next=6;break}return e.next=6,this.loadModel(i,t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"attemptToCreateChat",value:function(){var e;if(t.chat)return null==(e=this._messages)||e.addNewErrorMessage("service",t.MULTIPLE_MODELS_ERROR),void console.error(t.MULTIPLE_MODELS_ERROR);if(!this._isModelLoaded&&!this._isModelLoading){var n=this._webModel.worker;return Tn.use_web_worker&&n?new window.webLLM.ChatWorkerClient(n):new window.webLLM.ChatModule}}},{key:"getConfig",value:function(){var e,n=t.DEFAULT_MODEL;this._webModel.model&&(n=this._webModel.model);var i=JSON.parse(JSON.stringify(Tn));if(this._webModel.urls){var s=i.model_list.find((function(e){return e.local_id=n}));s&&(this._webModel.urls.model&&(s.model_url=this._webModel.urls.model),this._webModel.urls.wasm&&(s.model_lib_url=this._webModel.urls.wasm))}return null!=(e=this._webModel.load)&&e.skipCache&&(i.use_cache=!1),{model:n,appConfig:i}}},{key:"loadModel",value:(p=f(h().mark((function e(n,i){var s,r,o,a,l,c,u,d,p,f,m,v,g,y,b,_=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scrollToTop(),t.chat=n,this._isModelLoading=!0,d=!1===(null==(s=this._webModel.introMessage)?void 0:s.displayed),p=function(e){var t;null==(t=_._messages)||t.addNewMessage({html:"<div>".concat(e.text,"</div>"),overwrite:!0,sendUpdate:!1}),d&&(setTimeout((function(){var e;return K.scrollToBottom(null==(e=_._messages)?void 0:e.elementRef)})),d=!1)},t.chat.setInitProgressCallback(p),e.prev=4,m=this.getConfig(),v=m.model,g=m.appConfig,y={},this._webModel.instruction&&(y.conv_config={system:this._webModel.instruction}),this._conversationHistory.length>0&&(y.conversation_history=this._conversationHistory),e.next=10,t.chat.reload(v,y,g,i);case 10:f=e.sent,e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(4),e.abrupt("return",this.unloadChat(e.t0));case 16:null==(o=(r=this.deepChat)._validationHandler)||o.call(r),null!=(a=this._webModel.introMessage)&&a.removeAfterLoad?!1===this._webModel.introMessage.displayed?null==(c=this._messages)||c.removeLastMessage():null==(u=this._removeIntro)||u.call(this):(b=Cn.setUpAfterLoad(f,this._webModel.introMessage,this._chatEl,!!this._webModel.worker),null==(l=this._messages)||l.addNewMessage({html:b,overwrite:!0,sendUpdate:!1})),this._isModelLoaded=!0,this._isModelLoading=!1;case 18:case"end":return e.stop()}}),e,this,[[4,13]])}))),function(e,t){return p.apply(this,arguments)})},{key:"unloadChat",value:(d=f(h().mark((function e(n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(i=this._messages)||i.addNewErrorMessage("service",t.GENERIC_ERROR),console.error(n),this._isModelLoaded=!1,this._isModelLoading=!1,e.t0=t.chat,!e.t0){e.next=9;break}return e.next=8,t.chat.unload();case 8:t.chat=void 0;case 9:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"immediateResp",value:(u=f(h().mark((function e(n,i,s){var r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.generate(i,void 0,0);case 2:return e.t0=e.sent,r={text:e.t0},e.next=6,t.processResponse(this.deepChat,n,r);case 6:(o=e.sent)&&n.addNewMessage(o),this.completionsHandlers.onFinish();case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"streamResp",value:(l=f(h().mark((function e(n,i,s){var r,o=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.streamHandlers.abortStream.abort=function(){s.interruptGenerate()},this.streamHandlers.onOpen(),r=new Jt(n),e.next=4,s.generate(i,function(){var e=f(h().mark((function e(i,s){var a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.processResponse(o.deepChat,n,{text:s});case 2:(a=e.sent)&&r.upsertStreamedMessage({text:a.text,overwrite:!0});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 4:r.finaliseStreamedMessage(),this.streamHandlers.onClose();case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return l.apply(this,arguments)})},{key:"generateRespByType",value:(a=f(h().mark((function e(t,n,i,s){var r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!i){e.next=6;break}return e.next=4,this.streamResp(t,n,s);case 4:e.next=8;break;case 6:return e.next=8,this.immediateResp(t,n,s);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),null==(r=this._messages)||r.addNewErrorMessage("service"),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(e,t,n,i){return a.apply(this,arguments)})},{key:"generateResp",value:(s=f(h().mark((function e(t,n,i){var s,r,o,a,l,c,u;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n[n.length-1].text,e.next=3,Zt.processRequestInterceptor(this.deepChat,{body:{text:s}});case 3:r=e.sent,o=r.body,a=r.error,l=!!this.stream;try{a?(Zt.displayError(t,new Error(a)),(l?this.streamHandlers.onClose:this.completionsHandlers.onFinish)()):o&&o.text?this.generateRespByType(t,o.text,!!this.stream,i):(c=G.INVALID_MODEL_REQUEST({body:o},!1),console.error(c),u=l?this.streamHandlers.onClose:this.completionsHandlers.onFinish,Zt.onInterceptorError(t,c,u))}catch(c){this.unloadChat(c)}case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return s.apply(this,arguments)})},{key:"callServiceAPI",value:(i=f(h().mark((function e(n,i){var s,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._isModelLoaded){e.next=7;break}if(!this._loadOnFirstMessage){e.next=6;break}return e.next=4,this.init();case 4:e.next=7;break;case 6:return e.abrupt("return");case 7:!t.chat||this._isModelLoading||(null!=(s=this._webModel.introMessage)&&s.removeAfterMessage&&(null==(r=this._removeIntro)||r.call(this)),n.addLoadingMessage(),this.generateResp(n,i,t.chat));case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"canSubmit",value:function(e){return!(null==e||!e.trim()||this._isModelLoading)&&(!!this._loadOnFirstMessage||!!this._isModelLoaded)}},{key:"isWebModel",value:function(){return!0}}],[{key:"setUpHistory",value:function(e,t){t.forEach((function(n,i){if(n.role===Wt.USER_ROLE&&n.text){var s=t[i+1];null!=s&&s.text&&s.role!==Wt.USER_ROLE&&e.push([n.text,s.text])}}))}},{key:"processResponse",value:(n=f(h().mark((function e(t,n,i){var s,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(s=t.responseInterceptor)?void 0:s.call(t,i);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=i;case 5:if(!(r=e.t0).error){e.next=11;break}return Zt.displayError(n,new Error(r.error)),e.abrupt("return");case 11:if(r&&r.text){e.next=15;break}return o=G.INVALID_MODEL_RESPONSE(i,!!t.responseInterceptor,r),Zt.displayError(n,new Error(o)),e.abrupt("return");case 15:return e.abrupt("return",r);case 16:case"end":return e.stop()}}),e)}))),function(e,t,i){return n.apply(this,arguments)})},{key:"clearAllCache",value:function(){t.clearCache("webllm/model"),t.clearCache("webllm/wasm")}},{key:"clearCache",value:function(e){caches.open(e).then((function(e){e.keys().then((function(t){t.forEach((function(t){e.delete(t)}))}))}))}}]);var n,i,s,a,l,u,d,p,m,v}(vn);Mn.GENERIC_ERROR="Error, please check the [troubleshooting](https://deepchat.dev/docs/webModel#troubleshooting) section of documentation for help.",Mn.MULTIPLE_MODELS_ERROR="Cannot run multiple web models",Mn.WEB_LLM_NOT_FOUND_ERROR="WebLLM module not found",Mn.DEFAULT_MODEL="Llama-2-7b-chat-hf-q4f32_1",Mn.MODULE_SEARCH_LIMIT_S=5;var An=Mn,In=function(){function e(){k(this,e)}return S(e,null,[{key:"buildHeaders",value:function(e){return{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}},{key:"handleVerificationResult",value:function(e,t,n,i){var s=e;Array.isArray(s.error)&&"Error in `parameters`: field required"===s.error[0]?n(t):i(G.INVALID_KEY)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api-inference.huggingface.co/models/gpt2",method:"POST",handleVerificationResult:e.handleVerificationResult}}}])}(),Rn=function(e){function t(e,n,i,s,o,a){var l;return k(this,t),(l=r(this,t,[e,In.buildKeyVerificationDetails(),In.buildHeaders,o,a])).insertKeyPlaceholderText="Hugging Face Token",l.keyHelpUrl="https://huggingface.co/settings/tokens",l.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Hugging Face</b></div>\n    <p>First message may take an extented amount of time to complete as the model needs to be initialized.</p>',l.permittedErrorPrefixes=["Authorization header"],l.url="".concat(t.URL_PREFIX).concat(i),l.textInputPlaceholderText=n,"object"==w(s)&&(s.model&&(l.url="".concat(t.URL_PREFIX).concat(s.model)),s.options&&(l.rawBody.options=s.options),s.parameters&&(l.rawBody.parameters=s.parameters)),l}return c(t,e),S(t,[{key:"preprocessBody",value:function(e,t,n){var i,s=JSON.parse(JSON.stringify(e)),r=t[t.length-1].text;if(r)return null!==(i=s.options)&&void 0!==i||(s.options={}),s.options.wait_for_model=!0,b({inputs:r},s)}},{key:"callServiceAPI",value:(n=f(h().mark((function e(t,n,i){var s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:s=this.preprocessBody(this.rawBody,n,i),dn.request(this,s,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,i){return n.apply(this,arguments)})}]);var n}(gn);Rn.URL_PREFIX="https://api-inference.huggingface.co/models/";var On=Rn,Ln=function(e){function t(e,n,i,s,o,a){var l;return k(this,t),(l=r(this,t,[e,n,i,s,o,a])).isTextInputDisabled=!0,l.canSendMessage=t.canSendFile,l}return c(t,e),S(t,[{key:"preprocessBody",value:function(e,t,n){return n[0]}},{key:"callServiceAPI",value:(n=f(h().mark((function e(t,n,i){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null!=i&&i[0]){e.next=4;break}throw new Error("No file was added");case 4:dn.poll(this,i[0],t,!1);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,i){return n.apply(this,arguments)})}],[{key:"canSendFile",value:function(e,t){return!(null==t||!t[0])}}]);var n}(On),Pn=function(e){function t(e){var n,i,s;return k(this,t),r(this,t,[e,"Attach an audio file","ehcalabres/wav2vec2-lg-xlsr-en-speech-emotion-recognition",null==(i=null==(n=e.directConnection)?void 0:n.huggingFace)?void 0:i.audioClassification,null==(s=e.directConnection)?void 0:s.huggingFace,{audio:{}}])}return c(t,e),S(t,[{key:"extractPollResultData",value:(n=f(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.estimated_time){e.next=2;break}return e.abrupt("return",{timeoutMS:1e3*(t.estimated_time+1)});case 2:if(!t.error){e.next=4;break}throw t.error;case 4:return e.abrupt("return",{text:(null==(n=t[0])?void 0:n.label)||""});case 5:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n}(Ln),Dn=function(e){function t(e){var n,i,s;return k(this,t),r(this,t,[e,"Attach an image file","google/vit-base-patch16-224",null==(i=null==(n=e.directConnection)?void 0:n.huggingFace)?void 0:i.imageClassification,null==(s=e.directConnection)?void 0:s.huggingFace,{images:{}}])}return c(t,e),S(t,[{key:"extractPollResultData",value:(n=f(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.estimated_time){e.next=2;break}return e.abrupt("return",{timeoutMS:1e3*(t.estimated_time+1)});case 2:if(!t.error){e.next=4;break}throw t.error;case 4:return e.abrupt("return",{text:(null==(n=t[0])?void 0:n.label)||""});case 5:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n}(Ln),Nn="data:image/png;base64,",zn=function(){function e(){k(this,e)}return S(e,null,[{key:"buildHeaders",value:function(e){return{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}},{key:"handleVerificationResult",value:function(e,t,n,i){e.message?i(G.INVALID_KEY):n(t)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.stability.ai/v1/engines/list",method:"GET",handleVerificationResult:e.handleVerificationResult}}}])}(),Bn=function(e){function t(e,n,i,s,o){var a;return k(this,t),(a=r(this,t,[e,n,i,s,o])).insertKeyPlaceholderText="Stability AI API Key",a.keyHelpUrl="https://platform.stability.ai/docs/getting-started/authentication",a.permittedErrorPrefixes=["Incorrect","invalid_"],a}return c(t,e),S(t)}(gn),Fn=function(e){function t(e){var n,i;k(this,t);var s=JSON.parse(JSON.stringify(e.directConnection)),o=null==s?void 0:s.stabilityAI;(n=r(this,t,[e,zn.buildKeyVerificationDetails(),zn.buildHeaders,o,{images:{files:{acceptedFormats:".png",maxNumberOfFiles:1}}}])).url="https://api.stability.ai/v1/generation/esrgan-v1-x2plus/image-to-image/upscale",n.textInputPlaceholderText="Describe image changes",n.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Stability AI</b></div>\n    <div style="width: 100%; text-align: center; margin-left: -10px; margin-top: 5px"><b>Image to Image Upscale</b></div>\n    <p>Upload an image to generate a new one with higher resolution.</p>\n    <p>Click <a href="https://platform.stability.ai/">here</a> for more info.</p>';var a=null==(i=null==s?void 0:s.stabilityAI)?void 0:i.imageToImageUpscale;return"object"==w(a)&&(a.engine_id&&(n.url="https://api.stability.ai/v1/generation/".concat(a.engine_id,"/image-to-image/upscale")),t.cleanConfig(a),Object.assign(n.rawBody,a)),n.canSendMessage=t.canSendFileMessage,n}return c(t,e),S(t,[{key:"createFormDataBody",value:function(e,t){var n=new FormData;return n.append("image",t),Object.keys(e).forEach((function(t){n.append(t,String(e[t]))})),n}},{key:"callServiceAPI",value:(i=f(h().mark((function e(t,n,i){var s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:if(i){e.next=4;break}throw new Error("Image was not found");case 4:s=this.createFormDataBody(this.rawBody,i[0]),Zt.tempRemoveContentHeader(this.connectSettings,dn.request.bind(this,this,s,t),!1);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"extractResultData",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.message){e.next=2;break}throw t.message;case 2:return e.abrupt("return",{files:t.artifacts.map((function(e){return{src:"".concat(Nn).concat(e.base64),type:"image"}}))});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}],[{key:"cleanConfig",value:function(e){delete e.engine_id}},{key:"canSendFileMessage",value:function(e,t){return!(null==t||!t[0])}}]);var n,i}(Bn),Un=function(e){function t(e){var n,i;k(this,t);var s=JSON.parse(JSON.stringify(e.directConnection)),o=null==s?void 0:s.stabilityAI;(n=r(this,t,[e,zn.buildKeyVerificationDetails(),zn.buildHeaders,o,{images:{files:{acceptedFormats:".png",maxNumberOfFiles:2}}}])).url="https://api.stability.ai/v1/generation/stable-diffusion-xl-1024-v1-0/image-to-image/masking",n._maskSource="MASK_IMAGE_WHITE",n.textInputPlaceholderText="Describe image changes",n.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Stability AI</b></div>\n    <div style="width: 100%; text-align: center; margin-left: -10px; margin-top: 5px"><b>Image to Image Masking</b></div>\n    <p>Upload an image, its mask image to create a new one based on the changes you have described for the mask area.</p>\n    <p>Click <a href="https://platform.stability.ai/">here</a> for more info.</p>';var a=null==(i=null==s?void 0:s.stabilityAI)?void 0:i.imageToImageMasking;return"object"==w(a)&&(a.engine_id&&(n.url="https://api.stability.ai/v1/generation/".concat(a.engine_id,"/image-to-image/masking")),void 0!==a.weight&&null!==a.weight&&(n._imageWeight=a.weight),void 0!==a.mask_source&&null!==a.mask_source&&(n._maskSource=a.mask_source),t.cleanConfig(a),Object.assign(n.rawBody,a)),n.canSendMessage=t.canSendFileTextMessage,n}return c(t,e),S(t,[{key:"createFormDataBody",value:function(e,t,n,i){var s=new FormData;return s.append("init_image",t),s.append("mask_source",String(this._maskSource)),s.append("mask_image",n),i&&""!==i&&s.append("text_prompts[0][text]",i),void 0!==this._imageWeight&&null!==this._imageWeight&&s.append("text_prompts[0][weight]",String(this._imageWeight)),Object.keys(e).forEach((function(t){s.append(t,String(e[t]))})),void 0===s.get("weight")&&s.append("weight",String(1)),s}},{key:"callServiceAPI",value:(i=f(h().mark((function e(t,n,i){var s,r,o,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:if(i&&i[0]&&i[1]){e.next=4;break}throw new Error("Image was not found");case 4:o=null==(r=null==(s=n[n.length-1])?void 0:s.text)?void 0:r.trim(),a=this.createFormDataBody(this.rawBody,i[0],i[1],o),Zt.tempRemoveContentHeader(this.connectSettings,dn.request.bind(this,this,a,t),!1);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"extractResultData",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.message){e.next=2;break}throw t.message;case 2:return e.abrupt("return",{files:t.artifacts.map((function(e){return{src:"".concat(Nn).concat(e.base64),type:"image"}}))});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}],[{key:"cleanConfig",value:function(e){delete e.engine_id,delete e.weight}},{key:"canSendFileTextMessage",value:function(e,t){return!(null==t||!t[0]||!e||""===e.trim())}}]);var n,i}(Bn),jn=function(e){function t(e){var n,i,s;return k(this,t),r(this,t,[e,"Attach an audio file","facebook/wav2vec2-large-960h-lv60-self",null==(i=null==(n=e.directConnection)?void 0:n.huggingFace)?void 0:i.audioSpeechRecognition,null==(s=e.directConnection)?void 0:s.huggingFace,{audio:{}}])}return c(t,e),S(t,[{key:"extractPollResultData",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.estimated_time){e.next=2;break}return e.abrupt("return",{timeoutMS:1e3*(t.estimated_time+1)});case 2:if(!t.error){e.next=4;break}throw t.error;case 4:return e.abrupt("return",{text:t.text||""});case 5:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n}(Ln),qn=function(e){function t(e){var n,i,s;return k(this,t),r(this,t,[e,"Once upon a time","gpt2",null==(i=null==(n=e.directConnection)?void 0:n.huggingFace)?void 0:i.textGeneration,null==(s=e.directConnection)?void 0:s.huggingFace])}return c(t,e),S(t,[{key:"extractResultData",value:(n=f(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:return e.abrupt("return",{text:(null==(n=t[0])?void 0:n.generated_text)||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n}(On),Vn=function(e){function t(e){var n,i,s,o;k(this,t);var a=null==(s=null==(i=e.directConnection)?void 0:i.huggingFace)?void 0:s.questionAnswer;return(n=r(this,t,[e,"Ask a question","bert-large-uncased-whole-word-masking-finetuned-squad",a,null==(o=e.directConnection)?void 0:o.huggingFace])).permittedErrorPrefixes=["Authorization header","Error in"],n.context=a.context,n}return c(t,e),S(t,[{key:"preprocessBody",value:function(e,t){var n=t[t.length-1].text;if(n)return{inputs:{question:n,context:this.context,options:{wait_for_model:!0}}}}},{key:"extractResultData",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:return e.abrupt("return",{text:t.answer||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n}(On),Hn=function(e){function t(e){var n,i,s;return k(this,t),r(this,t,[e,"Insert text to summarize","facebook/bart-large-cnn",null==(i=null==(n=e.directConnection)?void 0:n.huggingFace)?void 0:i.summarization,null==(s=e.directConnection)?void 0:s.huggingFace])}return c(t,e),S(t,[{key:"extractResultData",value:(n=f(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:return e.abrupt("return",{text:(null==(n=t[0])?void 0:n.summary_text)||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n}(On),Gn=function(e){function t(e){var n,i,s,o,a;return k(this,t),null!==(n=(i=r(this,t,[e,"Ask me anything!","facebook/blenderbot-400M-distill",null==(o=null==(s=e.directConnection)?void 0:s.huggingFace)?void 0:o.conversation,null==(a=e.directConnection)?void 0:a.huggingFace])).maxMessages)&&void 0!==n||(i.maxMessages=-1),i}return c(t,e),S(t,[{key:"processMessages",value:function(e){var t=e.filter((function(e){return e.text})),n=t[t.length-1].text,i=t.slice(0,t.length-1);if(n)return{past_user_inputs:i.filter((function(e){return"user"===e.role})).map((function(e){return e.text})),generated_responses:i.filter((function(e){return"ai"===e.role})).map((function(e){return e.text})),mostRecentMessageText:n}}},{key:"preprocessBody",value:function(e,t){var n,i=JSON.parse(JSON.stringify(e)),s=this.processMessages(t);if(s)return null!==(n=i.options)&&void 0!==n||(i.options={}),i.options.wait_for_model=!0,b({inputs:{past_user_inputs:s.past_user_inputs,generated_responses:s.generated_responses,text:s.mostRecentMessageText}},i)}},{key:"extractResultData",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:return e.abrupt("return",{text:t.generated_text||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n}(On),Wn=function(e){function t(e){var n,i;k(this,t);var s=JSON.parse(JSON.stringify(e.directConnection)),o=s.stabilityAI;(n=r(this,t,[e,zn.buildKeyVerificationDetails(),zn.buildHeaders,o,{images:{files:{acceptedFormats:".png",maxNumberOfFiles:1}}}])).url="https://api.stability.ai/v1/generation/stable-diffusion-v1-6/image-to-image",n.textInputPlaceholderText="Describe image changes",n.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Stability AI: Image to Image</b></div>\n    <p>Upload an image to create a new one with the changes you have described.</p>\n    <p>Click <a href="https://platform.stability.ai/">here</a> for more info.</p>';var a=null==(i=s.stabilityAI)?void 0:i.imageToImage;return"object"==w(a)&&(a.engine_id&&(n.url="https://api.stability.ai/v1/generation/".concat(a.engine_id,"/text-to-image")),void 0!==a.weight&&null!==a.weight&&(n._imageWeight=a.weight),t.cleanConfig(a),Object.assign(n.rawBody,a)),n.canSendMessage=t.canSendFileTextMessage,n}return c(t,e),S(t,[{key:"createFormDataBody",value:function(e,t,n){var i=new FormData;return i.append("init_image",t),n&&""!==n&&i.append("text_prompts[0][text]",n),void 0!==this._imageWeight&&null!==this._imageWeight&&i.append("text_prompts[0][weight]",String(this._imageWeight)),Object.keys(e).forEach((function(t){i.append(t,String(e[t]))})),void 0===i.get("weight")&&i.append("weight",String(1)),i}},{key:"callServiceAPI",value:(i=f(h().mark((function e(t,n,i){var s,r,o,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:if(i){e.next=4;break}throw new Error("Image was not found");case 4:o=null==(r=null==(s=n[n.length-1])?void 0:s.text)?void 0:r.trim(),a=this.createFormDataBody(this.rawBody,i[0],o),Zt.tempRemoveContentHeader(this.connectSettings,dn.request.bind(this,this,a,t),!1);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"extractResultData",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.message){e.next=2;break}throw t.message;case 2:return e.abrupt("return",{files:t.artifacts.map((function(e){return{src:"".concat(Nn).concat(e.base64),type:"image"}}))});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}],[{key:"cleanConfig",value:function(e){delete e.engine_id,delete e.weight}},{key:"canSendFileTextMessage",value:function(e,t){return!(null==t||!t[0]||!e||""===e.trim())}}]);var n,i}(Bn),Kn=function(e){function t(e){var n,i,s;return k(this,t),r(this,t,[e,"Insert text to translate","Helsinki-NLP/opus-tatoeba-en-ja",null==(i=null==(n=e.directConnection)?void 0:n.huggingFace)?void 0:i.translation,null==(s=e.directConnection)?void 0:s.huggingFace])}return c(t,e),S(t,[{key:"extractResultData",value:(n=f(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:return e.abrupt("return",{text:(null==(n=t[0])?void 0:n.translation_text)||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n}(On),Jn=function(e){function t(e){var n,i;k(this,t);var s=JSON.parse(JSON.stringify(e.directConnection)),o=s.stabilityAI;(n=r(this,t,[e,zn.buildKeyVerificationDetails(),zn.buildHeaders,o])).url="https://api.stability.ai/v1/generation/stable-diffusion-v1-6/text-to-image",n.textInputPlaceholderText="Describe an image",n.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Stability AI: Text to Image</b></div>\n    <p>Insert text to generate an image.</p>\n    <p>Click <a href="https://platform.stability.ai/">here</a> for more info.</p>';var a=null==(i=s.stabilityAI)?void 0:i.textToImage;return"object"==w(a)&&(a.engine_id&&(n.url="https://api.stability.ai/v1/generation/".concat(a.engine_id,"/text-to-image")),void 0!==a.weight&&null!==a.weight&&(n._imageWeight=a.weight),t.cleanConfig(a),Object.assign(n.rawBody,a)),n.canSendMessage=t.canSendTextMessage,n}return c(t,e),S(t,[{key:"preprocessBody",value:function(e,t){var n=JSON.parse(JSON.stringify(e)),i={text:t};return this._imageWeight&&(i.weight=this._imageWeight),n.text_prompts=[i],n}},{key:"callServiceAPI",value:(i=f(h().mark((function e(t,n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:i=this.preprocessBody(this.rawBody,n[n.length-1].text),dn.request(this,i,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"extractResultData",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.message){e.next=2;break}throw t.message;case 2:return e.abrupt("return",{files:t.artifacts.map((function(e){return{src:"".concat(Nn).concat(e.base64),type:"image"}}))});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}],[{key:"cleanConfig",value:function(e){delete e.engine_id,delete e.weight}},{key:"canSendTextMessage",value:function(e){return!(!e||""===e.trim())}}]);var n,i}(Bn),Yn=function(e){function t(e){var n,i,s,o;return k(this,t),(n=r(this,t,[e,"The goal of life is [MASK].","bert-base-uncased",null==(s=null==(i=e.directConnection)?void 0:i.huggingFace)?void 0:s.fillMask,null==(o=e.directConnection)?void 0:o.huggingFace])).introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Hugging Face</b></div>\n    <p>Insert a sentence with the word [MASK] and the model will try to fill it for you. E.g. I want [MASK].</p>\n    <p>First message may take an extented amount of time to complete as the model needs to be initialized.</p>',n.permittedErrorPrefixes=["Authorization header","No mask_token"],n}return c(t,e),S(t,[{key:"extractResultData",value:(n=f(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:return e.abrupt("return",{text:(null==(n=t[0])?void 0:n.sequence)||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n}(On),Zn=function(){function e(){k(this,e)}return S(e,null,[{key:"buildHeaders",value:function(e){return{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}},{key:"handleVerificationResult",value:function(e,t,n,i){var s=e;s.error?"invalid_api_key"===s.error.code?i(G.INVALID_KEY):i(G.CONNECTION_FAILED):n(t)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.openai.com/v1/models",method:"GET",handleVerificationResult:e.handleVerificationResult}}},{key:"directFetch",value:(t=f(h().mark((function e(t,n,i){var s,r,o=arguments;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=!(o.length>3&&void 0!==o[3])||o[3],t.connectSettings.method=i,e.next=4,Zt.fetch(t,t.connectSettings.headers,s,n).then((function(e){return Zt.processResponseByType(e)}));case 4:if(!(r=e.sent).error){e.next=7;break}throw r.error.message;case 7:return e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)}))),function(e,n,i){return t.apply(this,arguments)})}]);var t}();Zn.FUNCTION_TOOL_RESP_ERROR="Response object must either be {response: string}[] for each individual function or {text: string} for a direct response, see https://deepchat.dev/docs/directConnection/OpenAI#FunctionHandler.";var Xn=Zn,$n=function(){function e(){k(this,e)}return S(e,null,[{key:"storeFiles",value:(o=f(h().mark((function e(t,n,i,s){var r,o,a,l;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.connectSettings.headers){e.next=3;break}return e.abrupt("return");case 3:return t.url=s,o=r[Zt.CONTENT_TYPE],delete r[Zt.CONTENT_TYPE],a=i.map(function(){var e=f(h().mark((function e(n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new FormData,e.abrupt("return",(i.append("purpose","assistants"),i.append("file",n),new Promise((function(e){e(Xn.directFetch(t,i,"POST",!1))}))));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.prev=7,e.next=10,Promise.all(a);case 10:return l=e.sent.map((function(e){return{id:e.id,name:e.filename}})),e.abrupt("return",(r[Zt.CONTENT_TYPE]=o,l));case 14:throw e.prev=14,e.t0=e.catch(7),r[Zt.CONTENT_TYPE]=o,Zt.displayError(n,e.t0),t.completionsHandlers.onFinish(),e.t0;case 17:case"end":return e.stop()}}),e,null,[[7,14]])}))),function(e,t,n,i){return o.apply(this,arguments)})},{key:"getType",value:function(e,t){var n=e[t].path;return!n||n.endsWith("png")?"image":"any"}},{key:"getFiles",value:(r=f(h().mark((function t(n,i,s,r){var o,a;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=i.map((function(e){var t=e.fileId;return n.url="".concat(s).concat(t).concat(r),new Promise((function(e){e(Xn.directFetch(n,void 0,"GET",!1))}))})),t.next=3,Promise.all(o);case 3:return a=t.sent.map((function(t,n){return new Promise((function(s){var r=new FileReader;r.readAsDataURL(t),r.onload=function(t){s({src:t.target.result,name:i[n].name,type:e.getType(i,n)})}}))})),t.next=6,Promise.all(a);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"getFileName",value:function(e){var t=e.split("/");return t[t.length-1]}},{key:"getFilesAndNewText",value:(s=f(h().mark((function t(n,i,s,r,o){var a,l,c,u,d;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u=s.getFilesPrefix,d=s.getFilesPostfix,t.t0=i.length>0,!t.t0){t.next=7;break}return t.next=5,e.getFiles(n,i,u,d);case 5:c=t.sent,null!=(a=null==o?void 0:o.text)&&a.value&&c.forEach((function(e,t){var n;if(e.src){var s=i[t].path;null!=(n=null==o?void 0:o.text)&&n.value&&s&&(o.text.value=o.text.value.replace(s,e.src))}}));case 7:return t.abrupt("return",null!=(l=null==o?void 0:o.text)&&l.value?{text:o.text.value,role:r}:{files:c,role:r});case 8:case"end":return t.stop()}}),t)}))),function(e,t,n,i,r){return s.apply(this,arguments)})},{key:"getFileDetails",value:function(t,n){var i,s=[];return null!=(i=null==n?void 0:n.text)&&i.value&&t.content.forEach((function(t){var n,i;null==(i=null==(n=t.text)?void 0:n.annotations)||i.forEach((function(t){var n;t.text&&t.text.startsWith("sandbox:")&&null!=(n=t.file_path)&&n.file_id&&s.push({path:t.text,fileId:t.file_path.file_id,name:e.getFileName(t.text)})}))})),null!=n&&n.image_file&&s.push({fileId:n.image_file.file_id}),s}},{key:"getFilesAndText",value:(i=f(h().mark((function t(n,i,s,r){var o;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.getFileDetails(i,r),t.next=3,e.getFilesAndNewText(n,o,s,i.role,r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(e,t,n,s){return i.apply(this,arguments)})},{key:"parseResult",value:function(e,t){var n=[];if(t)n=e.data;else for(var i=0;i<e.data.length;i+=1){var s=e.data[i];if("assistant"!==s.role)break;n.push(s)}return n.reverse()}},{key:"parseMessages",value:function(t,n,i){var s=[];return n.forEach(function(){var n=f(h().mark((function n(r){return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r.content.filter((function(e){return!!e.text||!!e.image_file})).sort((function(e){return e.text?-1:e.image_file?1:0})).forEach(function(){var n=f(h().mark((function n(o){return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:s.push(e.getFilesAndText(t,r,i,o));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),Promise.all(s)}},{key:"processStreamMessages",value:(n=f(h().mark((function t(n,i,s){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.parseMessages(n,[{content:i,role:"assistant"}],s));case 1:case"end":return t.stop()}}),t)}))),function(e,t,i){return n.apply(this,arguments)})},{key:"processAPIMessages",value:(t=f(h().mark((function t(n,i,s,r){var o;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.parseResult(i,s),t.abrupt("return",e.parseMessages(n,o,r));case 2:case"end":return t.stop()}}),t)}))),function(e,n,i,s){return t.apply(this,arguments)})}]);var t,n,i,s,r,o}();$n.FILES_WITH_TEXT_ERROR="content with type `text` must have `text` values",$n.FUNCTION_TOOL_RESP_ERROR="Response must contain an array of strings for each individual function/tool_call, see https://deepchat.dev/docs/directConnection/OpenAI/#assistant-functions.";var Qn=$n,ei=function(e){function t(e,n,i,s,o,a){var l;if(k(this,t),(l=r(this,t,[e,s,o,a])).insertKeyPlaceholderText="OpenAI API Key",l.keyHelpUrl="https://platform.openai.com/account/api-keys",l.url="",l.permittedErrorPrefixes=["Incorrect","Please send text",pn.FAILED_ERROR_MESSAGE],l.shouldFetchHistory=!1,l.searchedForThreadId=!1,l.config={},l.newAssistantDetails={model:"gpt-4"},l.waitingForStreamResponse=!1,l.isSSEStream=!1,l.urlSegments=i,"object"==w(n)){l.config=n;var c=l.config,u=c.new_assistant,d=c.thread_id,h=c.load_thread_history;Object.assign(l.newAssistantDetails,u),d&&(l.sessionId=d),h&&(l.shouldFetchHistory=!0)}return l.maxMessages=1,l.isSSEStream=!(!l.stream||"object"==w(l.stream)&&l.stream.simulation),l}return c(t,e),S(t,[{key:"fetchHistoryFunc",value:(g=f(h().mark((function e(){var t,n=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return setTimeout((function(){return n.deepChat.disableSubmitButton()}),2),e.prev=1,e.next=4,this.getThreadMessages(this.sessionId,!0);case 4:return t=e.sent,e.abrupt("return",(this.deepChat.disableSubmitButton(!1),t));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",[{error:"Failed to fetch history"}]);case 11:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(){return g.apply(this,arguments)})},{key:"processMessage",value:function(e,n){var i=this.totalMessagesMaxCharLength||-1,s=fn.getCharacterLimitMessages(e,i)[0];if(n&&n.length>0){var r=this.filesToolType;if("function"==typeof this.filesToolType){var o=this.filesToolType(n.map((function(e){return e.name})));"code_interpreter"===o||"file_search"===o||"images"===o?r=o:(console.error('Tool type "'.concat(o,'" is not valid')),console.error('Expected "code_interpreter" or "file_search" or "images". Going to default to "images"'))}if("file_search"===r)return t.processAttachmentsMessage(s,n,"file_search");if("code_interpreter"===r)return t.processAttachmentsMessage(s,n,"code_interpreter");if(n.find((function(e){var t=e.name;return!Q.isImageFileExtension(t)})))console.error("The uploaded files contained a non-image file"),console.error('Make sure only images can be uploaded or define a "code_interpreter" or "file_search" value in the "files_tool_type" property'),console.warn('Make sure your existing assistant supports these "tools" or specify them in the "new_assistant" property');else{var a=t.processImageMessage(s,n);if(a)return a}}return{content:s.text||"",role:"user"}}},{key:"createNewThreadMessages",value:function(e,t,n){var i=JSON.parse(JSON.stringify(e)),s=this.processMessage(t,n);return i.thread={messages:[s]},i}},{key:"callService",value:function(e,t,n){if(this.messages=e,this.sessionId){this.url="".concat(this.urlSegments.threadsPrefix,"/").concat(this.sessionId,"/messages").concat(this.urlSegments.createMessagePostfix);var i=this.processMessage(t,n);dn.request(this,i,e)}else{this.url="".concat(this.urlSegments.threadsPrefix,"/runs").concat(this.urlSegments.threadsPosfix);var s=this.createNewThreadMessages(this.rawBody,t,n);this.isSSEStream?this.createStreamRun(s):dn.request(this,s,e)}}},{key:"callServiceAPI",value:(v=f(h().mark((function e(t,n,i){var s,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.waitingForStreamResponse=!1,this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null===(s=(r=this.rawBody).assistant_id)||void 0===s){e.next=6;break}e.next=12;break;case 6:if(e.t0=this.config.assistant_id,e.t0){e.next=11;break}return e.next=10,this.createNewAssistant();case 10:e.t0=e.sent;case 11:r.assistant_id=e.t0;case 12:if(this.searchedForThreadId||this.searchPreviousMessagesForThreadId(t.messageToElements),!i){e.next=19;break}return e.next=16,Qn.storeFiles(this,t,i,this.urlSegments.storeFiles);case 16:e.t1=e.sent,e.next=20;break;case 19:e.t1=void 0;case 20:o=e.t1,this.connectSettings.method="POST",this.callService(t,n,o);case 22:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return v.apply(this,arguments)})},{key:"createNewAssistant",value:(m=f(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.url=this.urlSegments.newAssistantUrl,e.next=4,Xn.directFetch(this,JSON.parse(JSON.stringify(this.newAssistantDetails)),"POST");case 4:return t=e.sent,e.abrupt("return",(this.config.assistant_id=t.id,this.config.assistant_id));case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),console.error("Failed to create a new assistant");case 11:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return m.apply(this,arguments)})},{key:"searchPreviousMessagesForThreadId",value:function(e){var t=e.find((function(e){return d(e,1)[0]._sessionId}));t&&(this.sessionId=t[0]._sessionId),this.searchedForThreadId=!0}},{key:"extractResultData",value:(p=f(h().mark((function e(t){var n,i,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.waitingForStreamResponse||this.isSSEStream&&this.sessionId)){e.next=4;break}return e.next=3,this.handleStream(t);case 3:return e.abrupt("return",e.sent);case 4:if(!t.error){e.next=6;break}throw t.error.message.startsWith(Qn.FILES_WITH_TEXT_ERROR)?Error("Please send text with your file(s)"):t.error.message;case 6:return e.next=8,this.assignThreadAndRun(t);case 8:return i="".concat(this.urlSegments.threadsPrefix,"/").concat(this.sessionId,"/runs/").concat(this.run_id).concat(this.urlSegments.threadsPosfix),s={method:"GET",headers:null==(n=this.connectSettings)?void 0:n.headers},e.abrupt("return",(dn.executePollRequest(this,i,s,this.messages),{makingAnotherRequest:!0}));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"assignThreadAndRun",value:(u=f(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.sessionId){e.next=8;break}return this.url="".concat(this.urlSegments.threadsPrefix,"/").concat(this.sessionId,"/runs").concat(this.urlSegments.threadsPosfix),e.next=4,Xn.directFetch(this,JSON.parse(JSON.stringify(this.rawBody)),"POST");case 4:n=e.sent,this.run_id=n.id,e.next=9;break;case 8:this.sessionId=t.thread_id,this.run_id=t.id,this.messages&&this.messages.messageToElements.length>0&&(this.messages.messageToElements[this.messages.messageToElements.length-1][0]._sessionId=this.sessionId);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"getThreadMessages",value:(l=f(h().mark((function e(t){var n,i,s,r,o=arguments;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]&&o[1],this.url="".concat(this.urlSegments.threadsPrefix,"/").concat(t,"/messages?").concat(this.urlSegments.listMessagesPostfix),e.next=4,Xn.directFetch(this,{},"GET");case 4:if(r=e.sent,e.t0=!n&&this.deepChat.responseInterceptor,!e.t0){e.next=10;break}return e.next=9,null==(s=(i=this.deepChat).responseInterceptor)?void 0:s.call(i,r);case 9:r=e.sent;case 10:return e.abrupt("return",Qn.processAPIMessages(this,r,n,this.urlSegments));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"extractPollResultData",value:(a=f(h().mark((function e(n){var i,s,r,o,a,l,c,u,d=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=n.status,r=n.required_action,"queued"!==s&&"in_progress"!==s){e.next=3;break}return e.abrupt("return",{timeoutMS:t.POLLING_TIMEOUT_MS});case 3:if("completed"!==s||!this.messages){e.next=11;break}return e.next=6,this.getThreadMessages(n.thread_id);case 6:return o=e.sent,a=o.shift(),l=a.text,c=a.files,e.abrupt("return",(setTimeout((function(){o.forEach((function(e){return d.deepChat.addMessage(e)}))})),{text:l,_sessionId:this.sessionId,files:c}));case 11:if(u=null==(i=null==r?void 0:r.submit_tool_outputs)?void 0:i.tool_calls,"requires_action"!==s||!u){e.next=16;break}return e.next=15,this.handleTools(u);case 15:return e.abrupt("return",e.sent);case 16:throw Error("Thread run status: ".concat(s));case 17:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"handleTools",value:(o=f(h().mark((function e(n){var i,s,r,o,a,l;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.functionHandler){e.next=2;break}throw Error("Please define the `function_handler` property inside the [openAI](https://deepchat.dev/docs/directConnection/openAI#Assistant) object.");case 2:return i=n.map((function(e){return{name:e.function.name,arguments:e.function.arguments}})),e.next=5,this.functionHandler(i);case 5:if(s=e.sent,Array.isArray(s)&&n.length===s.length){e.next=8;break}throw Error(Qn.FUNCTION_TOOL_RESP_ERROR);case 8:return e.next=10,Promise.all(s);case 10:if(!(r=e.sent).find((function(e){return"string"!=typeof e}))){e.next=13;break}throw Error(Qn.FUNCTION_TOOL_RESP_ERROR);case 13:if(o=r.map((function(e,t){return{tool_call_id:n[t].id,output:e}})),a="".concat(this.urlSegments.threadsPrefix,"/").concat(this.sessionId),l="/runs/".concat(this.run_id,"/submit_tool_outputs").concat(this.urlSegments.threadsPosfix),this.url="".concat(a).concat(l),!this.isSSEStream){e.next=20;break}return e.next=18,this.createStreamRun({tool_outputs:o});case 18:e.next=22;break;case 20:return e.next=22,Xn.directFetch(this,{tool_outputs:o},"POST");case 22:return e.abrupt("return",{timeoutMS:t.POLLING_TIMEOUT_MS});case 23:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"handleStream",value:(s=f(h().mark((function e(t){var n,i,s,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=null==(i=null==(n=t.required_action)?void 0:n.submit_tool_outputs)?void 0:i.tool_calls,"requires_action"!==t.status||!s){e.next=6;break}return this.run_id=t.id,e.next=5,this.handleTools(s);case 5:return e.abrupt("return",e.sent);case 6:if(!this.waitingForStreamResponse){e.next=8;break}return e.abrupt("return",this.parseStreamResult(t));case 8:return this.isSSEStream&&this.sessionId&&(this.url="".concat(this.urlSegments.threadsPrefix,"/").concat(this.sessionId,"/runs").concat(this.urlSegments.threadsPosfix),r=JSON.parse(JSON.stringify(this.rawBody)),this.createStreamRun(r)),e.abrupt("return",{makingAnotherRequest:!0});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"parseStreamResult",value:(i=f(h().mark((function e(t){var n,i,s,r,o,a,l,c,u,d;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.content&&t.content.length>0&&this.messages)){e.next=5;break}if(a=t.content.find((function(e){return e.text})),!(null!=(n=null==a?void 0:a.text)&&n.annotations&&a.text.annotations.length>0)){e.next=5;break}return l=t.content.find((function(e){return!!e.text}))||t.content[0],c=Qn.getFilesAndText.bind(this,this,{role:"assistant",content:t.content},this.urlSegments,l),e.abrupt("return",(null==(i=this.messageStream)||i.endStreamAfterFileDownloaded(this.messages,c),{text:""}));case 5:if(null==(s=t.delta)||!s.content){e.next=14;break}if(!(t.delta.content.length>1)){e.next=13;break}if(u=t.delta.content.find((function(e){return e.text})),null==(r=null==u?void 0:u.text)||!r.annotations||0!==u.text.annotations.length){e.next=13;break}return e.next=11,Qn.processStreamMessages(this,t.delta.content,this.urlSegments);case 11:return d=e.sent,e.abrupt("return",{text:d[0].text,files:d[1].files});case 13:return e.abrupt("return",{text:null==(o=t.delta.content[0].text)?void 0:o.value});case 14:return e.abrupt("return",(!this.sessionId&&t.thread_id&&(this.sessionId=t.thread_id),{makingAnotherRequest:!0}));case 15:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"createStreamRun",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.stream=!0,this.waitingForStreamResponse=!0,e.next=4,on.request(this,t,this.messages,!0,!0);case 4:this.messageStream=e.sent;case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}],[{key:"processImageMessage",value:function(e,t){var n=null==t?void 0:t.filter((function(e){return Q.isImageFileExtension(e.name)})).map((function(e){return{type:"image_file",image_file:{file_id:e.id}}}));if(n&&n.length>0)return e.text&&e.text.length>0&&n.push({type:"text",text:e.text}),{content:n,role:"user"}}},{key:"processAttachmentsMessage",value:function(e,t,n){return{attachments:t.map((function(e){return{tools:[{type:n}],file_id:e.id}})),content:[{type:"text",text:e.text}],role:"user"}}}]);var n,i,s,o,a,l,u,p,m,v,g}(gn);ei.POLLING_TIMEOUT_MS=800;var ti=ei,ni=function(e){function t(e){var n,i,s,a,l,c,u,d;k(this,t);var h=JSON.parse(JSON.stringify(e.directConnection)),p=h.openAI,f=null==(a=h.openAI)?void 0:a.assistant;if(null!==(n=(l=(s=r(this,t,[e,f,t.URL_SEGMENTS,Xn.buildKeyVerificationDetails(),Xn.buildHeaders,p])).connectSettings).headers)&&void 0!==n||(l.headers={}),null!==(i=(c=s.connectSettings.headers)["OpenAI-Beta"])&&void 0!==i||(c["OpenAI-Beta"]="assistants=v2"),s.shouldFetchHistory&&s.sessionId&&(s.fetchHistory=s.fetchHistoryFunc.bind(o(s))),"object"==w(f)){var m=null==(d=null==(u=e.directConnection)?void 0:u.openAI)?void 0:d.assistant,v=m.function_handler,g=m.files_tool_type;v&&(s.functionHandler=v),g&&(s.filesToolType=g)}return s}return c(t,e),S(t)}(ti);ni.URL_SEGMENTS={threadsPrefix:"https://api.openai.com/v1/threads",threadsPosfix:"",newAssistantUrl:"https://api.openai.com/v1/assistants",createMessagePostfix:"",listMessagesPostfix:"order=desc",storeFiles:"https://api.openai.com/v1/files",getFilesPrefix:"https://api.openai.com/v1/files/",getFilesPostfix:"/content"};var ii=ni,si=function(){function e(){k(this,e)}return S(e,null,[{key:"buildHeaders",value:function(e){return{Authorization:"Bearer ".concat(e),"Content-Type":"application/json",accept:"application/json"}}},{key:"handleVerificationResult",value:function(e,t,n,i){var s;null!=(s=e.message)&&s.includes("invalid request: prompt must be at least 1 token long")?n(t):i(G.INVALID_KEY)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.cohere.ai/v1/generate",method:"POST",handleVerificationResult:e.handleVerificationResult,body:JSON.stringify({prompt:""})}}}])}(),ri=function(e){function t(e,n,i,s,o){var a;return k(this,t),(a=r(this,t,[e,si.buildKeyVerificationDetails(),si.buildHeaders,o])).insertKeyPlaceholderText="Cohere API Key",a.keyHelpUrl="https://dashboard.cohere.ai/api-keys",a.permittedErrorPrefixes=["invalid"],a.url=n,a.textInputPlaceholderText=i,s&&"object"==w(s)&&Object.assign(a.rawBody,s),a}return c(t,e),S(t)}(gn),oi=function(e){function t(e){var n,i,s;return k(this,t),r(this,t,[e,"https://api.cohere.ai/v1/generate","Once upon a time",null==(i=null==(n=e.directConnection)?void 0:n.cohere)?void 0:i.textGeneration,null==(s=e.directConnection)?void 0:s.cohere])}return c(t,e),S(t,[{key:"preprocessBody",value:function(e,t){var n=JSON.parse(JSON.stringify(e)),i=t[t.length-1].text;if(i)return b({prompt:i},n)}},{key:"callServiceAPI",value:(i=f(h().mark((function e(t,n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:i=this.preprocessBody(this.rawBody,n),dn.request(this,i,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"extractResultData",value:(n=f(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.message){e.next=2;break}throw t.message;case 2:return e.abrupt("return",{text:(null==(n=t.generations)?void 0:n[0].text)||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n,i}(ri),ai=function(){return S((function e(){k(this,e)}),null,[{key:"buildHeaders",value:function(e){return{"api-key":e,"Content-Type":"application/json"}}},{key:"buildKeyVerificationDetails",value:function(e){return{url:"".concat(e.endpoint,"/openai/models?api-version=").concat(e.version),method:"GET",handleVerificationResult:Xn.handleVerificationResult}}},{key:"validateURLDetails",value:function(e){var t=e.endpoint,n=e.version,i=e.deploymentId;return t&&n&&i}}])}();ai.URL_DETAILS_ERROR_MESSAGE="Please define the Azure URL Details. [More Information](https://deepchat.dev/docs/directConnection/Azure)";var li=ai,ci=function(e){function t(e){var n,i,s,o,a,l,c,u,d,h;k(this,t);var p=JSON.parse(JSON.stringify(e.directConnection)),f=p.azure,m=null==(s=p.azure)?void 0:s.openAI,v=(null==m?void 0:m.urlDetails)||{},g="".concat(null==(o=null==m?void 0:m.urlDetails)?void 0:o.endpoint,"/openai/"),y="?api-version=".concat(null==(a=null==m?void 0:m.urlDetails)?void 0:a.version),b={threadsPrefix:"".concat(g).concat(t.THREAD_RESOURCE),threadsPosfix:y,newAssistantUrl:"".concat(g).concat(t.NEW_ASSISTANT_RESOURCE).concat(y),createMessagePostfix:y,listMessagesPostfix:"order=desc&api-version=".concat(null==(l=null==m?void 0:m.urlDetails)?void 0:l.version),storeFiles:"".concat(g,"files").concat(y),getFilesPrefix:"".concat(g,"files/"),getFilesPostfix:"/content".concat(y)};if((i=r(this,t,[e,null==m?void 0:m.assistant,b,li.buildKeyVerificationDetails(v),li.buildHeaders,f])).permittedErrorPrefixes=[li.URL_DETAILS_ERROR_MESSAGE],i.insertKeyPlaceholderText="Azure OpenAI API Key",i.keyHelpUrl="https://learn.microsoft.com/en-us/answers/questions/1193991/how-to-get-the-value-of-openai-api-key",i.isTextInputDisabled=!1,"object"==w(null==m?void 0:m.assistant)){var _=null==(d=null==(u=null==(c=e.directConnection)?void 0:c.azure)?void 0:u.openAI)?void 0:d.assistant,x=_.function_handler,S=_.files_tool_type;x&&(i.functionHandler=x),S&&(i.filesToolType=S)}return li.validateURLDetails(v)?null!==(n=(h=i.connectSettings).headers)&&void 0!==n||(h.headers={}):(i.isTextInputDisabled=!0,i.canSendMessage=function(){return!1},setTimeout((function(){e.addMessage({error:li.URL_DETAILS_ERROR_MESSAGE})}))),i}return c(t,e),S(t)}(ti);ci.THREAD_RESOURCE="threads",ci.NEW_ASSISTANT_RESOURCE="assistants";var ui=ci,di=function(e){function t(e){var n,i,s;return k(this,t),r(this,t,[e,"https://api.cohere.ai/v1/summarize","Insert text to summarize",null==(i=null==(n=e.directConnection)?void 0:n.cohere)?void 0:i.summarization,null==(s=e.directConnection)?void 0:s.cohere])}return c(t,e),S(t,[{key:"preprocessBody",value:function(e,t){var n=JSON.parse(JSON.stringify(e)),i=t[t.length-1].text;if(i)return b({text:i},n)}},{key:"callServiceAPI",value:(i=f(h().mark((function e(t,n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:i=this.preprocessBody(this.rawBody,n),dn.request(this,i,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"extractResultData",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.message){e.next=2;break}throw t.message;case 2:return e.abrupt("return",{text:t.summary||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n,i}(ri),hi=function(e){function t(e){var n,i,s,o,a,l;k(this,t);var c=JSON.parse(JSON.stringify(e.directConnection)),u=null==c?void 0:c.openAI;(s=r(this,t,[e,Xn.buildKeyVerificationDetails(),Xn.buildHeaders,u])).insertKeyPlaceholderText="OpenAI API Key",s.keyHelpUrl="https://platform.openai.com/account/api-keys",s.url="https://api.openai.com/v1/audio/speech",s.permittedErrorPrefixes=["Invalid"],s.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>OpenAI : Text To Speech</b></div>\n    <p>Generate an audio file based on your text input.</p>\n    <p>Click <a href="https://platform.openai.com/docs/guides/text-to-speech">here</a> for more information.</p>';var d=null==(o=null==c?void 0:c.openAI)?void 0:o.textToSpeech;return"object"==w(d)&&Object.assign(s.rawBody,d),null!==(n=(a=s.rawBody).model)&&void 0!==n||(a.model=t.DEFAULT_MODEL),null!==(i=(l=s.rawBody).voice)&&void 0!==i||(l.voice=t.DEFAULT_VOIDE),s.textInputPlaceholderText="Insert text to generate audio",s.rawBody.response_format="mp3",s}return c(t,e),S(t,[{key:"preprocessBody",value:function(e,t){var n,i,s=JSON.parse(JSON.stringify(e)),r=null==(i=null==(n=t[t.length-1])?void 0:n.text)?void 0:i.trim();return r&&""!==r&&(s.input=r),s}},{key:"callServiceAPI",value:(i=f(h().mark((function e(t,n){var i,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(i=this.connectSettings)&&i.headers){e.next=2;break}throw new Error("Request settings have not been set up");case 2:this.url=this.connectSettings.url||this.url,s=this.preprocessBody(this.rawBody,n),dn.request(this,s,t);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"extractResultData",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t instanceof Blob)){e.next=2;break}return e.abrupt("return",new Promise((function(e){var n=new FileReader;n.readAsDataURL(t),n.onload=function(t){e({files:[{src:t.target.result,type:"audio"}]})}})));case 2:if(!t.error){e.next=4;break}throw t.error.message;case 4:return e.abrupt("return",{error:"error"});case 5:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n,i}(gn);hi.DEFAULT_MODEL="tts-1",hi.DEFAULT_VOIDE="alloy";var pi=hi,fi=function(e){function t(e){var n,i,s,o;k(this,t);var a=JSON.parse(JSON.stringify(e.directConnection)),l=null==a?void 0:a.openAI;(i=r(this,t,[e,Xn.buildKeyVerificationDetails(),Xn.buildHeaders,l,{audio:{}}])).insertKeyPlaceholderText="OpenAI API Key",i.keyHelpUrl="https://platform.openai.com/account/api-keys",i.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>OpenAI : Speech To Text</b></div>\n    <p><b>Upload an audio file</b> to transcribe it into text. You can optionally provide text to guide the audio\n      processing.\n    <p>Click <a href="https://platform.openai.com/docs/guides/speech-to-text">here</a> for more info.</p>',i.url="",i.permittedErrorPrefixes=["Invalid"],i.textInputPlaceholderText="Upload an audio file",i._service_url=t.AUDIO_TRANSCRIPTIONS_URL;var c=null==(s=null==a?void 0:a.openAI)?void 0:s.audio;return"object"==w(c)&&(i.processConfig(c),t.cleanConfig(c),Object.assign(i.rawBody,c)),null!==(n=(o=i.rawBody).model)&&void 0!==n||(o.model=t.DEFAULT_MODEL),i.rawBody.response_format="json",i.canSendMessage=t.canSendFileMessage,i}return c(t,e),S(t,[{key:"processConfig",value:function(e){null!=e&&e.type&&"translation"===e.type&&(this._service_url=t.AUDIO_TRANSLATIONS_URL,delete e.language)}},{key:"preprocessBody",value:function(e,t){var n,i,s=JSON.parse(JSON.stringify(e)),r=null==(i=null==(n=t[t.length-1])?void 0:n.text)?void 0:i.trim();return r&&""!==r&&(s.prompt=r),s}},{key:"callServiceAPI",value:(i=f(h().mark((function e(n,i,s){var r,o,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(r=this.connectSettings)&&r.headers){e.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null!=s&&s[0]){e.next=4;break}throw new Error("No file was added");case 4:this.url=this.connectSettings.url||this._service_url,o=this.preprocessBody(this.rawBody,i),a=t.createFormDataBody(o,s[0]),Zt.tempRemoveContentHeader(this.connectSettings,dn.request.bind(this,this,a,n),!1);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"extractResultData",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error.message;case 2:return e.abrupt("return",{text:t.text});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}],[{key:"canSendFileMessage",value:function(e,t){return!(null==t||!t[0])}},{key:"cleanConfig",value:function(e){delete e.type}},{key:"createFormDataBody",value:function(e,t){var n=new FormData;return n.append("file",t),Object.keys(e).forEach((function(t){n.append(t,String(e[t]))})),n}}]);var n,i}(gn);fi.AUDIO_TRANSCRIPTIONS_URL="https://api.openai.com/v1/audio/transcriptions",fi.AUDIO_TRANSLATIONS_URL="https://api.openai.com/v1/audio/translations",fi.DEFAULT_MODEL="whisper-1";var mi=fi,vi=function(){function e(){k(this,e)}return S(e,null,[{key:"buildTextToSpeechHeaders",value:function(e,t){return{"Ocp-Apim-Subscription-Key":t,"Content-Type":"application/ssml+xml","X-Microsoft-OutputFormat":e}}},{key:"buildSpeechToTextHeaders",value:function(e){return{"Ocp-Apim-Subscription-Key":e,Accept:"application/json"}}},{key:"handleSpeechVerificationResult",value:function(e,t,n,i){e.error?i(G.INVALID_KEY):n(t)}},{key:"buildSpeechKeyVerificationDetails",value:function(t){return{url:"https://".concat(t,".api.cognitive.microsoft.com/sts/v1.0/issuetoken"),method:"POST",createHeaders:function(e){return{"Ocp-Apim-Subscription-Key":"".concat(e)}},handleVerificationResult:e.handleSpeechVerificationResult}}},{key:"buildSummarizationHeader",value:function(e){return{"Ocp-Apim-Subscription-Key":e,"Content-Type":"application/json"}}},{key:"handleLanguageVerificationResult",value:function(e,t,n,i){var s;"401"===(null==(s=e.error)?void 0:s.code)?i(G.INVALID_KEY):n(t)}},{key:"buildLanguageKeyVerificationDetails",value:function(t){return{url:"".concat(t,"/language/analyze-text/jobs?api-version=2022-10-01-preview"),method:"POST",createHeaders:function(e){return{"Ocp-Apim-Subscription-Key":"".concat(e)}},handleVerificationResult:e.handleLanguageVerificationResult}}},{key:"handleTranslationVerificationResult",value:function(e,t,n,i){e.json().then((function(e){Array.isArray(e)||401e3!==e.error.code?n(t):i(G.INVALID_KEY)}))}},{key:"buildTranslationKeyVerificationDetails",value:function(t){return{url:"https://api.cognitive.microsofttranslator.com/translate?api-version=3.0&to=es",method:"POST",createHeaders:function(n){return e.buildTranslationHeaders(t,n)},handleVerificationResult:e.handleTranslationVerificationResult}}},{key:"buildTranslationHeaders",value:function(e,t){var n={"Ocp-Apim-Subscription-Key":t,"Content-Type":"application/json"};return e&&(n["Ocp-Apim-Subscription-Region"]=e),n}}])}(),gi=function(e){function t(e,n,i,s,o){var a;return k(this,t),(a=r(this,t,[e,vi.buildLanguageKeyVerificationDetails(i),n,s,o])).insertKeyPlaceholderText="Azure Language Subscription Key",a.keyHelpUrl="https://learn.microsoft.com/en-us/azure/api-management/api-management-subscriptions#create-and-manage-subscriptions-in-azure-portal",a.permittedErrorPrefixes=["Access"],a}return c(t,e),S(t)}(gn),yi=function(e){function t(e){var n,i,s,o,a,l;k(this,t);var c=null==(o=null==(s=e.directConnection)?void 0:s.azure)?void 0:o.summarization,u=null==(a=e.directConnection)?void 0:a.azure;return(i=r(this,t,[e,vi.buildSummarizationHeader,c.endpoint,u])).permittedErrorPrefixes=[t.ENDPOINT_ERROR_MESSAGE],i.url="",i.textInputPlaceholderText="Insert text to summarize",i.isTextInputDisabled=!1,c.endpoint?(null!==(n=(l=i.rawBody).language)&&void 0!==n||(l.language="en"),Object.assign(i.rawBody,c),i.url="".concat(c.endpoint,"/language/analyze-text/jobs?api-version=2022-10-01-preview")):(i.isTextInputDisabled=!0,i.canSendMessage=function(){return!1},setTimeout((function(){e.addMessage({error:t.ENDPOINT_ERROR_MESSAGE})}))),i}return c(t,e),S(t,[{key:"preprocessBody",value:function(e,t){var n=t[t.length-1].text;if(n)return{analysisInput:{documents:[{id:"1",language:e.language,text:n}]},tasks:[{kind:"ExtractiveSummarization"}]}}},{key:"callServiceAPI",value:(o=f(h().mark((function e(t,n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:i=this.preprocessBody(this.rawBody,n),dn.request(this,i,t),this.messages=t;case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"extractResultData",value:(s=f(h().mark((function e(t){var n,i,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error.message;case 2:return this.messages&&this.completionsHandlers&&(i=t.headers.get("operation-location"),s={method:"GET",headers:null==(n=this.connectSettings)?void 0:n.headers},dn.executePollRequest(this,i,s,this.messages)),e.abrupt("return",{makingAnotherRequest:!0});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"extractPollResultData",value:(n=f(h().mark((function e(t){var n,s,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:if("running"!==t.status){e.next=4;break}return e.abrupt("return",{timeoutMS:2e3});case 4:if(!(t.errors.length>0)){e.next=6;break}throw t.errors[0];case 6:if(!(t.tasks.items[0].results.errors.length>0)){e.next=8;break}throw t.tasks.items[0].results.errors[0];case 8:n="",s=i(t.tasks.items[0].results.documents[0].sentences);try{for(s.s();!(r=s.n()).done;)o=r.value,n+=o.text}catch(a){s.e(a)}finally{s.f()}return e.abrupt("return",{text:n||""});case 12:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n,s,o}(gi);yi.ENDPOINT_ERROR_MESSAGE="Please define the azure endpoint. [More Information](https://deepchat.dev/docs/directConnection/Azure#Summarization)";var bi=yi,_i=function(){function e(){k(this,e)}return S(e,null,[{key:"poll",value:(t=f(h().mark((function e(t,n){var i,s,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={authorization:t,"content-type":"application/json"},e.t0="https://api.assemblyai.com/v2/transcript/",e.next=4,fetch("https://api.assemblyai.com/v2/transcript",{method:"POST",body:JSON.stringify({audio_url:n}),headers:i});case 4:return e.next=6,e.sent.json();case 6:e.t1=e.sent.id,s=e.t0.concat.call(e.t0,e.t1);case 8:if(r){e.next=24;break}return e.next=11,fetch(s,{headers:i});case 11:return e.next=13,e.sent.json();case 13:if("completed"!==(o=e.sent).status){e.next=18;break}r=o,e.next=22;break;case 18:if("error"!==o.status){e.next=20;break}throw new Error("Transcription failed: ".concat(o.error));case 20:return e.next=22,new Promise((function(e){return setTimeout(e,3e3)}));case 22:e.next=8;break;case 24:return e.abrupt("return",r);case 25:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},{key:"buildHeaders",value:function(e){return{Authorization:e,"Content-Type":"application/octet-stream"}}},{key:"handleVerificationResult",value:function(e,t,n,i){var s=e;s.error?"invalid_api_key"===s.error.code?i(G.INVALID_KEY):i(G.CONNECTION_FAILED):n(t)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.assemblyai.com/v2/upload",method:"POST",handleVerificationResult:e.handleVerificationResult}}}]);var t}(),wi=function(e){function t(e){var n,i;k(this,t);var s=null==(i=e.directConnection)?void 0:i.assemblyAI;return(n=r(this,t,[e,_i.buildKeyVerificationDetails(),_i.buildHeaders,s,{audio:{}}])).insertKeyPlaceholderText="AssemblyAI API Key",n.keyHelpUrl="https://www.assemblyai.com/app/account",n.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>AssemblyAI Audio</b></div>\n    <p><b>Upload an audio file</b> to transcribe it into text.\n    <p>\n      Click <a href="https://www.assemblyai.com/docs/Guides/transcribing_an_audio_file#get-started">here</a> for more info.\n    </p>',n.url="https://api.assemblyai.com/v2/upload",n.isTextInputDisabled=!0,n.textInputPlaceholderText="Upload an audio file",n.permittedErrorPrefixes=["Authentication","Invalid"],n.canSendMessage=t.canFileSendMessage,n}return c(t,e),S(t,[{key:"callServiceAPI",value:(i=f(h().mark((function e(t,n,i){var s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(s=this.connectSettings)&&s.headers){e.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null!=i&&i[0]){e.next=4;break}throw new Error("No file was added");case 4:dn.request(this,i[0],t,!1);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"extractResultData",value:(n=f(h().mark((function e(t){var n,i,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:return s=null==(i=null==(n=this.connectSettings)?void 0:n.headers)?void 0:i.Authorization,e.next=5,_i.poll(s,t.upload_url);case 5:return e.t0=e.sent.text,e.abrupt("return",{text:e.t0});case 7:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}],[{key:"canFileSendMessage",value:function(e,t){return!(null==t||!t[0])}}]);var n,i}(gn),ki=function(e){function t(e,n,i,s,o){var a;return k(this,t),(a=r(this,t,[e,vi.buildSpeechKeyVerificationDetails(i),n,s,o])).insertKeyPlaceholderText="Azure Speech Subscription Key",a.keyHelpUrl="https://learn.microsoft.com/en-us/azure/api-management/api-management-subscriptions#create-and-manage-subscriptions-in-azure-portal",a}return c(t,e),S(t)}(gn),xi=function(e){function t(e){var n,i,s,o,a,l,c,u,d,h;k(this,t);var p=null==(l=null==(a=e.directConnection)?void 0:a.azure)?void 0:l.textToSpeech,f=null==(c=e.directConnection)?void 0:c.azure;return(o=r(this,t,[e,vi.buildTextToSpeechHeaders.bind({},(null==p?void 0:p.outputFormat)||"audio-16khz-128kbitrate-mono-mp3"),p.region,f])).permittedErrorPrefixes=[t.REGION_ERROR_MESSAGE],o.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Azure Text To Speech</b></div>\n    <p>Insert text to synthesize it to audio.\n    <p>\n      Click <a href="'.concat(t.HELP_LINK,'">here</a> for more info.\n    </p>'),o.isTextInputDisabled=!1,o.url="",p.region?(Object.assign(o.rawBody,p),null!==(n=(u=o.rawBody).lang)&&void 0!==n||(u.lang="en-US"),null!==(i=(d=o.rawBody).name)&&void 0!==i||(d.name="en-US-JennyNeural"),null!==(s=(h=o.rawBody).gender)&&void 0!==s||(h.gender="Female"),o.url="https://".concat(p.region,".tts.speech.microsoft.com/cognitiveservices/v1")):(o.isTextInputDisabled=!0,o.canSendMessage=function(){return!1},setTimeout((function(){e.addMessage({error:t.REGION_ERROR_MESSAGE})}))),o}return c(t,e),S(t,[{key:"preprocessBody",value:function(e,t){var n=t[t.length-1].text;if(n)return"<speak version='1.0' xml:lang='".concat(e.lang,"'>\n      <voice xml:lang='").concat(e.lang,"' xml:gender='").concat(e.gender,"' name='").concat(e.name,"'>\n        ").concat(n,"\n      </voice>\n    </speak>")}},{key:"callServiceAPI",value:(i=f(h().mark((function e(t,n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:i=this.preprocessBody(this.rawBody,n),dn.request(this,i,t,!1);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"extractResultData",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=new FileReader;n.readAsDataURL(t),n.onload=function(t){e({files:[{src:t.target.result,type:"audio"}]})}})));case 1:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n,i}(ki);xi.HELP_LINK="https://learn.microsoft.com/en-GB/azure/cognitive-services/speech-service/get-started-text-to-speech?tabs=windows%2Cterminal&pivots=programming-language-rest",xi.REGION_ERROR_MESSAGE="Please define a region config property. [More Information](https://deepchat.dev/docs/directConnection/Azure#TextToSpeech)";var Si=xi,Ei=function(e){function t(e){var n,i,s,o;k(this,t);var a=null==(s=null==(i=e.directConnection)?void 0:i.azure)?void 0:s.speechToText,l=null==(o=e.directConnection)?void 0:o.azure;if((n=r(this,t,[e,vi.buildSpeechToTextHeaders,a.region,l,{audio:{files:{acceptedFormats:".wav,.ogg"}}}])).permittedErrorPrefixes=[t.REGION_ERROR_MESSAGE],n.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>Azure Speech To Text</b></div>\n    <p><b>Upload a .wav or .ogg audio file</b> to transcribe it into text.\n    <p>\n      Click <a href="'.concat(t.HELP_LINK,'">here</a> for more info.\n    </p>'),n.url="",n.isTextInputDisabled=!0,n.textInputPlaceholderText="Upload an audio file",a.region){n.canSendMessage=t.canFileSendMessage;var c=a.lang||"en-US";n.url="https://".concat(a.region,".stt.speech.microsoft.com/speech/recognition/conversation/cognitiveservices/v1?language=").concat(c,"&format=detailed"),n.recordAudio=void 0}else n.isTextInputDisabled=!0,n.canSendMessage=function(){return!1},setTimeout((function(){e.addMessage({error:t.REGION_ERROR_MESSAGE})}));return n}return c(t,e),S(t,[{key:"callServiceAPI",value:(i=f(h().mark((function e(t,n,i){var s,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(s=this.connectSettings)&&s.headers){e.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null!=i&&i[0]){e.next=4;break}throw new Error("No file was added");case 4:null!=(r=this.connectSettings)&&r.headers&&(this.connectSettings.headers["Content-Type"]=i[0].name.toLocaleLowerCase().endsWith(".wav")?"audio/wav; codecs=audio/pcm; samplerate=16000":"audio/ogg; codecs=opus"),dn.request(this,i[0],t,!1);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"extractResultData",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error;case 2:return e.abrupt("return",{text:t.DisplayText||""});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}],[{key:"canFileSendMessage",value:function(e,t){return!(null==t||!t[0])}}]);var n,i}(ki);Ei.HELP_LINK="https://learn.microsoft.com/en-GB/azure/cognitive-services/speech-service/get-started-text-to-speech?tabs=windows%2Cterminal&pivots=programming-language-rest",Ei.REGION_ERROR_MESSAGE="Please define a region config property. [More Information](https://deepchat.dev/docs/directConnection/Azure#SpeechToText)";var Ci=Ei,Ti=function(e){function t(e){var n,i,s,o;k(this,t);var a=null==(s=null==(i=e.directConnection)?void 0:i.azure)?void 0:s.translation,l=null==(o=e.directConnection)?void 0:o.azure;return(n=r(this,t,[e,vi.buildTranslationKeyVerificationDetails(a.region),vi.buildTranslationHeaders.bind({},null==a?void 0:a.region),l])).insertKeyPlaceholderText="Azure Translate Subscription Key",n.keyHelpUrl="https://learn.microsoft.com/en-us/azure/api-management/api-management-subscriptions#create-and-manage-subscriptions-in-azure-portal",n.url="",n.url="https://api.cognitive.microsofttranslator.com/translate?api-version=3.0&to=".concat(a.language||"es"),n}return c(t,e),S(t,[{key:"preprocessBody",value:function(e){var t=e[e.length-1].text;if(t)return[{Text:t}]}},{key:"callServiceAPI",value:(i=f(h().mark((function e(t,n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:i=this.preprocessBody(n),dn.request(this,i,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"extractResultData",value:(n=f(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Array.isArray(t)){e.next=2;break}return e.abrupt("return",{text:(null==(n=t[0].translations)?void 0:n[0].text)||""});case 2:throw t.error;case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n,i}(gn),Mi=function(e){function t(e,n,i,s,o){var a,l,c,u,d,h,p;k(this,t);var f=JSON.parse(JSON.stringify(e.directConnection));(c=r(this,t,[e,n||Xn.buildKeyVerificationDetails(),i||Xn.buildHeaders,s||f.openAI])).insertKeyPlaceholderText="OpenAI API Key",c.keyHelpUrl="https://platform.openai.com/account/api-keys",c.url="https://api.openai.com/v1/chat/completions",c.permittedErrorPrefixes=["Incorrect"],c.asyncCallInProgress=!1,c._systemMessage=t.generateSystemMessage("You are a helpful assistant.");var m=o||(null==(u=f.openAI)?void 0:u.chat);if("object"==w(m)){m.system_prompt&&(c._systemMessage=t.generateSystemMessage(m.system_prompt));var v=(null==(h=null==(d=e.directConnection)?void 0:d.openAI)?void 0:h.chat).function_handler;v&&(c._functionHandler=v),c.cleanConfig(m),Object.assign(c.rawBody,m)}return null!==(a=c.maxMessages)&&void 0!==a||(c.maxMessages=-1),null!==(l=(p=c.rawBody).model)&&void 0!==l||(p.model="gpt-4o"),c}return c(t,e),S(t,[{key:"cleanConfig",value:function(e){delete e.system_prompt,delete e.function_handler}},{key:"preprocessBody",value:function(e,n){var i,s=JSON.parse(JSON.stringify(e)),r=fn.getCharacterLimitMessages(n,this.totalMessagesMaxCharLength?this.totalMessagesMaxCharLength-this._systemMessage.content.length:-1).map((function(e){return{content:t.getContent(e),role:e.role===Wt.USER_ROLE?"user":"assistant"}}));return n.find((function(e){return e.files&&e.files.length>0}))&&(null!==(i=s.max_tokens)&&void 0!==i||(s.max_tokens=300)),s.messages=[this._systemMessage].concat(m(r)),s}},{key:"callServiceAPI",value:(o=f(h().mark((function e(t,n){var i,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:i=this.preprocessBody(this.rawBody,n),(s=this.stream)&&("object"!=w(s)||!s.simulation)||i.stream?(i.stream=!0,on.request(this,i,t)):dn.request(this,i,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"extractResultData",value:(s=f(h().mark((function e(t,n,i){var s,r,o,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error.message;case 2:return e.abrupt("return",null!=(r=null==(s=t.choices)?void 0:s[0])&&r.delta?this.extractStreamResult(t.choices[0],n,i):null!=(a=null==(o=t.choices)?void 0:o[0])&&a.message?t.choices[0].message.tool_calls?this.handleTools(t.choices[0].message,n,i):{text:t.choices[0].message.content}:{text:""});case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return s.apply(this,arguments)})},{key:"extractStreamResult",value:(i=f(h().mark((function e(t,n,i){var s,r,o=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.delta,"tool_calls"!==t.finish_reason){e.next=7;break}return this.asyncCallInProgress=!0,r={tool_calls:this._streamToolCalls},e.abrupt("return",(this._streamToolCalls=void 0,this.handleTools(r,n,i)));case 7:null!=s&&s.tool_calls&&(this._streamToolCalls?s.tool_calls.forEach((function(e,t){o._streamToolCalls&&(o._streamToolCalls[t].function.arguments+=e.function.arguments)})):this._streamToolCalls=s.tool_calls);case 8:return e.abrupt("return",{text:(null==s?void 0:s.content)||""});case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"handleTools",value:(n=f(h().mark((function e(t,n,i){var s,r,o,a,l,c,u,d,p,f,m;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.tool_calls&&n&&i&&this._functionHandler){e.next=2;break}throw Error("Please define the `function_handler` property inside the [openAI](https://deepchat.dev/docs/directConnection/openAI#Chat) object.");case 2:return c=JSON.parse(JSON.stringify(i)),u=t.tool_calls.map((function(e){return{name:e.function.name,arguments:e.function.arguments}})),e.next=6,null==(s=this._functionHandler)?void 0:s.call(this,u);case 6:if(d=e.sent,Array.isArray(d)){e.next=17;break}if(!d.text){e.next=16;break}return p={text:d.text},e.next=12,null==(o=(r=this.deepChat).responseInterceptor)?void 0:o.call(r,p);case 12:if(e.t0=e.sent,e.t0){e.next=15;break}e.t0=p;case 15:return e.abrupt("return",e.t0);case 16:throw Error(Xn.FUNCTION_TOOL_RESP_ERROR);case 17:return e.next=19,Promise.all(d);case 19:if(f=e.sent,c.messages.push({tool_calls:t.tool_calls,role:"assistant",content:null}),f.find((function(e){return"string"!=typeof e.response}))||u.length!==f.length){e.next=40;break}return f.forEach((function(e,n){var i,s=null==(i=t.tool_calls)?void 0:i[n];null==c||c.messages.push({role:"tool",tool_call_id:null==s?void 0:s.id,name:null==s?void 0:s.function.name,content:e.response})})),delete c.tools,delete c.tool_choice,delete c.stream,e.prev=22,e.next=25,null==n?void 0:n(c).then((function(e){return Zt.processResponseByType(e)}));case 25:return m=e.sent,e.next=28,null==(l=(a=this.deepChat).responseInterceptor)?void 0:l.call(a,m);case 28:if(e.t1=e.sent,e.t1){e.next=31;break}e.t1=m;case 31:if(!(m=e.t1).error){e.next=34;break}throw m.error.message;case 34:return e.abrupt("return",{text:m.choices[0].message.content||""});case 37:throw e.prev=37,e.t2=e.catch(22),this.asyncCallInProgress=!1,e.t2;case 40:throw Error(Xn.FUNCTION_TOOL_RESP_ERROR);case 41:case"end":return e.stop()}}),e,this,[[22,37]])}))),function(e,t,i){return n.apply(this,arguments)})}],[{key:"generateSystemMessage",value:function(e){return{role:"system",content:e}}},{key:"getContent",value:function(e){if(e.files&&e.files.length>0){var t=e.files.map((function(e){return{type:"image_url",image_url:{url:e.src}}}));return e.text&&e.text.trim().length>0&&t.unshift({type:"text",text:e.text}),t}return e.text}}]);var n,i,s,o}(gn),Ai=function(e){function t(e){var n,i,s,o,a,l,c,u;k(this,t);var d=JSON.parse(JSON.stringify(e.directConnection)),h=d.azure,p=(null==(s=null==(i=d.azure)?void 0:i.openAI)?void 0:s.urlDetails)||{},f=null==(a=null==(o=d.azure)?void 0:o.openAI)?void 0:a.chat;if((n=r(this,t,[e,li.buildKeyVerificationDetails(p),li.buildHeaders,h,f])).permittedErrorPrefixes=[li.URL_DETAILS_ERROR_MESSAGE],n.isTextInputDisabled=!1,"object"==w(f)){var m=(null==(u=null==(c=null==(l=e.directConnection)?void 0:l.azure)?void 0:c.openAI)?void 0:u.chat).function_handler;m&&(n._functionHandler=m)}return li.validateURLDetails(p)?n.url=t.buildURL(p):(n.isTextInputDisabled=!0,n.canSendMessage=function(){return!1},setTimeout((function(){e.addMessage({error:li.URL_DETAILS_ERROR_MESSAGE})}))),n}return c(t,e),S(t,null,[{key:"buildURL",value:function(e){var t=e.endpoint,n=e.deploymentId,i=e.version;return"".concat(t,"/openai/deployments/").concat(n,"/completions?api-version=").concat(i)}}])}(Mi),Ii=function(e){function t(e){var n,i;k(this,t);var s=e.directConnection,o=null==s?void 0:s.openAI;(n=r(this,t,[e,Xn.buildKeyVerificationDetails(),Xn.buildHeaders,o,{images:{files:{acceptedFormats:".png",maxNumberOfFiles:2}}}])).insertKeyPlaceholderText="OpenAI API Key",n.keyHelpUrl="https://platform.openai.com/account/api-keys",n.introPanelMarkUp='\n    <div style="width: 100%; text-align: center; margin-left: -10px"><b>OpenAI DALL\xb7E</b></div>\n    <p><b>Insert text</b> to generate an image.</p>\n    <p><b>Upload 1</b> PNG image to generate its variation and optionally insert text to specify the change.</p>\n    <p><b>Upload 2</b> PNG images where the second is a copy of the first with a transparent area where the edit should\n      take place and text to specify the edit.</p>\n    <p>Click <a href="https://platform.openai.com/docs/guides/images/introduction">here</a> for more info.</p>',n.url="",n.permittedErrorPrefixes=["Incorrect","Invalid input image"];var a=null==(i=null==s?void 0:s.openAI)?void 0:i.images;if(n.camera){var l="object"==w(a)&&a.size?Number.parseInt(a.size):1024;n.camera.files={dimensions:{width:l,height:l}}}return"object"==w(a)&&Object.assign(n.rawBody,a),n.canSendMessage=t.canFileSendMessage,n}return c(t,e),S(t,[{key:"preprocessBody",value:function(e,t){var n=JSON.parse(JSON.stringify(e));return t&&""!==t&&(n.prompt=t),n}},{key:"callApiWithImage",value:function(e,n,i){var s,r,o,a=null==(r=null==(s=n[n.length-1])?void 0:s.text)?void 0:r.trim();if(i[1]||a&&""!==a){this.url=t.IMAGE_EDIT_URL;var l=this.preprocessBody(this.rawBody,a);o=t.createFormDataBody(l,i[0],i[1])}else this.url=t.IMAGE_VARIATIONS_URL,o=t.createFormDataBody(this.rawBody,i[0]);Zt.tempRemoveContentHeader(this.connectSettings,dn.request.bind(this,this,o,e),!1)}},{key:"callServiceAPI",value:(i=f(h().mark((function e(n,i,s){var r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(r=this.connectSettings)&&r.headers){e.next=2;break}throw new Error("Request settings have not been set up");case 2:if(null==s||!s[0]){e.next=6;break}this.callApiWithImage(n,i,s),e.next=11;break;case 6:if(this.connectSettings){e.next=8;break}throw new Error("Request settings have not been set up");case 8:this.url=t.IMAGE_GENERATION_URL,o=this.preprocessBody(this.rawBody,i[i.length-1].text),dn.request(this,o,n);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"extractResultData",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=2;break}throw t.error.message;case 2:return e.abrupt("return",{files:t.data.map((function(e){return e.url?{src:e.url,type:"image"}:{src:"".concat(Nn).concat(e.b64_json),type:"image"}}))});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}],[{key:"canFileSendMessage",value:function(e,t){return!(null==t||!t[0])||!(!e||""===e.trim())}},{key:"createFormDataBody",value:function(e,t,n){var i=new FormData;return i.append("image",t),n&&i.append("mask",n),Object.keys(e).forEach((function(t){i.append(t,String(e[t]))})),i}}]);var n,i}(gn);Ii.IMAGE_GENERATION_URL="https://api.openai.com/v1/images/generations",Ii.IMAGE_VARIATIONS_URL="https://api.openai.com/v1/images/variations",Ii.IMAGE_EDIT_URL="https://api.openai.com/v1/images/edits";var Ri=Ii,Oi=function(e){function t(e){var n,i,s;k(this,t);var o=JSON.parse(JSON.stringify(e.directConnection)),a=null==(s=o.cohere)?void 0:s.chat;return i=r(this,t,[e,"https://api.cohere.ai/v1/chat","Ask me anything!",a,o.cohere]),"object"==w(a)&&Object.assign(i.rawBody,a),null!==(n=i.maxMessages)&&void 0!==n||(i.maxMessages=-1),i}return c(t,e),S(t,[{key:"preprocessBody",value:function(e,t){var n=JSON.parse(JSON.stringify(e)),i=t.filter((function(e){return e.text}));return n.query=i[i.length-1].text,n.chat_history=i.slice(0,i.length-1).map((function(e){return{text:e.text,user_name:"ai"===e.role?"CHATBOT":"USER"}})),n}},{key:"callServiceAPI",value:(i=f(h().mark((function e(t,n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:i=this.preprocessBody(this.rawBody,n),dn.request(this,i,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"extractResultData",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.message){e.next=2;break}throw t.message;case 2:return e.abrupt("return",{text:t.text});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n,i}(ri),Li=function(){function e(){k(this,e)}return S(e,null,[{key:"buildHeaders",value:function(e){return{Authorization:"Bearer ".concat(e),"Content-Type":"application/json",accept:"application/json"}}},{key:"handleVerificationResult",value:function(e,t,n,i){var s;null!=(s=e.message)&&s.includes("invalid request: prompt must be at least 1 token long")?n(t):i(G.INVALID_KEY)}},{key:"buildKeyVerificationDetails",value:function(){return{url:"https://api.mistral.ai/v1/models",method:"GET",handleVerificationResult:e.handleVerificationResult}}}])}(),Pi=function(e){function t(e){var n,i,s,o;k(this,t);var a=JSON.parse(JSON.stringify(e.directConnection)).mistral;return(s=r(this,t,[e,Li.buildKeyVerificationDetails(),Li.buildHeaders,a])).insertKeyPlaceholderText="Mistral API Key",s.keyHelpUrl="https://console.mistral.ai/api-keys/",s.url="https://api.mistral.ai/v1/chat/completions",s.permittedErrorPrefixes=["invalid"],a&&(s.cleanConfig(a),Object.assign(s.rawBody,a)),null!==(n=s.maxMessages)&&void 0!==n||(s.maxMessages=-1),null!==(i=(o=s.rawBody).model)&&void 0!==i||(o.model="open-mistral-7b"),s}return c(t,e),S(t,[{key:"cleanConfig",value:function(e){delete e.key}},{key:"preprocessBody",value:function(e,t){var n=JSON.parse(JSON.stringify(e)),i=t.filter((function(e){return e.text}));return n.messages=i.slice(0,i.length-1).map((function(e){return{text:e.text,user_name:"ai"===e.role?"system":"user"}})),n}},{key:"callServiceAPI",value:(i=f(h().mark((function e(t,n){var i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectSettings){e.next=2;break}throw new Error("Request settings have not been set up");case 2:i=this.preprocessBody(this.rawBody,n),dn.request(this,i,t);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"extractResultData",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.message){e.next=2;break}throw t.message;case 2:return e.abrupt("return",{text:t.text});case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n,i}(gn),Di=function(){return S((function e(){k(this,e)}),null,[{key:"create",value:function(e){var t=e.directConnection,n=e.connect,i=e.demo;if(e.webModel)return new An(e);if(t){if(t.openAI)return t.openAI.images?new Ri(e):t.openAI.speechToText?new mi(e):t.openAI.textToSpeech?new pi(e):t.openAI.assistant?new ii(e):new Mi(e);if(t.assemblyAI)return new wi(e);if(t.cohere)return t.cohere.textGeneration?new oi(e):t.cohere.summarization?new di(e):new Oi(e);if(t.huggingFace)return t.huggingFace.textGeneration?new qn(e):t.huggingFace.summarization?new Hn(e):t.huggingFace.translation?new Kn(e):t.huggingFace.fillMask?new Yn(e):t.huggingFace.questionAnswer?new Vn(e):t.huggingFace.audioSpeechRecognition?new jn(e):t.huggingFace.audioClassification?new Pn(e):t.huggingFace.imageClassification?new Dn(e):new Gn(e);if(t.azure){if(t.azure.openAI){if(t.azure.openAI.chat)return new Ai(e);if(t.azure.openAI.assistant)return new ui(e)}if(t.azure.speechToText)return new Ci(e);if(t.azure.textToSpeech)return new Si(e);if(t.azure.summarization)return new bi(e);if(t.azure.translation)return new Ti(e)}if(t.stabilityAI)return t.stabilityAI.imageToImage?new Wn(e):t.stabilityAI.imageToImageUpscale?new Fn(e):t.stabilityAI.imageToImageMasking?new Un(e):new Jn(e);if(t.mistral)return new Pi(e)}return!n||i&&n.stream?new vn(e,void 0,i||!0):new vn(e)}}])}(),Ni=S((function e(){k(this,e)}));Ni.attibutes={string:function(e){return e},number:function(e){return parseFloat(e)},boolean:function(e){return"true"===e},object:function(e){return JSON.parse(e)},array:function(e){return JSON.parse(e)},function:function(e){return new Function("return ".concat(e))()}};var zi=Ni;function Bi(e){return function(t,n){Object.defineProperty(t,n,{});var i=t.constructor,s=n.toLocaleLowerCase();i._attributes_[s]=zi.attibutes[e],i._attributeToProperty_[s]=n}}var Fi=function(){function e(t,n,i){k(this,e),this._isDisplayed=!1,t?(this._elementRef=this.createIntroPanelWithChild(t,i),this._isDisplayed=!0):n&&(this._elementRef=this.createInternalIntroPanel(n,i),this._isDisplayed=!0)}return S(e,[{key:"createIntroPanelWithChild",value:function(t,n){var i=e.createIntroPanel(n);return"none"===t.style.display&&(t.style.display="block"),i.appendChild(t),i}},{key:"createInternalIntroPanel",value:function(t,n){var i=e.createIntroPanel(n);return i.id="internal-intro-panel",i.innerHTML=t,i}},{key:"hide",value:function(){this._isDisplayed&&this._elementRef&&(this._elementRef.style.display="none",this._isDisplayed=!1)}},{key:"display",value:function(){!this._isDisplayed&&this._elementRef&&(this._elementRef.style.display="",this._isDisplayed=!0)}}],[{key:"createIntroPanel",value:function(e){var t=document.createElement("div");return t.classList.add("intro-panel"),Object.assign(t.style,e),t}}])}(),Ui=function(){function e(){k(this,e)}return S(e,null,[{key:"createImage",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=new Image;return s.src=e.src,!n&&i&&Q.scrollDownOnImageLoad(s.src,t),Q.processContent("image",s,s.src,e.name)}},{key:"createImageMessage",value:function(t,n,i,s){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=e.createImage(n,t.elementRef,s,r),a=t.createNewMessageElement("",i);return a.bubbleElement.appendChild(o),a.bubbleElement.classList.add(e.IMAGE_BUBBLE_CLASS),{type:"image",elements:a}}},{key:"createAudioElement",value:function(e,t){var n=document.createElement("audio");return n.src=e.src,n.classList.add("audio-player"),n.controls=!0,P.IS_SAFARI&&(n.classList.add("audio-player-safari"),n.classList.add(t===Wt.USER_ROLE?"audio-player-safari-right":"audio-player-safari-left")),n}},{key:"createNewAudioMessage",value:function(t,n,i,s){var r=e.createAudioElement(n,i),o=t.createMessageElementsOnOrientation("",i,s);return o.bubbleElement.appendChild(r),o.bubbleElement.classList.add(e.AUDIO_BUBBLE_CLASS),{type:"audio",elements:o}}},{key:"createAnyFile",value:function(e){var t=document.createElement("div");t.classList.add("any-file-message-contents");var n=document.createElement("div");n.classList.add("any-file-message-icon-container");var i=wn.createSVGElement('<?xml version="1.0" encoding="iso-8859-1"?>\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" \n\t viewBox="50 30 420 450" xml:space="preserve">\n<g filter="brightness(0) saturate(100%) invert(16%) sepia(0%) saturate(1942%) hue-rotate(215deg) brightness(99%) contrast(93%)">\n\t<g>\n\t\t<path d="M447.933,103.629c-0.034-3.076-1.224-6.09-3.485-8.352L352.683,3.511c-0.004-0.004-0.007-0.005-0.011-0.008\n\t\t\tC350.505,1.338,347.511,0,344.206,0H89.278C75.361,0,64.04,11.32,64.04,25.237v461.525c0,13.916,11.32,25.237,25.237,25.237\n\t\t\th333.444c13.916,0,25.237-11.32,25.237-25.237V103.753C447.96,103.709,447.937,103.672,447.933,103.629z M356.194,40.931\n\t\t\tl50.834,50.834h-49.572c-0.695,0-1.262-0.567-1.262-1.262V40.931z M423.983,486.763c0,0.695-0.566,1.261-1.261,1.261H89.278\n\t\t\tc-0.695,0-1.261-0.566-1.261-1.261V25.237c0-0.695,0.566-1.261,1.261-1.261h242.94v66.527c0,13.916,11.322,25.239,25.239,25.239\n\t\t\th66.527V486.763z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M362.088,164.014H149.912c-6.62,0-11.988,5.367-11.988,11.988c0,6.62,5.368,11.988,11.988,11.988h212.175\n\t\t\tc6.62,0,11.988-5.368,11.988-11.988C374.076,169.381,368.707,164.014,362.088,164.014z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M362.088,236.353H149.912c-6.62,0-11.988,5.368-11.988,11.988c0,6.62,5.368,11.988,11.988,11.988h212.175\n\t\t\tc6.62,0,11.988-5.368,11.988-11.988C374.076,241.721,368.707,236.353,362.088,236.353z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M362.088,308.691H149.912c-6.62,0-11.988,5.368-11.988,11.988c0,6.621,5.368,11.988,11.988,11.988h212.175\n\t\t\tc6.62,0,11.988-5.367,11.988-11.988C374.076,314.06,368.707,308.691,362.088,308.691z"/>\n\t</g>\n</g>\n<g>\n\t<g>\n\t\t<path d="M256,381.031H149.912c-6.62,0-11.988,5.368-11.988,11.988c0,6.621,5.368,11.988,11.988,11.988H256\n\t\t\tc6.62,0,11.988-5.367,11.988-11.988C267.988,386.398,262.62,381.031,256,381.031z"/>\n\t</g>\n</g>\n</svg>');i.classList.add("any-file-message-icon"),n.appendChild(i);var s=document.createElement("div");return s.classList.add("any-file-message-text"),s.textContent=e.name||Q.DEFAULT_FILE_NAME,t.appendChild(n),t.appendChild(s),Q.processContent("any",t,e.src,s.textContent)}},{key:"createNewAnyFileMessage",value:function(t,n,i,s){var r=t.createMessageElementsOnOrientation("",i,s),o=e.createAnyFile(n);return r.bubbleElement.classList.add(e.ANY_FILE_BUBBLE_CLASS),r.bubbleElement.appendChild(o),{type:"file",elements:r}}},{key:"createMessages",value:function(t,n,i){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return n.map((function(n){return n.ref&&(n=Q.removeFileRef(n)),Q.isAudioFile(n)?e.createNewAudioMessage(t,n,i,s):Q.isImageFile(n)?e.createImageMessage(t,n,i,s,r):e.createNewAnyFileMessage(t,n,i,s)}))}},{key:"addMessages",value:function(t,n,i,s){e.createMessages(t,n,i,s).forEach((function(e){var n=e.type,r=e.elements;Q.addMessage(t,r,n,i,s)}))}}])}();Ui.IMAGE_BUBBLE_CLASS="image-message",Ui.AUDIO_BUBBLE_CLASS="audio-message",Ui.ANY_FILE_BUBBLE_CLASS="any-file-message";var ji=Ui,qi=function(){function e(){k(this,e)}return S(e,null,[{key:"removeElements",value:function(e,t){if(t){var n=e.findIndex((function(e){return e===t}));e.splice(n,1),null==t||t.outerContainer.remove()}}},{key:"removeFilesMessages",value:function(t,n){var i;null==(i=n[1].files)||i.forEach((function(n){e.removeElements(t.messageElementRefs,n)})),delete n[0].files,delete n[1].files}},{key:"removeTextHTMLMessage",value:function(t,n,i){var s=n[1][i];e.removeElements(t.messageElementRefs,s),delete n[0][i],delete n[1][i]}},{key:"updateHTMLMessage",value:function(e,t,n){var i,s;if(t[1].html)le.overwriteElements(e,n,t[1].html);else{var r=le.create(e,n,t[0].role),o=(null==(s=t[1].files)?void 0:s[(null==(i=t[1].files)?void 0:i.length)-1])||t[1].text;e.elementRef.insertBefore(r.outerContainer,o.outerContainer.nextSibling),e.messageElementRefs.splice(e.messageElementRefs.length-1,1);var a=e.messageElementRefs.findIndex((function(e){return e===o}));e.messageElementRefs.splice(a+1,0,r),t[1].html=r}t[0].html=n}},{key:"updateFileMessages",value:function(t,n,i){var s,r,o=n[0].role,a=ji.createMessages(t,i,o),l=n[1].html,c=(null==(r=n[1].files)?void 0:r[(null==(s=n[1].files)?void 0:s.length)-1])||n[1].text,u=l||c,d=t.messageElementRefs.findIndex((function(e){return e===u}));c&&(d+=1);var h=(null==l?void 0:l.outerContainer)||(null==c?void 0:c.outerContainer.nextSibling);a.forEach((function(e,n){var i=e.type,s=e.elements;Q.setElementProps(t,s,i,o),t.elementRef.insertBefore(s.outerContainer,h),t.messageElementRefs.splice(t.messageElementRefs.length-1,1),t.messageElementRefs.splice(d+n,0,s)})),e.removeFilesMessages(t,n),n[1].files=a.map((function(e){return e.elements})),n[0].files=i}},{key:"updateTextMessage",value:function(e,t,n){var i;if(t[1].text)e.renderText(t[1].text.bubbleElement,n);else{var s=e.createElements(n,t[0].role),r=(null==(i=t[1].files)?void 0:i[0])||t[1].html;e.elementRef.insertBefore(s.outerContainer,r.outerContainer);var o=e.messageElementRefs.findIndex((function(e){return e===r}));e.messageElementRefs.splice(o,0,s),t[1].text=s}t[0].text=n}},{key:"isElementActive",value:function(e){var t,n;return Hi.isActiveElement(null==(t=e.text)?void 0:t.bubbleElement.classList)||Hi.isActiveElement(null==(n=e.html)?void 0:n.bubbleElement.classList)}},{key:"update",value:function(t,n,i){var s=t.messageToElements[i];if(s){if(e.isElementActive(s[1]))return console.error("Cannot update a message that is being streamed");n.text&&e.updateTextMessage(t,s,n.text),n.html&&e.updateHTMLMessage(t,s,n.html),n.files?e.updateFileMessages(t,s,n.files):e.removeFilesMessages(t,s),!n.text&&s[1].text&&e.removeTextHTMLMessage(t,s,"text"),!n.html&&s[1].html&&e.removeTextHTMLMessage(t,s,"html")}else console.error("Message index not found. Please use the `getMessages` method to find the correct index")}}])}(),Vi=function(){return S((function e(){k(this,e)}),null,[{key:"getText",value:function(e,t){var n;if(!(e.directConnection||e.connect||e.webModel||e.demo))return"Connect to any API using the [connect](https://deepchat.dev/docs/connect#connect-1) property or a popular service via [directConnection](https://deepchat.dev/docs/directConnection/#directConnection).\n Host AI entirely on your browser via a [webModel](https://deepchat.dev/docs/webModel).\n To get started checkout the [Start](https://deepchat.dev/start) page and live code [examples](https://deepchat.dev/examples/frameworks).\n To remove this message set the [demo](https://deepchat.dev/docs/demo#demo) property to true.";if(e.directConnection){if(!t.isDirectConnection())return"Please define a valid service inside\n          the [directConnection](https://deepchat.dev/docs/directConnection/#directConnection) object.";var i=null==(n=e.directConnection.openAI)?void 0:n.chat;if("object"==w(i)&&i.tools&&!i.function_handler)return"Please define the `function_handler` property inside the openAI [chat](https://deepchat.dev/docs/directConnection/openAI#Chat) object."}else if(e.connect&&!e.connect.url&&!e.connect.handler)return e.demo?e.connect.stream?null:"When [demo](https://deepchat.dev/docs/demo) mode is enabled - the [connect](https://deepchat.dev/docs/connect#connect-1) object can only accept the [stream](https://deepchat.dev/docs/connect#Stream) property.":"Please define a `url` or a `handler` property inside the [connect](https://deepchat.dev/docs/connect#connect-1) object.";return null}}])}(),Hi=function(e){function t(e,n,i){var s,o,a;k(this,t),s=r(this,t,[e]);var l=n.permittedErrorPrefixes,c=n.introPanelMarkUp,u=n.demo;return s._errorMessageOverrides=null==(o=e.errorMessages)?void 0:o.overrides,s._onClearMessages=Nt.onClearMessages.bind(s,e),s._onError=Nt.onError.bind(s,e),s._displayLoadingMessage=t.getDisplayLoadingMessage(e,n),s._permittedErrorPrefixes=l,s.addSetupMessageIfNeeded(e,n)||s.populateIntroPanel(i,c,e.introPanelStyle),s.addIntroductoryMessages(e,n),new pn(e,s,n),s._displayServiceErrorMessages=null==(a=e.errorMessages)?void 0:a.displayServiceErrorMessages,e.getMessages=function(){return JSON.parse(JSON.stringify(s.messageToElements.map((function(e){return d(e,1)[0]}))))},e.clearMessages=s.clearMessages.bind(s,n),e.refreshMessages=s.refreshTextMessages.bind(s,e.remarkable),e.scrollToBottom=K.scrollToBottom.bind(s,s.elementRef),e.addMessage=function(e,t){s.addAnyMessage(b(b({},e),{},{sendUpdate:!!t}),!t)},e.updateMessage=function(e,t){return qi.update(s,e,t)},n.isWebModel()&&n.setUpMessages(s),u&&s.prepareDemo(ee.processDemo(u)),e.textToSpeech&&Y.processConfig(e.textToSpeech,(function(e){s.textToSpeech=e})),s}return c(t,e),S(t,[{key:"prepareDemo",value:function(e){var t;if("object"==w(e)){if(e.displayLoading){var n=e.displayLoading.history;null!=n&&n.small&&Bt.addMessage(this,!1),null!=n&&n.full&&Bt.addMessage(this)}e.displayErrors&&(e.displayErrors.default&&this.addNewErrorMessage("",""),e.displayErrors.service&&this.addNewErrorMessage("service",""),e.displayErrors.speechToText&&this.addNewErrorMessage("speechToText","")),null!=(t=e.displayLoading)&&t.message&&this.addLoadingMessage(),e.response&&(this.customDemoResponse=e.response)}}},{key:"addSetupMessageIfNeeded",value:function(e,t){var n=Vi.getText(e,t);if(n){var i=this.createAndAppendNewMessageElement(n,Wt.AI_ROLE);this.applyCustomStyles(i,Wt.AI_ROLE,!1)}return!!n}},{key:"addIntroductoryMessages",value:function(e,t){var n,i=this;null!=e&&e.shadowRoot&&(this._introMessage=e.introMessage);var s=this._introMessage;null!=t&&t.isWebModel()&&(null!==(n=s)&&void 0!==n||(s=t.getIntroMessage(s))),s&&(Array.isArray(s)?s.forEach((function(e,t){0!==t&&Wt.hideRoleElements(i.messageElementRefs,!!i._avatars,!!i._names),i.addIntroductoryMessage(e)})):this.addIntroductoryMessage(s))}},{key:"addIntroductoryMessage",value:function(e){var t,n;null!=e&&e.text?n=this.createAndAppendNewMessageElement(e.text,Wt.AI_ROLE):null!=e&&e.html&&(n=le.add(this,e.html,Wt.AI_ROLE,this.messageElementRefs)),n&&(this.applyCustomStyles(n,Wt.AI_ROLE,!1,null==(t=this.messageStyles)?void 0:t.intro),n.outerContainer.classList.add(Ut.INTRO_CLASS))}},{key:"removeIntroductoryMessage",value:function(){var e=this.messageElementRefs[0];e.outerContainer.classList.contains(Ut.INTRO_CLASS)&&(e.outerContainer.remove(),this.messageElementRefs.shift())}},{key:"addAnyMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.error?this.addNewErrorMessage("service",e.error):this.addNewMessage(e,t,n)}},{key:"addNewMessage",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=t.createMessageContent(e),r={status:e.overwrite};if(!e.ignoreText&&void 0!==s.text&&null!==e.text&&(this.addNewTextMessage(s.text,s.role,r,i),!n&&this.textToSpeech&&s.role!==Wt.USER_ROLE&&Y.speak(s.text,this.textToSpeech)),s.files&&Array.isArray(s.files)&&ji.addMessages(this,s.files,s.role,i),void 0!==s.html&&null!==s.html){var o=le.add(this,s.html,s.role,this.messageElementRefs,r,i);se.isElementTemporary(o)&&delete s.html}return this.isValidMessageContent(s)&&!i&&this.updateStateOnMessage(s,e.overwrite,e.sendUpdate,n),s}},{key:"isValidMessageContent",value:function(e){return e.text||e.html||e.files&&e.files.length>0}},{key:"updateStateOnMessage",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!t){var s=Wt.generateMessageBody(e,this.messageElementRefs);this.messageToElements.push([e,s])}n&&this.sendClientUpdate(e,i)}},{key:"removeMessageOnError",value:function(){var e=this.messageElementRefs[this.messageElementRefs.length-1],n=null==e?void 0:e.bubbleElement;(null!=n&&n.classList.contains(Jt.MESSAGE_CLASS)&&""===n.textContent||t.isTemporaryElement(e))&&this.removeLastMessage()}},{key:"addNewErrorMessage",value:function(e,t){var n,i,s,r,o,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.removeMessageOnError();var l=this.getPermittedMessage(t)||(null==(n=this._errorMessageOverrides)?void 0:n[e])||(null==(i=this._errorMessageOverrides)?void 0:i.default)||"Error, please try again.",c=this.createMessageElementsOnOrientation(l,"error",a);Wt.hideRoleElements(this.messageElementRefs,!!this._avatars,!!this._names);var u=c.bubbleElement,d=c.outerContainer;u.classList.add("error-message-text"),this.renderText(u,l);var h=Dt.extractParticularSharedStyles(["fontSize","fontFamily"],null==(s=this.messageStyles)?void 0:s.default);Dt.applyCustomStylesToElements(c,!1,h),Dt.applyCustomStylesToElements(c,!1,null==(r=this.messageStyles)?void 0:r.error),a||this.elementRef.appendChild(d),this.textToSpeech&&Y.speak(l,this.textToSpeech),null==(o=this._onError)||o.call(this,l)}},{key:"getPermittedMessage",value:function(e){if(e)for(var n=t.extractErrorMessages(e),i=0;i<n.length;i+=1){var s=n[i];if("string"==typeof s){if(this._displayServiceErrorMessages)return s;if(this._permittedErrorPrefixes){var r=t.checkPermittedErrorPrefixes(this._permittedErrorPrefixes,s);if(r)return r}}}}},{key:"removeError",value:function(){this.isLastMessageError()&&Wt.getLastMessageElement(this.elementRef).remove()}},{key:"addDefaultLoadingMessage",value:function(){var e=this.createMessageElements("",Wt.AI_ROLE),t=e.bubbleElement;e.bubbleElement.classList.add(X.DOTS_CONTAINER_CLASS);var n=document.createElement("div");return n.classList.add("loading-message-dots"),t.appendChild(n),X.setDots(t,this.messageStyles),e}},{key:"addLoadingMessage",value:function(){var e,t,n,i,s,r;if(this._displayLoadingMessage){var o=null==(n=null==(t=null==(e=this.messageStyles)?void 0:e.loading)?void 0:t.message)?void 0:n.html,a=o?le.createElements(this,o,Wt.AI_ROLE,!1):this.addDefaultLoadingMessage();this.elementRef.appendChild(a.outerContainer),a.bubbleElement.classList.add(X.BUBBLE_CLASS),this.applyCustomStyles(a,Wt.AI_ROLE,!1,null==(r=null==(s=null==(i=this.messageStyles)?void 0:i.loading)?void 0:s.message)?void 0:r.styles),K.scrollToBottom(this.elementRef)}}},{key:"populateIntroPanel",value:function(e,t,n){(e||t)&&(this._introPanel=new Fi(e,t,n),this._introPanel._elementRef&&(re.apply(this,this._introPanel._elementRef),this.elementRef.appendChild(this._introPanel._elementRef)))}},{key:"addMultipleFiles",value:(n=f(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all((t||[]).map((function(e){return new Promise((function(t){if(e.type&&"any"!==e.type){var n=new FileReader;n.readAsDataURL(e.file),n.onload=function(){t({src:n.result,type:e.type,ref:e.file})}}else{var i=e.file.name||Q.DEFAULT_FILE_NAME;t({name:i,type:"any",ref:e.file})}}))}))));case 1:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"clearMessages",value:function(e,n){var i,s,r,o=[];this.messageElementRefs.forEach((function(e){t.isActiveElement(e.bubbleElement.classList)?o.push(e):e.outerContainer.remove()})),Array.from(this.elementRef.children).forEach((function(e){var t,n=null==(t=e.children[0])?void 0:t.children[0];null!=n&&n.classList.contains("error-message-text")&&e.remove()})),this.messageElementRefs=o;var a=this.messageToElements.filter((function(e){return e[1].text&&t.isActiveElement(e[1].text.bubbleElement.classList)||e[1].html&&t.isActiveElement(e[1].html.bubbleElement.classList)}));(i=this.messageToElements).splice.apply(i,[0,this.messageToElements.length].concat(m(a))),!1!==n&&(null!=(s=this._introPanel)&&s._elementRef&&this._introPanel.display(),this.addIntroductoryMessages()),null==(r=this._onClearMessages)||r.call(this),delete e.sessionId}}],[{key:"getDisplayLoadingMessage",value:function(e,t){var n;return!t.websocket&&(null===(n=e.displayLoadingBubble)||void 0===n||n)}},{key:"checkPermittedErrorPrefixes",value:function(e,t){for(var n=0;n<e.length;n+=1)if(t.startsWith(e[n]))return t}},{key:"extractErrorMessages",value:function(e){return Array.isArray(e)?e:e instanceof Error?[e.message]:"string"==typeof e?[e]:"object"==w(e)&&e.error?[e.error]:[]}},{key:"isActiveElement",value:function(e){return!!e&&(e.contains(X.BUBBLE_CLASS)||e.contains(Bt.CLASS)||e.contains(Jt.MESSAGE_CLASS))}}]);var n}(Ut),Gi=function(){function e(){k(this,e)}return S(e,null,[{key:"adjustInputPadding",value:function(e,t){t["inside-left"].length>0&&e.classList.add("text-input-inner-left-adjustment"),t["inside-right"].length>0&&e.classList.add("text-input-inner-right-adjustment")}},{key:"adjustForOutsideButton",value:function(t,n,i){0===i["outside-right"].length&&i["outside-left"].length>0?(t[0].classList.add(e.INPUT_OUTSIDE_LEFT_SMALL_ADJUSTMENT_CLASS),n.classList.add(e.INPUT_OUTSIDE_LEFT_SMALL_ADJUSTMENT_CLASS)):0===i["outside-left"].length&&i["outside-right"].length>0&&(t[3].classList.add(e.INPUT_OUTSIDE_RIGHT_SMALL_ADJUSTMENT_CLASS),n.classList.add(e.INPUT_OUTSIDE_RIGHT_SMALL_ADJUSTMENT_CLASS))}},{key:"adjustOutsideSubmit",value:function(t,n,i){if(!(i["inside-left"].length>0||i["inside-right"].length>0)){if(0===i["outside-right"].length&&i["outside-left"].length>0)return t[0].classList.add(e.INPUT_OUTSIDE_LEFT_ADJUSTMENT_CLASS),n.classList.add(e.INPUT_OUTSIDE_LEFT_ADJUSTMENT_CLASS),i["outside-left"].map((function(e){return e.button.elementRef.classList.add("submit-button-enlarged")}));if(0===i["outside-left"].length&&i["outside-right"].length>0)return t[3].classList.add(e.INPUT_OUTSIDE_RIGHT_ADJUSTMENT_CLASS),n.classList.add(e.INPUT_OUTSIDE_RIGHT_ADJUSTMENT_CLASS),i["outside-right"].map((function(e){return e.button.elementRef.classList.add("submit-button-enlarged")}))}}},{key:"set",value:function(t,n,i,s){!!e.adjustOutsideSubmit(n,i,s)||e.adjustForOutsideButton(n,i,s),e.adjustInputPadding(t,s)}}])}();Gi.INPUT_OUTSIDE_LEFT_ADJUSTMENT_CLASS="text-input-container-left-adjustment",Gi.INPUT_OUTSIDE_RIGHT_ADJUSTMENT_CLASS="text-input-container-right-adjustment",Gi.INPUT_OUTSIDE_LEFT_SMALL_ADJUSTMENT_CLASS="text-input-container-left-small-adjustment",Gi.INPUT_OUTSIDE_RIGHT_SMALL_ADJUSTMENT_CLASS="text-input-container-right-small-adjustment";var Wi=Gi,Ki=function(){function e(){k(this,e)}return S(e,null,[{key:"create",value:function(){return Array.from({length:4}).map((function(e,t){var n=document.createElement("div");return n.classList.add("input-button-container"),(0===t||3===t)&&n.classList.add("outer-button-container"),(1===t||2===t)&&n.classList.add("inner-button-container"),n}))}},{key:"add",value:function(e,t){e.insertBefore(t[1],e.firstChild),e.insertBefore(t[0],e.firstChild),e.appendChild(t[2]),e.appendChild(t[3])}},{key:"getContainerIndex",value:function(e){return"outside-left"===e?0:"inside-left"===e?1:"inside-right"===e?2:3}},{key:"addButton",value:function(t,n,i){n.classList.add(i);var s=e.getContainerIndex(i);t[s].appendChild(n),3===s&&n.classList.add("outside-right")}}])}(),Ji=["camera","gifs","images","audio","mixedFiles","submit","microphone"],Yi=function(){function e(){k(this,e)}return S(e,null,[{key:"createTextElement",value:function(e){var t=document.createElement("div");return t.classList.add("text-button"),t.innerText=e,t}},{key:"createElement",value:function(t,n){return n?e.createTextElement(t):wn.createSVGElement(t)}},{key:"createCustomElement",value:function(t,n){var i,s,r,o,a=null==n?void 0:n[t];return null!=(i=null==a?void 0:a.svg)&&i.content?e.createElement(null==(s=null==a?void 0:a.svg)?void 0:s.content,!1):null!=(r=null==a?void 0:a.text)&&r.content?e.createElement(null==(o=null==a?void 0:a.text)?void 0:o.content,!0):void 0}},{key:"processElement",value:function(e,t){null!=t&&t.classList.contains("text-button")||e.classList.add("input-button-svg")}},{key:"createSpecificStateElement",value:function(t,n,i){var s;return i&&(s=e.createCustomElement(n,i)),e.processElement(t,s),s}},{key:"createInnerElement",value:function(t,n,i,s){var r,o;return(!(arguments.length>4&&void 0!==arguments[4]&&arguments[4])||null!=(o=null==(r=null==s?void 0:s[i])?void 0:r.svg)&&o.content)&&e.createSpecificStateElement(t,i,s)||n}}])}(),Zi=function(){function e(){k(this,e)}return S(e,null,[{key:"unsetAllCSS",value:function(e,t){var n,i;t.container&&M.unsetAllCSSMouseStates(e,t.container),null!=(n=t.svg)&&n.styles&&M.unsetAllCSSMouseStates(e.children[0],t.svg.styles),null!=(i=t.text)&&i.styles&&M.unsetAllCSSMouseStates(e.children[0],t.text.styles)}},{key:"unsetActionCSS",value:function(e,t){var n,i;t.container&&M.unsetActivityCSSMouseStates(e,t.container),null!=(n=t.svg)&&n.styles&&M.unsetActivityCSSMouseStates(e.children[0],t.svg.styles),null!=(i=t.text)&&i.styles&&M.unsetActivityCSSMouseStates(e.children[0],t.text.styles)}},{key:"setElementsCSS",value:function(e,t,n){var i,s,r,o,a;Object.assign(e.style,null==(i=t.container)?void 0:i[n]),Object.assign(e.children[0].style,null==(r=null==(s=t.svg)?void 0:s.styles)?void 0:r[n]),Object.assign(e.children[0].style,null==(a=null==(o=t.text)?void 0:o.styles)?void 0:a[n])}},{key:"setElementCssUpToState",value:function(t,n,i){e.setElementsCSS(t,n,"default"),"default"!==i&&(e.setElementsCSS(t,n,"hover"),"hover"!==i&&e.setElementsCSS(t,n,"click"))}}])}(),Xi=function(){return S((function e(t,n,i,s){k(this,e),this._mouseState={state:"default"},this.elementRef=t,this._customStyles=i,this.position=n,this.dropupText=s}),[{key:"buttonMouseLeave",value:function(e){this._mouseState.state="default",e&&(Zi.unsetAllCSS(this.elementRef,e),Zi.setElementsCSS(this.elementRef,e,"default"))}},{key:"buttonMouseEnter",value:function(e){this._mouseState.state="hover",e&&Zi.setElementsCSS(this.elementRef,e,"hover")}},{key:"buttonMouseUp",value:function(e){e&&Zi.unsetActionCSS(this.elementRef,e),this.buttonMouseEnter(e)}},{key:"buttonMouseDown",value:function(e){this._mouseState.state="click",e&&Zi.setElementsCSS(this.elementRef,e,"click")}},{key:"setEvents",value:function(e){this.elementRef.onmousedown=this.buttonMouseDown.bind(this,e),this.elementRef.onmouseup=this.buttonMouseUp.bind(this,e),this.elementRef.onmouseenter=this.buttonMouseEnter.bind(this,e),this.elementRef.onmouseleave=this.buttonMouseLeave.bind(this,e)}},{key:"unsetCustomStateStyles",value:function(e){if(this._customStyles)for(var t=0;t<e.length;t+=1){var n=e[t],i=n&&this._customStyles[n];i&&Zi.unsetActionCSS(this.elementRef,i)}}},{key:"reapplyStateStyle",value:function(e,t){if(this._customStyles){t&&this.unsetCustomStateStyles(t);var n=this._customStyles[e];n&&Zi.setElementCssUpToState(this.elementRef,n,this._mouseState.state),this.setEvents(n)}}}])}(),$i=function(){function e(){k(this,e)}return S(e,null,[{key:"focusItemWhenOnEdge",value:function(t,n){var i=n?t.children[0]:t.children[t.children.length-1];e.focusSiblingItem(i,t,n,!0)}},{key:"focusSiblingItem",value:function(t,n,i){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3]?t:t[i?"nextSibling":"previousSibling"];s?(t.dispatchEvent(new MouseEvent("mouseleave")),s.dispatchEvent(new MouseEvent("mouseenter"))):(t.dispatchEvent(new MouseEvent("mouseleave")),e.focusItemWhenOnEdge(n,i))}}])}(),Qi=function(){function e(){k(this,e)}return S(e,null,[{key:"addItemEvents",value:function(e,t,n,i){te.add(t,i),t.addEventListener("click",(function(){n.click()})),t.addEventListener("mouseenter",(function(t){e.highlightedItem=t.target})),t.addEventListener("mouseleave",(function(){e.highlightedItem=void 0}))}},{key:"createItemText",value:function(e,t){var n=document.createElement("div");return Object.assign(n.style,t),n.classList.add("dropup-menu-item-text"),n.textContent=e||"File",n}},{key:"createItemIcon",value:function(e,t){var n=document.createElement("div");return Object.assign(n.style,t),n.classList.add("dropup-menu-item-icon"),n.appendChild(e.children[0]),n}},{key:"populateItem",value:function(t,n,i,s){var r=t.children[0];r.classList.contains("text-button")?n.appendChild(e.createItemText(r.textContent,null==s?void 0:s.text)):(n.appendChild(e.createItemIcon(t,null==s?void 0:s.iconContainer)),n.appendChild(e.createItemText(i,null==s?void 0:s.text)))}},{key:"createItem",value:function(t,n,i){var s,r=n.elementRef,o=n.dropupText,a=document.createElement("div");Object.assign(a.style,null==(s=null==i?void 0:i.item)?void 0:s.default),e.populateItem(r,a,o,i),a.classList.add("dropup-menu-item");var l=M.processStateful((null==i?void 0:i.item)||{},{backgroundColor:"#f3f3f3"},{backgroundColor:"#ebebeb"});return e.addItemEvents(t,a,r,l),a}}])}(),es=function(){return S((function e(t,n){var i,s=this;k(this,e),this._isOpen=!0,this._styles=n,this.elementRef=e.createElement(null==(i=this._styles)?void 0:i.container),this.close(),setTimeout((function(){return s.addWindowEvents(t)}))}),[{key:"open",value:function(){this.elementRef.style.display="block",this._isOpen=!0}},{key:"close",value:function(){this._isOpen&&(this.elementRef.style.display="none",this._isOpen=!1)}},{key:"toggle",value:function(){this._isOpen?this.close():this.open()}},{key:"addItem",value:function(e){var t=Qi.createItem(this,e,this._styles);this.elementRef.appendChild(t)}},{key:"addWindowEvents",value:function(e){this.clickEvent=this.windowClick.bind(this,e),window.addEventListener("click",this.clickEvent),this.keyDownEvent=this.windowKeyDown.bind(this,e),window.addEventListener("keydown",this.keyDownEvent)}},{key:"windowClick",value:function(e,t){var n;!e.isConnected&&this.clickEvent?window.removeEventListener("click",this.clickEvent):e.parentElement!==(null==(n=t.target.shadowRoot)?void 0:n.children[0])&&this.close()}},{key:"windowKeyDown",value:function(e,t){var n,i,s;!e.isConnected&&this.keyDownEvent?window.removeEventListener("keydown",this.keyDownEvent):this._isOpen&&(t.key===D.ESCAPE?(this.close(),null==(n=this.highlightedItem)||n.dispatchEvent(new MouseEvent("mouseleave"))):t.key===D.ENTER?(null==(i=this.highlightedItem)||i.click(),null==(s=this.highlightedItem)||s.dispatchEvent(new MouseEvent("mouseleave"))):t.key===D.ARROW_DOWN?$i.focusSiblingItem(this.highlightedItem||this.elementRef.children[this.elementRef.children.length-1],this.elementRef,!0):t.key===D.ARROW_UP&&$i.focusSiblingItem(this.highlightedItem||this.elementRef.children[0],this.elementRef,!1))}}],[{key:"createElement",value:function(e){var t=document.createElement("div");return t.id="dropup-menu",Object.assign(t.style,e),t}}])}(),ts=function(e){function t(e,n){var i,s;k(this,t);var o=(i=r(this,t,[t.createButtonElement(),void 0,{styles:null==(s=null==n?void 0:n.button)?void 0:s.styles}])).createInnerElements(i._customStyles);return i._menu=new es(e,null==n?void 0:n.menu),i.addClickEvent(),i.buttonContainer=t.createButtonContainer(),i.elementRef.appendChild(o.styles),i.buttonContainer.appendChild(i.elementRef),i.elementRef.classList.add("dropup-icon","upload-file-button"),i.elementRef.children[0].id="dropup-icon",i.buttonContainer.appendChild(i._menu.elementRef),i.reapplyStateStyle("styles"),i.addContainerEvents(e),i}return c(t,e),S(t,[{key:"createInnerElements",value:function(e){return{styles:this.createInnerElement(t.createSVGIconElement(),"styles",e)}}},{key:"createInnerElement",value:function(e,t,n){return Yi.createSpecificStateElement(this.elementRef,t,n)||e}},{key:"addClickEvent",value:function(){this.elementRef.onclick=this._menu.toggle.bind(this._menu)}},{key:"addItem",value:function(e){this._menu.addItem(e)}},{key:"addContainerEvents",value:function(e){var t=this;e.addEventListener("click",(function(e){e.target.classList.contains("dropup-icon")||t._menu.close()}))}}],[{key:"createButtonElement",value:function(){var e=document.createElement("div");return e.classList.add("input-button"),e}},{key:"createSVGIconElement",value:function(){return wn.createSVGElement('<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">\n    <path d="M16 0c-8.836 0-16 7.163-16 16s7.163 16 16 16c8.837 0 16-7.163 16-16s-7.163-16-16-16zM16 30.032c-7.72 0-14-6.312-14-14.032s6.28-14 14-14 14 6.28 14 14-6.28 14.032-14 14.032zM23 15h-6v-6c0-0.552-0.448-1-1-1s-1 0.448-1 1v6h-6c-0.552 0-1 0.448-1 1s0.448 1 1 1h6v6c0 0.552 0.448 1 1 1s1-0.448 1-1v-6h6c0.552 0 1-0.448 1-1s-0.448-1-1-1z"></path>\n</svg>')}},{key:"createButtonContainer",value:function(){var e=document.createElement("div");return e.id="dropup-container",e}},{key:"getPosition",value:function(e,t){var n,i;return null!=(n=null==t?void 0:t.button)&&n.position?null==(i=null==t?void 0:t.button)?void 0:i.position:e["outside-left"].length>0&&0===e["outside-right"].length?"outside-right":"outside-left"}}])}(Xi),ns=function(){function e(){k(this,e)}return S(e,null,[{key:"addToDropup",value:function(e,t,n,i){var s=new ts(n,i);Ji.forEach((function(e){var n=t["dropup-menu"].findIndex((function(t){return t.buttonType===e})),i=t["dropup-menu"][n];i&&(s.addItem(i.button),t["dropup-menu"].splice(n,1))}));var r=ts.getPosition(t,i);Ki.addButton(e,s.buttonContainer,r),t[r].push({})}},{key:"addToSideContainer",value:function(e,t){["inside-left","inside-right","outside-left","outside-right"].forEach((function(n){var i=n;t[i].forEach((function(t){Ki.addButton(e,t.button.elementRef,i)}))}))}},{key:"setPosition",value:function(e,t,n){var i=b(b({},e[t]),{},{buttonType:t});n.push(i),delete e[t]}},{key:"createPositionsObj",value:function(){return{"dropup-menu":[],"outside-left":[],"inside-left":[],"inside-right":[],"outside-right":[]}}},{key:"generatePositions",value:function(t){var n=e.createPositionsObj();Object.keys(t).forEach((function(i){var s,r=null==(s=t[i])?void 0:s.button.position;r&&e.setPosition(t,i,n[r])})),0===n["inside-right"].length&&t.submit&&e.setPosition(t,"submit",n["inside-right"]),0===n["outside-right"].length&&(t.submit?e.setPosition(t,"submit",n["outside-right"]):t.microphone?e.setPosition(t,"microphone",n["outside-right"]):t.camera&&e.setPosition(t,"camera",n["outside-right"])),t.submit&&e.setPosition(t,"submit",0===n["outside-left"].length?n["outside-left"]:n["inside-right"]),t.microphone&&e.setPosition(t,"microphone",0===n["outside-left"].length?n["outside-left"]:n["inside-right"]);var i=Object.keys(t);return i.length>1||n["dropup-menu"].length>0?Ji.forEach((function(e){t[e]&&n["dropup-menu"].push(b(b({},t[e]),{},{buttonType:e}))})):1===i.length&&e.setPosition(t,i[0],0===n["outside-right"].length?n["outside-right"]:n["outside-left"]),n}},{key:"addButtons",value:function(t,n,i,s){var r=e.generatePositions(n);return e.addToSideContainer(t,r),r["dropup-menu"].length>0&&e.addToDropup(t,r,i,s),r}}])}(),is={images:{id:"upload-images-icon",svgString:'<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n  <path d="M20,15.2928932 L20,5.5 C20,4.67157288 19.3284271,4 18.5,4 L5.5,4 C4.67157288,4 4,4.67157288 4,5.5 L4,12.2928932 L7.14644661,9.14644661 C7.34170876,8.95118446 7.65829124,8.95118446 7.85355339,9.14644661 L13.5,14.7928932 L16.1464466,12.1464466 C16.3417088,11.9511845 16.6582912,11.9511845 16.8535534,12.1464466 L20,15.2928932 Z M20,16.7071068 L16.5,13.2071068 L13.8535534,15.8535534 C13.6582912,16.0488155 13.3417088,16.0488155 13.1464466,15.8535534 L7.5,10.2071068 L4,13.7071068 L4,18.5 C4,19.3284271 4.67157288,20 5.5,20 L18.5,20 C19.3284271,20 20,19.3284271 20,18.5 L20,16.7071068 Z M3,5.5 C3,4.11928813 4.11928813,3 5.5,3 L18.5,3 C19.8807119,3 21,4.11928813 21,5.5 L21,18.5 C21,19.8807119 19.8807119,21 18.5,21 L5.5,21 C4.11928813,21 3,19.8807119 3,18.5 L3,5.5 Z M15,6 L17,6 C17.5522847,6 18,6.44771525 18,7 L18,9 C18,9.55228475 17.5522847,10 17,10 L15,10 C14.4477153,10 14,9.55228475 14,9 L14,7 C14,6.44771525 14.4477153,6 15,6 Z M15,7 L15,9 L17,9 L17,7 L15,7 Z"/>\n</svg>\n',dropupText:"Image"},gifs:{id:"upload-gifs-icon",svgString:'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 5.9266752 5.6408391" height="21.31971" width="22.4">\n  <g>\n    <path d="m 5.2564627,1.548212 c -3.1136005,-0.4796804 -1.5568006,-0.2398402 0,0 z M 2.0001198,2.0922063 c 0.1556781,0 0.2657489,0.020893 0.3917849,0.080366 0.081154,0.038347 0.1153492,0.134065 0.076377,0.2138602 -0.038973,0.07979 -0.1363527,0.1134129 -0.2175069,0.075091 -0.078199,-0.036919 -0.1407455,-0.048792 -0.250655,-0.048792 -0.2260486,0 -0.3921482,0.2042182 -0.3921482,0.4801409 0,0.2761822 0.1663188,0.4810688 0.3921482,0.4810688 0.1117901,0 0.2064255,-0.046133 0.255659,-0.1284198 l 0.00162,-0.00389 V 3.0534032 l -0.098011,1.75e-4 c -0.081844,0 -0.1495979,-0.059305 -0.1612403,-0.1365887 l -0.00175,-0.023683 c 0,-0.08047 0.060311,-0.1470874 0.1389194,-0.1585331 l 0.024085,-0.00195 h 0.2612303 c 0.081842,0 0.149598,0.059305 0.1612404,0.1365891 l 0.00175,0.023683 -3.398e-4,0.3968809 v 0 l -0.00168,0.014211 v 0 l -0.00553,0.023034 v 0 l -0.00532,0.014145 c -0.098178,0.22826 -0.3236506,0.3528713 -0.5706303,0.3528713 -0.4240855,0 -0.7181621,-0.3622714 -0.7181621,-0.8016063 0,-0.4391857 0.2940275,-0.8006848 0.7181621,-0.8006848 z m 1.2034759,0.031275 c 0.081843,0 0.1495977,0.059305 0.1612403,0.1365891 l 0.00175,0.023683 v 1.2211775 c 0,0.088516 -0.07298,0.1602721 -0.1630073,0.1602721 -0.081841,0 -0.1495972,-0.059305 -0.1612397,-0.1365892 L 3.040589,3.5049308 V 2.2837527 c 0,-0.088516 0.07298,-0.1602721 0.1630067,-0.1602714 z m 0.7813442,0 0.5209469,0.00195 c 0.090025,3.048e-4 0.1627543,0.072306 0.1624458,0.1608234 -2.809e-4,0.08047 -0.06083,0.1468798 -0.1394772,0.158066 l -0.024092,0.00195 -0.3575326,-0.0013 v 0.4497782 l 0.2928918,2.27e-4 c 0.081842,0 0.1495979,0.059305 0.1612403,0.136589 l 0.00175,0.023683 c 0,0.080469 -0.06031,0.1470871 -0.1389193,0.1585393 l -0.024092,0.00195 -0.2928919,-2.336e-4 1.563e-4,0.2860316 c 0,0.080471 -0.06031,0.1470873 -0.1389193,0.1585395 l -0.024085,0.00195 c -0.081843,0 -0.1495979,-0.059305 -0.1612403,-0.1365826 l -0.00175,-0.023691 V 2.2841354 c 2.798e-4,-0.08047 0.060829,-0.1468797 0.1394758,-0.1580594 z"/>\n    <path d="m 5.0894191,1.0943261 c 0,-0.21918999 -0.177687,-0.39686999 -0.396876,-0.39686999 h -3.43959 c -0.2191879,0 -0.391262,0.1777519 -0.3968759,0.39686999 l -0.027082,3.4379266 c 0.040152,0.2939927 0.4235456,0.409415 0.4235456,0.409415 l 3.4785583,-0.00851 c 0,0 0.3008506,-0.1402998 0.3236271,-0.4201576 0.042911,-0.5272495 0.034693,-1.6106146 0.034693,-3.4186761 z m -4.49792494,0 c 0,-0.36530999 0.29614504,-0.66145999 0.66145894,-0.66145999 h 3.43959 c 0.365314,0 0.66146,0.29615 0.66146,0.66145999 v 3.43959 c 0,0.36532 -0.296146,0.66146 -0.66146,0.66146 h -3.43959 c -0.3653139,0 -0.66145894,-0.29614 -0.66145894,-0.66146 z"/>\n  </g>\n</svg>\n',dropupText:"GIF"},audio:{id:"upload-audio-icon",svgString:'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-49.49 -49.49 593.87 593.87" stroke-width="3.95908" transform="rotate(0)">\n  <g stroke-width="0"></g>\n  <g stroke-linecap="round" stroke-linejoin="round" stroke-width="0.98977"></g>\n  <g>\n    <g>\n      <g>\n        <path d="M163.205,76.413v293.301c-3.434-3.058-7.241-5.867-11.486-8.339c-21.38-12.452-49.663-15.298-77.567-7.846 c-49.038,13.096-80.904,54.519-71.038,92.337c4.019,15.404,14.188,28.221,29.404,37.087c13.553,7.894,29.87,11.933,47.115,11.933 c9.962,0,20.231-1.356,30.447-4.087c42.74-11.406,72.411-44.344,72.807-77.654h0.011v-0.162c0.002-0.166,0-0.331,0-0.496V187.072 l290.971-67.3v178.082c-3.433-3.055-7.238-5.863-11.481-8.334c-21.385-12.452-49.654-15.308-77.567-7.846 c-49.038,13.087-80.904,54.519-71.038,92.356c4.019,15.385,14.183,28.212,29.404,37.067c13.548,7.894,29.875,11.933,47.115,11.933 c9.962,0,20.231-1.356,30.452-4.087c42.74-11.413,72.411-44.346,72.804-77.654h0.004v-0.065c0.003-0.236,0.001-0.469,0-0.704V0 L163.205,76.413z M104.999,471.779c-22.543,6.038-45.942,3.846-62.572-5.846c-10.587-6.163-17.591-14.817-20.255-25.038 c-7.144-27.375,18.452-58.029,57.062-68.346c8.409-2.25,16.938-3.346,25.188-3.346c13.87,0,26.962,3.115,37.389,9.192 c10.587,6.163,17.591,14.817,20.255,25.029c0.809,3.102,1.142,6.248,1.139,9.4v0.321h0.014 C162.99,437.714,139.082,462.678,104.999,471.779z M182.898,166.853V92.067l290.971-67.298v74.784L182.898,166.853z M415.677,399.923c-22.558,6.038-45.942,3.837-62.587-5.846c-10.587-6.163-17.587-14.817-20.25-25.019 c-7.144-27.385,18.452-58.058,57.058-68.365c8.414-2.25,16.942-3.346,25.192-3.346c13.875,0,26.962,3.115,37.385,9.192 c10.596,6.163,17.596,14.817,20.26,25.029v0.01c0.796,3.05,1.124,6.144,1.135,9.244v0.468h0.02 C473.668,365.851,449.763,390.814,415.677,399.923z">\n        </path>\n      </g>\n    </g>\n  </g>\n</svg>',dropupText:"Audio"},mixedFiles:{id:"upload-mixed-files-icon",svgString:'<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<title>file</title>\n<path d="M20 10.9696L11.9628 18.5497C10.9782 19.4783 9.64274 20 8.25028 20C6.85782 20 5.52239 19.4783 4.53777 18.5497C3.55315 17.6211 3 16.3616 3 15.0483C3 13.7351 3.55315 12.4756 4.53777 11.547L12.575 3.96687C13.2314 3.34779 14.1217 3 15.05 3C15.9783 3 16.8686 3.34779 17.525 3.96687C18.1814 4.58595 18.5502 5.4256 18.5502 6.30111C18.5502 7.17662 18.1814 8.01628 17.525 8.63535L9.47904 16.2154C9.15083 16.525 8.70569 16.6989 8.24154 16.6989C7.77738 16.6989 7.33224 16.525 7.00403 16.2154C6.67583 15.9059 6.49144 15.4861 6.49144 15.0483C6.49144 14.6106 6.67583 14.1907 7.00403 13.8812L14.429 6.88674" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>',dropupText:"File"}},ss=function(){function e(){k(this,e)}return S(e,null,[{key:"addAttributes",value:function(e){e.role="button",e.setAttribute("tabindex","0")}},{key:"addAriaBusy",value:function(e){e.setAttribute("aria-busy","true")}},{key:"removeAriaBusy",value:function(e){e.removeAttribute("aria-busy")}},{key:"addAriaDisabled",value:function(e){e.setAttribute("aria-disabled","true")}},{key:"removeAriaDisabled",value:function(e){e.removeAttribute("aria-disabled")}},{key:"removeAriaAttributes",value:function(t){e.removeAriaBusy(t),e.removeAriaDisabled(t)}}])}(),rs=function(e){function t(e){var n;return k(this,t),"dropup-menu"===(null==e?void 0:e.position)&&(e.position="outside-right"),(n=r(this,t,[t.createMicrophoneElement(),null==e?void 0:e.position,e])).isActive=!1,n._innerElements=n.createInnerElements(n._customStyles),n.changeToDefault(),n}return c(t,e),S(t,[{key:"createInnerElements",value:function(e){var n=t.createSVGIconElement();return{default:this.createInnerElement(n,"default",e),active:this.createInnerElement(n,"active",e),unsupported:this.createInnerElement(n,"unsupported",e),commandMode:this.createInnerElement(n,"commandMode",e)}}},{key:"createInnerElement",value:function(e,t,n){return Yi.createSpecificStateElement(this.elementRef,t,n)||e}},{key:"changeToActive",value:function(){this.elementRef.replaceChildren(this._innerElements.active),this.toggleIconFilter("active"),this.reapplyStateStyle("active",["default","commandMode"]),this.isActive=!0}},{key:"changeToDefault",value:function(){this.elementRef.replaceChildren(this._innerElements.default),this.toggleIconFilter("default"),this.reapplyStateStyle("default",["active","commandMode"]),this.isActive=!1}},{key:"changeToCommandMode",value:function(){this.elementRef.replaceChildren(this._innerElements.unsupported),this.toggleIconFilter("command"),this.reapplyStateStyle("commandMode",["active"])}},{key:"changeToUnsupported",value:function(){this.elementRef.replaceChildren(this._innerElements.unsupported),this.elementRef.classList.add("unsupported-microphone"),this.reapplyStateStyle("unsupported",["active"])}},{key:"toggleIconFilter",value:function(e){var t=this.elementRef.children[0];if("svg"===t.tagName.toLocaleLowerCase())switch(e){case"default":t.classList.remove("active-microphone-icon","command-microphone-icon"),t.classList.add("default-microphone-icon");break;case"active":t.classList.remove("default-microphone-icon","command-microphone-icon"),t.classList.add("active-microphone-icon");break;case"command":t.classList.remove("active-microphone-icon","default-microphone-icon"),t.classList.add("command-microphone-icon")}}}],[{key:"createMicrophoneElement",value:function(){var e=document.createElement("div");return e.id="microphone-button",e.classList.add("input-button"),ss.addAttributes(e),e}},{key:"createSVGIconElement",value:function(){var e=wn.createSVGElement('<?xml version="1.0" encoding="iso-8859-1"?>\n<svg height="1.4em" width="1.4em" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n\t viewBox="0 0 490.9 490.9" xml:space="preserve">\n\t<g>\n\t\t<g>\n\t\t\t<path d="M245.5,322.9c53,0,96.2-43.2,96.2-96.2V96.2c0-53-43.2-96.2-96.2-96.2s-96.2,43.2-96.2,96.2v130.5\n\t\t\t\tC149.3,279.8,192.5,322.9,245.5,322.9z M173.8,96.2c0-39.5,32.2-71.7,71.7-71.7s71.7,32.2,71.7,71.7v130.5\n\t\t\t\tc0,39.5-32.2,71.7-71.7,71.7s-71.7-32.2-71.7-71.7V96.2z"/>\n\t\t\t<path d="M94.4,214.5c-6.8,0-12.3,5.5-12.3,12.3c0,85.9,66.7,156.6,151.1,162.8v76.7h-63.9c-6.8,0-12.3,5.5-12.3,12.3\n\t\t\t\ts5.5,12.3,12.3,12.3h152.3c6.8,0,12.3-5.5,12.3-12.3s-5.5-12.3-12.3-12.3h-63.9v-76.7c84.4-6.3,151.1-76.9,151.1-162.8\n\t\t\t\tc0-6.8-5.5-12.3-12.3-12.3s-12.3,5.5-12.3,12.3c0,76.6-62.3,138.9-138.9,138.9s-138.9-62.3-138.9-138.9\n\t\t\t\tC106.6,220,101.2,214.5,94.4,214.5z"/>\n\t\t</g>\n\t</g>\n</svg>\n');return e.id="microphone-icon",e}}])}(Xi),os={},as={},ls={},cs={},us={};Object.defineProperty(us,"__esModule",{value:!0}),us.Text=void 0;var ds=function(){function e(){k(this,e)}return S(e,null,[{key:"capitalize",value:function(t){return t.replace(e.FIRST_CHAR_REGEX,(function(e){return e.toUpperCase()}))}},{key:"lineBreak",value:function(t){return t.replace(e.DOUBLE_LINE,"<p></p>").replace(e.ONE_LINE,"<br>")}},{key:"isCharDefined",value:function(e){return void 0!==e&&"\xa0"!==e&&" "!==e&&"\n"!==e&&""!==e}},{key:"breakupIntoWordsArr",value:function(e){return e.split(/(\W+)/)}}])}();us.Text=ds,ds.FIRST_CHAR_REGEX=/\S/,ds.DOUBLE_LINE=/\n\n/g,ds.ONE_LINE=/\n/g,Object.defineProperty(cs,"__esModule",{value:!0}),cs.Translate=void 0;var hs=us,ps=function(){return S((function e(){k(this,e)}),null,[{key:"translate",value:function(e,t){for(var n=hs.Text.breakupIntoWordsArr(e),i=0;i<n.length;i+=1)t[n[i]]&&(n[i]=t[n[i]]);return n.join("")}}])}();cs.Translate=ps,Object.defineProperty(ls,"__esModule",{value:!0}),ls.WebSpeechTranscript=void 0;var fs=cs,ms=function(){return S((function e(){k(this,e)}),null,[{key:"extract",value:function(e,t,n){for(var i="",s=e.resultIndex;s<e.results.length;++s){var r=e.results[s][0].transcript;n&&(r=fs.Translate.translate(r,n)),e.results[s].isFinal?t+=r:i+=r}return{interimTranscript:i,finalTranscript:t,newText:i||t}}},{key:"extractSafari",value:function(e,t,n){for(var i="",s=e.resultIndex;s<e.results.length;++s){var r=e.results[s][0].transcript;n&&(r=fs.Translate.translate(r,n)),i+=r}return{interimTranscript:"",finalTranscript:i,newText:i}}}])}();ls.WebSpeechTranscript=ms;var vs={};Object.defineProperty(vs,"__esModule",{value:!0}),vs.Browser=void 0;var gs=S((function e(){k(this,e)}));vs.Browser=gs,gs.IS_SAFARI=function(){return void 0===gs._IS_SAFARI&&(gs._IS_SAFARI=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),gs._IS_SAFARI};var ys={},bs={};Object.defineProperty(bs,"__esModule",{value:!0}),bs.EventListeners=void 0;var _s=function(){function e(){k(this,e)}return S(e,null,[{key:"getElementIfFocusedOnAvailable",value:function(e,t){return Array.isArray(e)?e.find((function(e){return t===e})):t===e?e:void 0}},{key:"keyDownWindow",value:function(t){var n=this;t.element&&e.getElementIfFocusedOnAvailable(t.element,document.activeElement)&&(null!==e.KEY_DOWN_TIMEOUT&&clearTimeout(e.KEY_DOWN_TIMEOUT),e.KEY_DOWN_TIMEOUT=setTimeout((function(){e.KEY_DOWN_TIMEOUT=null,n.resetRecording(t)}),500))}},{key:"mouseDownWindow",value:function(t,n){this.mouseDownElement=e.getElementIfFocusedOnAvailable(t,n.target)}},{key:"mouseUpWindow",value:function(e){this.mouseDownElement&&this.resetRecording(e),this.mouseDownElement=void 0}},{key:"add",value:function(t,n){var i=void 0===(null==n?void 0:n.insertInCursorLocation)||(null==n?void 0:n.insertInCursorLocation);null!=n&&n.element&&i&&(t.mouseDownEvent=e.mouseDownWindow.bind(t,n.element),document.addEventListener("mousedown",t.mouseDownEvent),t.mouseUpEvent=e.mouseUpWindow.bind(t,n),document.addEventListener("mouseup",t.mouseUpEvent),t.keyDownEvent=e.keyDownWindow.bind(t,n),document.addEventListener("keydown",t.keyDownEvent))}},{key:"remove",value:function(e){document.removeEventListener("mousedown",e.mouseDownEvent),document.removeEventListener("mouseup",e.mouseUpEvent),document.removeEventListener("keydown",e.keyDownEvent)}}])}();bs.EventListeners=_s,_s.KEY_DOWN_TIMEOUT=null;var ws={};Object.defineProperty(ws,"__esModule",{value:!0}),ws.PreResultUtils=void 0;var ks=function(){return S((function e(){k(this,e)}),null,[{key:"process",value:function(e,t,n,i,s){var r=null==i?void 0:i(t,n);return!!r&&(setTimeout((function(){r.restart?e.resetRecording(s):r.stop&&e.stop()})),(r.stop||r.restart)&&r.removeNewText)}}])}();ws.PreResultUtils=ks;var xs={},Ss={};Object.defineProperty(Ss,"__esModule",{value:!0}),Ss.AutoScroll=void 0;var Es=function(){function e(){k(this,e)}return S(e,null,[{key:"changeStateIfNeeded",value:function(e,t){t&&!e.isCursorAtEnd&&(e.endPadding="",e.scrollingSpan.innerHTML="&nbsp;")}},{key:"scrollGeneric",value:function(e,t){e.isCursorAtEnd?t.scrollTop=t.scrollHeight:e.scrollingSpan.scrollIntoView({block:"nearest"})}},{key:"scrollSafariPrimitiveToEnd",value:function(e){e.scrollLeft=e.scrollWidth,e.scrollTop=e.scrollHeight}},{key:"isElementOverflown",value:function(e){return e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth}},{key:"isRequired",value:function(t,n){return t&&e.isElementOverflown(n)}}])}();Ss.AutoScroll=Es;var Cs={};Object.defineProperty(Cs,"__esModule",{value:!0}),Cs.Elements=void 0;var Ts=function(){return S((function e(){k(this,e)}),null,[{key:"isPrimitiveElement",value:function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName}},{key:"createInterimSpan",value:function(){var e=document.createElement("span");return e.style.color="grey",e.style.pointerEvents="none",e}},{key:"createGenericSpan",value:function(){var e=document.createElement("span");return e.style.pointerEvents="none",e}},{key:"appendSpans",value:function(e,t){if(e.spansPopulated=!0,e.insertInCursorLocation&&document.activeElement===t){var n=window.getSelection();if(null!=n&&n.focusNode){var i=n.getRangeAt(0);return i.insertNode(e.scrollingSpan),i.insertNode(e.interimSpan),i.insertNode(e.finalSpan),i.collapse(!1),n.removeAllRanges(),void n.addRange(i)}}t.appendChild(e.finalSpan),t.appendChild(e.interimSpan),t.appendChild(e.scrollingSpan)}},{key:"applyCustomColors",value:function(e,t){t.interim&&(e.interimSpan.style.color=t.interim),t.final&&(e.finalSpan.style.color=t.final)}},{key:"isInsideShadowDOM",value:function(e){return e.getRootNode()instanceof ShadowRoot}}])}();Cs.Elements=Ts;var Ms={};Object.defineProperty(Ms,"__esModule",{value:!0}),Ms.Cursor=void 0;var As=function(){function e(){k(this,e)}return S(e,null,[{key:"setOffsetForGeneric",value:function(t,n){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=0,r=0;r<t.childNodes.length;r+=1){var o=t.childNodes[r];if(o.childNodes.length>0){var a=e.setOffsetForGeneric(o,n,i);if(-1===a)return-1;i+=a}else if(null!==o.textContent){if(i+o.textContent.length>n){var l=document.createRange();l.setStart(o,n-i),l.collapse(!0);var c=window.getSelection();return null==c||c.removeAllRanges(),null==c||c.addRange(l),t.focus(),-1}i+=o.textContent.length,s+=o.textContent.length}}return s}},{key:"focusEndOfGeneric",value:function(e){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var n=window.getSelection();n&&(n.removeAllRanges(),n.addRange(t))}},{key:"setOffsetForSafariGeneric",value:function(t,n){var i=window.getSelection();if(i){var s=e.getGenericElementCursorOffset(t,i,!0);console.log(s),setTimeout((function(){}),100),e.setOffsetForGeneric(t,s+n)}}},{key:"setOffsetForPrimitive",value:function(e,t,n){n&&e.blur(),e.setSelectionRange(t,t),e.focus()}},{key:"getGenericElementCursorOffset",value:function(e,t,n){var i=0;if(t.rangeCount>0){var s=t.getRangeAt(0),r=s.cloneRange();r.selectNodeContents(e),n?r.setEnd(s.startContainer,s.startOffset):r.setEnd(s.endContainer,s.endOffset),i=r.toString().length}return i}}])}();Ms.Cursor=As,Object.defineProperty(xs,"__esModule",{value:!0}),xs.CommandUtils=void 0;var Is=Ss,Rs=Cs,Os=vs,Ls=Ms,Ps=us,Ds=function(){function e(){k(this,e)}return S(e,null,[{key:"processCommand",value:function(e,t){return(!t||!t.caseSensitive)&&(e=e.toLowerCase()),!1===(null==t?void 0:t.substrings)?Ps.Text.breakupIntoWordsArr(e):e}},{key:"process",value:function(t){var n;return!0===(null===(n=t.settings)||void 0===n?void 0:n.caseSensitive)?t:Object.keys(t).reduce((function(n,i){var s=t[i];return n[i]="string"==typeof s?e.processCommand(s,t.settings):s,n}),{})}},{key:"toggleCommandModeOn",value:function(e){var t;e.isWaitingForCommand=!0,null===(t=e.onCommandModeTrigger)||void 0===t||t.call(e,!0)}},{key:"toggleCommandModeOff",value:function(e){var t;e.isWaitingForCommand&&(null===(t=e.onCommandModeTrigger)||void 0===t||t.call(e,!1),e.isWaitingForCommand=!1)}},{key:"setText",value:function(t,n,i,s){e.toggleCommandModeOff(t),Rs.Elements.isPrimitiveElement(s)?(s.value=i,t.isTargetInShadow||Ls.Cursor.setOffsetForPrimitive(s,i.length,!0),Os.Browser.IS_SAFARI()&&t.autoScroll&&Is.AutoScroll.scrollSafariPrimitiveToEnd(s)):(s.textContent=i,t.isTargetInShadow||Ls.Cursor.focusEndOfGeneric(s),setTimeout((function(){return Is.AutoScroll.scrollGeneric(t,s)}))),t.resetRecording(n)}},{key:"checkIfMatchesSubstring",value:function(e,t){return t.includes(e)}},{key:"checkIfMatchesWord",value:function(e,t,n){for(var i=e,s=n.length-1;s>=0;s-=1){for(var r=s,o=i.length-1;n[r]===i[o]&&o>=0;)r-=1,o-=1;if(o<0)return!0}return!1}},{key:"execCommand",value:function(t,n,i,s,r){var o,a,l,c=t.commands;if(c&&s&&i){var u=!0===(null===(o=c.settings)||void 0===o?void 0:o.caseSensitive)?n:n.toLowerCase(),d=Ps.Text.breakupIntoWordsArr(u),h=!1===(null===(a=c.settings)||void 0===a?void 0:a.substrings)?e.checkIfMatchesWord:e.checkIfMatchesSubstring;if(c.commandMode&&h(c.commandMode,u,d))return t.setInterimColorToFinal(),setTimeout((function(){return e.toggleCommandModeOn(t)})),{doNotProcessTranscription:!1};if(!c.commandMode||t.isWaitingForCommand){if(c.stop&&h(c.stop,u,d))return e.toggleCommandModeOff(t),setTimeout((function(){return t.stop()})),{doNotProcessTranscription:!1};if(c.pause&&h(c.pause,u,d))return e.toggleCommandModeOff(t),t.setInterimColorToFinal(),setTimeout((function(){var e;t.isPaused=!0,null===(e=t.onPauseTrigger)||void 0===e||e.call(t,!0)})),{doNotProcessTranscription:!1};if(c.resume&&h(c.resume,u,d))return t.isPaused=!1,null===(l=t.onPauseTrigger)||void 0===l||l.call(t,!1),e.toggleCommandModeOff(t),t.resetRecording(i),{doNotProcessTranscription:!0};if(c.reset&&h(c.reset,u,d))return void 0!==r&&e.setText(t,i,r,s),{doNotProcessTranscription:!0};if(c.removeAllText&&h(c.removeAllText,u,d))return e.setText(t,i,"",s),{doNotProcessTranscription:!0}}}}}])}();xs.CommandUtils=Ds;var Ns={};Object.defineProperty(Ns,"__esModule",{value:!0}),Ns.Highlight=void 0;var zs=Cs,Bs=Ms,Fs=function(){function e(){k(this,e)}return S(e,null,[{key:"setStateForPrimitive",value:function(e,t){var n,i;null!==t.selectionStart&&(n=t.selectionStart),null!==t.selectionEnd&&(i=t.selectionEnd),e.isHighlighted=n!==i}},{key:"setStateForGeneric",value:function(e,t){var n=window.getSelection();if(null!=n&&n.focusNode){var i=Bs.Cursor.getGenericElementCursorOffset(t,n,!0),s=Bs.Cursor.getGenericElementCursorOffset(t,n,!1);e.isHighlighted=i!==s}}},{key:"setState",value:function(t,n){document.activeElement===n&&(zs.Elements.isPrimitiveElement(n)?e.setStateForPrimitive(t,n):e.setStateForGeneric(t,n))}},{key:"removeForGeneric",value:function(e,t){var n=window.getSelection();if(n){var i=Bs.Cursor.getGenericElementCursorOffset(t,n,!0);n.deleteFromDocument(),Bs.Cursor.setOffsetForGeneric(t,i),e.isHighlighted=!1}}},{key:"removeForPrimitive",value:function(e,t){var n=t.selectionStart,i=t.selectionEnd,s=t.value;if(n&&i){var r=s.substring(0,n)+s.substring(i);t.value=r,Bs.Cursor.setOffsetForPrimitive(t,n,e.autoScroll)}e.isHighlighted=!1}}])}();Ns.Highlight=Fs;var Us={};Object.defineProperty(Us,"__esModule",{value:!0}),Us.Padding=void 0;var js=Cs,qs=Ms,Vs=us,Hs=function(){function e(){k(this,e)}return S(e,null,[{key:"setStateForPrimitiveElement",value:function(e,t){if(document.activeElement===t&&null!==t.selectionStart){var n=t.selectionStart,i=t.value[n-1],s=null===t.selectionEnd?n:t.selectionEnd,r=t.value[s];return Vs.Text.isCharDefined(i)&&(e.startPadding=" ",e.numberOfSpacesBeforeNewText=1),Vs.Text.isCharDefined(r)&&(e.endPadding=" ",e.numberOfSpacesAfterNewText=1),void(e.isCursorAtEnd=t.value.length===s)}var o=t.value[t.value.length-1];Vs.Text.isCharDefined(o)&&(e.startPadding=" ",e.numberOfSpacesBeforeNewText=1),e.isCursorAtEnd=!0}},{key:"setStateForGenericElement",value:function(e,t){var n,i,s;if(document.activeElement===t){var r=window.getSelection();if(null!=r&&r.focusNode){var o=qs.Cursor.getGenericElementCursorOffset(t,r,!0),a=null===(n=t.textContent)||void 0===n?void 0:n[o-1],l=qs.Cursor.getGenericElementCursorOffset(t,r,!1),c=null===(i=t.textContent)||void 0===i?void 0:i[l];return Vs.Text.isCharDefined(a)&&(e.startPadding=" "),Vs.Text.isCharDefined(c)&&(e.endPadding=" "),void(e.isCursorAtEnd=(null===(s=t.textContent)||void 0===s?void 0:s.length)===l)}}var u=t.innerText.charAt(t.innerText.length-1);Vs.Text.isCharDefined(u)&&(e.startPadding=" "),e.isCursorAtEnd=!0}},{key:"setState",value:function(t,n){js.Elements.isPrimitiveElement(n)?e.setStateForPrimitiveElement(t,n):e.setStateForGenericElement(t,n)}},{key:"adjustStateAfterRecodingPrimitiveElement",value:function(e,t){e.primitiveTextRecorded=!0,e.insertInCursorLocation&&document.activeElement===t&&(null!==t.selectionEnd&&(e.endPadding=e.endPadding+t.value.slice(t.selectionEnd)),null!==t.selectionStart)?e.startPadding=t.value.slice(0,t.selectionStart)+e.startPadding:e.startPadding=t.value+e.startPadding}},{key:"adjustSateForNoTextPrimitiveElement",value:function(e){1===e.numberOfSpacesBeforeNewText&&(e.startPadding=e.startPadding.substring(0,e.startPadding.length-1),e.numberOfSpacesBeforeNewText=0),1===e.numberOfSpacesAfterNewText&&(e.endPadding=e.endPadding.substring(1),e.numberOfSpacesAfterNewText=0)}}])}();Us.Padding=Hs,Object.defineProperty(ys,"__esModule",{value:!0}),ys.Speech=void 0;var Gs=bs,Ws=ws,Ks=xs,Js=Ss,Ys=Ns,Zs=Cs,Xs=Us,$s=vs,Qs=Ms,er=us,tr=function(){return S((function e(){k(this,e),this.finalTranscript="",this.interimSpan=Zs.Elements.createInterimSpan(),this.finalSpan=Zs.Elements.createGenericSpan(),this.scrollingSpan=Zs.Elements.createGenericSpan(),this.isCursorAtEnd=!1,this.spansPopulated=!1,this.startPadding="",this.endPadding="",this.numberOfSpacesBeforeNewText=0,this.numberOfSpacesAfterNewText=0,this.isHighlighted=!1,this.primitiveTextRecorded=!1,this.recognizing=!1,this._displayInterimResults=!0,this.insertInCursorLocation=!0,this.autoScroll=!0,this.isRestarting=!1,this.isPaused=!1,this.isWaitingForCommand=!1,this.isTargetInShadow=!1,this.cannotBeStopped=!1,this.resetState()}),[{key:"prepareBeforeStart",value:function(e){var t,n;if(null!=e&&e.element)if(Gs.EventListeners.add(this,e),Array.isArray(e.element)){var i=e.element.find((function(e){return e===document.activeElement}))||e.element[0];if(!i)return;this.prepare(i)}else this.prepare(e.element);void 0!==(null==e?void 0:e.displayInterimResults)&&(this._displayInterimResults=e.displayInterimResults),null!=e&&e.textColor&&(this._finalTextColor=null===(t=null==e?void 0:e.textColor)||void 0===t?void 0:t.final,Zs.Elements.applyCustomColors(this,e.textColor)),void 0!==(null==e?void 0:e.insertInCursorLocation)&&(this.insertInCursorLocation=e.insertInCursorLocation),void 0!==(null==e?void 0:e.autoScroll)&&(this.autoScroll=e.autoScroll),this._onResult=null==e?void 0:e.onResult,this._onPreResult=null==e?void 0:e.onPreResult,this._onStart=null==e?void 0:e.onStart,this._onStop=null==e?void 0:e.onStop,this._onError=null==e?void 0:e.onError,this.onCommandModeTrigger=null==e?void 0:e.onCommandModeTrigger,this.onPauseTrigger=null==e?void 0:e.onPauseTrigger,this._options=e,null!==(n=this._options)&&void 0!==n&&n.commands&&(this.commands=Ks.CommandUtils.process(this._options.commands))}},{key:"prepare",value:function(e){Xs.Padding.setState(this,e),Ys.Highlight.setState(this,e),this.isTargetInShadow=Zs.Elements.isInsideShadowDOM(e),Zs.Elements.isPrimitiveElement(e)?(this._primitiveElement=e,this._originalText=this._primitiveElement.value):(this._genericElement=e,this._originalText=this._genericElement.textContent)}},{key:"resetRecording",value:function(e){this.isRestarting=!0,this.stop(!0),this.resetState(!0),this.start(e,!0)}},{key:"updateElements",value:function(e,t,n){var i,s=er.Text.capitalize(t);if(this.finalTranscript!==s||""!==e){Ws.PreResultUtils.process(this,n,""===e,this._onPreResult,this._options)&&(e="",n="");var r=this.commands&&Ks.CommandUtils.execCommand(this,n,this._options,this._primitiveElement||this._genericElement,this._originalText);if(r){if(r.doNotProcessTranscription)return;e="",n=""}if(!this.isPaused&&!this.isWaitingForCommand){null===(i=this._onResult)||void 0===i||i.call(this,n,""===e),this.finalTranscript=s,this._displayInterimResults||(e="");var o=""===this.finalTranscript&&""===e;this._primitiveElement?this.updatePrimitiveElement(this._primitiveElement,e,o):this._genericElement&&this.updateGenericElement(this._genericElement,e,o)}}}},{key:"updatePrimitiveElement",value:function(e,t,n){this.isHighlighted&&Ys.Highlight.removeForPrimitive(this,e),this.primitiveTextRecorded||Xs.Padding.adjustStateAfterRecodingPrimitiveElement(this,e),n&&Xs.Padding.adjustSateForNoTextPrimitiveElement(this);var i=this.startPadding+this.finalTranscript+t;if(e.value=i+this.endPadding,!this.isTargetInShadow){var s=i.length+this.numberOfSpacesAfterNewText;Qs.Cursor.setOffsetForPrimitive(e,s,this.autoScroll)}this.autoScroll&&$s.Browser.IS_SAFARI()&&this.isCursorAtEnd&&Js.AutoScroll.scrollSafariPrimitiveToEnd(e)}},{key:"updateGenericElement",value:function(e,t,n){this.isHighlighted&&Ys.Highlight.removeForGeneric(this,e),this.spansPopulated||Zs.Elements.appendSpans(this,e);var i=(n?"":this.startPadding)+er.Text.lineBreak(this.finalTranscript);this.finalSpan.innerHTML=i;var s=Js.AutoScroll.isRequired(this.autoScroll,e);Js.AutoScroll.changeStateIfNeeded(this,s);var r=er.Text.lineBreak(t)+(n?"":this.endPadding);this.interimSpan.innerHTML=r,$s.Browser.IS_SAFARI()&&this.insertInCursorLocation&&Qs.Cursor.setOffsetForSafariGeneric(e,i.length+r.length),s&&Js.AutoScroll.scrollGeneric(this,e),n&&(this.scrollingSpan.innerHTML="")}},{key:"finalise",value:function(e){this._genericElement&&(e?(this.finalSpan=Zs.Elements.createGenericSpan(),this.setInterimColorToFinal(),this.interimSpan=Zs.Elements.createInterimSpan(),this.scrollingSpan=Zs.Elements.createGenericSpan()):this._genericElement.textContent=this._genericElement.textContent,this.spansPopulated=!1),Gs.EventListeners.remove(this)}},{key:"setInterimColorToFinal",value:function(){this.interimSpan.style.color=this._finalTextColor||"black"}},{key:"resetState",value:function(e){this._primitiveElement=void 0,this._genericElement=void 0,this.finalTranscript="",this.finalSpan.innerHTML="",this.interimSpan.innerHTML="",this.scrollingSpan.innerHTML="",this.startPadding="",this.endPadding="",this.isHighlighted=!1,this.primitiveTextRecorded=!1,this.numberOfSpacesBeforeNewText=0,this.numberOfSpacesAfterNewText=0,e||(this.stopTimeout=void 0)}},{key:"setStateOnStart",value:function(){var e;this.recognizing=!0,this.isRestarting?this.isRestarting=!1:null===(e=this._onStart)||void 0===e||e.call(this)}},{key:"setStateOnStop",value:function(){var e;this.recognizing=!1,this.isRestarting||null===(e=this._onStop)||void 0===e||e.call(this)}},{key:"setStateOnError",value:function(e){var t;null===(t=this._onError)||void 0===t||t.call(this,e),this.recognizing=!1}}])}();ys.Speech=tr,Object.defineProperty(as,"__esModule",{value:!0}),as.WebSpeech=void 0;var nr=ls,ir=vs,sr=function(e){function t(){return k(this,t),r(this,t)}return c(t,e),S(t,[{key:"start",value:function(e){var t;void 0===this._extractText&&(this._extractText=ir.Browser.IS_SAFARI()?nr.WebSpeechTranscript.extractSafari:nr.WebSpeechTranscript.extract),this.validate()&&(this.prepareBeforeStart(e),this.instantiateService(e),null===(t=this._service)||void 0===t||t.start(),this._translations=null==e?void 0:e.translations)}},{key:"validate",value:function(){return!!t.getAPI()||(this.error("Speech Recognition is unsupported"),!1)}},{key:"instantiateService",value:function(e){var n,i,s=t.getAPI();this._service=new s,this._service.continuous=!0,this._service.interimResults=null===(n=null==e?void 0:e.displayInterimResults)||void 0===n||n,this._service.lang=(null===(i=null==e?void 0:e.language)||void 0===i?void 0:i.trim())||"en-US",this.setEvents()}},{key:"setEvents",value:function(){var e=this;this._service&&(this._service.onstart=function(){e.setStateOnStart()},this._service.onerror=function(t){ir.Browser.IS_SAFARI()&&"Another request is started"===t.message||"aborted"===t.error&&e.isRestarting||"no-speech"!==t.error&&e.error(t.message||t.error)},this._service.onaudioend=function(){e.setStateOnStop()},this._service.onend=function(){e._stopping=!1},this._service.onresult=function(t){if(w(t.results)>"u"&&e._service)e._service.onend=null,e._service.stop();else if(e._extractText&&!e._stopping){var n=e._extractText(t,e.finalTranscript,e._translations),i=n.interimTranscript,s=n.finalTranscript,r=n.newText;e.updateElements(i,s,r)}})}},{key:"stop",value:function(e){var t;this._stopping=!0,null===(t=this._service)||void 0===t||t.stop(),this.finalise(e)}},{key:"error",value:function(e){console.error(e),this.setStateOnError(e),this.stop()}}],[{key:"getAPI",value:function(){return window.webkitSpeechRecognition||window.SpeechRecognition}}])}(ys.Speech);as.WebSpeech=sr;var rr={};Object.defineProperty(rr,"__esModule",{value:!0}),rr.GlobalState=void 0;var or=function(){function e(){k(this,e)}return S(e,null,[{key:"doubleClickDetector",value:function(){return!!e.doubleClickPending||(e.doubleClickPending=!0,setTimeout((function(){e.doubleClickPending=!1}),300),!1)}}])}();rr.GlobalState=or,or.doubleClickPending=!1;var ar={},lr={};Object.defineProperty(lr,"__esModule",{value:!0}),lr.PreventConnectionStop=void 0;var cr=function(){return S((function e(){k(this,e)}),null,[{key:"applyPrevention",value:function(e){clearTimeout(e._manualConnectionStopPrevention),e.cannotBeStopped=!0,e._manualConnectionStopPrevention=setTimeout((function(){e.cannotBeStopped=!1}),800)}},{key:"clearPrevention",value:function(e){clearTimeout(e._manualConnectionStopPrevention),e.cannotBeStopped=!1}}])}();lr.PreventConnectionStop=cr;var ur={},dr={};Object.defineProperty(dr,"__esModule",{value:!0}),dr.README_URL=void 0,dr.README_URL="https://github.com/OvidijusParsiunas/speech-to-element",Object.defineProperty(ur,"__esModule",{value:!0}),ur.AzureSpeechConfig=void 0;var hr=dr,pr=function(){function e(){k(this,e)}return S(e,null,[{key:"validateOptions",value:function(e,t){return t?t.subscriptionKey||t.token||t.retrieveToken?!!t.region||(e("Please define a 'region' property - more info: ".concat(hr.README_URL)),!1):(e("Please define a 'subscriptionKey', 'token' or 'retrieveToken' property - more info: ".concat(hr.README_URL)),!1):(e("Please provide subscription details - more info: ".concat(hr.README_URL)),!1)}},{key:"getNewSpeechConfig",value:(n=f(h().mark((function e(t,n){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.region){e.next=2;break}return e.abrupt("return",n.subscriptionKey?t.fromSubscription(n.subscriptionKey.trim(),n.region.trim()):n.token?t.fromAuthorizationToken(n.token.trim(),n.region.trim()):n.retrieveToken?n.retrieveToken().then((function(e){return n.region?t.fromAuthorizationToken((null==e?void 0:e.trim())||"",n.region.trim()):null})).catch((function(e){return console.error(e),null})):null);case 2:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"process",value:function(e,t){t.language&&(e.speechRecognitionLanguage=t.language.trim())}},{key:"get",value:(t=f(h().mark((function t(n,i){var s;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getNewSpeechConfig(n,i);case 2:return s=t.sent,t.abrupt("return",(s&&e.process(s,i),s));case 4:case"end":return t.stop()}}),t)}))),function(e,n){return t.apply(this,arguments)})}]);var t,n}();ur.AzureSpeechConfig=pr;var fr={};Object.defineProperty(fr,"__esModule",{value:!0}),fr.StopTimeout=void 0;var mr=function(){function e(){k(this,e)}return S(e,null,[{key:"set",value:function(e){e.stopTimeout=setTimeout((function(){return e.stop()}),e.stopTimeoutMS)}},{key:"reset",value:function(t,n){t.stopTimeoutMS=n||e.DEFAULT_MS,t.stopTimeout&&clearTimeout(t.stopTimeout),e.set(t)}}])}();fr.StopTimeout=mr,mr.DEFAULT_MS=2e4;var vr={};Object.defineProperty(vr,"__esModule",{value:!0}),vr.AzureTranscript=void 0;var gr=cs,yr=function(){return S((function e(){k(this,e)}),null,[{key:"extract",value:function(e,t,n,i){return i&&(e=gr.Translate.translate(e,i)),n?{interimTranscript:"",finalTranscript:t+e,newText:e}:{interimTranscript:e,finalTranscript:t,newText:e}}}])}();vr.AzureTranscript=yr,Object.defineProperty(ar,"__esModule",{value:!0}),ar.Azure=void 0;var br=lr,_r=ur,wr=fr,kr=vr,xr=function(e){function t(){var e;return k(this,t),(e=r(this,t,arguments))._newTextPadding="",e}return c(t,e),S(t,[{key:"start",value:function(e,t){this._newTextPadding="",void 0===this.stopTimeout&&wr.StopTimeout.reset(this,null==e?void 0:e.stopAfterSilenceMs),this.prepareBeforeStart(e),this.startAsync(e),t||br.PreventConnectionStop.applyPrevention(this)}},{key:"startAsync",value:(i=f(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.validate(t),!e.t0){e.next=6;break}return e.next=4,this.instantiateService(t);case 4:this._translations=null==t?void 0:t.translations,null===(n=this._service)||void 0===n||n.startContinuousRecognitionAsync((function(){}),this.error);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"validate",value:function(e){return t.getAPI()?_r.AzureSpeechConfig.validateOptions(this.error.bind(this),e):(this.moduleNotFound(),!1)}},{key:"instantiateService",value:(n=f(h().mark((function e(n){var i,s,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.getAPI(),s=i.AudioConfig.fromDefaultMicrophoneInput(),e.next=4,_r.AzureSpeechConfig.get(i.SpeechConfig,n);case 4:(r=e.sent)?(o=new i.SpeechRecognizer(r,s),this.setEvents(o),this._service=o,n.retrieveToken&&this.retrieveTokenInterval(n.retrieveToken)):this.error("Unable to contact Azure server");case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"setEvents",value:function(e){e.recognizing=this.onRecognizing.bind(this),e.recognized=this.onRecognized.bind(this),e.sessionStarted=this.onSessionStarted.bind(this),e.canceled=this.onCanceled.bind(this),e.sessionStopped=this.onSessionStopped.bind(this)}},{key:"onRecognizing",value:function(e,t){if(!this._stopping){var n=kr.AzureTranscript.extract(this._newTextPadding+t.result.text,this.finalTranscript,!1,this._translations),i=n.interimTranscript,s=n.finalTranscript,r=n.newText;wr.StopTimeout.reset(this,this.stopTimeoutMS),this.updateElements(i,s,r)}}},{key:"onRecognized",value:function(e,t){var n=t.result;switch(n.reason){case window.SpeechSDK.ResultReason.Canceled:break;case window.SpeechSDK.ResultReason.RecognizedSpeech:if(n.text&&!this._stopping){var i=kr.AzureTranscript.extract(this._newTextPadding+n.text,this.finalTranscript,!0,this._translations),s=i.interimTranscript,r=i.finalTranscript,o=i.newText;wr.StopTimeout.reset(this,this.stopTimeoutMS),this.updateElements(s,r,o),""!==r&&(this._newTextPadding=" ")}}}},{key:"onCanceled",value:function(e,t){t.reason===window.SpeechSDK.CancellationReason.Error&&this.error(t.errorDetails)}},{key:"onSessionStarted",value:function(){br.PreventConnectionStop.clearPrevention(this),this.setStateOnStart()}},{key:"onSessionStopped",value:function(){this._retrieveTokenInterval||clearInterval(this._retrieveTokenInterval),this._stopping=!1,this.setStateOnStop()}},{key:"retrieveTokenInterval",value:function(e){var t=this;this._retrieveTokenInterval=setInterval((function(){null==e||e().then((function(e){t._service&&(t._service.authorizationToken=(null==e?void 0:e.trim())||"")})).catch((function(e){t.error(e)}))}),1e4)}},{key:"stop",value:function(e){var t;!e&&this._retrieveTokenInterval&&clearInterval(this._retrieveTokenInterval),this._stopping=!0,null===(t=this._service)||void 0===t||t.stopContinuousRecognitionAsync(),this.finalise(e)}},{key:"moduleNotFound",value:function(){console.error("speech recognition module not found:"),console.error("please install the 'microsoft-cognitiveservices-speech-sdk' npm package or add a script tag: <script src=\"https://aka.ms/csspeech/jsbrowserpackageraw\"><\/script>"),this.setStateOnError("speech recognition module not found")}},{key:"error",value:function(e){this._retrieveTokenInterval&&clearInterval(this._retrieveTokenInterval),console.error(e),this.setStateOnError(e),this.stop()}}],[{key:"getAPI",value:function(){return window.SpeechSDK}}]);var n,i}(ys.Speech);ar.Azure=xr,Object.defineProperty(os,"__esModule",{value:!0});var Sr=as,Er=xs,Cr=rr,Tr=ar,Mr=function(){function e(){k(this,e)}return S(e,null,[{key:"toggle",value:function(t,n){var i,s,r=t.toLocaleLowerCase().trim();null!==(i=Cr.GlobalState.service)&&void 0!==i&&i.recognizing?this.stop():"webspeech"===r?e.startWebSpeech(n):"azure"===r?e.startAzure(n):(console.error("service not found - must be either 'webspeech' or 'azure'"),null===(s=null==n?void 0:n.onError)||void 0===s||s.call(n,"service not found - must be either 'webspeech' or 'azure'"))}},{key:"startWebSpeech",value:function(t){e.stop()||(Cr.GlobalState.service=new Sr.WebSpeech,Cr.GlobalState.service.start(t))}},{key:"isWebSpeechSupported",value:function(){return!!Sr.WebSpeech.getAPI()}},{key:"startAzure",value:function(t){var n;e.stop()||null!==(n=Cr.GlobalState.service)&&void 0!==n&&n.cannotBeStopped||(Cr.GlobalState.service=new Tr.Azure,Cr.GlobalState.service.start(t))}},{key:"stop",value:function(){var e;return!!Cr.GlobalState.doubleClickDetector()||(!(null===(e=Cr.GlobalState.service)||void 0===e)&&e.recognizing&&Cr.GlobalState.service.stop(),!1)}},{key:"endCommandMode",value:function(){Cr.GlobalState.service&&Er.CommandUtils.toggleCommandModeOff(Cr.GlobalState.service)}}])}(),Ar=os.default=Mr,Ir=function(){return S((function e(t,n){k(this,e),this.silenceMS=2e3,this.stop=!0,"boolean"==typeof n&&!1===n&&(this.stop=!1),"number"==typeof t&&(this.silenceMS=t)}),[{key:"setSilenceTimeout",value:function(e,t){var n=this;this._silenceTimeout=setTimeout((function(){var i;null==(i=e.submit)||i.call(e),Ar.stop(),n.stop||setTimeout(t,Or.MICROPHONE_RESET_TIMEOUT_MS)}),this.silenceMS)}},{key:"clearSilenceTimeout",value:function(){this._silenceTimeout&&clearTimeout(this._silenceTimeout)}},{key:"resetSilenceTimeout",value:function(e,t){this.clearSilenceTimeout(),this.setSilenceTimeout(e,t)}},{key:"onPause",value:function(e,t,n){e?this.resetSilenceTimeout(t,n):this.clearSilenceTimeout()}}])}(),Rr=function(e){function t(e,n,i){var s;k(this,t);var o="object"==w(e.speechToText)?e.speechToText:{},a=(s=r(this,t,[null==o?void 0:o.button])).processConfiguration(n,e.speechToText),l=a.serviceName,c=a.processedConfig;if(s._addErrorMessage=i,"webspeech"!==l||Ar.isWebSpeechSupported()){var u=!e.textInput||!e.textInput.disabled;s.elementRef.onclick=s.buttonClick.bind(s,n,u,l,c)}else s.changeToUnsupported();return setTimeout((function(){s._validationHandler=e._validationHandler})),s}return c(t,e),S(t,[{key:"processConfiguration",value:function(e,n){var i,s,r,o,a,l,c="object"==w(n)?n:{},u="object"==w(c.webSpeech)?c.webSpeech:{},d=c.azure||{},h=b(b({displayInterimResults:null!==(i=c.displayInterimResults)&&void 0!==i?i:void 0,textColor:null!==(s=c.textColor)&&void 0!==s?s:void 0,translations:null!==(r=c.translations)&&void 0!==r?r:void 0,commands:null!==(o=c.commands)&&void 0!==o?o:void 0,events:null!==(a=c.events)&&void 0!==a?a:void 0},u),d),p=null==(l=c.commands)?void 0:l.submit;return p&&(h.onPreResult=function(t){return t.toLowerCase().includes(p)?(setTimeout((function(){var t;return null==(t=e.submit)?void 0:t.call(e)})),Ar.endCommandMode(),{restart:!0,removeNewText:!0}):null}),c.submitAfterSilence&&(this._silenceSubmit=new Ir(c.submitAfterSilence,c.stopAfterSubmit)),{serviceName:t.getServiceName(c),processedConfig:h}}},{key:"buttonClick",value:function(e,t,n,i){var s=this,r=null==i?void 0:i.events;e.removePlaceholderStyle(),Ar.toggle(n,b({insertInCursorLocation:!1,element:t?e.inputElementRef:void 0,onError:function(){var e;s.onError(),null==(e=s._silenceSubmit)||e.clearSilenceTimeout()},onStart:function(){var e;s.changeToActive(),null==(e=null==r?void 0:r.onStart)||e.call(r)},onStop:function(){var e,t,n;null==(e=s._validationHandler)||e.call(s),null==(t=s._silenceSubmit)||t.clearSilenceTimeout(),s.changeToDefault(),null==(n=null==r?void 0:r.onStop)||n.call(r)},onPauseTrigger:function(t){var n,i;null==(n=s._silenceSubmit)||n.onPause(t,e,s.elementRef.onclick),null==(i=null==r?void 0:r.onPauseTrigger)||i.call(r,t)},onPreResult:function(e,t){var n;null==(n=null==r?void 0:r.onPreResult)||n.call(r,e,t)},onResult:function(t,n){var i,o,a;n&&(null==(i=s._validationHandler)||i.call(s)),null==(o=s._silenceSubmit)||o.resetSilenceTimeout(e,s.elementRef.onclick),null==(a=null==r?void 0:r.onResult)||a.call(r,t,n)},onCommandModeTrigger:function(e){var t;s.onCommandModeTrigger(e),null==(t=null==r?void 0:r.onCommandModeTrigger)||t.call(r,e)}},i))}},{key:"onCommandModeTrigger",value:function(e){e?this.changeToCommandMode():this.changeToActive()}},{key:"onError",value:function(){this._addErrorMessage("speechToText","speech input error")}}],[{key:"getServiceName",value:function(e){return e.azure?"azure":"webspeech"}},{key:"toggleSpeechAfterSubmit",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.click(),n||setTimeout((function(){return e.click()}),t.MICROPHONE_RESET_TIMEOUT_MS)}}])}(rs);Rr.MICROPHONE_RESET_TIMEOUT_MS=300;var Or=Rr,Lr=function(){function e(t,n,i,s){var r=this;k(this,e),this._attachments=[],this._fileCountLimit=99,this._acceptedFormat="",n.maxNumberOfFiles&&(this._fileCountLimit=n.maxNumberOfFiles),this._toggleContainerDisplay=i,this._fileAttachmentsContainerRef=s,n.acceptedFormats&&(this._acceptedFormat=n.acceptedFormats),setTimeout((function(){r._validationHandler=t._validationHandler}))}return S(e,[{key:"attemptAddFile",value:function(t,n){return!!e.isFileTypeValid(t,this._acceptedFormat)&&(this.addAttachmentBasedOnType(t,n,!0),!0)}},{key:"addAttachmentBasedOnType",value:function(t,n,i){var s=e.getTypeFromBlob(t);if("image"===s){var r=e.createImageAttachment(n);this.addFileAttachment(t,"image",r,i)}else if("audio"===s){var o=Nr.createAudioAttachment(n);this.addFileAttachment(t,"audio",o,i)}else{var a=e.createAnyFileAttachment(t.name);this.addFileAttachment(t,"any",a,i)}}},{key:"addFileAttachment",value:function(t,n,i,s){var r,o=e.createContainer(i);if(this._attachments.length>=this._fileCountLimit){var a=this._attachments[this._attachments.length-1].removeButton;null==a||a.click();var l=this._fileAttachmentsContainerRef.children;this._fileAttachmentsContainerRef.insertBefore(o,l[0])}else this._fileAttachmentsContainerRef.appendChild(o);var c={file:t,attachmentContainerElement:o,fileType:n};return s&&(c.removeButton=this.createRemoveAttachmentButton(c),o.appendChild(c.removeButton)),this._toggleContainerDisplay(!0),this._attachments.push(c),this._fileAttachmentsContainerRef.scrollTop=this._fileAttachmentsContainerRef.scrollHeight,null==(r=this._validationHandler)||r.call(this),c}},{key:"createRemoveAttachmentButton",value:function(e){var t=document.createElement("div");t.classList.add("remove-file-attachment-button"),t.onclick=this.removeAttachment.bind(this,e);var n=document.createElement("div");return n.classList.add("x-icon"),n.innerText="\xd7",t.appendChild(n),t}},{key:"removeAttachment",value:function(e){var t,n=this._attachments.findIndex((function(t){return t===e})),i=this._attachments[n].attachmentContainerElement;this._attachments.splice(n,1),Nr.stopAttachmentPlayback(i),i.remove(),this._toggleContainerDisplay(!1),null==(t=this._validationHandler)||t.call(this)}},{key:"getFiles",value:function(){return Array.from(this._attachments).map((function(e){return{file:e.file,type:e.fileType}}))}},{key:"removeAllAttachments",value:function(){this._attachments.forEach((function(e){setTimeout((function(){var t;return null==(t=e.removeButton)?void 0:t.click()}))}))}}],[{key:"isFileTypeValid",value:function(e,t){if(""===t)return!0;for(var n=t.split(","),i=0;i<n.length;i++){var s=n[i].trim();if(e.type===s)return!0;if(s.startsWith(".")){var r=s.slice(1);if(e.name.endsWith(r))return!0}else{if(e.name.endsWith(s))return!0;if(s.endsWith("/*")&&e.type.startsWith(s.slice(0,-2)))return!0}}return!1}},{key:"getTypeFromBlob",value:function(e){var t=e.type;return t.startsWith("image")?"image":t.startsWith("audio")?"audio":"any"}},{key:"createImageAttachment",value:function(e){var t=new Image;return t.src=e,t.classList.add("image-attachment"),t}},{key:"createAnyFileAttachment",value:function(e){var t=document.createElement("div");t.classList.add("border-bound-attachment"),P.IS_SAFARI&&t.classList.add("border-bound-attachment-safari");var n=document.createElement("div");n.classList.add("any-file-attachment-text");var i=document.createElement("div");return i.classList.add("file-attachment-text-container"),i.appendChild(n),n.textContent=e,t.appendChild(i),t}},{key:"createContainer",value:function(e){var t=document.createElement("div");return t.classList.add("file-attachment"),t.appendChild(e),t}}])}(),Pr='<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">\n<title>stop</title>\n<path d="M5.92 24.096q0 0.832 0.576 1.408t1.44 0.608h16.128q0.832 0 1.44-0.608t0.576-1.408v-16.16q0-0.832-0.576-1.44t-1.44-0.576h-16.128q-0.832 0-1.44 0.576t-0.576 1.44v16.16z"></path>\n</svg>',Dr=function(e){function t(e,n,i,s){return k(this,t),r(this,t,[e,n,i,s])}return c(t,e),S(t,[{key:"createTimer",value:function(e,n){var i=this,s=0,r=void 0!==n&&n<t.TIMER_LIMIT_S?n:t.TIMER_LIMIT_S;return setInterval((function(){var t;(s+=1)===r&&(null==(t=i.stopPlaceholderCallback)||t.call(i),i.clearTimer()),600===s&&e.classList.add("audio-placeholder-text-4-digits");var n=Math.floor(s/60),o=(s%60).toString().padStart(2,"0");e.textContent="".concat(n,":").concat(o)}),1e3)}},{key:"createPlaceholderAudioAttachment",value:function(e){var n=t.createAudioContainer(),i=document.createElement("div");i.classList.add("audio-placeholder-text-3-digits");var s=document.createElement("div");s.classList.add("file-attachment-text-container","audio-placeholder-text-3-digits-container"),s.appendChild(i);var r=wn.createSVGElement(Pr);return r.classList.add("attachment-icon","stop-icon","not-removable-attachment-icon"),i.textContent="0:00",this._activePlaceholderTimer=this.createTimer(i,e),n.appendChild(s),this.addPlaceholderAudioAttachmentEvents(n,r,s),n}},{key:"addPlaceholderAudioAttachmentEvents",value:function(e,t,n){var i=this;e.addEventListener("mouseenter",(function(){return e.replaceChildren(t)}));e.addEventListener("mouseleave",(function(){return e.replaceChildren(n)}));e.addEventListener("click",(function(){var e;return null==(e=i.stopPlaceholderCallback)?void 0:e.call(i)}))}},{key:"addPlaceholderAttachment",value:function(e,t){var n=this.createPlaceholderAudioAttachment(t);this._activePlaceholderAttachment=this.addFileAttachment(new File([],""),"audio",n,!1),this.stopPlaceholderCallback=e}},{key:"completePlaceholderAttachment",value:function(e,n){var i=this._activePlaceholderAttachment;i&&(i.file=e,t.addAudioElements(i.attachmentContainerElement.children[0],n),i.removeButton=this.createRemoveAttachmentButton(i),i.attachmentContainerElement.appendChild(i.removeButton),this._activePlaceholderAttachment=void 0,this.clearTimer())}},{key:"removePlaceholderAttachment",value:function(){this._activePlaceholderAttachment&&(this.removeAttachment(this._activePlaceholderAttachment),this._activePlaceholderAttachment=void 0,this.clearTimer())}},{key:"clearTimer",value:function(){void 0!==this._activePlaceholderTimer&&(clearInterval(this._activePlaceholderTimer),this._activePlaceholderTimer=void 0,this.stopPlaceholderCallback=void 0)}}],[{key:"createAudioContainer",value:function(){var e=document.createElement("div");return e.classList.add("border-bound-attachment","audio-attachment-icon-container"),P.IS_SAFARI&&e.classList.add("border-bound-attachment-safari"),e}},{key:"addAudioElements",value:function(e,t){var n=e.parentElement?K.cloneElement(e):e,i=document.createElement("audio");i.src=t;var s=wn.createSVGElement('<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  <title>play</title>\n  <path d="M5.92 24.096q0 1.088 0.928 1.728 0.512 0.288 1.088 0.288 0.448 0 0.896-0.224l16.16-8.064q0.48-0.256 0.8-0.736t0.288-1.088-0.288-1.056-0.8-0.736l-16.16-8.064q-0.448-0.224-0.896-0.224-0.544 0-1.088 0.288-0.928 0.608-0.928 1.728v16.16z"></path>\n</svg>');s.classList.add("attachment-icon","play-icon");var r=wn.createSVGElement(Pr);r.classList.add("attachment-icon","stop-icon"),n.replaceChildren(s),i.onplay=function(){n.replaceChildren(r)},i.onpause=function(){n.replaceChildren(s),i.currentTime=0},i.onended=function(){n.replaceChildren(s)},n.onclick=function(){i.paused?i.play():i.pause()}}},{key:"createAudioAttachment",value:function(e){var n=t.createAudioContainer();return t.addAudioElements(n,e),n}},{key:"stopAttachmentPlayback",value:function(e){var t,n,i;null!=(i=null==(n=null==(t=e.children[0])?void 0:t.children)?void 0:n[0])&&i.classList.contains("stop-icon")&&e.children[0].click()}}])}(Lr);Dr.TIMER_LIMIT_S=5999;var Nr=Dr,zr=function(){return S((function e(){k(this,e)}),null,[{key:"create",value:function(e,t,n,i,s){return"audio"===s?new Nr(e,t,n,i):new Lr(e,t,n,i)}}])}(),Br=function(){function e(t,n,i){k(this,e),this._fileAttachmentsTypes=[],this.elementRef=this.createAttachmentContainer();var s="object"==w(i)&&!!i.displayFileAttachmentContainer;this.toggleContainerDisplay(s),t.appendChild(this.elementRef),n&&Object.assign(this.elementRef.style,n)}return S(e,[{key:"addType",value:function(e,t,n){var i=zr.create(e,t,this.toggleContainerDisplay.bind(this),this.elementRef,n);return this._fileAttachmentsTypes.push(i),i}},{key:"createAttachmentContainer",value:function(){var e=document.createElement("div");return e.id="file-attachment-container",e}},{key:"toggleContainerDisplay",value:function(e){e?this.elementRef.style.display="block":0===this.elementRef.children.length&&(this.elementRef.style.display="none")}},{key:"getAllFileData",value:function(){var e=this._fileAttachmentsTypes.map((function(e){return e.getFiles()})).flat();return e.length>0?e:void 0}},{key:"completePlaceholders",value:(t=f(h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this._fileAttachmentsTypes.map(function(){var e=f(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null==(n=t.stopPlaceholderCallback)?void 0:n.call(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"addFilesToAnyType",value:function(t){e.addFilesToType(t,this._fileAttachmentsTypes)}},{key:"removeAllFiles",value:function(){this._fileAttachmentsTypes.forEach((function(e){return e.removeAllAttachments()})),this.elementRef.replaceChildren(),this.toggleContainerDisplay(!1)}},{key:"getNumberOfTypes",value:function(){return this._fileAttachmentsTypes.length}}],[{key:"addFilesToType",value:function(e,t){e.forEach((function(e){var n=new FileReader;n.readAsDataURL(e),n.onload=function(n){for(var i=0;i<t.length&&!t[i].attemptAddFile(e,n.target.result);i+=1);}}))}}]);var t}(),Fr=function(){function e(t,n,i){k(this,e),this._isOpen=!1,this._contentRef=e.createModalContent(n,null==i?void 0:i.backgroundColor),this._buttonPanel=e.createButtonPanel(null==i?void 0:i.backgroundColor),this._elementRef=e.createContainer(this._contentRef,i),this._elementRef.appendChild(this._buttonPanel),t.appendChild(this._elementRef),this._backgroundPanelRef=e.createDarkBackgroundPanel(),t.appendChild(this._backgroundPanelRef),this.addWindowEvents(t)}return S(e,[{key:"isOpen",value:function(){return this._isOpen}},{key:"addButtons",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];n.forEach((function(t){ss.addAttributes(t),e._buttonPanel.appendChild(t)}))}},{key:"close",value:function(){var t=this;this._elementRef.classList.remove("show-modal"),this._elementRef.classList.add("hide-modal"),this._backgroundPanelRef.classList.remove("show-modal-background"),this._backgroundPanelRef.classList.add("hide-modal-background"),this._isOpen=!1,setTimeout((function(){t._elementRef.style.display="none",t._backgroundPanelRef.style.display="none"}),e.MODAL_CLOSE_TIMEOUT_MS)}},{key:"displayModalElements",value:function(){this._elementRef.style.display="flex",this._elementRef.classList.remove("hide-modal"),this._elementRef.classList.add("show-modal"),this._backgroundPanelRef.style.display="block",this._backgroundPanelRef.classList.remove("hide-modal-background"),this._backgroundPanelRef.classList.add("show-modal-background"),this._isOpen=!0}},{key:"openTextModal",value:function(e){this._contentRef.innerHTML=e,this.displayModalElements()}},{key:"addCloseButton",value:function(t,n,i){var s=this,r=n?e.createSVGButton(t):e.createTextButton(t);return this.addButtons(r),r.onclick=function(){s.close(),setTimeout((function(){null==i||i()}),140)},r}},{key:"addWindowEvents",value:function(e){this.keyDownEvent=this.windowKeyDown.bind(this,e),window.addEventListener("keydown",this.keyDownEvent)}},{key:"windowKeyDown",value:function(e,t){var n,i;!e.isConnected&&this.keyDownEvent?window.removeEventListener("keydown",this.keyDownEvent):this._isOpen&&(t.key===D.ESCAPE?(this.close(),null==(n=this.extensionCloseCallback)||n.call(this)):t.key===D.ENTER&&(this.close(),null==(i=this.extensionCloseCallback)||i.call(this)))}}],[{key:"createContainer",value:function(e,t){var n=document.createElement("div");return n.classList.add("modal"),n.appendChild(e),t&&delete t.backgroundColor,Object.assign(n.style,t),n}},{key:"createModalContent",value:function(e,t){var n,i=document.createElement("div");return(n=i.classList).add.apply(n,m(e)),t&&(i.style.backgroundColor=t),document.createElement("div").appendChild(i),i}},{key:"createButtonPanel",value:function(e){var t=document.createElement("div");return t.classList.add("modal-button-panel"),e&&(t.style.backgroundColor=e),t}},{key:"createDarkBackgroundPanel",value:function(){var e=document.createElement("div");return e.id="modal-background-panel",e}},{key:"createTextButton",value:function(e){var t=document.createElement("div");return t.classList.add("modal-button"),t.textContent=e,t}},{key:"createSVGButton",value:function(e){var t=document.createElement("div");t.classList.add("modal-button","modal-svg-button");var n=wn.createSVGElement(e);return n.classList.add("modal-svg-button-icon"),t.appendChild(n),t}},{key:"createTextModalFunc",value:function(t,n,i){var s;if("object"==w(n)&&null!=(s=n.files)&&s.infoModal){var r=new e(t,["modal-content"],n.files.infoModal.containerStyle);return r.addCloseButton("OK",!1,i),r.openTextModal.bind(r,n.infoModalTextMarkUp||"")}}}])}();Fr.MODAL_CLOSE_TIMEOUT_MS=190;var Ur=Fr,jr=function(e){function t(e,n,i,s,o,a){var l,c,u,d,h,p,f,m,v,g;k(this,t);var y=null==(c=null==i?void 0:i.button)?void 0:c.position,b=(null==(h=null==(d=null==(u=null==i?void 0:i.button)?void 0:u.styles)?void 0:d.text)?void 0:h.content)||a,_="dropup-menu"===y,w=(l=r(this,t,[t.createButtonElement(),y,i.button,b])).createInnerElements(s,o,l._customStyles,_);return l._inputElement=t.createInputElement(null==(p=null==i?void 0:i.files)?void 0:p.acceptedFormats),l.addClickEvent(e,i),l.elementRef.replaceChildren(w.styles),l.reapplyStateStyle("styles"),l._fileAttachmentsType=n,l._openModalOnce=!1===(null==(m=null==(f=i.files)?void 0:f.infoModal)?void 0:m.openModalOnce)||null==(g=null==(v=i.files)?void 0:v.infoModal)?void 0:g.openModalOnce,l}return c(t,e),S(t,[{key:"createInnerElements",value:function(e,n,i){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=t.createSVGIconElement(e,n);return{styles:Yi.createInnerElement(this.elementRef,r,"styles",i,s)}}},{key:"triggerImportPrompt",value:function(e){e.onchange=this.import.bind(this,e),e.click()}},{key:"import",value:function(e){Br.addFilesToType(Array.from(e.files||[]),[this._fileAttachmentsType]),e.value=""}},{key:"addClickEvent",value:function(e,t){var n=this.triggerImportPrompt.bind(this,this._inputElement),i=Ur.createTextModalFunc(e,t,n);this.elementRef.onclick=this.click.bind(this,i)}},{key:"click",value:function(e){!e||void 0!==this._openModalOnce&&!0!==this._openModalOnce?this.triggerImportPrompt(this._inputElement):(e(),!0===this._openModalOnce&&(this._openModalOnce=!1))}}],[{key:"createInputElement",value:function(e){var t=document.createElement("input");return t.type="file",t.accept=e||"",t.hidden=!0,t.multiple=!0,t}},{key:"createButtonElement",value:function(){var e=document.createElement("div");return e.classList.add("input-button","upload-file-button"),ss.addAttributes(e),e}},{key:"createSVGIconElement",value:function(e,t){var n=wn.createSVGElement(t);return n.id=e,n}}])}(Xi),qr=function(){function e(){k(this,e)}return S(e,null,[{key:"create",value:function(t,n,i){var s=e.createElement(i);e.addEvents(s,t,n),t.appendChild(s)}},{key:"createElement",value:function(e){var t=document.createElement("div");return t.id="drag-and-drop","object"==w(e)&&Object.assign(t.style,e),t}},{key:"addEvents",value:function(t,n,i){n.ondragenter=function(n){n.preventDefault(),e.display(t)},t.ondragleave=function(n){n.preventDefault(),e.hide(t)},t.ondragover=function(e){e.preventDefault()},t.ondrop=function(n){n.preventDefault(),e.uploadFile(i,n),e.hide(t)}}},{key:"uploadFile",value:function(e,t){var n,i=null==(n=t.dataTransfer)?void 0:n.files;i&&e.addFilesToAnyType(Array.from(i))}},{key:"display",value:function(e){e.style.display="block"}},{key:"hide",value:function(e){e.style.display="none"}},{key:"isEnabled",value:function(e,t){return(void 0===t||!1!==t)&&(!!t||e.getNumberOfTypes()>0)}}])}(),Vr=function(){function e(){k(this,e)}return S(e,null,[{key:"validate",value:function(e,t,n,i,s){var r=e(n,i,s);return r?t.changeToSubmitIcon():t.changeToDisabledIcon(),r}},{key:"useValidationFunc",value:(n=f(h().mark((function t(n,i,s,r){var o,a,l;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=i.isTextInputEmpty()?"":i.inputElementRef.textContent,t.next=3,s.completePlaceholders();case 3:return a=s.getAllFileData(),l=null==a?void 0:a.map((function(e){return e.file})),t.abrupt("return",e.validate(n,r,o,l));case 5:case"end":return t.stop()}}),t)}))),function(e,t,i,s){return n.apply(this,arguments)})},{key:"useValidationFuncProgrammatic",value:(t=f(h().mark((function t(n,i,s){var r,o;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=null==(r=i.files)?void 0:r.map((function(e){return e.file})),t.abrupt("return",e.validate(n,s,i.text,o,!0));case 2:case"end":return t.stop()}}),t)}))),function(e,n,i){return t.apply(this,arguments)})},{key:"validateWebsocket",value:function(e,t){return!(e.websocket&&!cn.canSendMessage(e.websocket))||(t.changeToDisabledIcon(),!1)}},{key:"attach",value:function(t,n,i,s,r){var o=t.validateInput||ee.processValidateInput(t);t._validationHandler=function(){var t=f(h().mark((function t(a){var l;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.status.loadingActive&&!r.status.requestInProgress&&!0!==n.isSubmitProgrammaticallyDisabled&&e.validateWebsocket(n,r)){t.next=2;break}return t.abrupt("return",!1);case 2:return l=o||n.canSendMessage,t.abrupt("return",l?a?e.useValidationFuncProgrammatic(l,a,r):e.useValidationFunc(l,i,s,r):null);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}]);var t,n}(),Hr=function(){return S((function e(){k(this,e)}),null,[{key:"getFileName",value:function(e,t){var n=new Date,i=String(n.getHours()).padStart(2,"0"),s=String(n.getMinutes()).padStart(2,"0"),r=String(n.getSeconds()).padStart(2,"0");return"".concat(e,"-").concat(i,"-").concat(s,"-").concat(r,".").concat(t)}}])}(),Gr=function(e){function t(e,n){var i,s,a;return k(this,t),(i=r(this,t,[n.button]))._waitingForBrowserApproval=!1,i._audioType=e,i._extension=(null==(s=n.files)?void 0:s.format)||"mp3",i._maxDurationSeconds=null==(a=n.files)?void 0:a.maxDurationSeconds,i.elementRef.onclick=i.buttonClick.bind(o(i)),i}return c(t,e),S(t,[{key:"buttonClick",value:function(){this._waitingForBrowserApproval||(this.isActive?this.stop():(this._waitingForBrowserApproval=!0,this.record()))}},{key:"stop",value:function(){var e=this;return new Promise((function(t){var n,i;e.changeToDefault(),null==(n=e._mediaRecorder)||n.stop(),null==(i=e._mediaStream)||i.getTracks().forEach((function(e){return e.stop()})),setTimeout((function(){t()}),10)}))}},{key:"record",value:function(){var e=this;navigator.mediaDevices.getUserMedia({audio:!0}).then((function(t){e.changeToActive(),e._mediaRecorder=new MediaRecorder(t),e._audioType.addPlaceholderAttachment(e.stop.bind(e),e._maxDurationSeconds),e._mediaStream=t,e._mediaRecorder.addEventListener("dataavailable",(function(t){e.createFile(t)})),e._mediaRecorder.start()})).catch((function(t){console.error(t),e.stop()})).finally((function(){e._waitingForBrowserApproval=!1}))}},{key:"createFile",value:function(e){var t=this,n=new Blob([e.data],{type:"audio/".concat(this._extension)}),i=Hr.getFileName(this._newFilePrefix||"audio",this._extension),s=new File([n],i,{type:n.type}),r=new FileReader;r.readAsDataURL(s),r.onload=function(e){t._audioType.completePlaceholderAttachment(s,e.target.result)}}}])}(rs),Wr=function(){function e(){k(this,e)}return S(e,null,[{key:"setPropertyValueIfDoesNotExist",value:function(t,n,i){var s,r,o=n[0];1===n.length?null!==(s=t[o])&&void 0!==s||(t[o]=i):(null!==(r=t[o])&&void 0!==r||(t[o]={}),n.shift(),e.setPropertyValueIfDoesNotExist(t[o],n,i))}},{key:"setPropertyValue",value:function(t,n,i){var s,r=n[0];1===n.length?t[r]=i:(null!==(s=t[r])&&void 0!==s||(t[r]={}),n.shift(),e.setPropertyValue(t[r],n,i))}},{key:"getObjectValue",value:function(t,n){var i=t[n[0]];return void 0===i||1===n.length?i:e.getObjectValue(i,n.slice(1))}},{key:"overwritePropertyObjectFromAnother",value:function(t,n,i){var s=e.getObjectValue(n,i);if(s){var r=b(b({},s),e.getObjectValue(t,i)||{});e.setPropertyValue(t,i,r)}}}])}(),Kr=function(){function e(){k(this,e)}return S(e,null,[{key:"resetSubmit",value:function(e,t){t?e.unsetCustomStateStyles(["loading","submit"]):e.unsetCustomStateStyles(["stop","loading","submit"]),e.reapplyStateStyle("submit")}},{key:"overwriteDefaultStyleWithSubmit",value:function(e,t){if(e.submit){var n=JSON.parse(JSON.stringify(e[t]||{}));Wr.overwritePropertyObjectFromAnother(n,e.submit,["container","default"]),Wr.overwritePropertyObjectFromAnother(n,e.submit,["text","styles","default"]),Wr.overwritePropertyObjectFromAnother(n,e.submit,["svg","styles","default"]),e[t]=n}}},{key:"setUpDisabledButton",value:function(t){Wr.setPropertyValueIfDoesNotExist(t,["submit","container","default","backgroundColor"],""),Wr.setPropertyValueIfDoesNotExist(t,["disabled","container","default","backgroundColor"],"unset"),Wr.setPropertyValueIfDoesNotExist(t.submit,["svg","styles","default","filter"],""),Wr.setPropertyValueIfDoesNotExist(t.disabled,["svg","styles","default","filter"],"brightness(0) saturate(100%) invert(70%) sepia(0%) saturate(5564%) hue-rotate(207deg) brightness(100%) contrast(97%)"),e.overwriteDefaultStyleWithSubmit(t,"disabled")}},{key:"process",value:function(t){var n=JSON.parse(JSON.stringify(t||{}));return e.overwriteDefaultStyleWithSubmit(n,"loading"),e.overwriteDefaultStyleWithSubmit(n,"stop"),null!=t&&t.alwaysEnabled||e.setUpDisabledButton(n),n}}])}(),Jr=function(e){function t(e,n,i,s,a,l){var c;k(this,t);var u=Kr.process(e.submitButtonStyles);return(c=r(this,t,[t.createButtonContainerElement(),null==u?void 0:u.position,u]))._isSVGLoadingIconOverriden=!1,c.status={requestInProgress:!1,loadingActive:!1},c._messages=i,c._textInput=n,c._fileAttachments=a,c._innerElements=c.createInnerElements(),c._abortStream=new AbortController,c._stopClicked={listener:function(){}},c._serviceIO=s,c._alwaysEnabled=!(null==u||!u.alwaysEnabled),e.disableSubmitButton=c.disableSubmitButton.bind(o(c),s),c.attemptOverwriteLoadingStyle(e),l.microphone&&c.setUpSpeechToText(l.microphone.button,e.speechToText),setTimeout((function(){var t;c._validationHandler=e._validationHandler,c.assignHandlers(c._validationHandler),null==(t=c._validationHandler)||t.call(o(c))})),c}return c(t,e),S(t,[{key:"createInnerElements",value:function(){var e=this.createCustomElements(),n=e.submit,i=e.loading,s=e.stop,r=n||t.createSubmitIconElement();return{submit:r,loading:i||t.createLoadingIconElement(),stop:s||t.createStopIconElement(),disabled:this.createDisabledIconElement(r)}}},{key:"createCustomElements",value:function(){var e=this,t=Yi.createSpecificStateElement(this.elementRef,"submit",this._customStyles),n={loading:void 0,stop:void 0};return Object.keys(n).forEach((function(t){var i=t,s=Yi.createCustomElement(i,e._customStyles);s&&(n[i]=s)})),n.submit=t,n}},{key:"createDisabledIconElement",value:function(e){return Yi.createCustomElement("disabled",this._customStyles)||e.cloneNode(!0)}},{key:"attemptOverwriteLoadingStyle",value:function(e){var t,n,i,s,r,o,a,l,c;if(!(null!=(n=null==(t=this._customStyles)?void 0:t.submit)&&n.svg||null!=(r=null==(s=null==(i=this._customStyles)?void 0:i.loading)?void 0:s.svg)&&r.content||null!=(l=null==(a=null==(o=this._customStyles)?void 0:o.loading)?void 0:a.text)&&l.content||void 0!==e.displayLoadingBubble&&!0!==e.displayLoadingBubble)){var u=document.createElement("style");u.textContent="\n        .loading-button > * {\n          filter: brightness(0) saturate(100%) invert(72%) sepia(0%) saturate(3044%) hue-rotate(322deg) brightness(100%)\n            contrast(96%) !important;\n        }",null==(c=e.shadowRoot)||c.appendChild(u),this._isSVGLoadingIconOverriden=!0}}},{key:"assignHandlers",value:function(e){this._serviceIO.completionsHandlers={onFinish:this.resetSubmit.bind(this,e)},this._serviceIO.streamHandlers={onOpen:this.changeToStopIcon.bind(this),onClose:this.resetSubmit.bind(this,e),abortStream:this._abortStream,stopClicked:this._stopClicked};var t=this._serviceIO.stream;"object"==w(t)&&"number"==typeof t.simulation&&(this._serviceIO.streamHandlers.simulationInterim=t.simulation)}},{key:"setUpSpeechToText",value:function(e,t){this._microphoneButton=e,this._stopSTTAfterSubmit="object"==w(t)&&t.stopAfterSubmit}},{key:"resetSubmit",value:function(e){this.status.requestInProgress=!1,this.status.loadingActive=!1,e()}},{key:"submitFromInput",value:(a=f(h().mark((function e(){var t,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fileAttachments.completePlaceholders();case 2:t=this._fileAttachments.getAllFileData(),this._textInput.isTextInputEmpty()?this.attemptSubmit({text:"",files:t}):(n=this._textInput.inputElementRef.innerText.trim(),this.attemptSubmit({text:n,files:t}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"programmaticSubmit",value:(s=f(h().mark((function e(t){var n,i=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"string"==typeof t&&(t=ee.processSubmitUserMessage(t)),n={text:t.text},t.files&&(n.files=Array.from(t.files).map((function(e){return{file:e,type:Lr.getTypeFromBlob(e)}}))),setTimeout((function(){return i.attemptSubmit(n,!0)}));case 3:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})},{key:"attemptSubmit",value:(i=f(h().mark((function e(t){var n,i,s,r,o,a,l=arguments;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]&&l[1],e.next=3,null==(i=this._validationHandler)?void 0:i.call(this,n?t:void 0);case 3:if(e.t0=e.sent,e.t1=!1,e.t0!==e.t1){e.next=7;break}return e.abrupt("return");case 7:return this.changeToLoadingIcon(),e.next=10,this.addNewMessage(t);case 10:return this._serviceIO.isWebModel()||this._messages.addLoadingMessage(),this._textInput.clear(),o=null==(s=t.files)?void 0:s.map((function(e){return e.file})),a={text:""===t.text?void 0:t.text,files:o},e.next=15,this._serviceIO.callAPI(a,this._messages);case 15:null==(r=this._fileAttachments)||r.removeAllFiles();case 16:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"addNewMessage",value:(n=f(h().mark((function e(t){var n,i,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.text,i=t.files,s={role:Wt.USER_ROLE},n&&(s.text=n),e.t0=i,!e.t0){e.next=8;break}return e.next=7,this._messages.addMultipleFiles(i);case 7:s.files=e.sent;case 8:this._serviceIO.sessionId&&(s._sessionId=this._serviceIO.sessionId),Object.keys(s).length>0&&this._messages.addNewMessage(s);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"stopStream",value:function(){var e;this._abortStream.abort(),null==(e=this._stopClicked)||e.listener(),this._validationHandler&&this.resetSubmit(this._validationHandler)}},{key:"changeToStopIcon",value:function(){this._serviceIO.websocket||(this.elementRef.classList.remove(t.LOADING_CLASS,t.DISABLED_CLASS,t.SUBMIT_CLASS),ss.removeAriaAttributes(this.elementRef),this.elementRef.replaceChildren(this._innerElements.stop),this.reapplyStateStyle("stop",["loading","submit"]),this.elementRef.onclick=this.stopStream.bind(this),this.status.loadingActive=!1)}},{key:"changeToLoadingIcon",value:function(){this._serviceIO.websocket||(this._isSVGLoadingIconOverriden||this.elementRef.replaceChildren(this._innerElements.loading),this.elementRef.classList.remove(t.SUBMIT_CLASS,t.DISABLED_CLASS),ss.removeAriaDisabled(this.elementRef),this.elementRef.classList.add(t.LOADING_CLASS),ss.addAriaBusy(this.elementRef),this.reapplyStateStyle("loading",["submit"]),this.elementRef.onclick=function(){},this.status.requestInProgress=!0,this.status.loadingActive=!0)}},{key:"changeToSubmitIcon",value:function(){var e=this;this.elementRef.classList.contains(t.SUBMIT_CLASS)||(this.elementRef.classList.remove(t.LOADING_CLASS,t.DISABLED_CLASS),ss.removeAriaAttributes(this.elementRef),this.elementRef.classList.add(t.SUBMIT_CLASS),this.elementRef.replaceChildren(this._innerElements.submit),Kr.resetSubmit(this,this.status.loadingActive),this.elementRef.onclick=function(){var t;e.submitFromInput(),null!=(t=e._microphoneButton)&&t.isActive&&Or.toggleSpeechAfterSubmit(e._microphoneButton.elementRef,!!e._stopSTTAfterSubmit)})}},{key:"changeToDisabledIcon",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._alwaysEnabled&&!e?this.changeToSubmitIcon():this.elementRef.classList.contains(t.DISABLED_CLASS)||(this.elementRef.classList.remove(t.LOADING_CLASS,t.SUBMIT_CLASS),ss.removeAriaBusy(this.elementRef),this.elementRef.classList.add(t.DISABLED_CLASS),ss.addAriaDisabled(this.elementRef),this.elementRef.replaceChildren(this._innerElements.disabled),this.reapplyStateStyle("disabled",["submit"]),this.elementRef.onclick=function(){})}},{key:"disableSubmitButton",value:function(e,t){var n;e.isSubmitProgrammaticallyDisabled=!1!==t,!this.status.requestInProgress&&!this.status.loadingActive&&(!1===t?null==(n=this._validationHandler)||n.call(this):this.changeToDisabledIcon(!0))}}],[{key:"createButtonContainerElement",value:function(){var e=document.createElement("div");return e.classList.add("input-button"),ss.addAttributes(e),e}},{key:"createSubmitIconElement",value:function(){var e=wn.createSVGElement('<?xml version="1.0" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" stroke="currentColor" fill="none" stroke-width="1" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">\n  <line x1="22" y1="2" x2="11" y2="14"></line>\n  <polygon points="22 2 15 22 11 14 2 10 22 2"></polygon>\n</svg>\n');return e.id="submit-icon",e}},{key:"createLoadingIconElement",value:function(){var e=document.createElement("div");return e.classList.add("loading-submit-button"),e}},{key:"createStopIconElement",value:function(){var e=document.createElement("div");return e.id="stop-icon",e}}]);var n,i,s,a}(Xi);Jr.SUBMIT_CLASS="submit-button",Jr.LOADING_CLASS="loading-button",Jr.DISABLED_CLASS="disabled-button";var Yr=Jr,Zr=function(e){function t(e,n,i,s){var o;k(this,t),(o=r(this,t,[e,["modal-content","modal-camera-content"],i]))._stopped=!1,o._format="image/png",o._canvas=document.createElement("canvas"),o._canvas.classList.add("camera-modal-canvas");var a=o.addButtonsAndTheirEvents(n),l=a.captureButton,c=a.submitButton;return o._captureButton=l,o._submitButton=c,o._captureIcon=o._captureButton.children[0],o._refreshIcon=wn.createSVGElement('<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">\n  <path d="M27.1 14.313V5.396L24.158 8.34c-2.33-2.325-5.033-3.503-8.11-3.503C9.902 4.837 4.901 9.847 4.899 16c.001 6.152 5.003 11.158 11.15 11.16 4.276 0 9.369-2.227 10.836-8.478l.028-.122h-3.23l-.022.068c-1.078 3.242-4.138 5.421-7.613 5.421a8 8 0 0 1-5.691-2.359A7.993 7.993 0 0 1 8 16.001c0-4.438 3.611-8.049 8.05-8.049 2.069 0 3.638.58 5.924 2.573l-3.792 3.789H27.1z"/>\n</svg>\n'),o._refreshIcon.classList.add("modal-svg-button-icon","modal-svg-refresh-icon"),"jpeg"===(null==s?void 0:s.format)&&(o._format="image/jpeg"),null!=s&&s.dimensions&&(o._dimensions=s.dimensions),o._contentRef.appendChild(o._canvas),o.extensionCloseCallback=o.stop,o}return c(t,e),S(t,[{key:"addButtonsAndTheirEvents",value:function(e){var t=Ur.createSVGButton('<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  <title>capture</title>\n  <path d="M0 16q0 3.264 1.28 6.208t3.392 5.12 5.12 3.424 6.208 1.248 6.208-1.248 5.12-3.424 3.392-5.12 1.28-6.208-1.28-6.208-3.392-5.12-5.088-3.392-6.24-1.28q-3.264 0-6.208 1.28t-5.12 3.392-3.392 5.12-1.28 6.208zM4 16q0-3.264 1.6-6.016t4.384-4.352 6.016-1.632 6.016 1.632 4.384 4.352 1.6 6.016-1.6 6.048-4.384 4.352-6.016 1.6-6.016-1.6-4.384-4.352-1.6-6.048z"></path>\n</svg>\n');t.classList.add("modal-svg-camera-button"),t.children[0].classList.add("modal-svg-camera-icon");var n=this.addCloseButton('<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">\n  <path d="M195.2 195.2a64 64 0 0 1 90.496 0L512 421.504 738.304 195.2a64 64 0 0 1 90.496 90.496L602.496 512 828.8 738.304a64 64 0 0 1-90.496 90.496L512 602.496 285.696 828.8a64 64 0 0 1-90.496-90.496L421.504 512 195.2 285.696a64 64 0 0 1 0-90.496z"/>\n</svg>',!0);n.classList.add("modal-svg-close-button"),n.children[0].classList.add("modal-svg-close-icon");var i=Ur.createSVGButton('<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.89163 13.2687L9.16582 17.5427L18.7085 8" stroke="#000000" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>');return i.classList.add("modal-svg-submit-button"),this.addButtons(t,i),this.addButtonEvents(t,n,i,e),{captureButton:t,submitButton:i}}},{key:"addButtonEvents",value:function(e,t,n,i){var s=this;e.onclick=function(){s.capture()},t.addEventListener("click",this.stop.bind(this)),n.onclick=function(){var e=s.getFile();e&&Br.addFilesToType([e],[i]),s.stop(),s.close()}}},{key:"stop",value:function(){var e=this;this._mediaStream&&this._mediaStream.getTracks().forEach((function(e){return e.stop()})),this._stopped=!0,setTimeout((function(){e._captureButton.replaceChildren(e._captureIcon),e._captureButton.classList.replace("modal-svg-refresh-button","modal-svg-camera-button");var t=e._canvas.getContext("2d");null==t||t.clearRect(0,0,e._canvas.width,e._canvas.height)}),Ur.MODAL_CLOSE_TIMEOUT_MS)}},{key:"start",value:function(){var e=this;this._dataURL=void 0,this._submitButton.classList.add("modal-svg-submit-disabled"),this._stopped=!1,navigator.mediaDevices.getUserMedia({video:this._dimensions||!0}).then((function(t){if(e._mediaStream=t,!e.isOpen())return e.stop();var n=document.createElement("video");n.srcObject=t,n.play(),requestAnimationFrame(e.updateCanvas.bind(e,n,e._canvas))})).catch((function(t){console.error(t),e.stop(),e.close()}))}},{key:"capture",value:function(){this._dataURL?(this._captureButton.replaceChildren(this._captureIcon),this._captureButton.classList.replace("modal-svg-refresh-button","modal-svg-camera-button"),this._submitButton.classList.add("modal-svg-submit-disabled"),this._dataURL=void 0):(this._captureButton.replaceChildren(this._refreshIcon),this._captureButton.classList.replace("modal-svg-camera-button","modal-svg-refresh-button"),this._submitButton.classList.remove("modal-svg-submit-disabled"),this._dataURL=this._canvas.toDataURL())}},{key:"getFile",value:function(){if(this._dataURL){for(var e=atob(this._dataURL.split(",")[1]),t=new Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);var i=new Uint8Array(t),s=new Blob([i],{type:this._format}),r="image/jpeg"===this._format?"jpeg":"png",o=Hr.getFileName(this._newFilePrefix||"photo",r);return new File([s],o,{type:s.type})}}},{key:"updateCanvas",value:function(e,t){if(!this._stopped){if(!this._dataURL){t.width=e.videoWidth,t.height=e.videoHeight;var n=t.getContext("2d");null==n||n.drawImage(e,0,0,t.width,t.height)}requestAnimationFrame(this.updateCanvas.bind(this,e,t))}}},{key:"openCameraModal",value:function(e){this.displayModalElements(),e.start()}}],[{key:"createCameraModalFunc",value:function(e,n,i,s){var r=new t(e,n,i,s);return r.openCameraModal.bind(r,r)}}])}(Ur),Xr=function(e){function t(e,n,i){var s,o,a,l,c;k(this,t);var u=null==(o=null==i?void 0:i.button)?void 0:o.position,d=(null==(c=null==(l=null==(a=null==i?void 0:i.button)?void 0:a.styles)?void 0:l.text)?void 0:c.content)||"Photo",h=(s=r(this,t,[t.createButtonElement(),u,(null==i?void 0:i.button)||{},d])).createInnerElements(s._customStyles,"dropup-menu"===u);return i&&s.addClickEvent(e,n,i.modalContainerStyle,i.files),s.elementRef.classList.add("upload-file-button"),s.elementRef.appendChild(h.styles),s.reapplyStateStyle("styles"),s}return c(t,e),S(t,[{key:"createInnerElements",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{styles:Yi.createInnerElement(this.elementRef,t.createSVGIconElement(),"styles",e,n)}}},{key:"addClickEvent",value:function(e,t,n,i){var s=Zr.createCameraModalFunc(e,t,n,i);this.elementRef.onclick=s}}],[{key:"createButtonElement",value:function(){var e=document.createElement("div");return e.classList.add("input-button"),ss.addAttributes(e),e}},{key:"createSVGIconElement",value:function(){var e=wn.createSVGElement('<?xml version="1.0" encoding="utf-8"?>\n<svg viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  <path d="M29 7h-4.599l-2.401-4h-12l-2.4 4h-4.6c-1 0-3 1-3 2.969v16.031c0 1.657 1.5 3 2.792 3h26.271c1.313 0 2.938-1.406 2.938-2.968v-16.032c0-1-1-3-3-3zM30 26.032c0 0.395-0.639 0.947-0.937 0.969h-26.265c-0.232-0.019-0.797-0.47-0.797-1v-16.031c0-0.634 0.851-0.953 1-0.969h5.732l2.4-4h9.802l1.785 3.030 0.55 0.97h5.731c0.705 0 0.99 0.921 1 1v16.032zM16 10c-3.866 0-7 3.134-7 7s3.134 7 7 7 7-3.134 7-7-3.134-7-7-7zM16 22c-2.757 0-5-2.243-5-5s2.243-5 5-5 5 2.243 5 5-2.243 5-5 5z"></path>\n</svg>');return e.id="camera-icon",e}}])}(Xi),$r=function(){function e(t,n,i,s){k(this,e),this.elementRef=e.createPanelElement(t.inputAreaStyle);var r={},o=this.createFileUploadComponents(t,i,s,r),a=new U(t,i,o);t.speechToText&&!r.microphone&&(r.microphone={button:new Or(t,a,n.addNewErrorMessage.bind(n))});var l=new Yr(t,a,n,i,o,r);a.submit=l.submitFromInput.bind(l),Vr.attach(t,i,a,o,l),t.submitUserMessage=l.programmaticSubmit.bind(l),r.submit={button:l},e.addElements(this.elementRef,a,r,s,o,t.dropupStyles)}return S(e,[{key:"createFileUploadComponents",value:function(t,n,i,s){var r,o,a,l,c=new Br(this.elementRef,t.attachmentContainerStyle,n.demo);if(e.createUploadButtons(t,n.fileTypes||{},c,i,s),null!=(r=n.camera)&&r.files){var u=(null==(o=s.images)?void 0:o.fileType)||c.addType(t,n.camera.files,"images");s.camera={button:new Xr(i,u,n.camera)}}if(null!=(a=n.recordAudio)&&a.files){var d=(null==(l=s.audio)?void 0:l.fileType)||c.addType(t,n.recordAudio.files,"audio");s.microphone={button:new Gr(d,n.recordAudio)}}return qr.isEnabled(c,t.dragAndDrop)&&qr.create(i,c,t.dragAndDrop),c}}],[{key:"createPanelElement",value:function(e){var t=document.createElement("div");return t.id="input",Object.assign(t.style,e),t}},{key:"createUploadButtons",value:function(e,t,n,i,s){Object.keys(t).forEach((function(r){var o=r,a=t[o];if(a.files){var l=n.addType(e,a.files,o),c=is[o],u=c.id,d=c.svgString,h=c.dropupText,p=new jr(i,l,a,u,d,h);s[o]={button:p,fileType:l}}}))}},{key:"addElements",value:function(e,t,n,i,s,r){K.addElements(e,t.elementRef);var o=Ki.create(),a=ns.addButtons(o,n,i,r);Wi.set(t.inputElementRef,o,s.elementRef,a),Ki.add(e,o)}}])}(),Qr=function(){function e(){k(this,e)}return S(e,null,[{key:"createElements",value:function(e,t,n){var i=document.createElement("div");i.id="chat-view";var s=new Hi(e,t,n);t.websocket&&cn.createConnection(t,s);var r=new $r(e,s,t,i);return K.addElements(i,s.elementRef,r.elementRef),i}},{key:"render",value:function(t,n,i,s){var r=e.createElements(t,i,s);n.replaceChildren(r)}}])}(),eo=Object.defineProperty,to=function(e,t,n,i){for(var s,r=void 0,o=e.length-1;o>=0;o--)(s=e[o])&&(r=s(t,n,r)||r);return r&&eo(t,n,r),r},no=function(e){function t(){var e;return k(this,t),(e=r(this,t)).getMessages=function(){return[]},e.submitUserMessage=function(){return console.warn("submitUserMessage failed - please wait for chat view to render before calling this property.")},e.addMessage=function(){return console.warn("addMessage failed - please wait for chat view to render before calling this property.")},e.updateMessage=function(){},e.clearMessages=function(){},e.focusInput=function(){return j.focusFromParentElement(e._elementRef)},e.refreshMessages=function(){},e.scrollToBottom=function(){},e.disableSubmitButton=function(){},e.setPlaceholderText=function(){},e._hasBeenRendered=!1,e._auxiliaryStyleApplied=!1,e._elementRef=document.createElement("div"),e._elementRef.id="container",e.attachShadow({mode:"open"}).appendChild(e._elementRef),L.apply('#validate-property-key-view{height:100%;position:relative;display:flex;justify-content:center;align-items:center;padding:8px}#loading-validate-key-property{display:inline-block;width:50px;height:50px}#loading-validate-key-property:after{content:" ";display:block;width:38px;height:38px;margin:1px;border-radius:50%;border:5px solid #5fb2ff;border-color:#5fb2ff transparent #5fb2ff transparent;animation:loading-spinner 1.4s linear infinite}#insert-key-view{height:100%;position:relative}#insert-key-contents{text-align:center;position:absolute;top:44%;left:50%;transform:translate(-50%,-50%);width:82%;display:flex;max-width:700px}#insert-key-title{margin-bottom:15px}#insert-key-input-container{margin-right:2.7em;width:calc(100% - 80px)}#insert-key-input{padding:.3em 1.7em .3em .3em;border-width:1px;border-style:solid;border-radius:3px;width:100%;font-size:inherit}.insert-key-input-valid{border-color:gray}.insert-key-input-invalid{border-color:red}#visibility-icon-container{position:relative;float:right;cursor:pointer;-webkit-user-select:none;user-select:none}.visibility-icon{filter:brightness(0) saturate(100%) invert(63%) sepia(1%) saturate(9%) hue-rotate(43deg) brightness(98%) contrast(92%);position:absolute;right:-1.7em;top:-1.43em}#visible-icon{top:-1.4em}.visibility-icon:hover{filter:unset}.visibility-icon>*{pointer-events:none}#start-button{border:1px solid grey;color:#454545;border-radius:4px;width:3em;display:flex;justify-content:center;align-items:center;cursor:pointer;padding:.28em .3em;-webkit-user-select:none;user-select:none;background-color:#fff}#start-button:hover{background-color:#f2f2f2}#start-button:active{background-color:#d2d2d2}#insert-key-help-text-container{width:100%;position:absolute;margin-top:32px;margin-bottom:20px}#insert-key-help-text-contents{width:100%;position:absolute}#insert-key-input-invalid-text{display:block;margin-top:1em;margin-bottom:.5em;color:red}.insert-key-input-help-text{display:block;margin-top:16px}#loading-key{display:inline-block;width:16px;height:16px}#loading-key:after{content:" ";display:block;width:11px;height:11px;margin:1px;border-radius:50%;border:2px solid #0084ff;border-color:#0084ff transparent #0084ff transparent;animation:loading-spinner 1.2s linear infinite}#error-view{color:red;font-size:1.2em;line-height:1.3em;margin-top:-5px;text-align:center;height:100%;display:flex;justify-content:center;align-items:center;padding-left:8px;padding-right:8px}@keyframes loading-spinner{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.intro-panel{position:absolute;display:flex;justify-content:center;right:0;bottom:0;left:0;margin:auto;height:fit-content;top:-2.5em}#internal-intro-panel{width:250px;height:min-content;display:block;border-radius:5px;overflow:auto;border:1px solid rgb(203,203,203);padding:10px;max-height:calc(100% - 6.8em)}#internal-intro-panel>p{margin-block-start:.8em;margin-block-end:.8em}pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}/*!\n  Theme: a11y-dark\n  Author: @ericwbailey\n  Maintainer: @ericwbailey\n\n  Based on the Tomorrow Night Eighties theme: https://github.com/isagalaev/highlight.js/blob/master/src/styles/tomorrow-night-eighties.css\n*/.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast: active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}#messages{overflow:auto}.outer-message-container:last-child{margin-bottom:5px}.inner-message-container{display:flex;margin-left:auto;margin-right:auto;width:calc(97.5% - 24px);max-width:100%}.message-bubble{margin-top:10px;word-wrap:break-word;width:fit-content;max-width:60%;border-radius:10px;padding:.42em .55em;height:fit-content;line-height:1.26em}.user-message-text{color:#fff;background-color:#0084ff;margin-right:0;margin-left:auto}.ai-message-text{color:#000;background-color:#e4e6eb;margin-left:0;margin-right:auto}.loading-history-message-full-view{position:absolute;height:70%;width:100%;display:flex;align-items:center}.loading-history-message-small{height:20px;margin-bottom:30px}.loading-history-message-small>div>div{scale:.6}.loading-history-message{margin-top:0;width:100%;max-width:100%;display:flex;justify-content:center;background-color:unset}.loading-history{width:70px}.loading-history div{position:absolute;width:var(--loading-history-width);height:var(--loading-history-height);margin:var(--loading-history-margin);border:var(--loading-history-border);border-radius:50%;animation:loading-spinner 1.2s cubic-bezier(.5,0,.5,1) infinite;border-color:var(--loading-history-color) transparent transparent transparent}.loading-history div:nth-child(1){animation-delay:-.45s}.loading-history div:nth-child(2){animation-delay:-.3s}.loading-history div:nth-child(3){animation-delay:-.15s}.html-message{max-width:unset}.error-message-text{margin:14px auto 10px;background-color:#f4c0c0;color:#474747;text-align:center;max-width:95%}.deep-chat-loading-message-dots-container{width:1em;padding:.6em .75em .6em 1.3em}.loading-message-dots{position:relative;width:.45em;height:.45em;border-radius:5px;background-color:var(--loading-message-color);color:var(--loading-message-color);animation:loading-message-dots 1s infinite linear alternate;animation-delay:.5s}.loading-message-dots:before,.loading-message-dots:after{content:"";display:inline-block;position:absolute;top:0}.loading-message-dots:before{left:-.7em;width:.45em;height:.45em;border-radius:5px;background-color:var(--loading-message-color);color:var(--loading-message-color);animation:loading-message-dots 1s infinite alternate;animation-delay:0s}.loading-message-dots:after{left:.7em;width:.45em;height:.45em;border-radius:5px;background-color:var(--loading-message-color);color:var(--loading-message-color);animation:loading-message-dots 1s infinite alternate;animation-delay:1s}@keyframes loading-message-dots{0%{background-color:var(--loading-message-color)}50%,to{background-color:var(--loading-message-color-fade)}}.message-bubble>p:first-child{margin-top:0}.message-bubble>p:last-child{margin-bottom:0}pre{overflow:auto;display:block;word-break:break-all;word-wrap:break-word;border-radius:7px;background:#2b2b2b;color:#f8f8f2;margin-top:.8em;margin-bottom:.8em;padding:.6em;font-size:.9em;line-height:1.5em}.image-message{padding:0;display:flex;background-color:#ddd}.image-message>*,.image-message>*>*{width:100%;border-radius:8px;display:flex}.audio-message{width:60%;max-width:300px;height:2.2em;max-height:54px;padding:0;background-color:unset}.audio-player{width:100%;height:100%}.audio-player-safari{height:fit-content;width:40px}.audio-player-safari-left{float:left}.audio-player-safari-right{float:right}.any-file-message{padding:1px}.any-file-message-contents{display:flex}.any-file-message-icon-container{width:1.3em;min-width:1.3em;position:relative;border-radius:4px;margin-left:6px;margin-right:2px}.any-file-message-icon{background-color:#fff;border-radius:4px;position:absolute;width:1em;height:1.25em;padding:1px;margin-top:auto;margin-bottom:auto;top:0;bottom:0}.any-file-message-text{padding-top:5px;overflow-wrap:anywhere;padding-bottom:5px;padding-right:7px}.message-bubble>a{color:inherit}.left-item-position{margin-right:10px}.right-item-position{margin-left:10px}.avatar{padding-top:5px;width:1.5em;height:1.5em;border-radius:1px}.avatar-container{margin-top:9px}.name{margin-top:16px;font-size:15px}#drag-and-drop{position:absolute;display:none;z-index:10;height:calc(100% - 10px);width:calc(100% - 10px);background-color:#70c6ff4d;border:5px dashed #6dafff}#file-attachment-container{position:absolute;height:3.6em;width:calc(80% - 4px);top:-2.5em;border-radius:5px;overflow:auto;text-align:left;background-color:#d7d7d73b;padding-left:4px}.file-attachment{width:2.85em;height:2.85em;display:inline-flex;margin-right:.6em;margin-bottom:.44em;margin-top:4px;position:relative;background-color:#fff;border-radius:5px}.image-attachment{width:100%;height:100%;object-fit:cover;border-radius:5px}.border-bound-attachment{width:calc(100% - 2px);height:calc(100% - 2px);border:1px solid #c3c3c3;border-radius:5px;overflow:hidden}.border-bound-attachment-safari{width:calc(100% - 1px);height:calc(100% - 1px)}.audio-attachment-icon-container{cursor:pointer}.audio-attachment-icon-container:hover{background-color:#f8f8f8}.attachment-icon{left:0;right:0;bottom:0;top:2px;margin:auto;position:absolute;width:25px;-webkit-user-select:none;user-select:none}.not-removable-attachment-icon{top:0;right:0;bottom:0;left:0}.play-icon{filter:brightness(0) saturate(100%) invert(17%) sepia(0%) saturate(1392%) hue-rotate(67deg) brightness(98%) contrast(97%)}.stop-icon{filter:brightness(0) saturate(100%) invert(29%) sepia(90%) saturate(1228%) hue-rotate(198deg) brightness(93%) contrast(98%)}.audio-placeholder-text-3-digits{padding-left:.26rem}.audio-placeholder-text-4-digits{padding-left:.1rem}.any-file-attachment{padding:2px 0}.file-attachment-text-container{position:absolute;width:inherit;display:flex;align-items:center;height:100%;top:-1px}.audio-placeholder-text-3-digits-container{padding-top:1px;cursor:default}.any-file-attachment-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;padding-left:.13em;margin-left:auto;margin-right:auto}.remove-file-attachment-button{height:1.25em;width:1.25em;border:1px solid #cfcfcf;border-radius:25px;background-color:#fff;top:-4px;right:-5px;position:absolute;display:flex;justify-content:center;cursor:pointer;-webkit-user-select:none;user-select:none}.remove-file-attachment-button:hover{background-color:#e4e4e4}.remove-file-attachment-button:active{background-color:#d7d7d7}.x-icon{color:#4e4e4e;top:-.075em;position:relative;font-size:1.05em}.modal{display:none;flex-direction:column;align-items:center;justify-content:center;position:absolute;width:80%;max-width:420px;max-height:80%;margin:auto;top:0;right:0;bottom:0;left:0;z-index:2}.modal-content{border-top:1px solid rgb(217,217,217);border-left:1px solid rgb(217,217,217);border-right:1px solid rgb(217,217,217);border-top-left-radius:inherit;border-top-right-radius:inherit;background-color:#fff;overflow-y:auto;height:fit-content;max-height:calc(100% - 3.3em);width:100%}.modal-content>p{margin-left:1em;margin-right:1em}.modal-content>ul{margin-right:1em}.modal-button-panel{height:3.3em;border:1px solid;border-color:rgb(223,223,223) rgb(217,217,217) rgb(217,217,217);border-bottom-left-radius:inherit;border-bottom-right-radius:inherit;background-color:#fff;text-align:center;justify-content:center;display:flex;width:100%}.modal-button{min-width:2.5em;text-align:center;color:#fff;border-radius:5px;padding:.4em .4em .3em;height:1.25em;background-color:#3279b2;top:0;bottom:0;cursor:pointer;-webkit-user-select:none;user-select:none;margin:auto .31em}.modal-button:hover{background-color:#276da7}.modal-button:active{background-color:#1b5687}.modal-svg-button{padding:0 0 2px;width:2em;height:1.8em}.modal-svg-button-icon{width:100%;height:100%;filter:brightness(0) saturate(100%) invert(100%) sepia(15%) saturate(4%) hue-rotate(346deg) brightness(101%) contrast(102%)}#modal-background-panel{position:absolute;width:100%;height:100%;background-color:#00000042;z-index:1;display:none}.show-modal-background{animation:fadeInBackground .3s ease-in-out}@keyframes fadeInBackground{0%{opacity:0}to{opacity:1}}.show-modal{animation:fadeInModal .3s ease-in-out}@keyframes fadeInModal{0%{opacity:0;scale:.95}to{opacity:1;scale:1}}.hide-modal-background{animation:fadeOutBackground .2s ease-in-out}@keyframes fadeOutBackground{0%{opacity:1}to{opacity:0}}.hide-modal{animation:fadeOutModal .2s ease-in-out}@keyframes fadeOutModal{0%{opacity:1;scale:1}to{opacity:0;scale:.95}}.modal-camera-content{overflow:hidden;text-align:center;border:unset;height:100%;background-color:#2a2a2a;display:flex;justify-content:center}.camera-modal-canvas{max-width:100%;max-height:100%;margin-top:auto;margin-bottom:auto}.modal-svg-submit-button{background-color:green}.modal-svg-submit-button:hover{background-color:#007500}.modal-svg-submit-button:active{background-color:#006500}.modal-svg-submit-disabled{pointer-events:none;background-color:#747474}.modal-svg-close-button{height:1.56em;padding-top:.37em;padding-bottom:0;background-color:#c13e3e}.modal-svg-close-button:hover{background-color:#b43434}.modal-svg-close-button:active{background-color:#972929}.modal-svg-close-icon{width:80%;height:80%}.modal-svg-camera-button{height:1.6em;padding-top:.38em;padding-bottom:0}.modal-svg-camera-icon{height:76%}.modal-svg-refresh-icon{height:105%}.modal-svg-refresh-button{height:1.66em;padding-top:.11em;padding-bottom:.21em}.input-button-container{position:relative;z-index:1}.inside-right{position:absolute;right:calc(10% + .35em);bottom:.85em}.inside-left{position:absolute;left:calc(10% + .35em);bottom:.85em}.outside-left{position:absolute;right:calc(11px - .55em);bottom:.88em}.outside-right{position:absolute;left:calc(11px - .55em);bottom:.88em}#upload-images-icon{position:absolute;pointer-events:none;width:1.45em;height:1.45em;left:.11em;bottom:.08em;filter:brightness(0) saturate(100%) invert(43%) sepia(0%) saturate(740%) hue-rotate(77deg) brightness(99%) contrast(92%)}#upload-gifs-icon{position:absolute;pointer-events:none;width:1.5em;height:1.48em;left:.07em;bottom:.08em;filter:brightness(0) saturate(100%) invert(49%) sepia(0%) saturate(2586%) hue-rotate(12deg) brightness(93%) contrast(90%)}#upload-audio-icon{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.17em;bottom:.2em;filter:brightness(0) saturate(100%) invert(15%) sepia(0%) saturate(337%) hue-rotate(125deg) brightness(91%) contrast(94%);transform:scaleX(.95)}#camera-icon{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.23em;bottom:.2em;filter:brightness(0) saturate(100%) invert(52%) sepia(0%) saturate(161%) hue-rotate(164deg) brightness(91%) contrast(92%);transform:scaleX(.95)}#upload-mixed-files-icon{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.25em;bottom:.2em;filter:brightness(0) saturate(100%) invert(53%) sepia(0%) saturate(36%) hue-rotate(74deg) brightness(98%) contrast(93%);transform:scaleX(.95)}#interim-text{color:gray}#microphone-button{padding-top:.5px}.outer-button-container>#microphone-button{padding-bottom:1px}#microphone-icon{position:absolute;pointer-events:none;width:1.21em;height:1.21em;left:.25em;bottom:.25em}.default-microphone-icon{filter:brightness(0) saturate(100%) invert(32%) sepia(0%) saturate(924%) hue-rotate(46deg) brightness(95%) contrast(99%)}.active-microphone-icon{filter:brightness(0) saturate(100%) invert(10%) sepia(97%) saturate(7495%) hue-rotate(0deg) brightness(101%) contrast(107%);border-radius:10px}.command-microphone-icon{filter:brightness(0) saturate(100%) invert(42%) sepia(96%) saturate(1067%) hue-rotate(77deg) brightness(99%) contrast(102%)}.unsupported-microphone{display:none}#submit-icon{height:100%;filter:brightness(0) saturate(100%) invert(32%) sepia(0%) saturate(924%) hue-rotate(46deg) brightness(95%) contrast(99%);width:1.21em}#stop-icon{background-color:#acacac;position:absolute;width:.95em;height:.95em;left:.35em;bottom:.35em;border-radius:2px}.submit-button-enlarged{scale:1.1;margin-right:.3em;margin-left:.3em}.loading-submit-button{position:relative;left:calc(-9990px + .275em);width:.22em;height:.22em;border-radius:5px;background-color:#848484;color:#848484;box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484;animation:loading-submit-button 1.5s infinite linear;bottom:-.75em}@keyframes loading-submit-button{0%{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}16.667%{box-shadow:9990px -6px #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}33.333%{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}50%{box-shadow:9990px 0 #848484,calc(9990px + .44em) -6px 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}66.667%{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}83.333%{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) -6px 0 0 #848484}to{box-shadow:9990px 0 #848484,calc(9990px + .44em) 0 0 0 #848484,calc(9990px + .8em) 0 0 0 #848484}}.input-button{border-radius:4px;cursor:pointer;margin-bottom:.2em;-webkit-user-select:none;user-select:none}.input-button-svg{width:1.65em;height:1.65em}.input-button:hover,.input-button:focus-visible{background-color:#9c9c9c2e}.input-button:active{background-color:#9c9c9c5e}.loading-button{cursor:auto}.loading-button:hover{background-color:unset}.text-button{filter:unset!important;display:flex;justify-content:center;align-items:center;margin-left:4px;margin-right:4px;height:1.6em}#text-input-container{background-color:#fff;width:80%;display:flex;border:1px solid #0000001a;border-radius:5px;margin-top:.8em;margin-bottom:.8em;box-shadow:#959da533 0 1px 12px;overflow-y:auto;max-height:200px;position:relative}.text-input-container-left-adjustment{margin-left:1.5em}.text-input-container-right-adjustment{margin-right:1.5em}.text-input-container-left-small-adjustment{margin-left:1.1em}.text-input-container-left-small-adjustment>.outside-left{right:calc(14px - .55em)}.text-input-container-right-small-adjustment{margin-right:1.1em}.text-input-container-right-small-adjustment>.outside-right{left:calc(14px - .55em)}#text-input{text-align:left;outline:none;word-wrap:break-word;line-break:auto}.text-input-styling{padding:.4em .5em;overflow:overlay;width:100%}.text-input-inner-left-adjustment{padding-left:2.2em}.text-input-inner-right-adjustment{padding-right:2em}.text-input-disabled{pointer-events:none;-webkit-user-select:none;user-select:none}[contenteditable]:empty:before{content:attr(deep-chat-placeholder-text);pointer-events:none}[contenteditable][textcolor]:empty:before{color:gray}.outside-right>#dropup-menu,.inside-right>#dropup-menu{right:0}#dropup-icon{position:absolute;pointer-events:none;width:1.16em;height:1.2em;left:.265em;bottom:.43em;filter:brightness(0) saturate(100%) invert(54%) sepia(0%) saturate(724%) hue-rotate(6deg) brightness(92%) contrast(90%)}#dropup-menu{background-color:#fff;position:absolute;transform:translateY(-100%);border-radius:5px;z-index:1;top:-.49em;box-shadow:#0003 -1px 2px 10px,#0000001a 0 2px 4px;cursor:pointer;-webkit-user-select:none;user-select:none}.dropup-menu-item{height:1.4em;padding:.28em .84em .28em .35em;display:flex;position:relative}.dropup-menu-item:first-child{padding-top:.49em;border-top-left-radius:inherit;border-top-right-radius:inherit}.dropup-menu-item:last-child{padding-bottom:.45em;border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.dropup-menu-item-icon{width:1.39em;position:relative;margin-right:.56em}.dropup-menu-item-icon>svg{bottom:0!important;top:0!important;margin-bottom:auto;margin-top:auto}.dropup-menu-item-text{margin-top:.08em;width:max-content}#input{width:100%;display:inline-flex;text-align:center;margin-left:auto;margin-right:auto;margin-top:auto;position:relative;justify-content:center}#chat-view{height:100%;display:grid;grid-template-columns:100%}::-webkit-scrollbar{width:9px;height:9px}::-webkit-scrollbar-thumb{background-color:#d0d0d0;border-radius:5px}::-webkit-scrollbar-track{background-color:#f2f2f2}.deep-chat-web-model-button{margin-top:10px;margin-bottom:5px;margin-left:1px}:host{all:initial;display:table-cell}#container{height:inherit;width:inherit;overflow:hidden}',e.shadowRoot),setTimeout((function(){e._hasBeenRendered||e.onRender()}),20),e}return c(t,e),S(t,[{key:"changeToChatView",value:function(){this._activeService&&(this._activeService.validateKeyProperty=!1),this.onRender()}},{key:"onRender",value:function(){var e;I.attemptAppendStyleSheetToHead(this.style),ee.processConnect(this),(!this._activeService||this._activeService.demo)&&(this._activeService=Di.create(this)),this.auxiliaryStyle&&!this._auxiliaryStyleApplied&&(L.apply(this.auxiliaryStyle,this.shadowRoot),this._auxiliaryStyleApplied=!0),L.applyDefaultStyleToComponent(this.style,this.chatStyle),ee.checkForContainerStyles(this,this._elementRef),this._activeService.key&&this._activeService.validateKeyProperty?T.render(this._elementRef,this.changeToChatView.bind(this),this._activeService):this._activeService instanceof gn&&!this._activeService.key?this._activeService instanceof gn&&Sn.render(this._elementRef,this.changeToChatView.bind(this),this._activeService):(null!==(e=this._childElement)&&void 0!==e||(this._childElement=this.children[0]),Qr.render(this,this._elementRef,this._activeService,this._childElement)),this._hasBeenRendered=!0,Nt.onRender(this)}},{key:"disconnectedCallback",value:function(){An.chat=void 0}}])}(_n);to([Bi("object")],no.prototype,"connect"),to([Bi("object")],no.prototype,"directConnection"),to([Bi("object")],no.prototype,"webModel"),to([Bi("object")],no.prototype,"requestBodyLimits"),to([Bi("function")],no.prototype,"requestInterceptor"),to([Bi("function")],no.prototype,"responseInterceptor"),to([Bi("function")],no.prototype,"validateInput"),to([Bi("function")],no.prototype,"loadHistory"),to([Bi("object")],no.prototype,"chatStyle"),to([Bi("object")],no.prototype,"attachmentContainerStyle"),to([Bi("object")],no.prototype,"dropupStyles"),to([Bi("object")],no.prototype,"inputAreaStyle"),to([Bi("object")],no.prototype,"textInput"),to([Bi("object")],no.prototype,"submitButtonStyles"),to([Bi("string")],no.prototype,"auxiliaryStyle"),to([Bi("array")],no.prototype,"history"),to([Bi("object")],no.prototype,"introMessage"),to([Bi("object")],no.prototype,"avatars"),to([Bi("object")],no.prototype,"names"),to([Bi("boolean")],no.prototype,"displayLoadingBubble"),to([Bi("object")],no.prototype,"errorMessages"),to([Bi("object")],no.prototype,"messageStyles"),to([Bi("object")],no.prototype,"textToSpeech"),to([Bi("object")],no.prototype,"speechToText"),to([Bi("object")],no.prototype,"images"),to([Bi("object")],no.prototype,"gifs"),to([Bi("object")],no.prototype,"camera"),to([Bi("object")],no.prototype,"audio"),to([Bi("object")],no.prototype,"microphone"),to([Bi("object")],no.prototype,"mixedFiles"),to([Bi("object")],no.prototype,"dragAndDrop"),to([Bi("object")],no.prototype,"introPanelStyle"),to([Bi("object")],no.prototype,"htmlClassUtilities"),to([Bi("object")],no.prototype,"remarkable"),to([Bi("function")],no.prototype,"onMessage"),to([Bi("function")],no.prototype,"onClearMessages"),to([Bi("function")],no.prototype,"onComponentRender"),to([Bi("function")],no.prototype,"onError"),to([Bi("object")],no.prototype,"demo"),to([Bi("object")],no.prototype,"_insertKeyViewStyles"),customElements.define("deep-chat",no);const io=new Set(["children","localName","ref","style","className"]),so=new WeakMap,ro=(e,t,n,i,s)=>{const r=s?.[t];void 0===r?(e[t]=n,null==n&&t in HTMLElement.prototype&&e.removeAttribute(t)):n!==i&&((e,t,n)=>{let i=so.get(e);void 0===i&&so.set(e,i=new Map);let s=i.get(t);void 0!==n?void 0===s?(i.set(t,s={handleEvent:n}),e.addEventListener(t,s)):s.handleEvent=n:void 0!==s&&(i.delete(t),e.removeEventListener(t,s))})(e,r,n)};var oo=n(2340);const ao=(({react:e,tagName:t,elementClass:n,events:i,displayName:s})=>{const r=new Set(Object.keys(i??{})),o=e.forwardRef(((s,o)=>{const a=e.useRef(new Map),l=e.useRef(null),c={},u={};for(const[e,t]of Object.entries(s))io.has(e)?c["className"===e?"class":e]=t:r.has(e)||e in n.prototype?u[e]=t:c[e]=t;return e.useLayoutEffect((()=>{if(null===l.current)return;const e=new Map;for(const t in u)ro(l.current,t,s[t],a.current.get(t),i),a.current.delete(t),e.set(t,s[t]);for(const[t,n]of a.current)ro(l.current,t,void 0,n,i);a.current=e})),e.useLayoutEffect((()=>{l.current?.removeAttribute("defer-hydration")}),[]),c.suppressHydrationWarning=!0,e.createElement(t,{...c,ref:e.useCallback((e=>{l.current=e,"function"==typeof o?o(e):null!==o&&(o.current=e)}),[o])})}));return o.displayName=s??n.name,o})({tagName:"deep-chat",elementClass:no,react:n.t(oo,2),events:{onactivate:"activate",onchange:"change"}})}}]);